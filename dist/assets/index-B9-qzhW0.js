var Uz=Object.defineProperty;var Bz=(n,e,t)=>e in n?Uz(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Re=(n,e,t)=>Bz(n,typeof e!="symbol"?e+"":e,t);function zz(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in n)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(n,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var ai=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Cp(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function K1(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var xL={exports:{}},tv={},_L={exports:{}},yt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rp=Symbol.for("react.element"),$z=Symbol.for("react.portal"),Vz=Symbol.for("react.fragment"),Hz=Symbol.for("react.strict_mode"),Wz=Symbol.for("react.profiler"),Gz=Symbol.for("react.provider"),qz=Symbol.for("react.context"),Xz=Symbol.for("react.forward_ref"),Yz=Symbol.for("react.suspense"),Kz=Symbol.for("react.memo"),Zz=Symbol.for("react.lazy"),xk=Symbol.iterator;function Jz(n){return n===null||typeof n!="object"?null:(n=xk&&n[xk]||n["@@iterator"],typeof n=="function"?n:null)}var bL={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},wL=Object.assign,SL={};function Sd(n,e,t){this.props=n,this.context=e,this.refs=SL,this.updater=t||bL}Sd.prototype.isReactComponent={};Sd.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Sd.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function EL(){}EL.prototype=Sd.prototype;function Z1(n,e,t){this.props=n,this.context=e,this.refs=SL,this.updater=t||bL}var J1=Z1.prototype=new EL;J1.constructor=Z1;wL(J1,Sd.prototype);J1.isPureReactComponent=!0;var _k=Array.isArray,TL=Object.prototype.hasOwnProperty,Q1={current:null},ML={key:!0,ref:!0,__self:!0,__source:!0};function kL(n,e,t){var r,i={},s=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)TL.call(e,r)&&!ML.hasOwnProperty(r)&&(i[r]=e[r]);var o=arguments.length-2;if(o===1)i.children=t;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(n&&n.defaultProps)for(r in o=n.defaultProps,o)i[r]===void 0&&(i[r]=o[r]);return{$$typeof:Rp,type:n,key:s,ref:a,props:i,_owner:Q1.current}}function Qz(n,e){return{$$typeof:Rp,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function eE(n){return typeof n=="object"&&n!==null&&n.$$typeof===Rp}function e$(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var bk=/\/+/g;function Dx(n,e){return typeof n=="object"&&n!==null&&n.key!=null?e$(""+n.key):e.toString(36)}function Qg(n,e,t,r,i){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var a=!1;if(n===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(n.$$typeof){case Rp:case $z:a=!0}}if(a)return a=n,i=i(a),n=r===""?"."+Dx(a,0):r,_k(i)?(t="",n!=null&&(t=n.replace(bk,"$&/")+"/"),Qg(i,e,t,"",function(c){return c})):i!=null&&(eE(i)&&(i=Qz(i,t+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(bk,"$&/")+"/")+n)),e.push(i)),1;if(a=0,r=r===""?".":r+":",_k(n))for(var o=0;o<n.length;o++){s=n[o];var l=r+Dx(s,o);a+=Qg(s,e,t,l,i)}else if(l=Jz(n),typeof l=="function")for(n=l.call(n),o=0;!(s=n.next()).done;)s=s.value,l=r+Dx(s,o++),a+=Qg(s,e,t,l,i);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function fm(n,e,t){if(n==null)return n;var r=[],i=0;return Qg(n,r,"","",function(s){return e.call(t,s,i++)}),r}function t$(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var br={current:null},ey={transition:null},n$={ReactCurrentDispatcher:br,ReactCurrentBatchConfig:ey,ReactCurrentOwner:Q1};function AL(){throw Error("act(...) is not supported in production builds of React.")}yt.Children={map:fm,forEach:function(n,e,t){fm(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return fm(n,function(){e++}),e},toArray:function(n){return fm(n,function(e){return e})||[]},only:function(n){if(!eE(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};yt.Component=Sd;yt.Fragment=Vz;yt.Profiler=Wz;yt.PureComponent=Z1;yt.StrictMode=Hz;yt.Suspense=Yz;yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=n$;yt.act=AL;yt.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=wL({},n.props),i=n.key,s=n.ref,a=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=Q1.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var o=n.type.defaultProps;for(l in e)TL.call(e,l)&&!ML.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];r.children=o}return{$$typeof:Rp,type:n.type,key:i,ref:s,props:r,_owner:a}};yt.createContext=function(n){return n={$$typeof:qz,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:Gz,_context:n},n.Consumer=n};yt.createElement=kL;yt.createFactory=function(n){var e=kL.bind(null,n);return e.type=n,e};yt.createRef=function(){return{current:null}};yt.forwardRef=function(n){return{$$typeof:Xz,render:n}};yt.isValidElement=eE;yt.lazy=function(n){return{$$typeof:Zz,_payload:{_status:-1,_result:n},_init:t$}};yt.memo=function(n,e){return{$$typeof:Kz,type:n,compare:e===void 0?null:e}};yt.startTransition=function(n){var e=ey.transition;ey.transition={};try{n()}finally{ey.transition=e}};yt.unstable_act=AL;yt.useCallback=function(n,e){return br.current.useCallback(n,e)};yt.useContext=function(n){return br.current.useContext(n)};yt.useDebugValue=function(){};yt.useDeferredValue=function(n){return br.current.useDeferredValue(n)};yt.useEffect=function(n,e){return br.current.useEffect(n,e)};yt.useId=function(){return br.current.useId()};yt.useImperativeHandle=function(n,e,t){return br.current.useImperativeHandle(n,e,t)};yt.useInsertionEffect=function(n,e){return br.current.useInsertionEffect(n,e)};yt.useLayoutEffect=function(n,e){return br.current.useLayoutEffect(n,e)};yt.useMemo=function(n,e){return br.current.useMemo(n,e)};yt.useReducer=function(n,e,t){return br.current.useReducer(n,e,t)};yt.useRef=function(n){return br.current.useRef(n)};yt.useState=function(n){return br.current.useState(n)};yt.useSyncExternalStore=function(n,e,t){return br.current.useSyncExternalStore(n,e,t)};yt.useTransition=function(){return br.current.useTransition()};yt.version="18.3.1";_L.exports=yt;var k=_L.exports;const tE=Cp(k),r$=zz({__proto__:null,default:tE},[k]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i$=k,s$=Symbol.for("react.element"),a$=Symbol.for("react.fragment"),o$=Object.prototype.hasOwnProperty,l$=i$.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c$={key:!0,ref:!0,__self:!0,__source:!0};function PL(n,e,t){var r,i={},s=null,a=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)o$.call(e,r)&&!c$.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:s$,type:n,key:s,ref:a,props:i,_owner:l$.current}}tv.Fragment=a$;tv.jsx=PL;tv.jsxs=PL;xL.exports=tv;var f=xL.exports,CL={exports:{}},ui={},RL={exports:{}},NL={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(L,D){var z=L.length;L.push(D);e:for(;0<z;){var K=z-1>>>1,re=L[K];if(0<i(re,D))L[K]=D,L[z]=re,z=K;else break e}}function t(L){return L.length===0?null:L[0]}function r(L){if(L.length===0)return null;var D=L[0],z=L.pop();if(z!==D){L[0]=z;e:for(var K=0,re=L.length,Se=re>>>1;K<Se;){var G=2*(K+1)-1,ne=L[G],ye=G+1,se=L[ye];if(0>i(ne,z))ye<re&&0>i(se,ne)?(L[K]=se,L[ye]=z,K=ye):(L[K]=ne,L[G]=z,K=G);else if(ye<re&&0>i(se,z))L[K]=se,L[ye]=z,K=ye;else break e}}return D}function i(L,D){var z=L.sortIndex-D.sortIndex;return z!==0?z:L.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,d=null,h=3,p=!1,y=!1,v=!1,g=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(L){for(var D=t(c);D!==null;){if(D.callback===null)r(c);else if(D.startTime<=L)r(c),D.sortIndex=D.expirationTime,e(l,D);else break;D=t(c)}}function b(L){if(v=!1,_(L),!y)if(t(l)!==null)y=!0,F(w);else{var D=t(c);D!==null&&j(b,D.startTime-L)}}function w(L,D){y=!1,v&&(v=!1,m(M),M=-1),p=!0;var z=h;try{for(_(D),d=t(l);d!==null&&(!(d.expirationTime>D)||L&&!P());){var K=d.callback;if(typeof K=="function"){d.callback=null,h=d.priorityLevel;var re=K(d.expirationTime<=D);D=n.unstable_now(),typeof re=="function"?d.callback=re:d===t(l)&&r(l),_(D)}else r(l);d=t(l)}if(d!==null)var Se=!0;else{var G=t(c);G!==null&&j(b,G.startTime-D),Se=!1}return Se}finally{d=null,h=z,p=!1}}var E=!1,S=null,M=-1,N=5,T=-1;function P(){return!(n.unstable_now()-T<N)}function H(){if(S!==null){var L=n.unstable_now();T=L;var D=!0;try{D=S(!0,L)}finally{D?W():(E=!1,S=null)}}else E=!1}var W;if(typeof x=="function")W=function(){x(H)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,I=O.port2;O.port1.onmessage=H,W=function(){I.postMessage(null)}}else W=function(){g(H,0)};function F(L){S=L,E||(E=!0,W())}function j(L,D){M=g(function(){L(n.unstable_now())},D)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(L){L.callback=null},n.unstable_continueExecution=function(){y||p||(y=!0,F(w))},n.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<L?Math.floor(1e3/L):5},n.unstable_getCurrentPriorityLevel=function(){return h},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(L){switch(h){case 1:case 2:case 3:var D=3;break;default:D=h}var z=h;h=D;try{return L()}finally{h=z}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(L,D){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var z=h;h=L;try{return D()}finally{h=z}},n.unstable_scheduleCallback=function(L,D,z){var K=n.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?K+z:K):z=K,L){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=z+re,L={id:u++,callback:D,priorityLevel:L,startTime:z,expirationTime:re,sortIndex:-1},z>K?(L.sortIndex=z,e(c,L),t(l)===null&&L===t(c)&&(v?(m(M),M=-1):v=!0,j(b,z-K))):(L.sortIndex=re,e(l,L),y||p||(y=!0,F(w))),L},n.unstable_shouldYield=P,n.unstable_wrapCallback=function(L){var D=h;return function(){var z=h;h=D;try{return L.apply(this,arguments)}finally{h=z}}}})(NL);RL.exports=NL;var u$=RL.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var d$=k,oi=u$;function _e(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var OL=new Set,Rf={};function vc(n,e){Zu(n,e),Zu(n+"Capture",e)}function Zu(n,e){for(Rf[n]=e,n=0;n<e.length;n++)OL.add(e[n])}var Aa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xw=Object.prototype.hasOwnProperty,h$=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,wk={},Sk={};function f$(n){return xw.call(Sk,n)?!0:xw.call(wk,n)?!1:h$.test(n)?Sk[n]=!0:(wk[n]=!0,!1)}function p$(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function m$(n,e,t,r){if(e===null||typeof e>"u"||p$(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function wr(n,e,t,r,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var zn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){zn[n]=new wr(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];zn[e]=new wr(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){zn[n]=new wr(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){zn[n]=new wr(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){zn[n]=new wr(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){zn[n]=new wr(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){zn[n]=new wr(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){zn[n]=new wr(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){zn[n]=new wr(n,5,!1,n.toLowerCase(),null,!1,!1)});var nE=/[\-:]([a-z])/g;function rE(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(nE,rE);zn[e]=new wr(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(nE,rE);zn[e]=new wr(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(nE,rE);zn[e]=new wr(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){zn[n]=new wr(n,1,!1,n.toLowerCase(),null,!1,!1)});zn.xlinkHref=new wr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){zn[n]=new wr(n,1,!1,n.toLowerCase(),null,!0,!0)});function iE(n,e,t,r){var i=zn.hasOwnProperty(e)?zn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(m$(e,t,i,r)&&(t=null),r||i===null?f$(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var Da=d$.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,pm=Symbol.for("react.element"),hu=Symbol.for("react.portal"),fu=Symbol.for("react.fragment"),sE=Symbol.for("react.strict_mode"),_w=Symbol.for("react.profiler"),LL=Symbol.for("react.provider"),DL=Symbol.for("react.context"),aE=Symbol.for("react.forward_ref"),bw=Symbol.for("react.suspense"),ww=Symbol.for("react.suspense_list"),oE=Symbol.for("react.memo"),so=Symbol.for("react.lazy"),IL=Symbol.for("react.offscreen"),Ek=Symbol.iterator;function Hd(n){return n===null||typeof n!="object"?null:(n=Ek&&n[Ek]||n["@@iterator"],typeof n=="function"?n:null)}var sn=Object.assign,Ix;function Dh(n){if(Ix===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Ix=e&&e[1]||""}return`
`+Ix+n}var jx=!1;function Fx(n,e){if(!n||jx)return"";jx=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(n,[],e)}else{try{e.call()}catch(c){r=c}n.call(e.prototype)}else{try{throw Error()}catch(c){r=c}n()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=a&&0<=o);break}}}finally{jx=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Dh(n):""}function g$(n){switch(n.tag){case 5:return Dh(n.type);case 16:return Dh("Lazy");case 13:return Dh("Suspense");case 19:return Dh("SuspenseList");case 0:case 2:case 15:return n=Fx(n.type,!1),n;case 11:return n=Fx(n.type.render,!1),n;case 1:return n=Fx(n.type,!0),n;default:return""}}function Sw(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case fu:return"Fragment";case hu:return"Portal";case _w:return"Profiler";case sE:return"StrictMode";case bw:return"Suspense";case ww:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case DL:return(n.displayName||"Context")+".Consumer";case LL:return(n._context.displayName||"Context")+".Provider";case aE:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case oE:return e=n.displayName||null,e!==null?e:Sw(n.type)||"Memo";case so:e=n._payload,n=n._init;try{return Sw(n(e))}catch{}}return null}function y$(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Sw(e);case 8:return e===sE?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Fo(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function jL(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function v$(n){var e=jL(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,s.call(this,a)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function mm(n){n._valueTracker||(n._valueTracker=v$(n))}function FL(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=jL(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function Ay(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Ew(n,e){var t=e.checked;return sn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function Tk(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=Fo(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function UL(n,e){e=e.checked,e!=null&&iE(n,"checked",e,!1)}function Tw(n,e){UL(n,e);var t=Fo(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Mw(n,e.type,t):e.hasOwnProperty("defaultValue")&&Mw(n,e.type,Fo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function Mk(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Mw(n,e,t){(e!=="number"||Ay(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Ih=Array.isArray;function Iu(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+Fo(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function kw(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(_e(91));return sn({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function kk(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(_e(92));if(Ih(t)){if(1<t.length)throw Error(_e(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Fo(t)}}function BL(n,e){var t=Fo(e.value),r=Fo(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function Ak(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function zL(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Aw(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?zL(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var gm,$L=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(gm=gm||document.createElement("div"),gm.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=gm.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Nf(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Jh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},x$=["Webkit","ms","Moz","O"];Object.keys(Jh).forEach(function(n){x$.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Jh[e]=Jh[n]})});function VL(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Jh.hasOwnProperty(n)&&Jh[n]?(""+e).trim():e+"px"}function HL(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=VL(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var _$=sn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Pw(n,e){if(e){if(_$[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(_e(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(_e(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(_e(61))}if(e.style!=null&&typeof e.style!="object")throw Error(_e(62))}}function Cw(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rw=null;function lE(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Nw=null,ju=null,Fu=null;function Pk(n){if(n=Lp(n)){if(typeof Nw!="function")throw Error(_e(280));var e=n.stateNode;e&&(e=av(e),Nw(n.stateNode,n.type,e))}}function WL(n){ju?Fu?Fu.push(n):Fu=[n]:ju=n}function GL(){if(ju){var n=ju,e=Fu;if(Fu=ju=null,Pk(n),e)for(n=0;n<e.length;n++)Pk(e[n])}}function qL(n,e){return n(e)}function XL(){}var Ux=!1;function YL(n,e,t){if(Ux)return n(e,t);Ux=!0;try{return qL(n,e,t)}finally{Ux=!1,(ju!==null||Fu!==null)&&(XL(),GL())}}function Of(n,e){var t=n.stateNode;if(t===null)return null;var r=av(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(_e(231,e,typeof t));return t}var Ow=!1;if(Aa)try{var Wd={};Object.defineProperty(Wd,"passive",{get:function(){Ow=!0}}),window.addEventListener("test",Wd,Wd),window.removeEventListener("test",Wd,Wd)}catch{Ow=!1}function b$(n,e,t,r,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(u){this.onError(u)}}var Qh=!1,Py=null,Cy=!1,Lw=null,w$={onError:function(n){Qh=!0,Py=n}};function S$(n,e,t,r,i,s,a,o,l){Qh=!1,Py=null,b$.apply(w$,arguments)}function E$(n,e,t,r,i,s,a,o,l){if(S$.apply(this,arguments),Qh){if(Qh){var c=Py;Qh=!1,Py=null}else throw Error(_e(198));Cy||(Cy=!0,Lw=c)}}function xc(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function KL(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function Ck(n){if(xc(n)!==n)throw Error(_e(188))}function T$(n){var e=n.alternate;if(!e){if(e=xc(n),e===null)throw Error(_e(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===t)return Ck(i),n;if(s===r)return Ck(i),e;s=s.sibling}throw Error(_e(188))}if(t.return!==r.return)t=i,r=s;else{for(var a=!1,o=i.child;o;){if(o===t){a=!0,t=i,r=s;break}if(o===r){a=!0,r=i,t=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===t){a=!0,t=s,r=i;break}if(o===r){a=!0,r=s,t=i;break}o=o.sibling}if(!a)throw Error(_e(189))}}if(t.alternate!==r)throw Error(_e(190))}if(t.tag!==3)throw Error(_e(188));return t.stateNode.current===t?n:e}function ZL(n){return n=T$(n),n!==null?JL(n):null}function JL(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=JL(n);if(e!==null)return e;n=n.sibling}return null}var QL=oi.unstable_scheduleCallback,Rk=oi.unstable_cancelCallback,M$=oi.unstable_shouldYield,k$=oi.unstable_requestPaint,hn=oi.unstable_now,A$=oi.unstable_getCurrentPriorityLevel,cE=oi.unstable_ImmediatePriority,eD=oi.unstable_UserBlockingPriority,Ry=oi.unstable_NormalPriority,P$=oi.unstable_LowPriority,tD=oi.unstable_IdlePriority,nv=null,Cs=null;function C$(n){if(Cs&&typeof Cs.onCommitFiberRoot=="function")try{Cs.onCommitFiberRoot(nv,n,void 0,(n.current.flags&128)===128)}catch{}}var Ki=Math.clz32?Math.clz32:O$,R$=Math.log,N$=Math.LN2;function O$(n){return n>>>=0,n===0?32:31-(R$(n)/N$|0)|0}var ym=64,vm=4194304;function jh(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Ny(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,s=n.pingedLanes,a=t&268435455;if(a!==0){var o=a&~i;o!==0?r=jh(o):(s&=a,s!==0&&(r=jh(s)))}else a=t&~i,a!==0?r=jh(a):s!==0&&(r=jh(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-Ki(e),i=1<<t,r|=n[t],e&=~i;return r}function L$(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function D$(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,s=n.pendingLanes;0<s;){var a=31-Ki(s),o=1<<a,l=i[a];l===-1?(!(o&t)||o&r)&&(i[a]=L$(o,e)):l<=e&&(n.expiredLanes|=o),s&=~o}}function Dw(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function nD(){var n=ym;return ym<<=1,!(ym&4194240)&&(ym=64),n}function Bx(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Np(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Ki(e),n[e]=t}function I$(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-Ki(t),s=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~s}}function uE(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-Ki(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var jt=0;function rD(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var iD,dE,sD,aD,oD,Iw=!1,xm=[],To=null,Mo=null,ko=null,Lf=new Map,Df=new Map,uo=[],j$="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Nk(n,e){switch(n){case"focusin":case"focusout":To=null;break;case"dragenter":case"dragleave":Mo=null;break;case"mouseover":case"mouseout":ko=null;break;case"pointerover":case"pointerout":Lf.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Df.delete(e.pointerId)}}function Gd(n,e,t,r,i,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Lp(e),e!==null&&dE(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function F$(n,e,t,r,i){switch(e){case"focusin":return To=Gd(To,n,e,t,r,i),!0;case"dragenter":return Mo=Gd(Mo,n,e,t,r,i),!0;case"mouseover":return ko=Gd(ko,n,e,t,r,i),!0;case"pointerover":var s=i.pointerId;return Lf.set(s,Gd(Lf.get(s)||null,n,e,t,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Df.set(s,Gd(Df.get(s)||null,n,e,t,r,i)),!0}return!1}function lD(n){var e=Nl(n.target);if(e!==null){var t=xc(e);if(t!==null){if(e=t.tag,e===13){if(e=KL(t),e!==null){n.blockedOn=e,oD(n.priority,function(){sD(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function ty(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=jw(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);Rw=r,t.target.dispatchEvent(r),Rw=null}else return e=Lp(t),e!==null&&dE(e),n.blockedOn=t,!1;e.shift()}return!0}function Ok(n,e,t){ty(n)&&t.delete(e)}function U$(){Iw=!1,To!==null&&ty(To)&&(To=null),Mo!==null&&ty(Mo)&&(Mo=null),ko!==null&&ty(ko)&&(ko=null),Lf.forEach(Ok),Df.forEach(Ok)}function qd(n,e){n.blockedOn===e&&(n.blockedOn=null,Iw||(Iw=!0,oi.unstable_scheduleCallback(oi.unstable_NormalPriority,U$)))}function If(n){function e(i){return qd(i,n)}if(0<xm.length){qd(xm[0],n);for(var t=1;t<xm.length;t++){var r=xm[t];r.blockedOn===n&&(r.blockedOn=null)}}for(To!==null&&qd(To,n),Mo!==null&&qd(Mo,n),ko!==null&&qd(ko,n),Lf.forEach(e),Df.forEach(e),t=0;t<uo.length;t++)r=uo[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<uo.length&&(t=uo[0],t.blockedOn===null);)lD(t),t.blockedOn===null&&uo.shift()}var Uu=Da.ReactCurrentBatchConfig,Oy=!0;function B$(n,e,t,r){var i=jt,s=Uu.transition;Uu.transition=null;try{jt=1,hE(n,e,t,r)}finally{jt=i,Uu.transition=s}}function z$(n,e,t,r){var i=jt,s=Uu.transition;Uu.transition=null;try{jt=4,hE(n,e,t,r)}finally{jt=i,Uu.transition=s}}function hE(n,e,t,r){if(Oy){var i=jw(n,e,t,r);if(i===null)Kx(n,e,r,Ly,t),Nk(n,r);else if(F$(i,n,e,t,r))r.stopPropagation();else if(Nk(n,r),e&4&&-1<j$.indexOf(n)){for(;i!==null;){var s=Lp(i);if(s!==null&&iD(s),s=jw(n,e,t,r),s===null&&Kx(n,e,r,Ly,t),s===i)break;i=s}i!==null&&r.stopPropagation()}else Kx(n,e,r,null,t)}}var Ly=null;function jw(n,e,t,r){if(Ly=null,n=lE(r),n=Nl(n),n!==null)if(e=xc(n),e===null)n=null;else if(t=e.tag,t===13){if(n=KL(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Ly=n,null}function cD(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(A$()){case cE:return 1;case eD:return 4;case Ry:case P$:return 16;case tD:return 536870912;default:return 16}default:return 16}}var go=null,fE=null,ny=null;function uD(){if(ny)return ny;var n,e=fE,t=e.length,r,i="value"in go?go.value:go.textContent,s=i.length;for(n=0;n<t&&e[n]===i[n];n++);var a=t-n;for(r=1;r<=a&&e[t-r]===i[s-r];r++);return ny=i.slice(n,1<r?1-r:void 0)}function ry(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function _m(){return!0}function Lk(){return!1}function di(n){function e(t,r,i,s,a){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in n)n.hasOwnProperty(o)&&(t=n[o],this[o]=t?t(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?_m:Lk,this.isPropagationStopped=Lk,this}return sn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=_m)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=_m)},persist:function(){},isPersistent:_m}),e}var Ed={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pE=di(Ed),Op=sn({},Ed,{view:0,detail:0}),$$=di(Op),zx,$x,Xd,rv=sn({},Op,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:mE,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Xd&&(Xd&&n.type==="mousemove"?(zx=n.screenX-Xd.screenX,$x=n.screenY-Xd.screenY):$x=zx=0,Xd=n),zx)},movementY:function(n){return"movementY"in n?n.movementY:$x}}),Dk=di(rv),V$=sn({},rv,{dataTransfer:0}),H$=di(V$),W$=sn({},Op,{relatedTarget:0}),Vx=di(W$),G$=sn({},Ed,{animationName:0,elapsedTime:0,pseudoElement:0}),q$=di(G$),X$=sn({},Ed,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Y$=di(X$),K$=sn({},Ed,{data:0}),Ik=di(K$),Z$={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},J$={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Q$={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function e5(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=Q$[n])?!!e[n]:!1}function mE(){return e5}var t5=sn({},Op,{key:function(n){if(n.key){var e=Z$[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=ry(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?J$[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:mE,charCode:function(n){return n.type==="keypress"?ry(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?ry(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),n5=di(t5),r5=sn({},rv,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jk=di(r5),i5=sn({},Op,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:mE}),s5=di(i5),a5=sn({},Ed,{propertyName:0,elapsedTime:0,pseudoElement:0}),o5=di(a5),l5=sn({},rv,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),c5=di(l5),u5=[9,13,27,32],gE=Aa&&"CompositionEvent"in window,ef=null;Aa&&"documentMode"in document&&(ef=document.documentMode);var d5=Aa&&"TextEvent"in window&&!ef,dD=Aa&&(!gE||ef&&8<ef&&11>=ef),Fk=" ",Uk=!1;function hD(n,e){switch(n){case"keyup":return u5.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fD(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var pu=!1;function h5(n,e){switch(n){case"compositionend":return fD(e);case"keypress":return e.which!==32?null:(Uk=!0,Fk);case"textInput":return n=e.data,n===Fk&&Uk?null:n;default:return null}}function f5(n,e){if(pu)return n==="compositionend"||!gE&&hD(n,e)?(n=uD(),ny=fE=go=null,pu=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return dD&&e.locale!=="ko"?null:e.data;default:return null}}var p5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Bk(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!p5[n.type]:e==="textarea"}function pD(n,e,t,r){WL(r),e=Dy(e,"onChange"),0<e.length&&(t=new pE("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var tf=null,jf=null;function m5(n){TD(n,0)}function iv(n){var e=yu(n);if(FL(e))return n}function g5(n,e){if(n==="change")return e}var mD=!1;if(Aa){var Hx;if(Aa){var Wx="oninput"in document;if(!Wx){var zk=document.createElement("div");zk.setAttribute("oninput","return;"),Wx=typeof zk.oninput=="function"}Hx=Wx}else Hx=!1;mD=Hx&&(!document.documentMode||9<document.documentMode)}function $k(){tf&&(tf.detachEvent("onpropertychange",gD),jf=tf=null)}function gD(n){if(n.propertyName==="value"&&iv(jf)){var e=[];pD(e,jf,n,lE(n)),YL(m5,e)}}function y5(n,e,t){n==="focusin"?($k(),tf=e,jf=t,tf.attachEvent("onpropertychange",gD)):n==="focusout"&&$k()}function v5(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return iv(jf)}function x5(n,e){if(n==="click")return iv(e)}function _5(n,e){if(n==="input"||n==="change")return iv(e)}function b5(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var rs=typeof Object.is=="function"?Object.is:b5;function Ff(n,e){if(rs(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!xw.call(e,i)||!rs(n[i],e[i]))return!1}return!0}function Vk(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Hk(n,e){var t=Vk(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=Vk(t)}}function yD(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?yD(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function vD(){for(var n=window,e=Ay();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Ay(n.document)}return e}function yE(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function w5(n){var e=vD(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&yD(t.ownerDocument.documentElement,t)){if(r!==null&&yE(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!n.extend&&s>r&&(i=r,r=s,s=i),i=Hk(t,s);var a=Hk(t,r);i&&a&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==a.node||n.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),s>r?(n.addRange(e),n.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var S5=Aa&&"documentMode"in document&&11>=document.documentMode,mu=null,Fw=null,nf=null,Uw=!1;function Wk(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Uw||mu==null||mu!==Ay(r)||(r=mu,"selectionStart"in r&&yE(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),nf&&Ff(nf,r)||(nf=r,r=Dy(Fw,"onSelect"),0<r.length&&(e=new pE("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=mu)))}function bm(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var gu={animationend:bm("Animation","AnimationEnd"),animationiteration:bm("Animation","AnimationIteration"),animationstart:bm("Animation","AnimationStart"),transitionend:bm("Transition","TransitionEnd")},Gx={},xD={};Aa&&(xD=document.createElement("div").style,"AnimationEvent"in window||(delete gu.animationend.animation,delete gu.animationiteration.animation,delete gu.animationstart.animation),"TransitionEvent"in window||delete gu.transitionend.transition);function sv(n){if(Gx[n])return Gx[n];if(!gu[n])return n;var e=gu[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in xD)return Gx[n]=e[t];return n}var _D=sv("animationend"),bD=sv("animationiteration"),wD=sv("animationstart"),SD=sv("transitionend"),ED=new Map,Gk="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Yo(n,e){ED.set(n,e),vc(e,[n])}for(var qx=0;qx<Gk.length;qx++){var Xx=Gk[qx],E5=Xx.toLowerCase(),T5=Xx[0].toUpperCase()+Xx.slice(1);Yo(E5,"on"+T5)}Yo(_D,"onAnimationEnd");Yo(bD,"onAnimationIteration");Yo(wD,"onAnimationStart");Yo("dblclick","onDoubleClick");Yo("focusin","onFocus");Yo("focusout","onBlur");Yo(SD,"onTransitionEnd");Zu("onMouseEnter",["mouseout","mouseover"]);Zu("onMouseLeave",["mouseout","mouseover"]);Zu("onPointerEnter",["pointerout","pointerover"]);Zu("onPointerLeave",["pointerout","pointerover"]);vc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vc("onBeforeInput",["compositionend","keypress","textInput","paste"]);vc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),M5=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fh));function qk(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,E$(r,e,void 0,n),n.currentTarget=null}function TD(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var a=r.length-1;0<=a;a--){var o=r[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;qk(i,o,c),s=l}else for(a=0;a<r.length;a++){if(o=r[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;qk(i,o,c),s=l}}}if(Cy)throw n=Lw,Cy=!1,Lw=null,n}function Wt(n,e){var t=e[Hw];t===void 0&&(t=e[Hw]=new Set);var r=n+"__bubble";t.has(r)||(MD(e,n,2,!1),t.add(r))}function Yx(n,e,t){var r=0;e&&(r|=4),MD(t,n,r,e)}var wm="_reactListening"+Math.random().toString(36).slice(2);function Uf(n){if(!n[wm]){n[wm]=!0,OL.forEach(function(t){t!=="selectionchange"&&(M5.has(t)||Yx(t,!1,n),Yx(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[wm]||(e[wm]=!0,Yx("selectionchange",!1,e))}}function MD(n,e,t,r){switch(cD(e)){case 1:var i=B$;break;case 4:i=z$;break;default:i=hE}t=i.bind(null,e,t,n),i=void 0,!Ow||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function Kx(n,e,t,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var o=r.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=Nl(o),a===null)return;if(l=a.tag,l===5||l===6){r=s=a;continue e}o=o.parentNode}}r=r.return}YL(function(){var c=s,u=lE(t),d=[];e:{var h=ED.get(n);if(h!==void 0){var p=pE,y=n;switch(n){case"keypress":if(ry(t)===0)break e;case"keydown":case"keyup":p=n5;break;case"focusin":y="focus",p=Vx;break;case"focusout":y="blur",p=Vx;break;case"beforeblur":case"afterblur":p=Vx;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Dk;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=H$;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=s5;break;case _D:case bD:case wD:p=q$;break;case SD:p=o5;break;case"scroll":p=$$;break;case"wheel":p=c5;break;case"copy":case"cut":case"paste":p=Y$;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=jk}var v=(e&4)!==0,g=!v&&n==="scroll",m=v?h!==null?h+"Capture":null:h;v=[];for(var x=c,_;x!==null;){_=x;var b=_.stateNode;if(_.tag===5&&b!==null&&(_=b,m!==null&&(b=Of(x,m),b!=null&&v.push(Bf(x,b,_)))),g)break;x=x.return}0<v.length&&(h=new p(h,y,null,t,u),d.push({event:h,listeners:v}))}}if(!(e&7)){e:{if(h=n==="mouseover"||n==="pointerover",p=n==="mouseout"||n==="pointerout",h&&t!==Rw&&(y=t.relatedTarget||t.fromElement)&&(Nl(y)||y[Pa]))break e;if((p||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,p?(y=t.relatedTarget||t.toElement,p=c,y=y?Nl(y):null,y!==null&&(g=xc(y),y!==g||y.tag!==5&&y.tag!==6)&&(y=null)):(p=null,y=c),p!==y)){if(v=Dk,b="onMouseLeave",m="onMouseEnter",x="mouse",(n==="pointerout"||n==="pointerover")&&(v=jk,b="onPointerLeave",m="onPointerEnter",x="pointer"),g=p==null?h:yu(p),_=y==null?h:yu(y),h=new v(b,x+"leave",p,t,u),h.target=g,h.relatedTarget=_,b=null,Nl(u)===c&&(v=new v(m,x+"enter",y,t,u),v.target=_,v.relatedTarget=g,b=v),g=b,p&&y)t:{for(v=p,m=y,x=0,_=v;_;_=Pc(_))x++;for(_=0,b=m;b;b=Pc(b))_++;for(;0<x-_;)v=Pc(v),x--;for(;0<_-x;)m=Pc(m),_--;for(;x--;){if(v===m||m!==null&&v===m.alternate)break t;v=Pc(v),m=Pc(m)}v=null}else v=null;p!==null&&Xk(d,h,p,v,!1),y!==null&&g!==null&&Xk(d,g,y,v,!0)}}e:{if(h=c?yu(c):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var w=g5;else if(Bk(h))if(mD)w=_5;else{w=v5;var E=y5}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(w=x5);if(w&&(w=w(n,c))){pD(d,w,t,u);break e}E&&E(n,h,c),n==="focusout"&&(E=h._wrapperState)&&E.controlled&&h.type==="number"&&Mw(h,"number",h.value)}switch(E=c?yu(c):window,n){case"focusin":(Bk(E)||E.contentEditable==="true")&&(mu=E,Fw=c,nf=null);break;case"focusout":nf=Fw=mu=null;break;case"mousedown":Uw=!0;break;case"contextmenu":case"mouseup":case"dragend":Uw=!1,Wk(d,t,u);break;case"selectionchange":if(S5)break;case"keydown":case"keyup":Wk(d,t,u)}var S;if(gE)e:{switch(n){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else pu?hD(n,t)&&(M="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(M="onCompositionStart");M&&(dD&&t.locale!=="ko"&&(pu||M!=="onCompositionStart"?M==="onCompositionEnd"&&pu&&(S=uD()):(go=u,fE="value"in go?go.value:go.textContent,pu=!0)),E=Dy(c,M),0<E.length&&(M=new Ik(M,n,null,t,u),d.push({event:M,listeners:E}),S?M.data=S:(S=fD(t),S!==null&&(M.data=S)))),(S=d5?h5(n,t):f5(n,t))&&(c=Dy(c,"onBeforeInput"),0<c.length&&(u=new Ik("onBeforeInput","beforeinput",null,t,u),d.push({event:u,listeners:c}),u.data=S))}TD(d,e)})}function Bf(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Dy(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Of(n,t),s!=null&&r.unshift(Bf(n,s,i)),s=Of(n,e),s!=null&&r.push(Bf(n,s,i))),n=n.return}return r}function Pc(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Xk(n,e,t,r,i){for(var s=e._reactName,a=[];t!==null&&t!==r;){var o=t,l=o.alternate,c=o.stateNode;if(l!==null&&l===r)break;o.tag===5&&c!==null&&(o=c,i?(l=Of(t,s),l!=null&&a.unshift(Bf(t,l,o))):i||(l=Of(t,s),l!=null&&a.push(Bf(t,l,o)))),t=t.return}a.length!==0&&n.push({event:e,listeners:a})}var k5=/\r\n?/g,A5=/\u0000|\uFFFD/g;function Yk(n){return(typeof n=="string"?n:""+n).replace(k5,`
`).replace(A5,"")}function Sm(n,e,t){if(e=Yk(e),Yk(n)!==e&&t)throw Error(_e(425))}function Iy(){}var Bw=null,zw=null;function $w(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Vw=typeof setTimeout=="function"?setTimeout:void 0,P5=typeof clearTimeout=="function"?clearTimeout:void 0,Kk=typeof Promise=="function"?Promise:void 0,C5=typeof queueMicrotask=="function"?queueMicrotask:typeof Kk<"u"?function(n){return Kk.resolve(null).then(n).catch(R5)}:Vw;function R5(n){setTimeout(function(){throw n})}function Zx(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),If(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);If(e)}function Ao(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function Zk(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Td=Math.random().toString(36).slice(2),Ts="__reactFiber$"+Td,zf="__reactProps$"+Td,Pa="__reactContainer$"+Td,Hw="__reactEvents$"+Td,N5="__reactListeners$"+Td,O5="__reactHandles$"+Td;function Nl(n){var e=n[Ts];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Pa]||t[Ts]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=Zk(n);n!==null;){if(t=n[Ts])return t;n=Zk(n)}return e}n=t,t=n.parentNode}return null}function Lp(n){return n=n[Ts]||n[Pa],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function yu(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(_e(33))}function av(n){return n[zf]||null}var Ww=[],vu=-1;function Ko(n){return{current:n}}function Xt(n){0>vu||(n.current=Ww[vu],Ww[vu]=null,vu--)}function $t(n,e){vu++,Ww[vu]=n.current,n.current=e}var Uo={},sr=Ko(Uo),jr=Ko(!1),tc=Uo;function Ju(n,e){var t=n.type.contextTypes;if(!t)return Uo;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in t)i[s]=e[s];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function Fr(n){return n=n.childContextTypes,n!=null}function jy(){Xt(jr),Xt(sr)}function Jk(n,e,t){if(sr.current!==Uo)throw Error(_e(168));$t(sr,e),$t(jr,t)}function kD(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(_e(108,y$(n)||"Unknown",i));return sn({},t,r)}function Fy(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Uo,tc=sr.current,$t(sr,n),$t(jr,jr.current),!0}function Qk(n,e,t){var r=n.stateNode;if(!r)throw Error(_e(169));t?(n=kD(n,e,tc),r.__reactInternalMemoizedMergedChildContext=n,Xt(jr),Xt(sr),$t(sr,n)):Xt(jr),$t(jr,t)}var la=null,ov=!1,Jx=!1;function AD(n){la===null?la=[n]:la.push(n)}function L5(n){ov=!0,AD(n)}function Zo(){if(!Jx&&la!==null){Jx=!0;var n=0,e=jt;try{var t=la;for(jt=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}la=null,ov=!1}catch(i){throw la!==null&&(la=la.slice(n+1)),QL(cE,Zo),i}finally{jt=e,Jx=!1}}return null}var xu=[],_u=0,Uy=null,By=0,wi=[],Si=0,nc=null,fa=1,pa="";function vl(n,e){xu[_u++]=By,xu[_u++]=Uy,Uy=n,By=e}function PD(n,e,t){wi[Si++]=fa,wi[Si++]=pa,wi[Si++]=nc,nc=n;var r=fa;n=pa;var i=32-Ki(r)-1;r&=~(1<<i),t+=1;var s=32-Ki(e)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,fa=1<<32-Ki(e)+i|t<<i|r,pa=s+n}else fa=1<<s|t<<i|r,pa=n}function vE(n){n.return!==null&&(vl(n,1),PD(n,1,0))}function xE(n){for(;n===Uy;)Uy=xu[--_u],xu[_u]=null,By=xu[--_u],xu[_u]=null;for(;n===nc;)nc=wi[--Si],wi[Si]=null,pa=wi[--Si],wi[Si]=null,fa=wi[--Si],wi[Si]=null}var ti=null,ei=null,Zt=!1,Hi=null;function CD(n,e){var t=Ti(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function eA(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,ti=n,ei=Ao(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,ti=n,ei=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=nc!==null?{id:fa,overflow:pa}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Ti(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,ti=n,ei=null,!0):!1;default:return!1}}function Gw(n){return(n.mode&1)!==0&&(n.flags&128)===0}function qw(n){if(Zt){var e=ei;if(e){var t=e;if(!eA(n,e)){if(Gw(n))throw Error(_e(418));e=Ao(t.nextSibling);var r=ti;e&&eA(n,e)?CD(r,t):(n.flags=n.flags&-4097|2,Zt=!1,ti=n)}}else{if(Gw(n))throw Error(_e(418));n.flags=n.flags&-4097|2,Zt=!1,ti=n}}}function tA(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;ti=n}function Em(n){if(n!==ti)return!1;if(!Zt)return tA(n),Zt=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!$w(n.type,n.memoizedProps)),e&&(e=ei)){if(Gw(n))throw RD(),Error(_e(418));for(;e;)CD(n,e),e=Ao(e.nextSibling)}if(tA(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(_e(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){ei=Ao(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}ei=null}}else ei=ti?Ao(n.stateNode.nextSibling):null;return!0}function RD(){for(var n=ei;n;)n=Ao(n.nextSibling)}function Qu(){ei=ti=null,Zt=!1}function _E(n){Hi===null?Hi=[n]:Hi.push(n)}var D5=Da.ReactCurrentBatchConfig;function Yd(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(_e(309));var r=t.stateNode}if(!r)throw Error(_e(147,n));var i=r,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof n!="string")throw Error(_e(284));if(!t._owner)throw Error(_e(290,n))}return n}function Tm(n,e){throw n=Object.prototype.toString.call(e),Error(_e(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function nA(n){var e=n._init;return e(n._payload)}function ND(n){function e(m,x){if(n){var _=m.deletions;_===null?(m.deletions=[x],m.flags|=16):_.push(x)}}function t(m,x){if(!n)return null;for(;x!==null;)e(m,x),x=x.sibling;return null}function r(m,x){for(m=new Map;x!==null;)x.key!==null?m.set(x.key,x):m.set(x.index,x),x=x.sibling;return m}function i(m,x){return m=No(m,x),m.index=0,m.sibling=null,m}function s(m,x,_){return m.index=_,n?(_=m.alternate,_!==null?(_=_.index,_<x?(m.flags|=2,x):_):(m.flags|=2,x)):(m.flags|=1048576,x)}function a(m){return n&&m.alternate===null&&(m.flags|=2),m}function o(m,x,_,b){return x===null||x.tag!==6?(x=s_(_,m.mode,b),x.return=m,x):(x=i(x,_),x.return=m,x)}function l(m,x,_,b){var w=_.type;return w===fu?u(m,x,_.props.children,b,_.key):x!==null&&(x.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===so&&nA(w)===x.type)?(b=i(x,_.props),b.ref=Yd(m,x,_),b.return=m,b):(b=uy(_.type,_.key,_.props,null,m.mode,b),b.ref=Yd(m,x,_),b.return=m,b)}function c(m,x,_,b){return x===null||x.tag!==4||x.stateNode.containerInfo!==_.containerInfo||x.stateNode.implementation!==_.implementation?(x=a_(_,m.mode,b),x.return=m,x):(x=i(x,_.children||[]),x.return=m,x)}function u(m,x,_,b,w){return x===null||x.tag!==7?(x=Hl(_,m.mode,b,w),x.return=m,x):(x=i(x,_),x.return=m,x)}function d(m,x,_){if(typeof x=="string"&&x!==""||typeof x=="number")return x=s_(""+x,m.mode,_),x.return=m,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case pm:return _=uy(x.type,x.key,x.props,null,m.mode,_),_.ref=Yd(m,null,x),_.return=m,_;case hu:return x=a_(x,m.mode,_),x.return=m,x;case so:var b=x._init;return d(m,b(x._payload),_)}if(Ih(x)||Hd(x))return x=Hl(x,m.mode,_,null),x.return=m,x;Tm(m,x)}return null}function h(m,x,_,b){var w=x!==null?x.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return w!==null?null:o(m,x,""+_,b);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case pm:return _.key===w?l(m,x,_,b):null;case hu:return _.key===w?c(m,x,_,b):null;case so:return w=_._init,h(m,x,w(_._payload),b)}if(Ih(_)||Hd(_))return w!==null?null:u(m,x,_,b,null);Tm(m,_)}return null}function p(m,x,_,b,w){if(typeof b=="string"&&b!==""||typeof b=="number")return m=m.get(_)||null,o(x,m,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case pm:return m=m.get(b.key===null?_:b.key)||null,l(x,m,b,w);case hu:return m=m.get(b.key===null?_:b.key)||null,c(x,m,b,w);case so:var E=b._init;return p(m,x,_,E(b._payload),w)}if(Ih(b)||Hd(b))return m=m.get(_)||null,u(x,m,b,w,null);Tm(x,b)}return null}function y(m,x,_,b){for(var w=null,E=null,S=x,M=x=0,N=null;S!==null&&M<_.length;M++){S.index>M?(N=S,S=null):N=S.sibling;var T=h(m,S,_[M],b);if(T===null){S===null&&(S=N);break}n&&S&&T.alternate===null&&e(m,S),x=s(T,x,M),E===null?w=T:E.sibling=T,E=T,S=N}if(M===_.length)return t(m,S),Zt&&vl(m,M),w;if(S===null){for(;M<_.length;M++)S=d(m,_[M],b),S!==null&&(x=s(S,x,M),E===null?w=S:E.sibling=S,E=S);return Zt&&vl(m,M),w}for(S=r(m,S);M<_.length;M++)N=p(S,m,M,_[M],b),N!==null&&(n&&N.alternate!==null&&S.delete(N.key===null?M:N.key),x=s(N,x,M),E===null?w=N:E.sibling=N,E=N);return n&&S.forEach(function(P){return e(m,P)}),Zt&&vl(m,M),w}function v(m,x,_,b){var w=Hd(_);if(typeof w!="function")throw Error(_e(150));if(_=w.call(_),_==null)throw Error(_e(151));for(var E=w=null,S=x,M=x=0,N=null,T=_.next();S!==null&&!T.done;M++,T=_.next()){S.index>M?(N=S,S=null):N=S.sibling;var P=h(m,S,T.value,b);if(P===null){S===null&&(S=N);break}n&&S&&P.alternate===null&&e(m,S),x=s(P,x,M),E===null?w=P:E.sibling=P,E=P,S=N}if(T.done)return t(m,S),Zt&&vl(m,M),w;if(S===null){for(;!T.done;M++,T=_.next())T=d(m,T.value,b),T!==null&&(x=s(T,x,M),E===null?w=T:E.sibling=T,E=T);return Zt&&vl(m,M),w}for(S=r(m,S);!T.done;M++,T=_.next())T=p(S,m,M,T.value,b),T!==null&&(n&&T.alternate!==null&&S.delete(T.key===null?M:T.key),x=s(T,x,M),E===null?w=T:E.sibling=T,E=T);return n&&S.forEach(function(H){return e(m,H)}),Zt&&vl(m,M),w}function g(m,x,_,b){if(typeof _=="object"&&_!==null&&_.type===fu&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case pm:e:{for(var w=_.key,E=x;E!==null;){if(E.key===w){if(w=_.type,w===fu){if(E.tag===7){t(m,E.sibling),x=i(E,_.props.children),x.return=m,m=x;break e}}else if(E.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===so&&nA(w)===E.type){t(m,E.sibling),x=i(E,_.props),x.ref=Yd(m,E,_),x.return=m,m=x;break e}t(m,E);break}else e(m,E);E=E.sibling}_.type===fu?(x=Hl(_.props.children,m.mode,b,_.key),x.return=m,m=x):(b=uy(_.type,_.key,_.props,null,m.mode,b),b.ref=Yd(m,x,_),b.return=m,m=b)}return a(m);case hu:e:{for(E=_.key;x!==null;){if(x.key===E)if(x.tag===4&&x.stateNode.containerInfo===_.containerInfo&&x.stateNode.implementation===_.implementation){t(m,x.sibling),x=i(x,_.children||[]),x.return=m,m=x;break e}else{t(m,x);break}else e(m,x);x=x.sibling}x=a_(_,m.mode,b),x.return=m,m=x}return a(m);case so:return E=_._init,g(m,x,E(_._payload),b)}if(Ih(_))return y(m,x,_,b);if(Hd(_))return v(m,x,_,b);Tm(m,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,x!==null&&x.tag===6?(t(m,x.sibling),x=i(x,_),x.return=m,m=x):(t(m,x),x=s_(_,m.mode,b),x.return=m,m=x),a(m)):t(m,x)}return g}var ed=ND(!0),OD=ND(!1),zy=Ko(null),$y=null,bu=null,bE=null;function wE(){bE=bu=$y=null}function SE(n){var e=zy.current;Xt(zy),n._currentValue=e}function Xw(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function Bu(n,e){$y=n,bE=bu=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Ir=!0),n.firstContext=null)}function Ai(n){var e=n._currentValue;if(bE!==n)if(n={context:n,memoizedValue:e,next:null},bu===null){if($y===null)throw Error(_e(308));bu=n,$y.dependencies={lanes:0,firstContext:n}}else bu=bu.next=n;return e}var Ol=null;function EE(n){Ol===null?Ol=[n]:Ol.push(n)}function LD(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,EE(e)):(t.next=i.next,i.next=t),e.interleaved=t,Ca(n,r)}function Ca(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var ao=!1;function TE(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function DD(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function ba(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Po(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,Mt&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Ca(n,t)}return i=r.interleaved,i===null?(e.next=e,EE(r)):(e.next=i.next,i.next=e),r.interleaved=e,Ca(n,t)}function iy(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,uE(n,t)}}function rA(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?i=s=a:s=s.next=a,t=t.next}while(t!==null);s===null?i=s=e:s=s.next=e}else i=s=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Vy(n,e,t,r){var i=n.updateQueue;ao=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var u=n.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(s!==null){var d=i.baseState;a=0,u=c=l=null,o=s;do{var h=o.lane,p=o.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=n,v=o;switch(h=e,p=t,v.tag){case 1:if(y=v.payload,typeof y=="function"){d=y.call(p,d,h);break e}d=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=v.payload,h=typeof y=="function"?y.call(p,d,h):y,h==null)break e;d=sn({},d,h);break e;case 2:ao=!0}}o.callback!==null&&o.lane!==0&&(n.flags|=64,h=i.effects,h===null?i.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=p,l=d):u=u.next=p,a|=h;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;h=o,o=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(u===null&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);ic|=a,n.lanes=a,n.memoizedState=d}}function iA(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(_e(191,i));i.call(r)}}}var Dp={},Rs=Ko(Dp),$f=Ko(Dp),Vf=Ko(Dp);function Ll(n){if(n===Dp)throw Error(_e(174));return n}function ME(n,e){switch($t(Vf,e),$t($f,n),$t(Rs,Dp),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Aw(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Aw(e,n)}Xt(Rs),$t(Rs,e)}function td(){Xt(Rs),Xt($f),Xt(Vf)}function ID(n){Ll(Vf.current);var e=Ll(Rs.current),t=Aw(e,n.type);e!==t&&($t($f,n),$t(Rs,t))}function kE(n){$f.current===n&&(Xt(Rs),Xt($f))}var en=Ko(0);function Hy(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Qx=[];function AE(){for(var n=0;n<Qx.length;n++)Qx[n]._workInProgressVersionPrimary=null;Qx.length=0}var sy=Da.ReactCurrentDispatcher,e_=Da.ReactCurrentBatchConfig,rc=0,rn=null,bn=null,Nn=null,Wy=!1,rf=!1,Hf=0,I5=0;function Vn(){throw Error(_e(321))}function PE(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!rs(n[t],e[t]))return!1;return!0}function CE(n,e,t,r,i,s){if(rc=s,rn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,sy.current=n===null||n.memoizedState===null?B5:z5,n=t(r,i),rf){s=0;do{if(rf=!1,Hf=0,25<=s)throw Error(_e(301));s+=1,Nn=bn=null,e.updateQueue=null,sy.current=$5,n=t(r,i)}while(rf)}if(sy.current=Gy,e=bn!==null&&bn.next!==null,rc=0,Nn=bn=rn=null,Wy=!1,e)throw Error(_e(300));return n}function RE(){var n=Hf!==0;return Hf=0,n}function vs(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nn===null?rn.memoizedState=Nn=n:Nn=Nn.next=n,Nn}function Pi(){if(bn===null){var n=rn.alternate;n=n!==null?n.memoizedState:null}else n=bn.next;var e=Nn===null?rn.memoizedState:Nn.next;if(e!==null)Nn=e,bn=n;else{if(n===null)throw Error(_e(310));bn=n,n={memoizedState:bn.memoizedState,baseState:bn.baseState,baseQueue:bn.baseQueue,queue:bn.queue,next:null},Nn===null?rn.memoizedState=Nn=n:Nn=Nn.next=n}return Nn}function Wf(n,e){return typeof e=="function"?e(n):e}function t_(n){var e=Pi(),t=e.queue;if(t===null)throw Error(_e(311));t.lastRenderedReducer=n;var r=bn,i=r.baseQueue,s=t.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}r.baseQueue=i=s,t.pending=null}if(i!==null){s=i.next,r=r.baseState;var o=a=null,l=null,c=s;do{var u=c.lane;if((rc&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:n(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=d,a=r):l=l.next=d,rn.lanes|=u,ic|=u}c=c.next}while(c!==null&&c!==s);l===null?a=r:l.next=o,rs(r,e.memoizedState)||(Ir=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=l,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do s=i.lane,rn.lanes|=s,ic|=s,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function n_(n){var e=Pi(),t=e.queue;if(t===null)throw Error(_e(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,s=e.memoizedState;if(i!==null){t.pending=null;var a=i=i.next;do s=n(s,a.action),a=a.next;while(a!==i);rs(s,e.memoizedState)||(Ir=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,r]}function jD(){}function FD(n,e){var t=rn,r=Pi(),i=e(),s=!rs(r.memoizedState,i);if(s&&(r.memoizedState=i,Ir=!0),r=r.queue,NE(zD.bind(null,t,r,n),[n]),r.getSnapshot!==e||s||Nn!==null&&Nn.memoizedState.tag&1){if(t.flags|=2048,Gf(9,BD.bind(null,t,r,i,e),void 0,null),Ln===null)throw Error(_e(349));rc&30||UD(t,e,i)}return i}function UD(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=rn.updateQueue,e===null?(e={lastEffect:null,stores:null},rn.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function BD(n,e,t,r){e.value=t,e.getSnapshot=r,$D(e)&&VD(n)}function zD(n,e,t){return t(function(){$D(e)&&VD(n)})}function $D(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!rs(n,t)}catch{return!0}}function VD(n){var e=Ca(n,1);e!==null&&Zi(e,n,1,-1)}function sA(n){var e=vs();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Wf,lastRenderedState:n},e.queue=n,n=n.dispatch=U5.bind(null,rn,n),[e.memoizedState,n]}function Gf(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=rn.updateQueue,e===null?(e={lastEffect:null,stores:null},rn.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function HD(){return Pi().memoizedState}function ay(n,e,t,r){var i=vs();rn.flags|=n,i.memoizedState=Gf(1|e,t,void 0,r===void 0?null:r)}function lv(n,e,t,r){var i=Pi();r=r===void 0?null:r;var s=void 0;if(bn!==null){var a=bn.memoizedState;if(s=a.destroy,r!==null&&PE(r,a.deps)){i.memoizedState=Gf(e,t,s,r);return}}rn.flags|=n,i.memoizedState=Gf(1|e,t,s,r)}function aA(n,e){return ay(8390656,8,n,e)}function NE(n,e){return lv(2048,8,n,e)}function WD(n,e){return lv(4,2,n,e)}function GD(n,e){return lv(4,4,n,e)}function qD(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function XD(n,e,t){return t=t!=null?t.concat([n]):null,lv(4,4,qD.bind(null,e,n),t)}function OE(){}function YD(n,e){var t=Pi();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&PE(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function KD(n,e){var t=Pi();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&PE(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function ZD(n,e,t){return rc&21?(rs(t,e)||(t=nD(),rn.lanes|=t,ic|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Ir=!0),n.memoizedState=t)}function j5(n,e){var t=jt;jt=t!==0&&4>t?t:4,n(!0);var r=e_.transition;e_.transition={};try{n(!1),e()}finally{jt=t,e_.transition=r}}function JD(){return Pi().memoizedState}function F5(n,e,t){var r=Ro(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},QD(n))eI(e,t);else if(t=LD(n,e,t,r),t!==null){var i=vr();Zi(t,n,r,i),tI(t,e,r)}}function U5(n,e,t){var r=Ro(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(QD(n))eI(e,i);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,t);if(i.hasEagerState=!0,i.eagerState=o,rs(o,a)){var l=e.interleaved;l===null?(i.next=i,EE(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}t=LD(n,e,i,r),t!==null&&(i=vr(),Zi(t,n,r,i),tI(t,e,r))}}function QD(n){var e=n.alternate;return n===rn||e!==null&&e===rn}function eI(n,e){rf=Wy=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function tI(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,uE(n,t)}}var Gy={readContext:Ai,useCallback:Vn,useContext:Vn,useEffect:Vn,useImperativeHandle:Vn,useInsertionEffect:Vn,useLayoutEffect:Vn,useMemo:Vn,useReducer:Vn,useRef:Vn,useState:Vn,useDebugValue:Vn,useDeferredValue:Vn,useTransition:Vn,useMutableSource:Vn,useSyncExternalStore:Vn,useId:Vn,unstable_isNewReconciler:!1},B5={readContext:Ai,useCallback:function(n,e){return vs().memoizedState=[n,e===void 0?null:e],n},useContext:Ai,useEffect:aA,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,ay(4194308,4,qD.bind(null,e,n),t)},useLayoutEffect:function(n,e){return ay(4194308,4,n,e)},useInsertionEffect:function(n,e){return ay(4,2,n,e)},useMemo:function(n,e){var t=vs();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=vs();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=F5.bind(null,rn,n),[r.memoizedState,n]},useRef:function(n){var e=vs();return n={current:n},e.memoizedState=n},useState:sA,useDebugValue:OE,useDeferredValue:function(n){return vs().memoizedState=n},useTransition:function(){var n=sA(!1),e=n[0];return n=j5.bind(null,n[1]),vs().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=rn,i=vs();if(Zt){if(t===void 0)throw Error(_e(407));t=t()}else{if(t=e(),Ln===null)throw Error(_e(349));rc&30||UD(r,e,t)}i.memoizedState=t;var s={value:t,getSnapshot:e};return i.queue=s,aA(zD.bind(null,r,s,n),[n]),r.flags|=2048,Gf(9,BD.bind(null,r,s,t,e),void 0,null),t},useId:function(){var n=vs(),e=Ln.identifierPrefix;if(Zt){var t=pa,r=fa;t=(r&~(1<<32-Ki(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Hf++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=I5++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},z5={readContext:Ai,useCallback:YD,useContext:Ai,useEffect:NE,useImperativeHandle:XD,useInsertionEffect:WD,useLayoutEffect:GD,useMemo:KD,useReducer:t_,useRef:HD,useState:function(){return t_(Wf)},useDebugValue:OE,useDeferredValue:function(n){var e=Pi();return ZD(e,bn.memoizedState,n)},useTransition:function(){var n=t_(Wf)[0],e=Pi().memoizedState;return[n,e]},useMutableSource:jD,useSyncExternalStore:FD,useId:JD,unstable_isNewReconciler:!1},$5={readContext:Ai,useCallback:YD,useContext:Ai,useEffect:NE,useImperativeHandle:XD,useInsertionEffect:WD,useLayoutEffect:GD,useMemo:KD,useReducer:n_,useRef:HD,useState:function(){return n_(Wf)},useDebugValue:OE,useDeferredValue:function(n){var e=Pi();return bn===null?e.memoizedState=n:ZD(e,bn.memoizedState,n)},useTransition:function(){var n=n_(Wf)[0],e=Pi().memoizedState;return[n,e]},useMutableSource:jD,useSyncExternalStore:FD,useId:JD,unstable_isNewReconciler:!1};function zi(n,e){if(n&&n.defaultProps){e=sn({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function Yw(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:sn({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var cv={isMounted:function(n){return(n=n._reactInternals)?xc(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=vr(),i=Ro(n),s=ba(r,i);s.payload=e,t!=null&&(s.callback=t),e=Po(n,s,i),e!==null&&(Zi(e,n,i,r),iy(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=vr(),i=Ro(n),s=ba(r,i);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=Po(n,s,i),e!==null&&(Zi(e,n,i,r),iy(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=vr(),r=Ro(n),i=ba(t,r);i.tag=2,e!=null&&(i.callback=e),e=Po(n,i,r),e!==null&&(Zi(e,n,r,t),iy(e,n,r))}};function oA(n,e,t,r,i,s,a){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,s,a):e.prototype&&e.prototype.isPureReactComponent?!Ff(t,r)||!Ff(i,s):!0}function nI(n,e,t){var r=!1,i=Uo,s=e.contextType;return typeof s=="object"&&s!==null?s=Ai(s):(i=Fr(e)?tc:sr.current,r=e.contextTypes,s=(r=r!=null)?Ju(n,i):Uo),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=cv,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=s),e}function lA(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&cv.enqueueReplaceState(e,e.state,null)}function Kw(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},TE(n);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Ai(s):(s=Fr(e)?tc:sr.current,i.context=Ju(n,s)),i.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Yw(n,e,s,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&cv.enqueueReplaceState(i,i.state,null),Vy(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function nd(n,e){try{var t="",r=e;do t+=g$(r),r=r.return;while(r);var i=t}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:i,digest:null}}function r_(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function Zw(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var V5=typeof WeakMap=="function"?WeakMap:Map;function rI(n,e,t){t=ba(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){Xy||(Xy=!0,oS=r),Zw(n,e)},t}function iI(n,e,t){t=ba(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){Zw(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){Zw(n,e),typeof r!="function"&&(Co===null?Co=new Set([this]):Co.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function cA(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new V5;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=rV.bind(null,n,e,t),e.then(n,n))}function uA(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function dA(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=ba(-1,1),e.tag=2,Po(t,e,1))),t.lanes|=1),n)}var H5=Da.ReactCurrentOwner,Ir=!1;function mr(n,e,t,r){e.child=n===null?OD(e,null,t,r):ed(e,n.child,t,r)}function hA(n,e,t,r,i){t=t.render;var s=e.ref;return Bu(e,i),r=CE(n,e,t,r,s,i),t=RE(),n!==null&&!Ir?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Ra(n,e,i)):(Zt&&t&&vE(e),e.flags|=1,mr(n,e,r,i),e.child)}function fA(n,e,t,r,i){if(n===null){var s=t.type;return typeof s=="function"&&!zE(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,sI(n,e,s,r,i)):(n=uy(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&i)){var a=s.memoizedProps;if(t=t.compare,t=t!==null?t:Ff,t(a,r)&&n.ref===e.ref)return Ra(n,e,i)}return e.flags|=1,n=No(s,r),n.ref=e.ref,n.return=e,e.child=n}function sI(n,e,t,r,i){if(n!==null){var s=n.memoizedProps;if(Ff(s,r)&&n.ref===e.ref)if(Ir=!1,e.pendingProps=r=s,(n.lanes&i)!==0)n.flags&131072&&(Ir=!0);else return e.lanes=n.lanes,Ra(n,e,i)}return Jw(n,e,t,r,i)}function aI(n,e,t){var r=e.pendingProps,i=r.children,s=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},$t(Su,Jr),Jr|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,$t(Su,Jr),Jr|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:t,$t(Su,Jr),Jr|=r}else s!==null?(r=s.baseLanes|t,e.memoizedState=null):r=t,$t(Su,Jr),Jr|=r;return mr(n,e,i,t),e.child}function oI(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Jw(n,e,t,r,i){var s=Fr(t)?tc:sr.current;return s=Ju(e,s),Bu(e,i),t=CE(n,e,t,r,s,i),r=RE(),n!==null&&!Ir?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Ra(n,e,i)):(Zt&&r&&vE(e),e.flags|=1,mr(n,e,t,i),e.child)}function pA(n,e,t,r,i){if(Fr(t)){var s=!0;Fy(e)}else s=!1;if(Bu(e,i),e.stateNode===null)oy(n,e),nI(e,t,r),Kw(e,t,r,i),r=!0;else if(n===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=t.contextType;typeof c=="object"&&c!==null?c=Ai(c):(c=Fr(t)?tc:sr.current,c=Ju(e,c));var u=t.getDerivedStateFromProps,d=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==r||l!==c)&&lA(e,a,r,c),ao=!1;var h=e.memoizedState;a.state=h,Vy(e,r,a,i),l=e.memoizedState,o!==r||h!==l||jr.current||ao?(typeof u=="function"&&(Yw(e,t,u,r),l=e.memoizedState),(o=ao||oA(e,t,o,r,h,l,c))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),a.props=r,a.state=l,a.context=c,r=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,DD(n,e),o=e.memoizedProps,c=e.type===e.elementType?o:zi(e.type,o),a.props=c,d=e.pendingProps,h=a.context,l=t.contextType,typeof l=="object"&&l!==null?l=Ai(l):(l=Fr(t)?tc:sr.current,l=Ju(e,l));var p=t.getDerivedStateFromProps;(u=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==d||h!==l)&&lA(e,a,r,l),ao=!1,h=e.memoizedState,a.state=h,Vy(e,r,a,i);var y=e.memoizedState;o!==d||h!==y||jr.current||ao?(typeof p=="function"&&(Yw(e,t,p,r),y=e.memoizedState),(c=ao||oA(e,t,c,r,h,y,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,y,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,y,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&h===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&h===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),a.props=r,a.state=y,a.context=l,r=c):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&h===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&h===n.memoizedState||(e.flags|=1024),r=!1)}return Qw(n,e,t,r,s,i)}function Qw(n,e,t,r,i,s){oI(n,e);var a=(e.flags&128)!==0;if(!r&&!a)return i&&Qk(e,t,!1),Ra(n,e,s);r=e.stateNode,H5.current=e;var o=a&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&a?(e.child=ed(e,n.child,null,s),e.child=ed(e,null,o,s)):mr(n,e,o,s),e.memoizedState=r.state,i&&Qk(e,t,!0),e.child}function lI(n){var e=n.stateNode;e.pendingContext?Jk(n,e.pendingContext,e.pendingContext!==e.context):e.context&&Jk(n,e.context,!1),ME(n,e.containerInfo)}function mA(n,e,t,r,i){return Qu(),_E(i),e.flags|=256,mr(n,e,t,r),e.child}var eS={dehydrated:null,treeContext:null,retryLane:0};function tS(n){return{baseLanes:n,cachePool:null,transitions:null}}function cI(n,e,t){var r=e.pendingProps,i=en.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=n!==null&&n.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),$t(en,i&1),n===null)return qw(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,n=r.fallback,s?(r=e.mode,s=e.child,a={mode:"hidden",children:a},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=hv(a,r,0,null),n=Hl(n,r,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=tS(t),e.memoizedState=eS,n):LE(e,a));if(i=n.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return W5(n,e,a,r,o,i,t);if(s){s=r.fallback,a=e.mode,i=n.child,o=i.sibling;var l={mode:"hidden",children:r.children};return!(a&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=No(i,l),r.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=No(o,s):(s=Hl(s,a,t,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,a=n.child.memoizedState,a=a===null?tS(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=n.childLanes&~t,e.memoizedState=eS,r}return s=n.child,n=s.sibling,r=No(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function LE(n,e){return e=hv({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Mm(n,e,t,r){return r!==null&&_E(r),ed(e,n.child,null,t),n=LE(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function W5(n,e,t,r,i,s,a){if(t)return e.flags&256?(e.flags&=-257,r=r_(Error(_e(422))),Mm(n,e,a,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=hv({mode:"visible",children:r.children},i,0,null),s=Hl(s,i,a,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&ed(e,n.child,null,a),e.child.memoizedState=tS(a),e.memoizedState=eS,s);if(!(e.mode&1))return Mm(n,e,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var o=r.dgst;return r=o,s=Error(_e(419)),r=r_(s,r,void 0),Mm(n,e,a,r)}if(o=(a&n.childLanes)!==0,Ir||o){if(r=Ln,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ca(n,i),Zi(r,n,i,-1))}return BE(),r=r_(Error(_e(421))),Mm(n,e,a,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=iV.bind(null,n),i._reactRetry=e,null):(n=s.treeContext,ei=Ao(i.nextSibling),ti=e,Zt=!0,Hi=null,n!==null&&(wi[Si++]=fa,wi[Si++]=pa,wi[Si++]=nc,fa=n.id,pa=n.overflow,nc=e),e=LE(e,r.children),e.flags|=4096,e)}function gA(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),Xw(n.return,e,t)}function i_(n,e,t,r,i){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=t,s.tailMode=i)}function uI(n,e,t){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(mr(n,e,r.children,t),r=en.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&gA(n,t,e);else if(n.tag===19)gA(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if($t(en,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&Hy(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),i_(e,!1,i,t,s);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&Hy(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}i_(e,!0,t,null,s);break;case"together":i_(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function oy(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Ra(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),ic|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(_e(153));if(e.child!==null){for(n=e.child,t=No(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=No(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function G5(n,e,t){switch(e.tag){case 3:lI(e),Qu();break;case 5:ID(e);break;case 1:Fr(e.type)&&Fy(e);break;case 4:ME(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;$t(zy,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?($t(en,en.current&1),e.flags|=128,null):t&e.child.childLanes?cI(n,e,t):($t(en,en.current&1),n=Ra(n,e,t),n!==null?n.sibling:null);$t(en,en.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return uI(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),$t(en,en.current),r)break;return null;case 22:case 23:return e.lanes=0,aI(n,e,t)}return Ra(n,e,t)}var dI,nS,hI,fI;dI=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};nS=function(){};hI=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,Ll(Rs.current);var s=null;switch(t){case"input":i=Ew(n,i),r=Ew(n,r),s=[];break;case"select":i=sn({},i,{value:void 0}),r=sn({},r,{value:void 0}),s=[];break;case"textarea":i=kw(n,i),r=kw(n,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=Iy)}Pw(t,r);var a;t=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(a in o)o.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Rf.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(o=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(t||(t={}),t[a]=l[a])}else t||(s||(s=[]),s.push(c,t)),t=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Rf.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Wt("scroll",n),s||o===l||(s=[])):(s=s||[]).push(c,l))}t&&(s=s||[]).push("style",t);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};fI=function(n,e,t,r){t!==r&&(e.flags|=4)};function Kd(n,e){if(!Zt)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function Hn(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function q5(n,e,t){var r=e.pendingProps;switch(xE(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hn(e),null;case 1:return Fr(e.type)&&jy(),Hn(e),null;case 3:return r=e.stateNode,td(),Xt(jr),Xt(sr),AE(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(Em(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Hi!==null&&(uS(Hi),Hi=null))),nS(n,e),Hn(e),null;case 5:kE(e);var i=Ll(Vf.current);if(t=e.type,n!==null&&e.stateNode!=null)hI(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(_e(166));return Hn(e),null}if(n=Ll(Rs.current),Em(e)){r=e.stateNode,t=e.type;var s=e.memoizedProps;switch(r[Ts]=e,r[zf]=s,n=(e.mode&1)!==0,t){case"dialog":Wt("cancel",r),Wt("close",r);break;case"iframe":case"object":case"embed":Wt("load",r);break;case"video":case"audio":for(i=0;i<Fh.length;i++)Wt(Fh[i],r);break;case"source":Wt("error",r);break;case"img":case"image":case"link":Wt("error",r),Wt("load",r);break;case"details":Wt("toggle",r);break;case"input":Tk(r,s),Wt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Wt("invalid",r);break;case"textarea":kk(r,s),Wt("invalid",r)}Pw(t,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?r.textContent!==o&&(s.suppressHydrationWarning!==!0&&Sm(r.textContent,o,n),i=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Sm(r.textContent,o,n),i=["children",""+o]):Rf.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Wt("scroll",r)}switch(t){case"input":mm(r),Mk(r,s,!0);break;case"textarea":mm(r),Ak(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Iy)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=zL(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=a.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=a.createElement(t,{is:r.is}):(n=a.createElement(t),t==="select"&&(a=n,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):n=a.createElementNS(n,t),n[Ts]=e,n[zf]=r,dI(n,e,!1,!1),e.stateNode=n;e:{switch(a=Cw(t,r),t){case"dialog":Wt("cancel",n),Wt("close",n),i=r;break;case"iframe":case"object":case"embed":Wt("load",n),i=r;break;case"video":case"audio":for(i=0;i<Fh.length;i++)Wt(Fh[i],n);i=r;break;case"source":Wt("error",n),i=r;break;case"img":case"image":case"link":Wt("error",n),Wt("load",n),i=r;break;case"details":Wt("toggle",n),i=r;break;case"input":Tk(n,r),i=Ew(n,r),Wt("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=sn({},r,{value:void 0}),Wt("invalid",n);break;case"textarea":kk(n,r),i=kw(n,r),Wt("invalid",n);break;default:i=r}Pw(t,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?HL(n,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&$L(n,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&Nf(n,l):typeof l=="number"&&Nf(n,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Rf.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Wt("scroll",n):l!=null&&iE(n,s,l,a))}switch(t){case"input":mm(n),Mk(n,r,!1);break;case"textarea":mm(n),Ak(n);break;case"option":r.value!=null&&n.setAttribute("value",""+Fo(r.value));break;case"select":n.multiple=!!r.multiple,s=r.value,s!=null?Iu(n,!!r.multiple,s,!1):r.defaultValue!=null&&Iu(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=Iy)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Hn(e),null;case 6:if(n&&e.stateNode!=null)fI(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(_e(166));if(t=Ll(Vf.current),Ll(Rs.current),Em(e)){if(r=e.stateNode,t=e.memoizedProps,r[Ts]=e,(s=r.nodeValue!==t)&&(n=ti,n!==null))switch(n.tag){case 3:Sm(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Sm(r.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Ts]=e,e.stateNode=r}return Hn(e),null;case 13:if(Xt(en),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Zt&&ei!==null&&e.mode&1&&!(e.flags&128))RD(),Qu(),e.flags|=98560,s=!1;else if(s=Em(e),r!==null&&r.dehydrated!==null){if(n===null){if(!s)throw Error(_e(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(_e(317));s[Ts]=e}else Qu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Hn(e),s=!1}else Hi!==null&&(uS(Hi),Hi=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||en.current&1?Sn===0&&(Sn=3):BE())),e.updateQueue!==null&&(e.flags|=4),Hn(e),null);case 4:return td(),nS(n,e),n===null&&Uf(e.stateNode.containerInfo),Hn(e),null;case 10:return SE(e.type._context),Hn(e),null;case 17:return Fr(e.type)&&jy(),Hn(e),null;case 19:if(Xt(en),s=e.memoizedState,s===null)return Hn(e),null;if(r=(e.flags&128)!==0,a=s.rendering,a===null)if(r)Kd(s,!1);else{if(Sn!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(a=Hy(n),a!==null){for(e.flags|=128,Kd(s,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)s=t,n=r,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,n=a.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return $t(en,en.current&1|2),e.child}n=n.sibling}s.tail!==null&&hn()>rd&&(e.flags|=128,r=!0,Kd(s,!1),e.lanes=4194304)}else{if(!r)if(n=Hy(a),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Kd(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Zt)return Hn(e),null}else 2*hn()-s.renderingStartTime>rd&&t!==1073741824&&(e.flags|=128,r=!0,Kd(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(t=s.last,t!==null?t.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=hn(),e.sibling=null,t=en.current,$t(en,r?t&1|2:t&1),e):(Hn(e),null);case 22:case 23:return UE(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Jr&1073741824&&(Hn(e),e.subtreeFlags&6&&(e.flags|=8192)):Hn(e),null;case 24:return null;case 25:return null}throw Error(_e(156,e.tag))}function X5(n,e){switch(xE(e),e.tag){case 1:return Fr(e.type)&&jy(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return td(),Xt(jr),Xt(sr),AE(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return kE(e),null;case 13:if(Xt(en),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(_e(340));Qu()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Xt(en),null;case 4:return td(),null;case 10:return SE(e.type._context),null;case 22:case 23:return UE(),null;case 24:return null;default:return null}}var km=!1,Qn=!1,Y5=typeof WeakSet=="function"?WeakSet:Set,je=null;function wu(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){on(n,e,r)}else t.current=null}function rS(n,e,t){try{t()}catch(r){on(n,e,r)}}var yA=!1;function K5(n,e){if(Bw=Oy,n=vD(),yE(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var a=0,o=-1,l=-1,c=0,u=0,d=n,h=null;t:for(;;){for(var p;d!==t||i!==0&&d.nodeType!==3||(o=a+i),d!==s||r!==0&&d.nodeType!==3||(l=a+r),d.nodeType===3&&(a+=d.nodeValue.length),(p=d.firstChild)!==null;)h=d,d=p;for(;;){if(d===n)break t;if(h===t&&++c===i&&(o=a),h===s&&++u===r&&(l=a),(p=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=p}t=o===-1||l===-1?null:{start:o,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(zw={focusedElem:n,selectionRange:t},Oy=!1,je=e;je!==null;)if(e=je,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,je=n;else for(;je!==null;){e=je;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var v=y.memoizedProps,g=y.memoizedState,m=e.stateNode,x=m.getSnapshotBeforeUpdate(e.elementType===e.type?v:zi(e.type,v),g);m.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(_e(163))}}catch(b){on(e,e.return,b)}if(n=e.sibling,n!==null){n.return=e.return,je=n;break}je=e.return}return y=yA,yA=!1,y}function sf(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var s=i.destroy;i.destroy=void 0,s!==void 0&&rS(e,t,s)}i=i.next}while(i!==r)}}function uv(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function iS(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function pI(n){var e=n.alternate;e!==null&&(n.alternate=null,pI(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Ts],delete e[zf],delete e[Hw],delete e[N5],delete e[O5])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function mI(n){return n.tag===5||n.tag===3||n.tag===4}function vA(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||mI(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function sS(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Iy));else if(r!==4&&(n=n.child,n!==null))for(sS(n,e,t),n=n.sibling;n!==null;)sS(n,e,t),n=n.sibling}function aS(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(aS(n,e,t),n=n.sibling;n!==null;)aS(n,e,t),n=n.sibling}var Fn=null,$i=!1;function Ua(n,e,t){for(t=t.child;t!==null;)gI(n,e,t),t=t.sibling}function gI(n,e,t){if(Cs&&typeof Cs.onCommitFiberUnmount=="function")try{Cs.onCommitFiberUnmount(nv,t)}catch{}switch(t.tag){case 5:Qn||wu(t,e);case 6:var r=Fn,i=$i;Fn=null,Ua(n,e,t),Fn=r,$i=i,Fn!==null&&($i?(n=Fn,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Fn.removeChild(t.stateNode));break;case 18:Fn!==null&&($i?(n=Fn,t=t.stateNode,n.nodeType===8?Zx(n.parentNode,t):n.nodeType===1&&Zx(n,t),If(n)):Zx(Fn,t.stateNode));break;case 4:r=Fn,i=$i,Fn=t.stateNode.containerInfo,$i=!0,Ua(n,e,t),Fn=r,$i=i;break;case 0:case 11:case 14:case 15:if(!Qn&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&rS(t,e,a),i=i.next}while(i!==r)}Ua(n,e,t);break;case 1:if(!Qn&&(wu(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(o){on(t,e,o)}Ua(n,e,t);break;case 21:Ua(n,e,t);break;case 22:t.mode&1?(Qn=(r=Qn)||t.memoizedState!==null,Ua(n,e,t),Qn=r):Ua(n,e,t);break;default:Ua(n,e,t)}}function xA(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new Y5),e.forEach(function(r){var i=sV.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function Ni(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var s=n,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:Fn=o.stateNode,$i=!1;break e;case 3:Fn=o.stateNode.containerInfo,$i=!0;break e;case 4:Fn=o.stateNode.containerInfo,$i=!0;break e}o=o.return}if(Fn===null)throw Error(_e(160));gI(s,a,i),Fn=null,$i=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){on(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)yI(e,n),e=e.sibling}function yI(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Ni(e,n),hs(n),r&4){try{sf(3,n,n.return),uv(3,n)}catch(v){on(n,n.return,v)}try{sf(5,n,n.return)}catch(v){on(n,n.return,v)}}break;case 1:Ni(e,n),hs(n),r&512&&t!==null&&wu(t,t.return);break;case 5:if(Ni(e,n),hs(n),r&512&&t!==null&&wu(t,t.return),n.flags&32){var i=n.stateNode;try{Nf(i,"")}catch(v){on(n,n.return,v)}}if(r&4&&(i=n.stateNode,i!=null)){var s=n.memoizedProps,a=t!==null?t.memoizedProps:s,o=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&UL(i,s),Cw(o,a);var c=Cw(o,s);for(a=0;a<l.length;a+=2){var u=l[a],d=l[a+1];u==="style"?HL(i,d):u==="dangerouslySetInnerHTML"?$L(i,d):u==="children"?Nf(i,d):iE(i,u,d,c)}switch(o){case"input":Tw(i,s);break;case"textarea":BL(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?Iu(i,!!s.multiple,p,!1):h!==!!s.multiple&&(s.defaultValue!=null?Iu(i,!!s.multiple,s.defaultValue,!0):Iu(i,!!s.multiple,s.multiple?[]:"",!1))}i[zf]=s}catch(v){on(n,n.return,v)}}break;case 6:if(Ni(e,n),hs(n),r&4){if(n.stateNode===null)throw Error(_e(162));i=n.stateNode,s=n.memoizedProps;try{i.nodeValue=s}catch(v){on(n,n.return,v)}}break;case 3:if(Ni(e,n),hs(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{If(e.containerInfo)}catch(v){on(n,n.return,v)}break;case 4:Ni(e,n),hs(n);break;case 13:Ni(e,n),hs(n),i=n.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(jE=hn())),r&4&&xA(n);break;case 22:if(u=t!==null&&t.memoizedState!==null,n.mode&1?(Qn=(c=Qn)||u,Ni(e,n),Qn=c):Ni(e,n),hs(n),r&8192){if(c=n.memoizedState!==null,(n.stateNode.isHidden=c)&&!u&&n.mode&1)for(je=n,u=n.child;u!==null;){for(d=je=u;je!==null;){switch(h=je,p=h.child,h.tag){case 0:case 11:case 14:case 15:sf(4,h,h.return);break;case 1:wu(h,h.return);var y=h.stateNode;if(typeof y.componentWillUnmount=="function"){r=h,t=h.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(v){on(r,t,v)}}break;case 5:wu(h,h.return);break;case 22:if(h.memoizedState!==null){bA(d);continue}}p!==null?(p.return=h,je=p):bA(d)}u=u.sibling}e:for(u=null,d=n;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=d.stateNode,l=d.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=VL("display",a))}catch(v){on(n,n.return,v)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(v){on(n,n.return,v)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===n)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===n)break e;for(;d.sibling===null;){if(d.return===null||d.return===n)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Ni(e,n),hs(n),r&4&&xA(n);break;case 21:break;default:Ni(e,n),hs(n)}}function hs(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(mI(t)){var r=t;break e}t=t.return}throw Error(_e(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Nf(i,""),r.flags&=-33);var s=vA(n);aS(n,s,i);break;case 3:case 4:var a=r.stateNode.containerInfo,o=vA(n);sS(n,o,a);break;default:throw Error(_e(161))}}catch(l){on(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function Z5(n,e,t){je=n,vI(n)}function vI(n,e,t){for(var r=(n.mode&1)!==0;je!==null;){var i=je,s=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||km;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Qn;o=km;var c=Qn;if(km=a,(Qn=l)&&!c)for(je=i;je!==null;)a=je,l=a.child,a.tag===22&&a.memoizedState!==null?wA(i):l!==null?(l.return=a,je=l):wA(i);for(;s!==null;)je=s,vI(s),s=s.sibling;je=i,km=o,Qn=c}_A(n)}else i.subtreeFlags&8772&&s!==null?(s.return=i,je=s):_A(n)}}function _A(n){for(;je!==null;){var e=je;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Qn||uv(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Qn)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:zi(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&iA(e,s,r);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}iA(e,a,t)}break;case 5:var o=e.stateNode;if(t===null&&e.flags&4){t=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&If(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(_e(163))}Qn||e.flags&512&&iS(e)}catch(h){on(e,e.return,h)}}if(e===n){je=null;break}if(t=e.sibling,t!==null){t.return=e.return,je=t;break}je=e.return}}function bA(n){for(;je!==null;){var e=je;if(e===n){je=null;break}var t=e.sibling;if(t!==null){t.return=e.return,je=t;break}je=e.return}}function wA(n){for(;je!==null;){var e=je;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{uv(4,e)}catch(l){on(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){on(e,i,l)}}var s=e.return;try{iS(e)}catch(l){on(e,s,l)}break;case 5:var a=e.return;try{iS(e)}catch(l){on(e,a,l)}}}catch(l){on(e,e.return,l)}if(e===n){je=null;break}var o=e.sibling;if(o!==null){o.return=e.return,je=o;break}je=e.return}}var J5=Math.ceil,qy=Da.ReactCurrentDispatcher,DE=Da.ReactCurrentOwner,ki=Da.ReactCurrentBatchConfig,Mt=0,Ln=null,gn=null,Bn=0,Jr=0,Su=Ko(0),Sn=0,qf=null,ic=0,dv=0,IE=0,af=null,Nr=null,jE=0,rd=1/0,sa=null,Xy=!1,oS=null,Co=null,Am=!1,yo=null,Yy=0,of=0,lS=null,ly=-1,cy=0;function vr(){return Mt&6?hn():ly!==-1?ly:ly=hn()}function Ro(n){return n.mode&1?Mt&2&&Bn!==0?Bn&-Bn:D5.transition!==null?(cy===0&&(cy=nD()),cy):(n=jt,n!==0||(n=window.event,n=n===void 0?16:cD(n.type)),n):1}function Zi(n,e,t,r){if(50<of)throw of=0,lS=null,Error(_e(185));Np(n,t,r),(!(Mt&2)||n!==Ln)&&(n===Ln&&(!(Mt&2)&&(dv|=t),Sn===4&&ho(n,Bn)),Ur(n,r),t===1&&Mt===0&&!(e.mode&1)&&(rd=hn()+500,ov&&Zo()))}function Ur(n,e){var t=n.callbackNode;D$(n,e);var r=Ny(n,n===Ln?Bn:0);if(r===0)t!==null&&Rk(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&Rk(t),e===1)n.tag===0?L5(SA.bind(null,n)):AD(SA.bind(null,n)),C5(function(){!(Mt&6)&&Zo()}),t=null;else{switch(rD(r)){case 1:t=cE;break;case 4:t=eD;break;case 16:t=Ry;break;case 536870912:t=tD;break;default:t=Ry}t=MI(t,xI.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function xI(n,e){if(ly=-1,cy=0,Mt&6)throw Error(_e(327));var t=n.callbackNode;if(zu()&&n.callbackNode!==t)return null;var r=Ny(n,n===Ln?Bn:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=Ky(n,r);else{e=r;var i=Mt;Mt|=2;var s=bI();(Ln!==n||Bn!==e)&&(sa=null,rd=hn()+500,Vl(n,e));do try{tV();break}catch(o){_I(n,o)}while(!0);wE(),qy.current=s,Mt=i,gn!==null?e=0:(Ln=null,Bn=0,e=Sn)}if(e!==0){if(e===2&&(i=Dw(n),i!==0&&(r=i,e=cS(n,i))),e===1)throw t=qf,Vl(n,0),ho(n,r),Ur(n,hn()),t;if(e===6)ho(n,r);else{if(i=n.current.alternate,!(r&30)&&!Q5(i)&&(e=Ky(n,r),e===2&&(s=Dw(n),s!==0&&(r=s,e=cS(n,s))),e===1))throw t=qf,Vl(n,0),ho(n,r),Ur(n,hn()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(_e(345));case 2:xl(n,Nr,sa);break;case 3:if(ho(n,r),(r&130023424)===r&&(e=jE+500-hn(),10<e)){if(Ny(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){vr(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=Vw(xl.bind(null,n,Nr,sa),e);break}xl(n,Nr,sa);break;case 4:if(ho(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var a=31-Ki(r);s=1<<a,a=e[a],a>i&&(i=a),r&=~s}if(r=i,r=hn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*J5(r/1960))-r,10<r){n.timeoutHandle=Vw(xl.bind(null,n,Nr,sa),r);break}xl(n,Nr,sa);break;case 5:xl(n,Nr,sa);break;default:throw Error(_e(329))}}}return Ur(n,hn()),n.callbackNode===t?xI.bind(null,n):null}function cS(n,e){var t=af;return n.current.memoizedState.isDehydrated&&(Vl(n,e).flags|=256),n=Ky(n,e),n!==2&&(e=Nr,Nr=t,e!==null&&uS(e)),n}function uS(n){Nr===null?Nr=n:Nr.push.apply(Nr,n)}function Q5(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],s=i.getSnapshot;i=i.value;try{if(!rs(s(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ho(n,e){for(e&=~IE,e&=~dv,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Ki(e),r=1<<t;n[t]=-1,e&=~r}}function SA(n){if(Mt&6)throw Error(_e(327));zu();var e=Ny(n,0);if(!(e&1))return Ur(n,hn()),null;var t=Ky(n,e);if(n.tag!==0&&t===2){var r=Dw(n);r!==0&&(e=r,t=cS(n,r))}if(t===1)throw t=qf,Vl(n,0),ho(n,e),Ur(n,hn()),t;if(t===6)throw Error(_e(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,xl(n,Nr,sa),Ur(n,hn()),null}function FE(n,e){var t=Mt;Mt|=1;try{return n(e)}finally{Mt=t,Mt===0&&(rd=hn()+500,ov&&Zo())}}function sc(n){yo!==null&&yo.tag===0&&!(Mt&6)&&zu();var e=Mt;Mt|=1;var t=ki.transition,r=jt;try{if(ki.transition=null,jt=1,n)return n()}finally{jt=r,ki.transition=t,Mt=e,!(Mt&6)&&Zo()}}function UE(){Jr=Su.current,Xt(Su)}function Vl(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,P5(t)),gn!==null)for(t=gn.return;t!==null;){var r=t;switch(xE(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&jy();break;case 3:td(),Xt(jr),Xt(sr),AE();break;case 5:kE(r);break;case 4:td();break;case 13:Xt(en);break;case 19:Xt(en);break;case 10:SE(r.type._context);break;case 22:case 23:UE()}t=t.return}if(Ln=n,gn=n=No(n.current,null),Bn=Jr=e,Sn=0,qf=null,IE=dv=ic=0,Nr=af=null,Ol!==null){for(e=0;e<Ol.length;e++)if(t=Ol[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,s=t.pending;if(s!==null){var a=s.next;s.next=i,r.next=a}t.pending=r}Ol=null}return n}function _I(n,e){do{var t=gn;try{if(wE(),sy.current=Gy,Wy){for(var r=rn.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Wy=!1}if(rc=0,Nn=bn=rn=null,rf=!1,Hf=0,DE.current=null,t===null||t.return===null){Sn=1,qf=e,gn=null;break}e:{var s=n,a=t.return,o=t,l=e;if(e=Bn,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=uA(a);if(p!==null){p.flags&=-257,dA(p,a,o,s,e),p.mode&1&&cA(s,c,e),e=p,l=c;var y=e.updateQueue;if(y===null){var v=new Set;v.add(l),e.updateQueue=v}else y.add(l);break e}else{if(!(e&1)){cA(s,c,e),BE();break e}l=Error(_e(426))}}else if(Zt&&o.mode&1){var g=uA(a);if(g!==null){!(g.flags&65536)&&(g.flags|=256),dA(g,a,o,s,e),_E(nd(l,o));break e}}s=l=nd(l,o),Sn!==4&&(Sn=2),af===null?af=[s]:af.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var m=rI(s,l,e);rA(s,m);break e;case 1:o=l;var x=s.type,_=s.stateNode;if(!(s.flags&128)&&(typeof x.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(Co===null||!Co.has(_)))){s.flags|=65536,e&=-e,s.lanes|=e;var b=iI(s,o,e);rA(s,b);break e}}s=s.return}while(s!==null)}SI(t)}catch(w){e=w,gn===t&&t!==null&&(gn=t=t.return);continue}break}while(!0)}function bI(){var n=qy.current;return qy.current=Gy,n===null?Gy:n}function BE(){(Sn===0||Sn===3||Sn===2)&&(Sn=4),Ln===null||!(ic&268435455)&&!(dv&268435455)||ho(Ln,Bn)}function Ky(n,e){var t=Mt;Mt|=2;var r=bI();(Ln!==n||Bn!==e)&&(sa=null,Vl(n,e));do try{eV();break}catch(i){_I(n,i)}while(!0);if(wE(),Mt=t,qy.current=r,gn!==null)throw Error(_e(261));return Ln=null,Bn=0,Sn}function eV(){for(;gn!==null;)wI(gn)}function tV(){for(;gn!==null&&!M$();)wI(gn)}function wI(n){var e=TI(n.alternate,n,Jr);n.memoizedProps=n.pendingProps,e===null?SI(n):gn=e,DE.current=null}function SI(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=X5(t,e),t!==null){t.flags&=32767,gn=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Sn=6,gn=null;return}}else if(t=q5(t,e,Jr),t!==null){gn=t;return}if(e=e.sibling,e!==null){gn=e;return}gn=e=n}while(e!==null);Sn===0&&(Sn=5)}function xl(n,e,t){var r=jt,i=ki.transition;try{ki.transition=null,jt=1,nV(n,e,t,r)}finally{ki.transition=i,jt=r}return null}function nV(n,e,t,r){do zu();while(yo!==null);if(Mt&6)throw Error(_e(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(_e(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(I$(n,s),n===Ln&&(gn=Ln=null,Bn=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Am||(Am=!0,MI(Ry,function(){return zu(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=ki.transition,ki.transition=null;var a=jt;jt=1;var o=Mt;Mt|=4,DE.current=null,K5(n,t),yI(t,n),w5(zw),Oy=!!Bw,zw=Bw=null,n.current=t,Z5(t),k$(),Mt=o,jt=a,ki.transition=s}else n.current=t;if(Am&&(Am=!1,yo=n,Yy=i),s=n.pendingLanes,s===0&&(Co=null),C$(t.stateNode),Ur(n,hn()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(Xy)throw Xy=!1,n=oS,oS=null,n;return Yy&1&&n.tag!==0&&zu(),s=n.pendingLanes,s&1?n===lS?of++:(of=0,lS=n):of=0,Zo(),null}function zu(){if(yo!==null){var n=rD(Yy),e=ki.transition,t=jt;try{if(ki.transition=null,jt=16>n?16:n,yo===null)var r=!1;else{if(n=yo,yo=null,Yy=0,Mt&6)throw Error(_e(331));var i=Mt;for(Mt|=4,je=n.current;je!==null;){var s=je,a=s.child;if(je.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(je=c;je!==null;){var u=je;switch(u.tag){case 0:case 11:case 15:sf(8,u,s)}var d=u.child;if(d!==null)d.return=u,je=d;else for(;je!==null;){u=je;var h=u.sibling,p=u.return;if(pI(u),u===c){je=null;break}if(h!==null){h.return=p,je=h;break}je=p}}}var y=s.alternate;if(y!==null){var v=y.child;if(v!==null){y.child=null;do{var g=v.sibling;v.sibling=null,v=g}while(v!==null)}}je=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,je=a;else e:for(;je!==null;){if(s=je,s.flags&2048)switch(s.tag){case 0:case 11:case 15:sf(9,s,s.return)}var m=s.sibling;if(m!==null){m.return=s.return,je=m;break e}je=s.return}}var x=n.current;for(je=x;je!==null;){a=je;var _=a.child;if(a.subtreeFlags&2064&&_!==null)_.return=a,je=_;else e:for(a=x;je!==null;){if(o=je,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:uv(9,o)}}catch(w){on(o,o.return,w)}if(o===a){je=null;break e}var b=o.sibling;if(b!==null){b.return=o.return,je=b;break e}je=o.return}}if(Mt=i,Zo(),Cs&&typeof Cs.onPostCommitFiberRoot=="function")try{Cs.onPostCommitFiberRoot(nv,n)}catch{}r=!0}return r}finally{jt=t,ki.transition=e}}return!1}function EA(n,e,t){e=nd(t,e),e=rI(n,e,1),n=Po(n,e,1),e=vr(),n!==null&&(Np(n,1,e),Ur(n,e))}function on(n,e,t){if(n.tag===3)EA(n,n,t);else for(;e!==null;){if(e.tag===3){EA(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Co===null||!Co.has(r))){n=nd(t,n),n=iI(e,n,1),e=Po(e,n,1),n=vr(),e!==null&&(Np(e,1,n),Ur(e,n));break}}e=e.return}}function rV(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=vr(),n.pingedLanes|=n.suspendedLanes&t,Ln===n&&(Bn&t)===t&&(Sn===4||Sn===3&&(Bn&130023424)===Bn&&500>hn()-jE?Vl(n,0):IE|=t),Ur(n,e)}function EI(n,e){e===0&&(n.mode&1?(e=vm,vm<<=1,!(vm&130023424)&&(vm=4194304)):e=1);var t=vr();n=Ca(n,e),n!==null&&(Np(n,e,t),Ur(n,t))}function iV(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),EI(n,t)}function sV(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(_e(314))}r!==null&&r.delete(e),EI(n,t)}var TI;TI=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||jr.current)Ir=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Ir=!1,G5(n,e,t);Ir=!!(n.flags&131072)}else Ir=!1,Zt&&e.flags&1048576&&PD(e,By,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;oy(n,e),n=e.pendingProps;var i=Ju(e,sr.current);Bu(e,t),i=CE(null,e,r,n,i,t);var s=RE();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Fr(r)?(s=!0,Fy(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,TE(e),i.updater=cv,e.stateNode=i,i._reactInternals=e,Kw(e,r,n,t),e=Qw(null,e,r,!0,s,t)):(e.tag=0,Zt&&s&&vE(e),mr(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch(oy(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=oV(r),n=zi(r,n),i){case 0:e=Jw(null,e,r,n,t);break e;case 1:e=pA(null,e,r,n,t);break e;case 11:e=hA(null,e,r,n,t);break e;case 14:e=fA(null,e,r,zi(r.type,n),t);break e}throw Error(_e(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:zi(r,i),Jw(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:zi(r,i),pA(n,e,r,i,t);case 3:e:{if(lI(e),n===null)throw Error(_e(387));r=e.pendingProps,s=e.memoizedState,i=s.element,DD(n,e),Vy(e,r,null,t);var a=e.memoizedState;if(r=a.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=nd(Error(_e(423)),e),e=mA(n,e,r,t,i);break e}else if(r!==i){i=nd(Error(_e(424)),e),e=mA(n,e,r,t,i);break e}else for(ei=Ao(e.stateNode.containerInfo.firstChild),ti=e,Zt=!0,Hi=null,t=OD(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Qu(),r===i){e=Ra(n,e,t);break e}mr(n,e,r,t)}e=e.child}return e;case 5:return ID(e),n===null&&qw(e),r=e.type,i=e.pendingProps,s=n!==null?n.memoizedProps:null,a=i.children,$w(r,i)?a=null:s!==null&&$w(r,s)&&(e.flags|=32),oI(n,e),mr(n,e,a,t),e.child;case 6:return n===null&&qw(e),null;case 13:return cI(n,e,t);case 4:return ME(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=ed(e,null,r,t):mr(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:zi(r,i),hA(n,e,r,i,t);case 7:return mr(n,e,e.pendingProps,t),e.child;case 8:return mr(n,e,e.pendingProps.children,t),e.child;case 12:return mr(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,$t(zy,r._currentValue),r._currentValue=a,s!==null)if(rs(s.value,a)){if(s.children===i.children&&!jr.current){e=Ra(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=ba(-1,t&-t),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),Xw(s.return,t,e),o.lanes|=t;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(_e(341));a.lanes|=t,o=a.alternate,o!==null&&(o.lanes|=t),Xw(a,t,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}mr(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Bu(e,t),i=Ai(i),r=r(i),e.flags|=1,mr(n,e,r,t),e.child;case 14:return r=e.type,i=zi(r,e.pendingProps),i=zi(r.type,i),fA(n,e,r,i,t);case 15:return sI(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:zi(r,i),oy(n,e),e.tag=1,Fr(r)?(n=!0,Fy(e)):n=!1,Bu(e,t),nI(e,r,i),Kw(e,r,i,t),Qw(null,e,r,!0,n,t);case 19:return uI(n,e,t);case 22:return aI(n,e,t)}throw Error(_e(156,e.tag))};function MI(n,e){return QL(n,e)}function aV(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ti(n,e,t,r){return new aV(n,e,t,r)}function zE(n){return n=n.prototype,!(!n||!n.isReactComponent)}function oV(n){if(typeof n=="function")return zE(n)?1:0;if(n!=null){if(n=n.$$typeof,n===aE)return 11;if(n===oE)return 14}return 2}function No(n,e){var t=n.alternate;return t===null?(t=Ti(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function uy(n,e,t,r,i,s){var a=2;if(r=n,typeof n=="function")zE(n)&&(a=1);else if(typeof n=="string")a=5;else e:switch(n){case fu:return Hl(t.children,i,s,e);case sE:a=8,i|=8;break;case _w:return n=Ti(12,t,e,i|2),n.elementType=_w,n.lanes=s,n;case bw:return n=Ti(13,t,e,i),n.elementType=bw,n.lanes=s,n;case ww:return n=Ti(19,t,e,i),n.elementType=ww,n.lanes=s,n;case IL:return hv(t,i,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case LL:a=10;break e;case DL:a=9;break e;case aE:a=11;break e;case oE:a=14;break e;case so:a=16,r=null;break e}throw Error(_e(130,n==null?n:typeof n,""))}return e=Ti(a,t,e,i),e.elementType=n,e.type=r,e.lanes=s,e}function Hl(n,e,t,r){return n=Ti(7,n,r,e),n.lanes=t,n}function hv(n,e,t,r){return n=Ti(22,n,r,e),n.elementType=IL,n.lanes=t,n.stateNode={isHidden:!1},n}function s_(n,e,t){return n=Ti(6,n,null,e),n.lanes=t,n}function a_(n,e,t){return e=Ti(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function lV(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Bx(0),this.expirationTimes=Bx(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Bx(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function $E(n,e,t,r,i,s,a,o,l){return n=new lV(n,e,t,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Ti(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},TE(s),n}function cV(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:hu,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function kI(n){if(!n)return Uo;n=n._reactInternals;e:{if(xc(n)!==n||n.tag!==1)throw Error(_e(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Fr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(_e(171))}if(n.tag===1){var t=n.type;if(Fr(t))return kD(n,t,e)}return e}function AI(n,e,t,r,i,s,a,o,l){return n=$E(t,r,!0,n,i,s,a,o,l),n.context=kI(null),t=n.current,r=vr(),i=Ro(t),s=ba(r,i),s.callback=e??null,Po(t,s,i),n.current.lanes=i,Np(n,i,r),Ur(n,r),n}function fv(n,e,t,r){var i=e.current,s=vr(),a=Ro(i);return t=kI(t),e.context===null?e.context=t:e.pendingContext=t,e=ba(s,a),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=Po(i,e,a),n!==null&&(Zi(n,i,a,s),iy(n,i,a)),a}function Zy(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function TA(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function VE(n,e){TA(n,e),(n=n.alternate)&&TA(n,e)}function uV(){return null}var PI=typeof reportError=="function"?reportError:function(n){console.error(n)};function HE(n){this._internalRoot=n}pv.prototype.render=HE.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(_e(409));fv(n,e,null,null)};pv.prototype.unmount=HE.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;sc(function(){fv(null,n,null,null)}),e[Pa]=null}};function pv(n){this._internalRoot=n}pv.prototype.unstable_scheduleHydration=function(n){if(n){var e=aD();n={blockedOn:null,target:n,priority:e};for(var t=0;t<uo.length&&e!==0&&e<uo[t].priority;t++);uo.splice(t,0,n),t===0&&lD(n)}};function WE(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function mv(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function MA(){}function dV(n,e,t,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=Zy(a);s.call(c)}}var a=AI(e,r,n,0,null,!1,!1,"",MA);return n._reactRootContainer=a,n[Pa]=a.current,Uf(n.nodeType===8?n.parentNode:n),sc(),a}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var o=r;r=function(){var c=Zy(l);o.call(c)}}var l=$E(n,0,!1,null,null,!1,!1,"",MA);return n._reactRootContainer=l,n[Pa]=l.current,Uf(n.nodeType===8?n.parentNode:n),sc(function(){fv(e,l,t,r)}),l}function gv(n,e,t,r,i){var s=t._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=Zy(a);o.call(l)}}fv(e,a,n,i)}else a=dV(t,e,n,i,r);return Zy(a)}iD=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=jh(e.pendingLanes);t!==0&&(uE(e,t|1),Ur(e,hn()),!(Mt&6)&&(rd=hn()+500,Zo()))}break;case 13:sc(function(){var r=Ca(n,1);if(r!==null){var i=vr();Zi(r,n,1,i)}}),VE(n,1)}};dE=function(n){if(n.tag===13){var e=Ca(n,134217728);if(e!==null){var t=vr();Zi(e,n,134217728,t)}VE(n,134217728)}};sD=function(n){if(n.tag===13){var e=Ro(n),t=Ca(n,e);if(t!==null){var r=vr();Zi(t,n,e,r)}VE(n,e)}};aD=function(){return jt};oD=function(n,e){var t=jt;try{return jt=n,e()}finally{jt=t}};Nw=function(n,e,t){switch(e){case"input":if(Tw(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=av(r);if(!i)throw Error(_e(90));FL(r),Tw(r,i)}}}break;case"textarea":BL(n,t);break;case"select":e=t.value,e!=null&&Iu(n,!!t.multiple,e,!1)}};qL=FE;XL=sc;var hV={usingClientEntryPoint:!1,Events:[Lp,yu,av,WL,GL,FE]},Zd={findFiberByHostInstance:Nl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},fV={bundleType:Zd.bundleType,version:Zd.version,rendererPackageName:Zd.rendererPackageName,rendererConfig:Zd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Da.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=ZL(n),n===null?null:n.stateNode},findFiberByHostInstance:Zd.findFiberByHostInstance||uV,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pm.isDisabled&&Pm.supportsFiber)try{nv=Pm.inject(fV),Cs=Pm}catch{}}ui.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hV;ui.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!WE(e))throw Error(_e(200));return cV(n,e,null,t)};ui.createRoot=function(n,e){if(!WE(n))throw Error(_e(299));var t=!1,r="",i=PI;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=$E(n,1,!1,null,null,t,!1,r,i),n[Pa]=e.current,Uf(n.nodeType===8?n.parentNode:n),new HE(e)};ui.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(_e(188)):(n=Object.keys(n).join(","),Error(_e(268,n)));return n=ZL(e),n=n===null?null:n.stateNode,n};ui.flushSync=function(n){return sc(n)};ui.hydrate=function(n,e,t){if(!mv(e))throw Error(_e(200));return gv(null,n,e,!0,t)};ui.hydrateRoot=function(n,e,t){if(!WE(n))throw Error(_e(405));var r=t!=null&&t.hydratedSources||null,i=!1,s="",a=PI;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=AI(e,null,n,1,t??null,i,!1,s,a),n[Pa]=e.current,Uf(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new pv(e)};ui.render=function(n,e,t){if(!mv(e))throw Error(_e(200));return gv(null,n,e,!1,t)};ui.unmountComponentAtNode=function(n){if(!mv(n))throw Error(_e(40));return n._reactRootContainer?(sc(function(){gv(null,null,n,!1,function(){n._reactRootContainer=null,n[Pa]=null})}),!0):!1};ui.unstable_batchedUpdates=FE;ui.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!mv(t))throw Error(_e(200));if(n==null||n._reactInternals===void 0)throw Error(_e(38));return gv(n,e,t,!1,r)};ui.version="18.3.1-next-f1338f8080-20240426";function CI(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(CI)}catch(n){console.error(n)}}CI(),CL.exports=ui;var GE=CL.exports,RI,kA=GE;RI=kA.createRoot,kA.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Xf(){return Xf=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Xf.apply(this,arguments)}var vo;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(vo||(vo={}));const AA="popstate";function pV(n){n===void 0&&(n={});function e(r,i){let{pathname:s,search:a,hash:o}=r.location;return dS("",{pathname:s,search:a,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(r,i){return typeof i=="string"?i:OI(i)}return gV(e,t,null,n)}function vn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function NI(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function mV(){return Math.random().toString(36).substr(2,8)}function PA(n,e){return{usr:n.state,key:n.key,idx:e}}function dS(n,e,t,r){return t===void 0&&(t=null),Xf({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Md(e):e,{state:t,key:e&&e.key||r||mV()})}function OI(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Md(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function gV(n,e,t,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,a=i.history,o=vo.Pop,l=null,c=u();c==null&&(c=0,a.replaceState(Xf({},a.state,{idx:c}),""));function u(){return(a.state||{idx:null}).idx}function d(){o=vo.Pop;let g=u(),m=g==null?null:g-c;c=g,l&&l({action:o,location:v.location,delta:m})}function h(g,m){o=vo.Push;let x=dS(v.location,g,m);c=u()+1;let _=PA(x,c),b=v.createHref(x);try{a.pushState(_,"",b)}catch(w){if(w instanceof DOMException&&w.name==="DataCloneError")throw w;i.location.assign(b)}s&&l&&l({action:o,location:v.location,delta:1})}function p(g,m){o=vo.Replace;let x=dS(v.location,g,m);c=u();let _=PA(x,c),b=v.createHref(x);a.replaceState(_,"",b),s&&l&&l({action:o,location:v.location,delta:0})}function y(g){let m=i.location.origin!=="null"?i.location.origin:i.location.href,x=typeof g=="string"?g:OI(g);return x=x.replace(/ $/,"%20"),vn(m,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,m)}let v={get action(){return o},get location(){return n(i,a)},listen(g){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(AA,d),l=g,()=>{i.removeEventListener(AA,d),l=null}},createHref(g){return e(i,g)},createURL:y,encodeLocation(g){let m=y(g);return{pathname:m.pathname,search:m.search,hash:m.hash}},push:h,replace:p,go(g){return a.go(g)}};return v}var CA;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(CA||(CA={}));function yV(n,e,t){return t===void 0&&(t="/"),vV(n,e,t,!1)}function vV(n,e,t,r){let i=typeof e=="string"?Md(e):e,s=II(i.pathname||"/",t);if(s==null)return null;let a=LI(n);xV(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let c=CV(s);o=AV(a[l],c,r)}return o}function LI(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let i=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(vn(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=Wl([r,l.relativePath]),u=t.concat(l);s.children&&s.children.length>0&&(vn(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),LI(s.children,e,u,c)),!(s.path==null&&!s.index)&&e.push({path:c,score:MV(c,s.index),routesMeta:u})};return n.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))i(s,a);else for(let l of DI(s.path))i(s,a,l)}),e}function DI(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),s=t.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let a=DI(r.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),i&&o.push(...a),o.map(l=>n.startsWith("/")&&l===""?"/":l)}function xV(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:kV(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const _V=/^:[\w-]+$/,bV=3,wV=2,SV=1,EV=10,TV=-2,RA=n=>n==="*";function MV(n,e){let t=n.split("/"),r=t.length;return t.some(RA)&&(r+=TV),e&&(r+=wV),t.filter(i=>!RA(i)).reduce((i,s)=>i+(_V.test(s)?bV:s===""?SV:EV),r)}function kV(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function AV(n,e,t){let{routesMeta:r}=n,i={},s="/",a=[];for(let o=0;o<r.length;++o){let l=r[o],c=o===r.length-1,u=s==="/"?e:e.slice(s.length)||"/",d=NA({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),h=l.route;if(!d&&c&&t&&!r[r.length-1].route.index&&(d=NA({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!d)return null;Object.assign(i,d.params),a.push({params:i,pathname:Wl([s,d.pathname]),pathnameBase:LV(Wl([s,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(s=Wl([s,d.pathnameBase]))}return a}function NA(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=PV(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:r.reduce((c,u,d)=>{let{paramName:h,isOptional:p}=u;if(h==="*"){let v=o[d]||"";a=s.slice(0,s.length-v.length).replace(/(.)\/+$/,"$1")}const y=o[d];return p&&!y?c[h]=void 0:c[h]=(y||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:a,pattern:n}}function PV(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),NI(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(r.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function CV(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return NI(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function II(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function RV(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?Md(n):n;return{pathname:t?t.startsWith("/")?t:NV(t,e):e,search:DV(r),hash:IV(i)}}function NV(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function o_(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function OV(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function jI(n,e){let t=OV(n);return e?t.map((r,i)=>i===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function FI(n,e,t,r){r===void 0&&(r=!1);let i;typeof n=="string"?i=Md(n):(i=Xf({},n),vn(!i.pathname||!i.pathname.includes("?"),o_("?","pathname","search",i)),vn(!i.pathname||!i.pathname.includes("#"),o_("#","pathname","hash",i)),vn(!i.search||!i.search.includes("#"),o_("#","search","hash",i)));let s=n===""||i.pathname==="",a=s?"/":i.pathname,o;if(a==null)o=t;else{let d=e.length-1;if(!r&&a.startsWith("..")){let h=a.split("/");for(;h[0]==="..";)h.shift(),d-=1;i.pathname=h.join("/")}o=d>=0?e[d]:"/"}let l=RV(i,o),c=a&&a!=="/"&&a.endsWith("/"),u=(s||a===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const Wl=n=>n.join("/").replace(/\/\/+/g,"/"),LV=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),DV=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,IV=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function jV(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const UI=["post","put","patch","delete"];new Set(UI);const FV=["get",...UI];new Set(FV);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Yf(){return Yf=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Yf.apply(this,arguments)}const qE=k.createContext(null),UV=k.createContext(null),Ip=k.createContext(null),yv=k.createContext(null),_c=k.createContext({outlet:null,matches:[],isDataRoute:!1}),BI=k.createContext(null);function jp(){return k.useContext(yv)!=null}function bc(){return jp()||vn(!1),k.useContext(yv).location}function zI(n){k.useContext(Ip).static||k.useLayoutEffect(n)}function Ia(){let{isDataRoute:n}=k.useContext(_c);return n?JV():BV()}function BV(){jp()||vn(!1);let n=k.useContext(qE),{basename:e,future:t,navigator:r}=k.useContext(Ip),{matches:i}=k.useContext(_c),{pathname:s}=bc(),a=JSON.stringify(jI(i,t.v7_relativeSplatPath)),o=k.useRef(!1);return zI(()=>{o.current=!0}),k.useCallback(function(c,u){if(u===void 0&&(u={}),!o.current)return;if(typeof c=="number"){r.go(c);return}let d=FI(c,JSON.parse(a),s,u.relative==="path");n==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Wl([e,d.pathname])),(u.replace?r.replace:r.push)(d,u.state,u)},[e,r,a,s,n])}function zV(n,e){return $V(n,e)}function $V(n,e,t,r){jp()||vn(!1);let{navigator:i,static:s}=k.useContext(Ip),{matches:a}=k.useContext(_c),o=a[a.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=bc(),d;if(e){var h;let m=typeof e=="string"?Md(e):e;c==="/"||(h=m.pathname)!=null&&h.startsWith(c)||vn(!1),d=m}else d=u;let p=d.pathname||"/",y=p;if(c!=="/"){let m=c.replace(/^\//,"").split("/");y="/"+p.replace(/^\//,"").split("/").slice(m.length).join("/")}let v=!s&&t&&t.matches&&t.matches.length>0?t.matches:yV(n,{pathname:y}),g=qV(v&&v.map(m=>Object.assign({},m,{params:Object.assign({},l,m.params),pathname:Wl([c,i.encodeLocation?i.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?c:Wl([c,i.encodeLocation?i.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),a,t,r);return e&&g?k.createElement(yv.Provider,{value:{location:Yf({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:vo.Pop}},g):g}function VV(){let n=ZV(),e=jV(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return k.createElement(k.Fragment,null,k.createElement("h2",null,"Unexpected Application Error!"),k.createElement("h3",{style:{fontStyle:"italic"}},e),t?k.createElement("pre",{style:i},t):null,null)}const HV=k.createElement(VV,null);class WV extends k.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?k.createElement(_c.Provider,{value:this.props.routeContext},k.createElement(BI.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function GV(n){let{routeContext:e,match:t,children:r}=n,i=k.useContext(qE);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),k.createElement(_c.Provider,{value:e},r)}function qV(n,e,t,r){var i;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var s;if(!t)return null;if(t.errors)n=t.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,o=(i=t)==null?void 0:i.errors;if(o!=null){let u=a.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);u>=0||vn(!1),a=a.slice(0,Math.min(a.length,u+1))}let l=!1,c=-1;if(t&&r&&r.v7_partialHydration)for(let u=0;u<a.length;u++){let d=a[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:h,errors:p}=t,y=d.route.loader&&h[d.route.id]===void 0&&(!p||p[d.route.id]===void 0);if(d.route.lazy||y){l=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}return a.reduceRight((u,d,h)=>{let p,y=!1,v=null,g=null;t&&(p=o&&d.route.id?o[d.route.id]:void 0,v=d.route.errorElement||HV,l&&(c<0&&h===0?(y=!0,g=null):c===h&&(y=!0,g=d.route.hydrateFallbackElement||null)));let m=e.concat(a.slice(0,h+1)),x=()=>{let _;return p?_=v:y?_=g:d.route.Component?_=k.createElement(d.route.Component,null):d.route.element?_=d.route.element:_=u,k.createElement(GV,{match:d,routeContext:{outlet:u,matches:m,isDataRoute:t!=null},children:_})};return t&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?k.createElement(WV,{location:t.location,revalidation:t.revalidation,component:v,error:p,children:x(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):x()},null)}var $I=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}($I||{}),Jy=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(Jy||{});function XV(n){let e=k.useContext(qE);return e||vn(!1),e}function YV(n){let e=k.useContext(UV);return e||vn(!1),e}function KV(n){let e=k.useContext(_c);return e||vn(!1),e}function VI(n){let e=KV(),t=e.matches[e.matches.length-1];return t.route.id||vn(!1),t.route.id}function ZV(){var n;let e=k.useContext(BI),t=YV(Jy.UseRouteError),r=VI(Jy.UseRouteError);return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function JV(){let{router:n}=XV($I.UseNavigateStable),e=VI(Jy.UseNavigateStable),t=k.useRef(!1);return zI(()=>{t.current=!0}),k.useCallback(function(i,s){s===void 0&&(s={}),t.current&&(typeof i=="number"?n.navigate(i):n.navigate(i,Yf({fromRouteId:e},s)))},[n,e])}function QV(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function XE(n){let{to:e,replace:t,state:r,relative:i}=n;jp()||vn(!1);let{future:s,static:a}=k.useContext(Ip),{matches:o}=k.useContext(_c),{pathname:l}=bc(),c=Ia(),u=FI(e,jI(o,s.v7_relativeSplatPath),l,i==="path"),d=JSON.stringify(u);return k.useEffect(()=>c(JSON.parse(d),{replace:t,state:r,relative:i}),[c,d,i,t,r]),null}function su(n){vn(!1)}function eH(n){let{basename:e="/",children:t=null,location:r,navigationType:i=vo.Pop,navigator:s,static:a=!1,future:o}=n;jp()&&vn(!1);let l=e.replace(/^\/*/,"/"),c=k.useMemo(()=>({basename:l,navigator:s,static:a,future:Yf({v7_relativeSplatPath:!1},o)}),[l,o,s,a]);typeof r=="string"&&(r=Md(r));let{pathname:u="/",search:d="",hash:h="",state:p=null,key:y="default"}=r,v=k.useMemo(()=>{let g=II(u,l);return g==null?null:{location:{pathname:g,search:d,hash:h,state:p,key:y},navigationType:i}},[l,u,d,h,p,y,i]);return v==null?null:k.createElement(Ip.Provider,{value:c},k.createElement(yv.Provider,{children:t,value:v}))}function tH(n){let{children:e,location:t}=n;return zV(hS(e),t)}new Promise(()=>{});function hS(n,e){e===void 0&&(e=[]);let t=[];return k.Children.forEach(n,(r,i)=>{if(!k.isValidElement(r))return;let s=[...e,i];if(r.type===k.Fragment){t.push.apply(t,hS(r.props.children,s));return}r.type!==su&&vn(!1),!r.props.index||!r.props.children||vn(!1);let a={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=hS(r.props.children,s)),t.push(a)}),t}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const nH="6";try{window.__reactRouterVersion=nH}catch{}const rH="startTransition",OA=r$[rH];function iH(n){let{basename:e,children:t,future:r,window:i}=n,s=k.useRef();s.current==null&&(s.current=pV({window:i,v5Compat:!0}));let a=s.current,[o,l]=k.useState({action:a.action,location:a.location}),{v7_startTransition:c}=r||{},u=k.useCallback(d=>{c&&OA?OA(()=>l(d)):l(d)},[l,c]);return k.useLayoutEffect(()=>a.listen(u),[a,u]),k.useEffect(()=>QV(r),[r]),k.createElement(eH,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:a,future:r})}var LA;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(LA||(LA={}));var DA;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(DA||(DA={}));/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const YE="162",sH=0,IA=1,aH=2,HI=1,oH=2,ta=3,Bo=0,Br=1,da=2,Oo=0,$u=1,jA=2,FA=3,UA=4,lH=5,Al=100,cH=101,uH=102,BA=103,zA=104,dH=200,hH=201,fH=202,pH=203,fS=204,pS=205,mH=206,gH=207,yH=208,vH=209,xH=210,_H=211,bH=212,wH=213,SH=214,EH=0,TH=1,MH=2,Qy=3,kH=4,AH=5,PH=6,CH=7,WI=0,RH=1,NH=2,Lo=0,OH=1,LH=2,DH=3,IH=4,jH=5,FH=6,UH=7,GI=300,id=301,sd=302,mS=303,gS=304,vv=306,yS=1e3,Wi=1001,vS=1002,gr=1003,$A=1004,Jd=1005,Rr=1006,l_=1007,Dl=1008,Do=1009,BH=1010,zH=1011,KE=1012,qI=1013,xo=1014,ha=1015,Kf=1016,XI=1017,YI=1018,Gl=1020,$H=1021,Gi=1023,VH=1024,HH=1025,ql=1026,ad=1027,WH=1028,KI=1029,GH=1030,ZI=1031,JI=1033,c_=33776,u_=33777,d_=33778,h_=33779,VA=35840,HA=35841,WA=35842,GA=35843,QI=36196,qA=37492,XA=37496,YA=37808,KA=37809,ZA=37810,JA=37811,QA=37812,eP=37813,tP=37814,nP=37815,rP=37816,iP=37817,sP=37818,aP=37819,oP=37820,lP=37821,f_=36492,cP=36494,uP=36495,qH=36283,dP=36284,hP=36285,fP=36286,XH=3200,YH=3201,KH=0,ZH=1,fo="",bs="srgb",Jo="srgb-linear",ZE="display-p3",xv="display-p3-linear",e0="linear",Gt="srgb",t0="rec709",n0="p3",Cc=7680,pP=519,JH=512,QH=513,eW=514,ej=515,tW=516,nW=517,rW=518,iW=519,mP=35044,gP="300 es",xS=1035,ma=2e3,r0=2001;class kd{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,a=i.length;s<a;s++)i[s].call(this,e);e.target=null}}}const Wn=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],p_=Math.PI/180,_S=180/Math.PI;function Fp(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Wn[n&255]+Wn[n>>8&255]+Wn[n>>16&255]+Wn[n>>24&255]+"-"+Wn[e&255]+Wn[e>>8&255]+"-"+Wn[e>>16&15|64]+Wn[e>>24&255]+"-"+Wn[t&63|128]+Wn[t>>8&255]+"-"+Wn[t>>16&255]+Wn[t>>24&255]+Wn[r&255]+Wn[r>>8&255]+Wn[r>>16&255]+Wn[r>>24&255]).toLowerCase()}function Or(n,e,t){return Math.max(e,Math.min(t,n))}function sW(n,e){return(n%e+e)%e}function m_(n,e,t){return(1-t)*n+t*e}function yP(n){return(n&n-1)===0&&n!==0}function bS(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function Qd(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Tr(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}class Rt{constructor(e=0,t=0){Rt.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Or(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),i=Math.sin(t),s=this.x-e.x,a=this.y-e.y;return this.x=s*r-a*i+e.x,this.y=s*i+a*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ct{constructor(e,t,r,i,s,a,o,l,c){ct.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,a,o,l,c)}set(e,t,r,i,s,a,o,l,c){const u=this.elements;return u[0]=e,u[1]=i,u[2]=o,u[3]=t,u[4]=s,u[5]=l,u[6]=r,u[7]=a,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,a=r[0],o=r[3],l=r[6],c=r[1],u=r[4],d=r[7],h=r[2],p=r[5],y=r[8],v=i[0],g=i[3],m=i[6],x=i[1],_=i[4],b=i[7],w=i[2],E=i[5],S=i[8];return s[0]=a*v+o*x+l*w,s[3]=a*g+o*_+l*E,s[6]=a*m+o*b+l*S,s[1]=c*v+u*x+d*w,s[4]=c*g+u*_+d*E,s[7]=c*m+u*b+d*S,s[2]=h*v+p*x+y*w,s[5]=h*g+p*_+y*E,s[8]=h*m+p*b+y*S,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],u=e[8];return t*a*u-t*o*c-r*s*u+r*o*l+i*s*c-i*a*l}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],u=e[8],d=u*a-o*c,h=o*l-u*s,p=c*s-a*l,y=t*d+r*h+i*p;if(y===0)return this.set(0,0,0,0,0,0,0,0,0);const v=1/y;return e[0]=d*v,e[1]=(i*c-u*r)*v,e[2]=(o*r-i*a)*v,e[3]=h*v,e[4]=(u*t-i*l)*v,e[5]=(i*s-o*t)*v,e[6]=p*v,e[7]=(r*l-c*t)*v,e[8]=(a*t-r*s)*v,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,s,a,o){const l=Math.cos(s),c=Math.sin(s);return this.set(r*l,r*c,-r*(l*a+c*o)+a+e,-i*c,i*l,-i*(-c*a+l*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(g_.makeScale(e,t)),this}rotate(e){return this.premultiply(g_.makeRotation(-e)),this}translate(e,t){return this.premultiply(g_.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const g_=new ct;function tj(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function i0(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function aW(){const n=i0("canvas");return n.style.display="block",n}const vP={};function oW(n){n in vP||(vP[n]=!0,console.warn(n))}const xP=new ct().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),_P=new ct().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Cm={[Jo]:{transfer:e0,primaries:t0,toReference:n=>n,fromReference:n=>n},[bs]:{transfer:Gt,primaries:t0,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[xv]:{transfer:e0,primaries:n0,toReference:n=>n.applyMatrix3(_P),fromReference:n=>n.applyMatrix3(xP)},[ZE]:{transfer:Gt,primaries:n0,toReference:n=>n.convertSRGBToLinear().applyMatrix3(_P),fromReference:n=>n.applyMatrix3(xP).convertLinearToSRGB()}},lW=new Set([Jo,xv]),Ft={enabled:!0,_workingColorSpace:Jo,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!lW.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){if(this.enabled===!1||e===t||!e||!t)return n;const r=Cm[e].toReference,i=Cm[t].fromReference;return i(r(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return Cm[n].primaries},getTransfer:function(n){return n===fo?e0:Cm[n].transfer}};function Vu(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function y_(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let Rc;class nj{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Rc===void 0&&(Rc=i0("canvas")),Rc.width=e.width,Rc.height=e.height;const r=Rc.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=Rc}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=i0("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height),s=i.data;for(let a=0;a<s.length;a++)s[a]=Vu(s[a]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(Vu(t[r]/255)*255):t[r]=Vu(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let cW=0;class rj{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:cW++}),this.uuid=Fp(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let a=0,o=i.length;a<o;a++)i[a].isDataTexture?s.push(v_(i[a].image)):s.push(v_(i[a]))}else s=v_(i);r.url=s}return t||(e.images[this.uuid]=r),r}}function v_(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?nj.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let uW=0;class zr extends kd{constructor(e=zr.DEFAULT_IMAGE,t=zr.DEFAULT_MAPPING,r=Wi,i=Wi,s=Rr,a=Dl,o=Gi,l=Do,c=zr.DEFAULT_ANISOTROPY,u=fo){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:uW++}),this.uuid=Fp(),this.name="",this.source=new rj(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=s,this.minFilter=a,this.anisotropy=c,this.format=o,this.internalFormat=null,this.type=l,this.offset=new Rt(0,0),this.repeat=new Rt(1,1),this.center=new Rt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ct,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=u,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==GI)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case yS:e.x=e.x-Math.floor(e.x);break;case Wi:e.x=e.x<0?0:1;break;case vS:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case yS:e.y=e.y-Math.floor(e.y);break;case Wi:e.y=e.y<0?0:1;break;case vS:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}zr.DEFAULT_IMAGE=null;zr.DEFAULT_MAPPING=GI;zr.DEFAULT_ANISOTROPY=1;class Un{constructor(e=0,t=0,r=0,i=1){Un.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=this.w,a=e.elements;return this.x=a[0]*t+a[4]*r+a[8]*i+a[12]*s,this.y=a[1]*t+a[5]*r+a[9]*i+a[13]*s,this.z=a[2]*t+a[6]*r+a[10]*i+a[14]*s,this.w=a[3]*t+a[7]*r+a[11]*i+a[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,s;const l=e.elements,c=l[0],u=l[4],d=l[8],h=l[1],p=l[5],y=l[9],v=l[2],g=l[6],m=l[10];if(Math.abs(u-h)<.01&&Math.abs(d-v)<.01&&Math.abs(y-g)<.01){if(Math.abs(u+h)<.1&&Math.abs(d+v)<.1&&Math.abs(y+g)<.1&&Math.abs(c+p+m-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const _=(c+1)/2,b=(p+1)/2,w=(m+1)/2,E=(u+h)/4,S=(d+v)/4,M=(y+g)/4;return _>b&&_>w?_<.01?(r=0,i=.707106781,s=.707106781):(r=Math.sqrt(_),i=E/r,s=S/r):b>w?b<.01?(r=.707106781,i=0,s=.707106781):(i=Math.sqrt(b),r=E/i,s=M/i):w<.01?(r=.707106781,i=.707106781,s=0):(s=Math.sqrt(w),r=S/s,i=M/s),this.set(r,i,s,t),this}let x=Math.sqrt((g-y)*(g-y)+(d-v)*(d-v)+(h-u)*(h-u));return Math.abs(x)<.001&&(x=1),this.x=(g-y)/x,this.y=(d-v)/x,this.z=(h-u)/x,this.w=Math.acos((c+p+m-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class dW extends kd{constructor(e=1,t=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Un(0,0,e,t),this.scissorTest=!1,this.viewport=new Un(0,0,e,t);const i={width:e,height:t,depth:1};r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Rr,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0,count:1},r);const s=new zr(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace);s.flipY=!1,s.generateMipmaps=r.generateMipmaps,s.internalFormat=r.internalFormat,this.textures=[];const a=r.count;for(let o=0;o<a;o++)this.textures[o]=s.clone(),this.textures[o].isRenderTargetTexture=!0;this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.depthTexture=r.depthTexture,this.samples=r.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let i=0,s=this.textures.length;i<s;i++)this.textures[i].image.width=e,this.textures[i].image.height=t,this.textures[i].image.depth=r;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let r=0,i=e.textures.length;r<i;r++)this.textures[r]=e.textures[r].clone(),this.textures[r].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new rj(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class ac extends dW{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}}class ij extends zr{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=gr,this.minFilter=gr,this.wrapR=Wi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class hW extends zr{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=gr,this.minFilter=gr,this.wrapR=Wi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Up{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,s,a,o){let l=r[i+0],c=r[i+1],u=r[i+2],d=r[i+3];const h=s[a+0],p=s[a+1],y=s[a+2],v=s[a+3];if(o===0){e[t+0]=l,e[t+1]=c,e[t+2]=u,e[t+3]=d;return}if(o===1){e[t+0]=h,e[t+1]=p,e[t+2]=y,e[t+3]=v;return}if(d!==v||l!==h||c!==p||u!==y){let g=1-o;const m=l*h+c*p+u*y+d*v,x=m>=0?1:-1,_=1-m*m;if(_>Number.EPSILON){const w=Math.sqrt(_),E=Math.atan2(w,m*x);g=Math.sin(g*E)/w,o=Math.sin(o*E)/w}const b=o*x;if(l=l*g+h*b,c=c*g+p*b,u=u*g+y*b,d=d*g+v*b,g===1-o){const w=1/Math.sqrt(l*l+c*c+u*u+d*d);l*=w,c*=w,u*=w,d*=w}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=d}static multiplyQuaternionsFlat(e,t,r,i,s,a){const o=r[i],l=r[i+1],c=r[i+2],u=r[i+3],d=s[a],h=s[a+1],p=s[a+2],y=s[a+3];return e[t]=o*y+u*d+l*p-c*h,e[t+1]=l*y+u*h+c*d-o*p,e[t+2]=c*y+u*p+o*h-l*d,e[t+3]=u*y-o*d-l*h-c*p,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const r=e._x,i=e._y,s=e._z,a=e._order,o=Math.cos,l=Math.sin,c=o(r/2),u=o(i/2),d=o(s/2),h=l(r/2),p=l(i/2),y=l(s/2);switch(a){case"XYZ":this._x=h*u*d+c*p*y,this._y=c*p*d-h*u*y,this._z=c*u*y+h*p*d,this._w=c*u*d-h*p*y;break;case"YXZ":this._x=h*u*d+c*p*y,this._y=c*p*d-h*u*y,this._z=c*u*y-h*p*d,this._w=c*u*d+h*p*y;break;case"ZXY":this._x=h*u*d-c*p*y,this._y=c*p*d+h*u*y,this._z=c*u*y+h*p*d,this._w=c*u*d-h*p*y;break;case"ZYX":this._x=h*u*d-c*p*y,this._y=c*p*d+h*u*y,this._z=c*u*y-h*p*d,this._w=c*u*d+h*p*y;break;case"YZX":this._x=h*u*d+c*p*y,this._y=c*p*d+h*u*y,this._z=c*u*y-h*p*d,this._w=c*u*d-h*p*y;break;case"XZY":this._x=h*u*d-c*p*y,this._y=c*p*d-h*u*y,this._z=c*u*y+h*p*d,this._w=c*u*d+h*p*y;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],i=t[4],s=t[8],a=t[1],o=t[5],l=t[9],c=t[2],u=t[6],d=t[10],h=r+o+d;if(h>0){const p=.5/Math.sqrt(h+1);this._w=.25/p,this._x=(u-l)*p,this._y=(s-c)*p,this._z=(a-i)*p}else if(r>o&&r>d){const p=2*Math.sqrt(1+r-o-d);this._w=(u-l)/p,this._x=.25*p,this._y=(i+a)/p,this._z=(s+c)/p}else if(o>d){const p=2*Math.sqrt(1+o-r-d);this._w=(s-c)/p,this._x=(i+a)/p,this._y=.25*p,this._z=(l+u)/p}else{const p=2*Math.sqrt(1+d-r-o);this._w=(a-i)/p,this._x=(s+c)/p,this._y=(l+u)/p,this._z=.25*p}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Or(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,i=e._y,s=e._z,a=e._w,o=t._x,l=t._y,c=t._z,u=t._w;return this._x=r*u+a*o+i*c-s*l,this._y=i*u+a*l+s*o-r*c,this._z=s*u+a*c+r*l-i*o,this._w=a*u-r*o-i*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const r=this._x,i=this._y,s=this._z,a=this._w;let o=a*e._w+r*e._x+i*e._y+s*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=r,this._y=i,this._z=s,this;const l=1-o*o;if(l<=Number.EPSILON){const p=1-t;return this._w=p*a+t*this._w,this._x=p*r+t*this._x,this._y=p*i+t*this._y,this._z=p*s+t*this._z,this.normalize(),this}const c=Math.sqrt(l),u=Math.atan2(c,o),d=Math.sin((1-t)*u)/c,h=Math.sin(t*u)/c;return this._w=a*d+this._w*h,this._x=r*d+this._x*h,this._y=i*d+this._y*h,this._z=s*d+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),r=Math.random(),i=Math.sqrt(1-r),s=Math.sqrt(r);return this.set(i*Math.sin(e),i*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Q{constructor(e=0,t=0,r=0){Q.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(bP.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(bP.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*r+s[6]*i,this.y=s[1]*t+s[4]*r+s[7]*i,this.z=s[2]*t+s[5]*r+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=e.elements,a=1/(s[3]*t+s[7]*r+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*r+s[8]*i+s[12])*a,this.y=(s[1]*t+s[5]*r+s[9]*i+s[13])*a,this.z=(s[2]*t+s[6]*r+s[10]*i+s[14])*a,this}applyQuaternion(e){const t=this.x,r=this.y,i=this.z,s=e.x,a=e.y,o=e.z,l=e.w,c=2*(a*i-o*r),u=2*(o*t-s*i),d=2*(s*r-a*t);return this.x=t+l*c+a*d-o*u,this.y=r+l*u+o*c-s*d,this.z=i+l*d+s*u-a*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i,this.y=s[1]*t+s[5]*r+s[9]*i,this.z=s[2]*t+s[6]*r+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,i=e.y,s=e.z,a=t.x,o=t.y,l=t.z;return this.x=i*l-s*o,this.y=s*a-r*l,this.z=r*o-i*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return x_.copy(this).projectOnVector(e),this.sub(x_)}reflect(e){return this.sub(x_.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Or(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,r=Math.sqrt(1-t*t);return this.x=r*Math.cos(e),this.y=t,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const x_=new Q,bP=new Up;class Bp{constructor(e=new Q(1/0,1/0,1/0),t=new Q(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(Oi.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(Oi.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=Oi.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const s=r.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let a=0,o=s.count;a<o;a++)e.isMesh===!0?e.getVertexPosition(a,Oi):Oi.fromBufferAttribute(s,a),Oi.applyMatrix4(e.matrixWorld),this.expandByPoint(Oi);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Rm.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),Rm.copy(r.boundingBox)),Rm.applyMatrix4(e.matrixWorld),this.union(Rm)}const i=e.children;for(let s=0,a=i.length;s<a;s++)this.expandByObject(i[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Oi),Oi.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(eh),Nm.subVectors(this.max,eh),Nc.subVectors(e.a,eh),Oc.subVectors(e.b,eh),Lc.subVectors(e.c,eh),Ba.subVectors(Oc,Nc),za.subVectors(Lc,Oc),il.subVectors(Nc,Lc);let t=[0,-Ba.z,Ba.y,0,-za.z,za.y,0,-il.z,il.y,Ba.z,0,-Ba.x,za.z,0,-za.x,il.z,0,-il.x,-Ba.y,Ba.x,0,-za.y,za.x,0,-il.y,il.x,0];return!__(t,Nc,Oc,Lc,Nm)||(t=[1,0,0,0,1,0,0,0,1],!__(t,Nc,Oc,Lc,Nm))?!1:(Om.crossVectors(Ba,za),t=[Om.x,Om.y,Om.z],__(t,Nc,Oc,Lc,Nm))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Oi).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Oi).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Hs[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Hs[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Hs[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Hs[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Hs[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Hs[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Hs[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Hs[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Hs),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Hs=[new Q,new Q,new Q,new Q,new Q,new Q,new Q,new Q],Oi=new Q,Rm=new Bp,Nc=new Q,Oc=new Q,Lc=new Q,Ba=new Q,za=new Q,il=new Q,eh=new Q,Nm=new Q,Om=new Q,sl=new Q;function __(n,e,t,r,i){for(let s=0,a=n.length-3;s<=a;s+=3){sl.fromArray(n,s);const o=i.x*Math.abs(sl.x)+i.y*Math.abs(sl.y)+i.z*Math.abs(sl.z),l=e.dot(sl),c=t.dot(sl),u=r.dot(sl);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>o)return!1}return!0}const fW=new Bp,th=new Q,b_=new Q;class _v{constructor(e=new Q,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;t!==void 0?r.copy(t):fW.setFromPoints(e).getCenter(r);let i=0;for(let s=0,a=e.length;s<a;s++)i=Math.max(i,r.distanceToSquared(e[s]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;th.subVectors(e,this.center);const t=th.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),i=(r-this.radius)*.5;this.center.addScaledVector(th,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(b_.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(th.copy(e.center).add(b_)),this.expandByPoint(th.copy(e.center).sub(b_))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Ws=new Q,w_=new Q,Lm=new Q,$a=new Q,S_=new Q,Dm=new Q,E_=new Q;class sj{constructor(e=new Q,t=new Q(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ws)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Ws.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Ws.copy(this.origin).addScaledVector(this.direction,t),Ws.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){w_.copy(e).add(t).multiplyScalar(.5),Lm.copy(t).sub(e).normalize(),$a.copy(this.origin).sub(w_);const s=e.distanceTo(t)*.5,a=-this.direction.dot(Lm),o=$a.dot(this.direction),l=-$a.dot(Lm),c=$a.lengthSq(),u=Math.abs(1-a*a);let d,h,p,y;if(u>0)if(d=a*l-o,h=a*o-l,y=s*u,d>=0)if(h>=-y)if(h<=y){const v=1/u;d*=v,h*=v,p=d*(d+a*h+2*o)+h*(a*d+h+2*l)+c}else h=s,d=Math.max(0,-(a*h+o)),p=-d*d+h*(h+2*l)+c;else h=-s,d=Math.max(0,-(a*h+o)),p=-d*d+h*(h+2*l)+c;else h<=-y?(d=Math.max(0,-(-a*s+o)),h=d>0?-s:Math.min(Math.max(-s,-l),s),p=-d*d+h*(h+2*l)+c):h<=y?(d=0,h=Math.min(Math.max(-s,-l),s),p=h*(h+2*l)+c):(d=Math.max(0,-(a*s+o)),h=d>0?s:Math.min(Math.max(-s,-l),s),p=-d*d+h*(h+2*l)+c);else h=a>0?-s:s,d=Math.max(0,-(a*h+o)),p=-d*d+h*(h+2*l)+c;return r&&r.copy(this.origin).addScaledVector(this.direction,d),i&&i.copy(w_).addScaledVector(Lm,h),p}intersectSphere(e,t){Ws.subVectors(e.center,this.origin);const r=Ws.dot(this.direction),i=Ws.dot(Ws)-r*r,s=e.radius*e.radius;if(i>s)return null;const a=Math.sqrt(s-i),o=r-a,l=r+a;return l<0?null:o<0?this.at(l,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,s,a,o,l;const c=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,h=this.origin;return c>=0?(r=(e.min.x-h.x)*c,i=(e.max.x-h.x)*c):(r=(e.max.x-h.x)*c,i=(e.min.x-h.x)*c),u>=0?(s=(e.min.y-h.y)*u,a=(e.max.y-h.y)*u):(s=(e.max.y-h.y)*u,a=(e.min.y-h.y)*u),r>a||s>i||((s>r||isNaN(r))&&(r=s),(a<i||isNaN(i))&&(i=a),d>=0?(o=(e.min.z-h.z)*d,l=(e.max.z-h.z)*d):(o=(e.max.z-h.z)*d,l=(e.min.z-h.z)*d),r>l||o>i)||((o>r||r!==r)&&(r=o),(l<i||i!==i)&&(i=l),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return this.intersectBox(e,Ws)!==null}intersectTriangle(e,t,r,i,s){S_.subVectors(t,e),Dm.subVectors(r,e),E_.crossVectors(S_,Dm);let a=this.direction.dot(E_),o;if(a>0){if(i)return null;o=1}else if(a<0)o=-1,a=-a;else return null;$a.subVectors(this.origin,e);const l=o*this.direction.dot(Dm.crossVectors($a,Dm));if(l<0)return null;const c=o*this.direction.dot(S_.cross($a));if(c<0||l+c>a)return null;const u=-o*$a.dot(E_);return u<0?null:this.at(u/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class xn{constructor(e,t,r,i,s,a,o,l,c,u,d,h,p,y,v,g){xn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,a,o,l,c,u,d,h,p,y,v,g)}set(e,t,r,i,s,a,o,l,c,u,d,h,p,y,v,g){const m=this.elements;return m[0]=e,m[4]=t,m[8]=r,m[12]=i,m[1]=s,m[5]=a,m[9]=o,m[13]=l,m[2]=c,m[6]=u,m[10]=d,m[14]=h,m[3]=p,m[7]=y,m[11]=v,m[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new xn().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,i=1/Dc.setFromMatrixColumn(e,0).length(),s=1/Dc.setFromMatrixColumn(e,1).length(),a=1/Dc.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*s,t[5]=r[5]*s,t[6]=r[6]*s,t[7]=0,t[8]=r[8]*a,t[9]=r[9]*a,t[10]=r[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,i=e.y,s=e.z,a=Math.cos(r),o=Math.sin(r),l=Math.cos(i),c=Math.sin(i),u=Math.cos(s),d=Math.sin(s);if(e.order==="XYZ"){const h=a*u,p=a*d,y=o*u,v=o*d;t[0]=l*u,t[4]=-l*d,t[8]=c,t[1]=p+y*c,t[5]=h-v*c,t[9]=-o*l,t[2]=v-h*c,t[6]=y+p*c,t[10]=a*l}else if(e.order==="YXZ"){const h=l*u,p=l*d,y=c*u,v=c*d;t[0]=h+v*o,t[4]=y*o-p,t[8]=a*c,t[1]=a*d,t[5]=a*u,t[9]=-o,t[2]=p*o-y,t[6]=v+h*o,t[10]=a*l}else if(e.order==="ZXY"){const h=l*u,p=l*d,y=c*u,v=c*d;t[0]=h-v*o,t[4]=-a*d,t[8]=y+p*o,t[1]=p+y*o,t[5]=a*u,t[9]=v-h*o,t[2]=-a*c,t[6]=o,t[10]=a*l}else if(e.order==="ZYX"){const h=a*u,p=a*d,y=o*u,v=o*d;t[0]=l*u,t[4]=y*c-p,t[8]=h*c+v,t[1]=l*d,t[5]=v*c+h,t[9]=p*c-y,t[2]=-c,t[6]=o*l,t[10]=a*l}else if(e.order==="YZX"){const h=a*l,p=a*c,y=o*l,v=o*c;t[0]=l*u,t[4]=v-h*d,t[8]=y*d+p,t[1]=d,t[5]=a*u,t[9]=-o*u,t[2]=-c*u,t[6]=p*d+y,t[10]=h-v*d}else if(e.order==="XZY"){const h=a*l,p=a*c,y=o*l,v=o*c;t[0]=l*u,t[4]=-d,t[8]=c*u,t[1]=h*d+v,t[5]=a*u,t[9]=p*d-y,t[2]=y*d-p,t[6]=o*u,t[10]=v*d+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(pW,e,mW)}lookAt(e,t,r){const i=this.elements;return Gr.subVectors(e,t),Gr.lengthSq()===0&&(Gr.z=1),Gr.normalize(),Va.crossVectors(r,Gr),Va.lengthSq()===0&&(Math.abs(r.z)===1?Gr.x+=1e-4:Gr.z+=1e-4,Gr.normalize(),Va.crossVectors(r,Gr)),Va.normalize(),Im.crossVectors(Gr,Va),i[0]=Va.x,i[4]=Im.x,i[8]=Gr.x,i[1]=Va.y,i[5]=Im.y,i[9]=Gr.y,i[2]=Va.z,i[6]=Im.z,i[10]=Gr.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,a=r[0],o=r[4],l=r[8],c=r[12],u=r[1],d=r[5],h=r[9],p=r[13],y=r[2],v=r[6],g=r[10],m=r[14],x=r[3],_=r[7],b=r[11],w=r[15],E=i[0],S=i[4],M=i[8],N=i[12],T=i[1],P=i[5],H=i[9],W=i[13],O=i[2],I=i[6],F=i[10],j=i[14],L=i[3],D=i[7],z=i[11],K=i[15];return s[0]=a*E+o*T+l*O+c*L,s[4]=a*S+o*P+l*I+c*D,s[8]=a*M+o*H+l*F+c*z,s[12]=a*N+o*W+l*j+c*K,s[1]=u*E+d*T+h*O+p*L,s[5]=u*S+d*P+h*I+p*D,s[9]=u*M+d*H+h*F+p*z,s[13]=u*N+d*W+h*j+p*K,s[2]=y*E+v*T+g*O+m*L,s[6]=y*S+v*P+g*I+m*D,s[10]=y*M+v*H+g*F+m*z,s[14]=y*N+v*W+g*j+m*K,s[3]=x*E+_*T+b*O+w*L,s[7]=x*S+_*P+b*I+w*D,s[11]=x*M+_*H+b*F+w*z,s[15]=x*N+_*W+b*j+w*K,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],i=e[8],s=e[12],a=e[1],o=e[5],l=e[9],c=e[13],u=e[2],d=e[6],h=e[10],p=e[14],y=e[3],v=e[7],g=e[11],m=e[15];return y*(+s*l*d-i*c*d-s*o*h+r*c*h+i*o*p-r*l*p)+v*(+t*l*p-t*c*h+s*a*h-i*a*p+i*c*u-s*l*u)+g*(+t*c*d-t*o*p-s*a*d+r*a*p+s*o*u-r*c*u)+m*(-i*o*u-t*l*d+t*o*h+i*a*d-r*a*h+r*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],u=e[8],d=e[9],h=e[10],p=e[11],y=e[12],v=e[13],g=e[14],m=e[15],x=d*g*c-v*h*c+v*l*p-o*g*p-d*l*m+o*h*m,_=y*h*c-u*g*c-y*l*p+a*g*p+u*l*m-a*h*m,b=u*v*c-y*d*c+y*o*p-a*v*p-u*o*m+a*d*m,w=y*d*l-u*v*l-y*o*h+a*v*h+u*o*g-a*d*g,E=t*x+r*_+i*b+s*w;if(E===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const S=1/E;return e[0]=x*S,e[1]=(v*h*s-d*g*s-v*i*p+r*g*p+d*i*m-r*h*m)*S,e[2]=(o*g*s-v*l*s+v*i*c-r*g*c-o*i*m+r*l*m)*S,e[3]=(d*l*s-o*h*s-d*i*c+r*h*c+o*i*p-r*l*p)*S,e[4]=_*S,e[5]=(u*g*s-y*h*s+y*i*p-t*g*p-u*i*m+t*h*m)*S,e[6]=(y*l*s-a*g*s-y*i*c+t*g*c+a*i*m-t*l*m)*S,e[7]=(a*h*s-u*l*s+u*i*c-t*h*c-a*i*p+t*l*p)*S,e[8]=b*S,e[9]=(y*d*s-u*v*s-y*r*p+t*v*p+u*r*m-t*d*m)*S,e[10]=(a*v*s-y*o*s+y*r*c-t*v*c-a*r*m+t*o*m)*S,e[11]=(u*o*s-a*d*s-u*r*c+t*d*c+a*r*p-t*o*p)*S,e[12]=w*S,e[13]=(u*v*i-y*d*i+y*r*h-t*v*h-u*r*g+t*d*g)*S,e[14]=(y*o*i-a*v*i-y*r*l+t*v*l+a*r*g-t*o*g)*S,e[15]=(a*d*i-u*o*i+u*r*l-t*d*l-a*r*h+t*o*h)*S,this}scale(e){const t=this.elements,r=e.x,i=e.y,s=e.z;return t[0]*=r,t[4]*=i,t[8]*=s,t[1]*=r,t[5]*=i,t[9]*=s,t[2]*=r,t[6]*=i,t[10]*=s,t[3]*=r,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),i=Math.sin(t),s=1-r,a=e.x,o=e.y,l=e.z,c=s*a,u=s*o;return this.set(c*a+r,c*o-i*l,c*l+i*o,0,c*o+i*l,u*o+r,u*l-i*a,0,c*l-i*o,u*l+i*a,s*l*l+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,s,a){return this.set(1,r,s,0,e,1,a,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){const i=this.elements,s=t._x,a=t._y,o=t._z,l=t._w,c=s+s,u=a+a,d=o+o,h=s*c,p=s*u,y=s*d,v=a*u,g=a*d,m=o*d,x=l*c,_=l*u,b=l*d,w=r.x,E=r.y,S=r.z;return i[0]=(1-(v+m))*w,i[1]=(p+b)*w,i[2]=(y-_)*w,i[3]=0,i[4]=(p-b)*E,i[5]=(1-(h+m))*E,i[6]=(g+x)*E,i[7]=0,i[8]=(y+_)*S,i[9]=(g-x)*S,i[10]=(1-(h+v))*S,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){const i=this.elements;let s=Dc.set(i[0],i[1],i[2]).length();const a=Dc.set(i[4],i[5],i[6]).length(),o=Dc.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),e.x=i[12],e.y=i[13],e.z=i[14],Li.copy(this);const c=1/s,u=1/a,d=1/o;return Li.elements[0]*=c,Li.elements[1]*=c,Li.elements[2]*=c,Li.elements[4]*=u,Li.elements[5]*=u,Li.elements[6]*=u,Li.elements[8]*=d,Li.elements[9]*=d,Li.elements[10]*=d,t.setFromRotationMatrix(Li),r.x=s,r.y=a,r.z=o,this}makePerspective(e,t,r,i,s,a,o=ma){const l=this.elements,c=2*s/(t-e),u=2*s/(r-i),d=(t+e)/(t-e),h=(r+i)/(r-i);let p,y;if(o===ma)p=-(a+s)/(a-s),y=-2*a*s/(a-s);else if(o===r0)p=-a/(a-s),y=-a*s/(a-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);return l[0]=c,l[4]=0,l[8]=d,l[12]=0,l[1]=0,l[5]=u,l[9]=h,l[13]=0,l[2]=0,l[6]=0,l[10]=p,l[14]=y,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,r,i,s,a,o=ma){const l=this.elements,c=1/(t-e),u=1/(r-i),d=1/(a-s),h=(t+e)*c,p=(r+i)*u;let y,v;if(o===ma)y=(a+s)*d,v=-2*d;else if(o===r0)y=s*d,v=-1*d;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-h,l[1]=0,l[5]=2*u,l[9]=0,l[13]=-p,l[2]=0,l[6]=0,l[10]=v,l[14]=-y,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<16;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const Dc=new Q,Li=new xn,pW=new Q(0,0,0),mW=new Q(1,1,1),Va=new Q,Im=new Q,Gr=new Q,wP=new xn,SP=new Up;class Na{constructor(e=0,t=0,r=0,i=Na.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const i=e.elements,s=i[0],a=i[4],o=i[8],l=i[1],c=i[5],u=i[9],d=i[2],h=i[6],p=i[10];switch(t){case"XYZ":this._y=Math.asin(Or(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-u,p),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(h,c),this._z=0);break;case"YXZ":this._x=Math.asin(-Or(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(o,p),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-d,s),this._z=0);break;case"ZXY":this._x=Math.asin(Or(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-d,p),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-Or(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(h,p),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-a,c));break;case"YZX":this._z=Math.asin(Or(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-d,s)):(this._x=0,this._y=Math.atan2(o,p));break;case"XZY":this._z=Math.asin(-Or(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(h,c),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-u,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return wP.makeRotationFromQuaternion(e),this.setFromRotationMatrix(wP,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return SP.setFromEuler(this),this.setFromQuaternion(SP,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Na.DEFAULT_ORDER="XYZ";class aj{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let gW=0;const EP=new Q,Ic=new Up,Gs=new xn,jm=new Q,nh=new Q,yW=new Q,vW=new Up,TP=new Q(1,0,0),MP=new Q(0,1,0),kP=new Q(0,0,1),xW={type:"added"},_W={type:"removed"},T_={type:"childadded",child:null},M_={type:"childremoved",child:null};class $r extends kd{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:gW++}),this.uuid=Fp(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=$r.DEFAULT_UP.clone();const e=new Q,t=new Na,r=new Up,i=new Q(1,1,1);function s(){r.setFromEuler(t,!1)}function a(){t.setFromQuaternion(r,void 0,!1)}t._onChange(s),r._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new xn},normalMatrix:{value:new ct}}),this.matrix=new xn,this.matrixWorld=new xn,this.matrixAutoUpdate=$r.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=$r.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new aj,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Ic.setFromAxisAngle(e,t),this.quaternion.multiply(Ic),this}rotateOnWorldAxis(e,t){return Ic.setFromAxisAngle(e,t),this.quaternion.premultiply(Ic),this}rotateX(e){return this.rotateOnAxis(TP,e)}rotateY(e){return this.rotateOnAxis(MP,e)}rotateZ(e){return this.rotateOnAxis(kP,e)}translateOnAxis(e,t){return EP.copy(e).applyQuaternion(this.quaternion),this.position.add(EP.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(TP,e)}translateY(e){return this.translateOnAxis(MP,e)}translateZ(e){return this.translateOnAxis(kP,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Gs.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?jm.copy(e):jm.set(e,t,r);const i=this.parent;this.updateWorldMatrix(!0,!1),nh.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Gs.lookAt(nh,jm,this.up):Gs.lookAt(jm,nh,this.up),this.quaternion.setFromRotationMatrix(Gs),i&&(Gs.extractRotation(i.matrixWorld),Ic.setFromRotationMatrix(Gs),this.quaternion.premultiply(Ic.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(xW),T_.child=e,this.dispatchEvent(T_),T_.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(_W),M_.child=e,this.dispatchEvent(M_),M_.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Gs.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Gs.multiply(e.parent.matrixWorld)),e.applyMatrix4(Gs),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){const a=this.children[r].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t,r=[]){this[e]===t&&r.push(this);const i=this.children;for(let s=0,a=i.length;s<a;s++)i[s].getObjectsByProperty(e,t,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(nh,e,yW),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(nh,vW,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,i=t.length;r<i;r++){const s=t[r];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const i=this.children;for(let s=0,a=i.length;s<a;s++){const o=i[s];o.matrixWorldAutoUpdate===!0&&o.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map(o=>({boxInitialized:o.boxInitialized,boxMin:o.box.min.toArray(),boxMax:o.box.max.toArray(),sphereInitialized:o.sphereInitialized,sphereRadius:o.sphere.radius,sphereCenter:o.sphere.center.toArray()})),i.maxGeometryCount=this._maxGeometryCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()}));function s(o,l){return o[l.uuid]===void 0&&(o[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const l=o.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++){const d=l[c];s(e.shapes,d)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let l=0,c=this.material.length;l<c;l++)o.push(s(e.materials,this.material[l]));i.material=o}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let o=0;o<this.children.length;o++)i.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let o=0;o<this.animations.length;o++){const l=this.animations[o];i.animations.push(s(e.animations,l))}}if(t){const o=a(e.geometries),l=a(e.materials),c=a(e.textures),u=a(e.images),d=a(e.shapes),h=a(e.skeletons),p=a(e.animations),y=a(e.nodes);o.length>0&&(r.geometries=o),l.length>0&&(r.materials=l),c.length>0&&(r.textures=c),u.length>0&&(r.images=u),d.length>0&&(r.shapes=d),h.length>0&&(r.skeletons=h),p.length>0&&(r.animations=p),y.length>0&&(r.nodes=y)}return r.object=i,r;function a(o){const l=[];for(const c in o){const u=o[c];delete u.metadata,l.push(u)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const i=e.children[r];this.add(i.clone())}return this}}$r.DEFAULT_UP=new Q(0,1,0);$r.DEFAULT_MATRIX_AUTO_UPDATE=!0;$r.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Di=new Q,qs=new Q,k_=new Q,Xs=new Q,jc=new Q,Fc=new Q,AP=new Q,A_=new Q,P_=new Q,C_=new Q;class Ms{constructor(e=new Q,t=new Q,r=new Q){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),Di.subVectors(e,t),i.cross(Di);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,t,r,i,s){Di.subVectors(i,t),qs.subVectors(r,t),k_.subVectors(e,t);const a=Di.dot(Di),o=Di.dot(qs),l=Di.dot(k_),c=qs.dot(qs),u=qs.dot(k_),d=a*c-o*o;if(d===0)return s.set(0,0,0),null;const h=1/d,p=(c*l-o*u)*h,y=(a*u-o*l)*h;return s.set(1-p-y,y,p)}static containsPoint(e,t,r,i){return this.getBarycoord(e,t,r,i,Xs)===null?!1:Xs.x>=0&&Xs.y>=0&&Xs.x+Xs.y<=1}static getInterpolation(e,t,r,i,s,a,o,l){return this.getBarycoord(e,t,r,i,Xs)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,Xs.x),l.addScaledVector(a,Xs.y),l.addScaledVector(o,Xs.z),l)}static isFrontFacing(e,t,r,i){return Di.subVectors(r,t),qs.subVectors(e,t),Di.cross(qs).dot(i)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Di.subVectors(this.c,this.b),qs.subVectors(this.a,this.b),Di.cross(qs).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Ms.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Ms.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,r,i,s){return Ms.getInterpolation(e,this.a,this.b,this.c,t,r,i,s)}containsPoint(e){return Ms.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Ms.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,i=this.b,s=this.c;let a,o;jc.subVectors(i,r),Fc.subVectors(s,r),A_.subVectors(e,r);const l=jc.dot(A_),c=Fc.dot(A_);if(l<=0&&c<=0)return t.copy(r);P_.subVectors(e,i);const u=jc.dot(P_),d=Fc.dot(P_);if(u>=0&&d<=u)return t.copy(i);const h=l*d-u*c;if(h<=0&&l>=0&&u<=0)return a=l/(l-u),t.copy(r).addScaledVector(jc,a);C_.subVectors(e,s);const p=jc.dot(C_),y=Fc.dot(C_);if(y>=0&&p<=y)return t.copy(s);const v=p*c-l*y;if(v<=0&&c>=0&&y<=0)return o=c/(c-y),t.copy(r).addScaledVector(Fc,o);const g=u*y-p*d;if(g<=0&&d-u>=0&&p-y>=0)return AP.subVectors(s,i),o=(d-u)/(d-u+(p-y)),t.copy(i).addScaledVector(AP,o);const m=1/(g+v+h);return a=v*m,o=h*m,t.copy(r).addScaledVector(jc,a).addScaledVector(Fc,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const oj={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ha={h:0,s:0,l:0},Fm={h:0,s:0,l:0};function R_(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}let It=class{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){if(t===void 0&&r===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=bs){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Ft.toWorkingColorSpace(this,t),this}setRGB(e,t,r,i=Ft.workingColorSpace){return this.r=e,this.g=t,this.b=r,Ft.toWorkingColorSpace(this,i),this}setHSL(e,t,r,i=Ft.workingColorSpace){if(e=sW(e,1),t=Or(t,0,1),r=Or(r,0,1),t===0)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+t):r+t-r*t,a=2*r-s;this.r=R_(a,s,e+1/3),this.g=R_(a,s,e),this.b=R_(a,s,e-1/3)}return Ft.toWorkingColorSpace(this,i),this}setStyle(e,t=bs){function r(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=i[1],o=i[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=i[1],a=s.length;if(a===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(a===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=bs){const r=oj[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Vu(e.r),this.g=Vu(e.g),this.b=Vu(e.b),this}copyLinearToSRGB(e){return this.r=y_(e.r),this.g=y_(e.g),this.b=y_(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=bs){return Ft.fromWorkingColorSpace(Gn.copy(this),e),Math.round(Or(Gn.r*255,0,255))*65536+Math.round(Or(Gn.g*255,0,255))*256+Math.round(Or(Gn.b*255,0,255))}getHexString(e=bs){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Ft.workingColorSpace){Ft.fromWorkingColorSpace(Gn.copy(this),t);const r=Gn.r,i=Gn.g,s=Gn.b,a=Math.max(r,i,s),o=Math.min(r,i,s);let l,c;const u=(o+a)/2;if(o===a)l=0,c=0;else{const d=a-o;switch(c=u<=.5?d/(a+o):d/(2-a-o),a){case r:l=(i-s)/d+(i<s?6:0);break;case i:l=(s-r)/d+2;break;case s:l=(r-i)/d+4;break}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,t=Ft.workingColorSpace){return Ft.fromWorkingColorSpace(Gn.copy(this),t),e.r=Gn.r,e.g=Gn.g,e.b=Gn.b,e}getStyle(e=bs){Ft.fromWorkingColorSpace(Gn.copy(this),e);const t=Gn.r,r=Gn.g,i=Gn.b;return e!==bs?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(r*255)},${Math.round(i*255)})`}offsetHSL(e,t,r){return this.getHSL(Ha),this.setHSL(Ha.h+e,Ha.s+t,Ha.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(Ha),e.getHSL(Fm);const r=m_(Ha.h,Fm.h,t),i=m_(Ha.s,Fm.s,t),s=m_(Ha.l,Fm.l,t);return this.setHSL(r,i,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,r=this.g,i=this.b,s=e.elements;return this.r=s[0]*t+s[3]*r+s[6]*i,this.g=s[1]*t+s[4]*r+s[7]*i,this.b=s[2]*t+s[5]*r+s[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const Gn=new It;It.NAMES=oj;let bW=0;class zp extends kd{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:bW++}),this.uuid=Fp(),this.name="",this.type="Material",this.blending=$u,this.side=Bo,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=fS,this.blendDst=pS,this.blendEquation=Al,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new It(0,0,0),this.blendAlpha=0,this.depthFunc=Qy,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=pP,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Cc,this.stencilZFail=Cc,this.stencilZPass=Cc,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const r=e[t];if(r===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapRotation!==void 0&&(r.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==$u&&(r.blending=this.blending),this.side!==Bo&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==fS&&(r.blendSrc=this.blendSrc),this.blendDst!==pS&&(r.blendDst=this.blendDst),this.blendEquation!==Al&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==Qy&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==pP&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Cc&&(r.stencilFail=this.stencilFail),this.stencilZFail!==Cc&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==Cc&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(s){const a=[];for(const o in s){const l=s[o];delete l.metadata,a.push(l)}return a}if(t){const s=i(e.textures),a=i(e.images);s.length>0&&(r.textures=s),a.length>0&&(r.images=a)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(t!==null){const i=t.length;r=new Array(i);for(let s=0;s!==i;++s)r[s]=t[s].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class lj extends zp{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new It(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Na,this.combine=WI,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const pn=new Q,Um=new Rt;class Ji{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=mP,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=ha,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return oW("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)Um.fromBufferAttribute(this,t),Um.applyMatrix3(e),this.setXY(t,Um.x,Um.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)pn.fromBufferAttribute(this,t),pn.applyMatrix3(e),this.setXYZ(t,pn.x,pn.y,pn.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)pn.fromBufferAttribute(this,t),pn.applyMatrix4(e),this.setXYZ(t,pn.x,pn.y,pn.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)pn.fromBufferAttribute(this,t),pn.applyNormalMatrix(e),this.setXYZ(t,pn.x,pn.y,pn.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)pn.fromBufferAttribute(this,t),pn.transformDirection(e),this.setXYZ(t,pn.x,pn.y,pn.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let r=this.array[e*this.itemSize+t];return this.normalized&&(r=Qd(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=Tr(r,this.array)),this.array[e*this.itemSize+t]=r,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Qd(t,this.array)),t}setX(e,t){return this.normalized&&(t=Tr(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Qd(t,this.array)),t}setY(e,t){return this.normalized&&(t=Tr(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Qd(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Tr(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Qd(t,this.array)),t}setW(e,t){return this.normalized&&(t=Tr(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=Tr(t,this.array),r=Tr(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=Tr(t,this.array),r=Tr(r,this.array),i=Tr(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=Tr(t,this.array),r=Tr(r,this.array),i=Tr(i,this.array),s=Tr(s,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==mP&&(e.usage=this.usage),e}}class cj extends Ji{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class uj extends Ji{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class Xl extends Ji{constructor(e,t,r){super(new Float32Array(e),t,r)}}let wW=0;const pi=new xn,N_=new $r,Uc=new Q,qr=new Bp,rh=new Bp,An=new Q;class ja extends kd{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:wW++}),this.uuid=Fp(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(tj(e)?uj:cj)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const s=new ct().getNormalMatrix(e);r.applyNormalMatrix(s),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return pi.makeRotationFromQuaternion(e),this.applyMatrix4(pi),this}rotateX(e){return pi.makeRotationX(e),this.applyMatrix4(pi),this}rotateY(e){return pi.makeRotationY(e),this.applyMatrix4(pi),this}rotateZ(e){return pi.makeRotationZ(e),this.applyMatrix4(pi),this}translate(e,t,r){return pi.makeTranslation(e,t,r),this.applyMatrix4(pi),this}scale(e,t,r){return pi.makeScale(e,t,r),this.applyMatrix4(pi),this}lookAt(e){return N_.lookAt(e),N_.updateMatrix(),this.applyMatrix4(N_.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Uc).negate(),this.translate(Uc.x,Uc.y,Uc.z),this}setFromPoints(e){const t=[];for(let r=0,i=e.length;r<i;r++){const s=e[r];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Xl(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Bp);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Q(-1/0,-1/0,-1/0),new Q(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,i=t.length;r<i;r++){const s=t[r];qr.setFromBufferAttribute(s),this.morphTargetsRelative?(An.addVectors(this.boundingBox.min,qr.min),this.boundingBox.expandByPoint(An),An.addVectors(this.boundingBox.max,qr.max),this.boundingBox.expandByPoint(An)):(this.boundingBox.expandByPoint(qr.min),this.boundingBox.expandByPoint(qr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new _v);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Q,1/0);return}if(e){const r=this.boundingSphere.center;if(qr.setFromBufferAttribute(e),t)for(let s=0,a=t.length;s<a;s++){const o=t[s];rh.setFromBufferAttribute(o),this.morphTargetsRelative?(An.addVectors(qr.min,rh.min),qr.expandByPoint(An),An.addVectors(qr.max,rh.max),qr.expandByPoint(An)):(qr.expandByPoint(rh.min),qr.expandByPoint(rh.max))}qr.getCenter(r);let i=0;for(let s=0,a=e.count;s<a;s++)An.fromBufferAttribute(e,s),i=Math.max(i,r.distanceToSquared(An));if(t)for(let s=0,a=t.length;s<a;s++){const o=t[s],l=this.morphTargetsRelative;for(let c=0,u=o.count;c<u;c++)An.fromBufferAttribute(o,c),l&&(Uc.fromBufferAttribute(e,c),An.add(Uc)),i=Math.max(i,r.distanceToSquared(An))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=t.position,i=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ji(new Float32Array(4*r.count),4));const a=this.getAttribute("tangent"),o=[],l=[];for(let M=0;M<r.count;M++)o[M]=new Q,l[M]=new Q;const c=new Q,u=new Q,d=new Q,h=new Rt,p=new Rt,y=new Rt,v=new Q,g=new Q;function m(M,N,T){c.fromBufferAttribute(r,M),u.fromBufferAttribute(r,N),d.fromBufferAttribute(r,T),h.fromBufferAttribute(s,M),p.fromBufferAttribute(s,N),y.fromBufferAttribute(s,T),u.sub(c),d.sub(c),p.sub(h),y.sub(h);const P=1/(p.x*y.y-y.x*p.y);isFinite(P)&&(v.copy(u).multiplyScalar(y.y).addScaledVector(d,-p.y).multiplyScalar(P),g.copy(d).multiplyScalar(p.x).addScaledVector(u,-y.x).multiplyScalar(P),o[M].add(v),o[N].add(v),o[T].add(v),l[M].add(g),l[N].add(g),l[T].add(g))}let x=this.groups;x.length===0&&(x=[{start:0,count:e.count}]);for(let M=0,N=x.length;M<N;++M){const T=x[M],P=T.start,H=T.count;for(let W=P,O=P+H;W<O;W+=3)m(e.getX(W+0),e.getX(W+1),e.getX(W+2))}const _=new Q,b=new Q,w=new Q,E=new Q;function S(M){w.fromBufferAttribute(i,M),E.copy(w);const N=o[M];_.copy(N),_.sub(w.multiplyScalar(w.dot(N))).normalize(),b.crossVectors(E,N);const P=b.dot(l[M])<0?-1:1;a.setXYZW(M,_.x,_.y,_.z,P)}for(let M=0,N=x.length;M<N;++M){const T=x[M],P=T.start,H=T.count;for(let W=P,O=P+H;W<O;W+=3)S(e.getX(W+0)),S(e.getX(W+1)),S(e.getX(W+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new Ji(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let h=0,p=r.count;h<p;h++)r.setXYZ(h,0,0,0);const i=new Q,s=new Q,a=new Q,o=new Q,l=new Q,c=new Q,u=new Q,d=new Q;if(e)for(let h=0,p=e.count;h<p;h+=3){const y=e.getX(h+0),v=e.getX(h+1),g=e.getX(h+2);i.fromBufferAttribute(t,y),s.fromBufferAttribute(t,v),a.fromBufferAttribute(t,g),u.subVectors(a,s),d.subVectors(i,s),u.cross(d),o.fromBufferAttribute(r,y),l.fromBufferAttribute(r,v),c.fromBufferAttribute(r,g),o.add(u),l.add(u),c.add(u),r.setXYZ(y,o.x,o.y,o.z),r.setXYZ(v,l.x,l.y,l.z),r.setXYZ(g,c.x,c.y,c.z)}else for(let h=0,p=t.count;h<p;h+=3)i.fromBufferAttribute(t,h+0),s.fromBufferAttribute(t,h+1),a.fromBufferAttribute(t,h+2),u.subVectors(a,s),d.subVectors(i,s),u.cross(d),r.setXYZ(h+0,u.x,u.y,u.z),r.setXYZ(h+1,u.x,u.y,u.z),r.setXYZ(h+2,u.x,u.y,u.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)An.fromBufferAttribute(e,t),An.normalize(),e.setXYZ(t,An.x,An.y,An.z)}toNonIndexed(){function e(o,l){const c=o.array,u=o.itemSize,d=o.normalized,h=new c.constructor(l.length*u);let p=0,y=0;for(let v=0,g=l.length;v<g;v++){o.isInterleavedBufferAttribute?p=l[v]*o.data.stride+o.offset:p=l[v]*u;for(let m=0;m<u;m++)h[y++]=c[p++]}return new Ji(h,u,d)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new ja,r=this.index.array,i=this.attributes;for(const o in i){const l=i[o],c=e(l,r);t.setAttribute(o,c)}const s=this.morphAttributes;for(const o in s){const l=[],c=s[o];for(let u=0,d=c.length;u<d;u++){const h=c[u],p=e(h,r);l.push(p)}t.morphAttributes[o]=l}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let o=0,l=a.length;o<l;o++){const c=a[o];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const l in r){const c=r[l];e.data.attributes[l]=c.toJSON(e.data)}const i={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let d=0,h=c.length;d<h;d++){const p=c[d];u.push(p.toJSON(e.data))}u.length>0&&(i[l]=u,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return o!==null&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone(t));const i=e.attributes;for(const c in i){const u=i[c];this.setAttribute(c,u.clone(t))}const s=e.morphAttributes;for(const c in s){const u=[],d=s[c];for(let h=0,p=d.length;h<p;h++)u.push(d[h].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let c=0,u=a.length;c<u;c++){const d=a[c];this.addGroup(d.start,d.count,d.materialIndex)}const o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const PP=new xn,al=new sj,Bm=new _v,CP=new Q,Bc=new Q,zc=new Q,$c=new Q,O_=new Q,zm=new Q,$m=new Rt,Vm=new Rt,Hm=new Rt,RP=new Q,NP=new Q,OP=new Q,Wm=new Q,Gm=new Q;class ga extends $r{constructor(e=new ja,t=new lj){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}getVertexPosition(e,t){const r=this.geometry,i=r.attributes.position,s=r.morphAttributes.position,a=r.morphTargetsRelative;t.fromBufferAttribute(i,e);const o=this.morphTargetInfluences;if(s&&o){zm.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const u=o[l],d=s[l];u!==0&&(O_.fromBufferAttribute(d,e),a?zm.addScaledVector(O_,u):zm.addScaledVector(O_.sub(t),u))}t.add(zm)}return t}raycast(e,t){const r=this.geometry,i=this.material,s=this.matrixWorld;i!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),Bm.copy(r.boundingSphere),Bm.applyMatrix4(s),al.copy(e.ray).recast(e.near),!(Bm.containsPoint(al.origin)===!1&&(al.intersectSphere(Bm,CP)===null||al.origin.distanceToSquared(CP)>(e.far-e.near)**2))&&(PP.copy(s).invert(),al.copy(e.ray).applyMatrix4(PP),!(r.boundingBox!==null&&al.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,t,al)))}_computeIntersections(e,t,r){let i;const s=this.geometry,a=this.material,o=s.index,l=s.attributes.position,c=s.attributes.uv,u=s.attributes.uv1,d=s.attributes.normal,h=s.groups,p=s.drawRange;if(o!==null)if(Array.isArray(a))for(let y=0,v=h.length;y<v;y++){const g=h[y],m=a[g.materialIndex],x=Math.max(g.start,p.start),_=Math.min(o.count,Math.min(g.start+g.count,p.start+p.count));for(let b=x,w=_;b<w;b+=3){const E=o.getX(b),S=o.getX(b+1),M=o.getX(b+2);i=qm(this,m,e,r,c,u,d,E,S,M),i&&(i.faceIndex=Math.floor(b/3),i.face.materialIndex=g.materialIndex,t.push(i))}}else{const y=Math.max(0,p.start),v=Math.min(o.count,p.start+p.count);for(let g=y,m=v;g<m;g+=3){const x=o.getX(g),_=o.getX(g+1),b=o.getX(g+2);i=qm(this,a,e,r,c,u,d,x,_,b),i&&(i.faceIndex=Math.floor(g/3),t.push(i))}}else if(l!==void 0)if(Array.isArray(a))for(let y=0,v=h.length;y<v;y++){const g=h[y],m=a[g.materialIndex],x=Math.max(g.start,p.start),_=Math.min(l.count,Math.min(g.start+g.count,p.start+p.count));for(let b=x,w=_;b<w;b+=3){const E=b,S=b+1,M=b+2;i=qm(this,m,e,r,c,u,d,E,S,M),i&&(i.faceIndex=Math.floor(b/3),i.face.materialIndex=g.materialIndex,t.push(i))}}else{const y=Math.max(0,p.start),v=Math.min(l.count,p.start+p.count);for(let g=y,m=v;g<m;g+=3){const x=g,_=g+1,b=g+2;i=qm(this,a,e,r,c,u,d,x,_,b),i&&(i.faceIndex=Math.floor(g/3),t.push(i))}}}}function SW(n,e,t,r,i,s,a,o){let l;if(e.side===Br?l=r.intersectTriangle(a,s,i,!0,o):l=r.intersectTriangle(i,s,a,e.side===Bo,o),l===null)return null;Gm.copy(o),Gm.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(Gm);return c<t.near||c>t.far?null:{distance:c,point:Gm.clone(),object:n}}function qm(n,e,t,r,i,s,a,o,l,c){n.getVertexPosition(o,Bc),n.getVertexPosition(l,zc),n.getVertexPosition(c,$c);const u=SW(n,e,t,r,Bc,zc,$c,Wm);if(u){i&&($m.fromBufferAttribute(i,o),Vm.fromBufferAttribute(i,l),Hm.fromBufferAttribute(i,c),u.uv=Ms.getInterpolation(Wm,Bc,zc,$c,$m,Vm,Hm,new Rt)),s&&($m.fromBufferAttribute(s,o),Vm.fromBufferAttribute(s,l),Hm.fromBufferAttribute(s,c),u.uv1=Ms.getInterpolation(Wm,Bc,zc,$c,$m,Vm,Hm,new Rt)),a&&(RP.fromBufferAttribute(a,o),NP.fromBufferAttribute(a,l),OP.fromBufferAttribute(a,c),u.normal=Ms.getInterpolation(Wm,Bc,zc,$c,RP,NP,OP,new Q),u.normal.dot(r.direction)>0&&u.normal.multiplyScalar(-1));const d={a:o,b:l,c,normal:new Q,materialIndex:0};Ms.getNormal(Bc,zc,$c,d.normal),u.face=d}return u}class $p extends ja{constructor(e=1,t=1,r=1,i=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:s,depthSegments:a};const o=this;i=Math.floor(i),s=Math.floor(s),a=Math.floor(a);const l=[],c=[],u=[],d=[];let h=0,p=0;y("z","y","x",-1,-1,r,t,e,a,s,0),y("z","y","x",1,-1,r,t,-e,a,s,1),y("x","z","y",1,1,e,r,t,i,a,2),y("x","z","y",1,-1,e,r,-t,i,a,3),y("x","y","z",1,-1,e,t,r,i,s,4),y("x","y","z",-1,-1,e,t,-r,i,s,5),this.setIndex(l),this.setAttribute("position",new Xl(c,3)),this.setAttribute("normal",new Xl(u,3)),this.setAttribute("uv",new Xl(d,2));function y(v,g,m,x,_,b,w,E,S,M,N){const T=b/S,P=w/M,H=b/2,W=w/2,O=E/2,I=S+1,F=M+1;let j=0,L=0;const D=new Q;for(let z=0;z<F;z++){const K=z*P-W;for(let re=0;re<I;re++){const Se=re*T-H;D[v]=Se*x,D[g]=K*_,D[m]=O,c.push(D.x,D.y,D.z),D[v]=0,D[g]=0,D[m]=E>0?1:-1,u.push(D.x,D.y,D.z),d.push(re/S),d.push(1-z/M),j+=1}}for(let z=0;z<M;z++)for(let K=0;K<S;K++){const re=h+K+I*z,Se=h+K+I*(z+1),G=h+(K+1)+I*(z+1),ne=h+(K+1)+I*z;l.push(re,Se,ne),l.push(Se,G,ne),L+=6}o.addGroup(p,L,N),p+=L,h+=j}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new $p(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function od(n){const e={};for(const t in n){e[t]={};for(const r in n[t]){const i=n[t][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][r]=null):e[t][r]=i.clone():Array.isArray(i)?e[t][r]=i.slice():e[t][r]=i}}return e}function hr(n){const e={};for(let t=0;t<n.length;t++){const r=od(n[t]);for(const i in r)e[i]=r[i]}return e}function EW(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function dj(n){return n.getRenderTarget()===null?n.outputColorSpace:Ft.workingColorSpace}const TW={clone:od,merge:hr};var MW=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,kW=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class zo extends zp{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=MW,this.fragmentShader=kW,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=od(e.uniforms),this.uniformsGroups=EW(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const a=this.uniforms[i].value;a&&a.isTexture?t.uniforms[i]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[i]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[i]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[i]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[i]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[i]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[i]={type:"m4",value:a.toArray()}:t.uniforms[i]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const r={};for(const i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class hj extends $r{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new xn,this.projectionMatrix=new xn,this.projectionMatrixInverse=new xn,this.coordinateSystem=ma}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Wa=new Q,LP=new Rt,DP=new Rt;class Ei extends hj{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=_S*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(p_*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return _S*2*Math.atan(Math.tan(p_*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,r){Wa.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Wa.x,Wa.y).multiplyScalar(-e/Wa.z),Wa.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(Wa.x,Wa.y).multiplyScalar(-e/Wa.z)}getViewSize(e,t){return this.getViewBounds(e,LP,DP),t.subVectors(DP,LP)}setViewOffset(e,t,r,i,s,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(p_*.5*this.fov)/this.zoom,r=2*t,i=this.aspect*r,s=-.5*i;const a=this.view;if(this.view!==null&&this.view.enabled){const l=a.fullWidth,c=a.fullHeight;s+=a.offsetX*i/l,t-=a.offsetY*r/c,i*=a.width/l,r*=a.height/c}const o=this.filmOffset;o!==0&&(s+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,t,t-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Vc=-90,Hc=1;class AW extends $r{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new Ei(Vc,Hc,e,t);i.layers=this.layers,this.add(i);const s=new Ei(Vc,Hc,e,t);s.layers=this.layers,this.add(s);const a=new Ei(Vc,Hc,e,t);a.layers=this.layers,this.add(a);const o=new Ei(Vc,Hc,e,t);o.layers=this.layers,this.add(o);const l=new Ei(Vc,Hc,e,t);l.layers=this.layers,this.add(l);const c=new Ei(Vc,Hc,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[r,i,s,a,o,l]=t;for(const c of t)this.remove(c);if(e===ma)r.up.set(0,1,0),r.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===r0)r.up.set(0,-1,0),r.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const c of t)this.add(c),c.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,a,o,l,c,u]=this.children,d=e.getRenderTarget(),h=e.getActiveCubeFace(),p=e.getActiveMipmapLevel(),y=e.xr.enabled;e.xr.enabled=!1;const v=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,i),e.render(t,s),e.setRenderTarget(r,1,i),e.render(t,a),e.setRenderTarget(r,2,i),e.render(t,o),e.setRenderTarget(r,3,i),e.render(t,l),e.setRenderTarget(r,4,i),e.render(t,c),r.texture.generateMipmaps=v,e.setRenderTarget(r,5,i),e.render(t,u),e.setRenderTarget(d,h,p),e.xr.enabled=y,r.texture.needsPMREMUpdate=!0}}class fj extends zr{constructor(e,t,r,i,s,a,o,l,c,u){e=e!==void 0?e:[],t=t!==void 0?t:id,super(e,t,r,i,s,a,o,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class PW extends ac{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];this.texture=new fj(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Rr}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new $p(5,5,5),s=new zo({name:"CubemapFromEquirect",uniforms:od(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Br,blending:Oo});s.uniforms.tEquirect.value=t;const a=new ga(i,s),o=t.minFilter;return t.minFilter===Dl&&(t.minFilter=Rr),new AW(1,10,this).update(e,a),t.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,r,i){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,r,i);e.setRenderTarget(s)}}const L_=new Q,CW=new Q,RW=new ct;class _l{constructor(e=new Q(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const i=L_.subVectors(r,t).cross(CW.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const r=e.delta(L_),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:t.copy(e.start).addScaledVector(r,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||RW.getNormalMatrix(e),i=this.coplanarPoint(L_).applyMatrix4(e),s=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const ol=new _v,Xm=new Q;class pj{constructor(e=new _l,t=new _l,r=new _l,i=new _l,s=new _l,a=new _l){this.planes=[e,t,r,i,s,a]}set(e,t,r,i,s,a){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(r),o[3].copy(i),o[4].copy(s),o[5].copy(a),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,t=ma){const r=this.planes,i=e.elements,s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],u=i[5],d=i[6],h=i[7],p=i[8],y=i[9],v=i[10],g=i[11],m=i[12],x=i[13],_=i[14],b=i[15];if(r[0].setComponents(l-s,h-c,g-p,b-m).normalize(),r[1].setComponents(l+s,h+c,g+p,b+m).normalize(),r[2].setComponents(l+a,h+u,g+y,b+x).normalize(),r[3].setComponents(l-a,h-u,g-y,b-x).normalize(),r[4].setComponents(l-o,h-d,g-v,b-_).normalize(),t===ma)r[5].setComponents(l+o,h+d,g+v,b+_).normalize();else if(t===r0)r[5].setComponents(o,d,v,_).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),ol.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),ol.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(ol)}intersectsSprite(e){return ol.center.set(0,0,0),ol.radius=.7071067811865476,ol.applyMatrix4(e.matrixWorld),this.intersectsSphere(ol)}intersectsSphere(e){const t=this.planes,r=e.center,i=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const i=t[r];if(Xm.x=i.normal.x>0?e.max.x:e.min.x,Xm.y=i.normal.y>0?e.max.y:e.min.y,Xm.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(Xm)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function mj(){let n=null,e=!1,t=null,r=null;function i(s,a){t(s,a),r=n.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(r=n.requestAnimationFrame(i),e=!0)},stop:function(){n.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function NW(n,e){const t=e.isWebGL2,r=new WeakMap;function i(c,u){const d=c.array,h=c.usage,p=d.byteLength,y=n.createBuffer();n.bindBuffer(u,y),n.bufferData(u,d,h),c.onUploadCallback();let v;if(d instanceof Float32Array)v=n.FLOAT;else if(d instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(t)v=n.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else v=n.UNSIGNED_SHORT;else if(d instanceof Int16Array)v=n.SHORT;else if(d instanceof Uint32Array)v=n.UNSIGNED_INT;else if(d instanceof Int32Array)v=n.INT;else if(d instanceof Int8Array)v=n.BYTE;else if(d instanceof Uint8Array)v=n.UNSIGNED_BYTE;else if(d instanceof Uint8ClampedArray)v=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);return{buffer:y,type:v,bytesPerElement:d.BYTES_PER_ELEMENT,version:c.version,size:p}}function s(c,u,d){const h=u.array,p=u._updateRange,y=u.updateRanges;if(n.bindBuffer(d,c),p.count===-1&&y.length===0&&n.bufferSubData(d,0,h),y.length!==0){for(let v=0,g=y.length;v<g;v++){const m=y[v];t?n.bufferSubData(d,m.start*h.BYTES_PER_ELEMENT,h,m.start,m.count):n.bufferSubData(d,m.start*h.BYTES_PER_ELEMENT,h.subarray(m.start,m.start+m.count))}u.clearUpdateRanges()}p.count!==-1&&(t?n.bufferSubData(d,p.offset*h.BYTES_PER_ELEMENT,h,p.offset,p.count):n.bufferSubData(d,p.offset*h.BYTES_PER_ELEMENT,h.subarray(p.offset,p.offset+p.count)),p.count=-1),u.onUploadCallback()}function a(c){return c.isInterleavedBufferAttribute&&(c=c.data),r.get(c)}function o(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=r.get(c);u&&(n.deleteBuffer(u.buffer),r.delete(c))}function l(c,u){if(c.isGLBufferAttribute){const h=r.get(c);(!h||h.version<c.version)&&r.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);const d=r.get(c);if(d===void 0)r.set(c,i(c,u));else if(d.version<c.version){if(d.size!==c.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");s(d.buffer,c,u),d.version=c.version}}return{get:a,remove:o,update:l}}class bv extends ja{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};const s=e/2,a=t/2,o=Math.floor(r),l=Math.floor(i),c=o+1,u=l+1,d=e/o,h=t/l,p=[],y=[],v=[],g=[];for(let m=0;m<u;m++){const x=m*h-a;for(let _=0;_<c;_++){const b=_*d-s;y.push(b,-x,0),v.push(0,0,1),g.push(_/o),g.push(1-m/l)}}for(let m=0;m<l;m++)for(let x=0;x<o;x++){const _=x+c*m,b=x+c*(m+1),w=x+1+c*(m+1),E=x+1+c*m;p.push(_,b,E),p.push(b,w,E)}this.setIndex(p),this.setAttribute("position",new Xl(y,3)),this.setAttribute("normal",new Xl(v,3)),this.setAttribute("uv",new Xl(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new bv(e.width,e.height,e.widthSegments,e.heightSegments)}}var OW=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,LW=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,DW=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,IW=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,jW=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,FW=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,UW=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,BW=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,zW=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,$W=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,VW=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,HW=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,WW=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,GW=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,qW=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,XW=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,YW=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,KW=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,ZW=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,JW=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,QW=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,e6=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,t6=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,n6=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,r6=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,i6=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,s6=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,a6=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,o6=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,l6=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,c6="gl_FragColor = linearToOutputTexel( gl_FragColor );",u6=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,d6=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,h6=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,f6=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,p6=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,m6=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,g6=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,y6=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,v6=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,x6=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,_6=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,b6=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,w6=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,S6=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,E6=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,T6=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,M6=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,k6=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,A6=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,P6=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,C6=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,R6=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,N6=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,O6=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,L6=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,D6=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,I6=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,j6=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,F6=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,U6=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,B6=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,z6=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,$6=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,V6=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,H6=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,W6=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,G6=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[MORPHTARGETS_COUNT];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,q6=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,X6=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Y6=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
	#endif
	#ifdef MORPHTARGETS_TEXTURE
		#ifndef USE_INSTANCING_MORPH
			uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		#endif
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,K6=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Z6=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,J6=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Q6=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,e8=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,t8=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,n8=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,r8=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,i8=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,s8=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,a8=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,o8=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,l8=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,c8=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,u8=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,d8=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,h8=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,f8=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,p8=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,m8=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,g8=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,y8=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,v8=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,x8=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,_8=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,b8=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,w8=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,S8=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,E8=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,T8=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,M8=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	float startCompression = 0.8 - 0.04;
	float desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min(color.r, min(color.g, color.b));
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max(color.r, max(color.g, color.b));
	if (peak < startCompression) return color;
	float d = 1. - startCompression;
	float newPeak = 1. - d * d / (peak + d - startCompression);
	color *= newPeak / peak;
	float g = 1. - 1. / (desaturation * (peak - newPeak) + 1.);
	return mix(color, vec3(1, 1, 1), g);
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,k8=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,A8=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,P8=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,C8=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,R8=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,N8=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const O8=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,L8=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,D8=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,I8=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,j8=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,F8=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,U8=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,B8=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,z8=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,$8=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,V8=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,H8=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,W8=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,G8=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,q8=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,X8=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Y8=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,K8=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Z8=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,J8=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Q8=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,eG=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,tG=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,nG=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,rG=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,iG=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,sG=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,aG=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,oG=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,lG=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,cG=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,uG=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,dG=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,hG=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ot={alphahash_fragment:OW,alphahash_pars_fragment:LW,alphamap_fragment:DW,alphamap_pars_fragment:IW,alphatest_fragment:jW,alphatest_pars_fragment:FW,aomap_fragment:UW,aomap_pars_fragment:BW,batching_pars_vertex:zW,batching_vertex:$W,begin_vertex:VW,beginnormal_vertex:HW,bsdfs:WW,iridescence_fragment:GW,bumpmap_pars_fragment:qW,clipping_planes_fragment:XW,clipping_planes_pars_fragment:YW,clipping_planes_pars_vertex:KW,clipping_planes_vertex:ZW,color_fragment:JW,color_pars_fragment:QW,color_pars_vertex:e6,color_vertex:t6,common:n6,cube_uv_reflection_fragment:r6,defaultnormal_vertex:i6,displacementmap_pars_vertex:s6,displacementmap_vertex:a6,emissivemap_fragment:o6,emissivemap_pars_fragment:l6,colorspace_fragment:c6,colorspace_pars_fragment:u6,envmap_fragment:d6,envmap_common_pars_fragment:h6,envmap_pars_fragment:f6,envmap_pars_vertex:p6,envmap_physical_pars_fragment:M6,envmap_vertex:m6,fog_vertex:g6,fog_pars_vertex:y6,fog_fragment:v6,fog_pars_fragment:x6,gradientmap_pars_fragment:_6,lightmap_fragment:b6,lightmap_pars_fragment:w6,lights_lambert_fragment:S6,lights_lambert_pars_fragment:E6,lights_pars_begin:T6,lights_toon_fragment:k6,lights_toon_pars_fragment:A6,lights_phong_fragment:P6,lights_phong_pars_fragment:C6,lights_physical_fragment:R6,lights_physical_pars_fragment:N6,lights_fragment_begin:O6,lights_fragment_maps:L6,lights_fragment_end:D6,logdepthbuf_fragment:I6,logdepthbuf_pars_fragment:j6,logdepthbuf_pars_vertex:F6,logdepthbuf_vertex:U6,map_fragment:B6,map_pars_fragment:z6,map_particle_fragment:$6,map_particle_pars_fragment:V6,metalnessmap_fragment:H6,metalnessmap_pars_fragment:W6,morphinstance_vertex:G6,morphcolor_vertex:q6,morphnormal_vertex:X6,morphtarget_pars_vertex:Y6,morphtarget_vertex:K6,normal_fragment_begin:Z6,normal_fragment_maps:J6,normal_pars_fragment:Q6,normal_pars_vertex:e8,normal_vertex:t8,normalmap_pars_fragment:n8,clearcoat_normal_fragment_begin:r8,clearcoat_normal_fragment_maps:i8,clearcoat_pars_fragment:s8,iridescence_pars_fragment:a8,opaque_fragment:o8,packing:l8,premultiplied_alpha_fragment:c8,project_vertex:u8,dithering_fragment:d8,dithering_pars_fragment:h8,roughnessmap_fragment:f8,roughnessmap_pars_fragment:p8,shadowmap_pars_fragment:m8,shadowmap_pars_vertex:g8,shadowmap_vertex:y8,shadowmask_pars_fragment:v8,skinbase_vertex:x8,skinning_pars_vertex:_8,skinning_vertex:b8,skinnormal_vertex:w8,specularmap_fragment:S8,specularmap_pars_fragment:E8,tonemapping_fragment:T8,tonemapping_pars_fragment:M8,transmission_fragment:k8,transmission_pars_fragment:A8,uv_pars_fragment:P8,uv_pars_vertex:C8,uv_vertex:R8,worldpos_vertex:N8,background_vert:O8,background_frag:L8,backgroundCube_vert:D8,backgroundCube_frag:I8,cube_vert:j8,cube_frag:F8,depth_vert:U8,depth_frag:B8,distanceRGBA_vert:z8,distanceRGBA_frag:$8,equirect_vert:V8,equirect_frag:H8,linedashed_vert:W8,linedashed_frag:G8,meshbasic_vert:q8,meshbasic_frag:X8,meshlambert_vert:Y8,meshlambert_frag:K8,meshmatcap_vert:Z8,meshmatcap_frag:J8,meshnormal_vert:Q8,meshnormal_frag:eG,meshphong_vert:tG,meshphong_frag:nG,meshphysical_vert:rG,meshphysical_frag:iG,meshtoon_vert:sG,meshtoon_frag:aG,points_vert:oG,points_frag:lG,shadow_vert:cG,shadow_frag:uG,sprite_vert:dG,sprite_frag:hG},ke={common:{diffuse:{value:new It(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new ct},alphaMap:{value:null},alphaMapTransform:{value:new ct},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new ct}},envmap:{envMap:{value:null},envMapRotation:{value:new ct},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new ct}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new ct}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new ct},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new ct},normalScale:{value:new Rt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new ct},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new ct}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new ct}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new ct}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new It(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new It(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new ct},alphaTest:{value:0},uvTransform:{value:new ct}},sprite:{diffuse:{value:new It(16777215)},opacity:{value:1},center:{value:new Rt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new ct},alphaMap:{value:null},alphaMapTransform:{value:new ct},alphaTest:{value:0}}},Es={basic:{uniforms:hr([ke.common,ke.specularmap,ke.envmap,ke.aomap,ke.lightmap,ke.fog]),vertexShader:ot.meshbasic_vert,fragmentShader:ot.meshbasic_frag},lambert:{uniforms:hr([ke.common,ke.specularmap,ke.envmap,ke.aomap,ke.lightmap,ke.emissivemap,ke.bumpmap,ke.normalmap,ke.displacementmap,ke.fog,ke.lights,{emissive:{value:new It(0)}}]),vertexShader:ot.meshlambert_vert,fragmentShader:ot.meshlambert_frag},phong:{uniforms:hr([ke.common,ke.specularmap,ke.envmap,ke.aomap,ke.lightmap,ke.emissivemap,ke.bumpmap,ke.normalmap,ke.displacementmap,ke.fog,ke.lights,{emissive:{value:new It(0)},specular:{value:new It(1118481)},shininess:{value:30}}]),vertexShader:ot.meshphong_vert,fragmentShader:ot.meshphong_frag},standard:{uniforms:hr([ke.common,ke.envmap,ke.aomap,ke.lightmap,ke.emissivemap,ke.bumpmap,ke.normalmap,ke.displacementmap,ke.roughnessmap,ke.metalnessmap,ke.fog,ke.lights,{emissive:{value:new It(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ot.meshphysical_vert,fragmentShader:ot.meshphysical_frag},toon:{uniforms:hr([ke.common,ke.aomap,ke.lightmap,ke.emissivemap,ke.bumpmap,ke.normalmap,ke.displacementmap,ke.gradientmap,ke.fog,ke.lights,{emissive:{value:new It(0)}}]),vertexShader:ot.meshtoon_vert,fragmentShader:ot.meshtoon_frag},matcap:{uniforms:hr([ke.common,ke.bumpmap,ke.normalmap,ke.displacementmap,ke.fog,{matcap:{value:null}}]),vertexShader:ot.meshmatcap_vert,fragmentShader:ot.meshmatcap_frag},points:{uniforms:hr([ke.points,ke.fog]),vertexShader:ot.points_vert,fragmentShader:ot.points_frag},dashed:{uniforms:hr([ke.common,ke.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ot.linedashed_vert,fragmentShader:ot.linedashed_frag},depth:{uniforms:hr([ke.common,ke.displacementmap]),vertexShader:ot.depth_vert,fragmentShader:ot.depth_frag},normal:{uniforms:hr([ke.common,ke.bumpmap,ke.normalmap,ke.displacementmap,{opacity:{value:1}}]),vertexShader:ot.meshnormal_vert,fragmentShader:ot.meshnormal_frag},sprite:{uniforms:hr([ke.sprite,ke.fog]),vertexShader:ot.sprite_vert,fragmentShader:ot.sprite_frag},background:{uniforms:{uvTransform:{value:new ct},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ot.background_vert,fragmentShader:ot.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new ct}},vertexShader:ot.backgroundCube_vert,fragmentShader:ot.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ot.cube_vert,fragmentShader:ot.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ot.equirect_vert,fragmentShader:ot.equirect_frag},distanceRGBA:{uniforms:hr([ke.common,ke.displacementmap,{referencePosition:{value:new Q},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ot.distanceRGBA_vert,fragmentShader:ot.distanceRGBA_frag},shadow:{uniforms:hr([ke.lights,ke.fog,{color:{value:new It(0)},opacity:{value:1}}]),vertexShader:ot.shadow_vert,fragmentShader:ot.shadow_frag}};Es.physical={uniforms:hr([Es.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new ct},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new ct},clearcoatNormalScale:{value:new Rt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new ct},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new ct},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new ct},sheen:{value:0},sheenColor:{value:new It(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new ct},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new ct},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new ct},transmissionSamplerSize:{value:new Rt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new ct},attenuationDistance:{value:0},attenuationColor:{value:new It(0)},specularColor:{value:new It(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new ct},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new ct},anisotropyVector:{value:new Rt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new ct}}]),vertexShader:ot.meshphysical_vert,fragmentShader:ot.meshphysical_frag};const Ym={r:0,b:0,g:0},ll=new Na,fG=new xn;function pG(n,e,t,r,i,s,a){const o=new It(0);let l=s===!0?0:1,c,u,d=null,h=0,p=null;function y(g,m){let x=!1,_=m.isScene===!0?m.background:null;_&&_.isTexture&&(_=(m.backgroundBlurriness>0?t:e).get(_)),_===null?v(o,l):_&&_.isColor&&(v(_,1),x=!0);const b=n.xr.getEnvironmentBlendMode();b==="additive"?r.buffers.color.setClear(0,0,0,1,a):b==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,a),(n.autoClear||x)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),_&&(_.isCubeTexture||_.mapping===vv)?(u===void 0&&(u=new ga(new $p(1,1,1),new zo({name:"BackgroundCubeMaterial",uniforms:od(Es.backgroundCube.uniforms),vertexShader:Es.backgroundCube.vertexShader,fragmentShader:Es.backgroundCube.fragmentShader,side:Br,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(w,E,S){this.matrixWorld.copyPosition(S.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(u)),ll.copy(m.backgroundRotation),ll.x*=-1,ll.y*=-1,ll.z*=-1,_.isCubeTexture&&_.isRenderTargetTexture===!1&&(ll.y*=-1,ll.z*=-1),u.material.uniforms.envMap.value=_,u.material.uniforms.flipEnvMap.value=_.isCubeTexture&&_.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=m.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,u.material.uniforms.backgroundRotation.value.setFromMatrix4(fG.makeRotationFromEuler(ll)),u.material.toneMapped=Ft.getTransfer(_.colorSpace)!==Gt,(d!==_||h!==_.version||p!==n.toneMapping)&&(u.material.needsUpdate=!0,d=_,h=_.version,p=n.toneMapping),u.layers.enableAll(),g.unshift(u,u.geometry,u.material,0,0,null)):_&&_.isTexture&&(c===void 0&&(c=new ga(new bv(2,2),new zo({name:"BackgroundMaterial",uniforms:od(Es.background.uniforms),vertexShader:Es.background.vertexShader,fragmentShader:Es.background.fragmentShader,side:Bo,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(c)),c.material.uniforms.t2D.value=_,c.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,c.material.toneMapped=Ft.getTransfer(_.colorSpace)!==Gt,_.matrixAutoUpdate===!0&&_.updateMatrix(),c.material.uniforms.uvTransform.value.copy(_.matrix),(d!==_||h!==_.version||p!==n.toneMapping)&&(c.material.needsUpdate=!0,d=_,h=_.version,p=n.toneMapping),c.layers.enableAll(),g.unshift(c,c.geometry,c.material,0,0,null))}function v(g,m){g.getRGB(Ym,dj(n)),r.buffers.color.setClear(Ym.r,Ym.g,Ym.b,m,a)}return{getClearColor:function(){return o},setClearColor:function(g,m=1){o.set(g),l=m,v(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(g){l=g,v(o,l)},render:y}}function mG(n,e,t,r){const i=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=r.isWebGL2?null:e.get("OES_vertex_array_object"),a=r.isWebGL2||s!==null,o={},l=g(null);let c=l,u=!1;function d(O,I,F,j,L){let D=!1;if(a){const z=v(j,F,I);c!==z&&(c=z,p(c.object)),D=m(O,j,F,L),D&&x(O,j,F,L)}else{const z=I.wireframe===!0;(c.geometry!==j.id||c.program!==F.id||c.wireframe!==z)&&(c.geometry=j.id,c.program=F.id,c.wireframe=z,D=!0)}L!==null&&t.update(L,n.ELEMENT_ARRAY_BUFFER),(D||u)&&(u=!1,M(O,I,F,j),L!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(L).buffer))}function h(){return r.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}function p(O){return r.isWebGL2?n.bindVertexArray(O):s.bindVertexArrayOES(O)}function y(O){return r.isWebGL2?n.deleteVertexArray(O):s.deleteVertexArrayOES(O)}function v(O,I,F){const j=F.wireframe===!0;let L=o[O.id];L===void 0&&(L={},o[O.id]=L);let D=L[I.id];D===void 0&&(D={},L[I.id]=D);let z=D[j];return z===void 0&&(z=g(h()),D[j]=z),z}function g(O){const I=[],F=[],j=[];for(let L=0;L<i;L++)I[L]=0,F[L]=0,j[L]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:I,enabledAttributes:F,attributeDivisors:j,object:O,attributes:{},index:null}}function m(O,I,F,j){const L=c.attributes,D=I.attributes;let z=0;const K=F.getAttributes();for(const re in K)if(K[re].location>=0){const G=L[re];let ne=D[re];if(ne===void 0&&(re==="instanceMatrix"&&O.instanceMatrix&&(ne=O.instanceMatrix),re==="instanceColor"&&O.instanceColor&&(ne=O.instanceColor)),G===void 0||G.attribute!==ne||ne&&G.data!==ne.data)return!0;z++}return c.attributesNum!==z||c.index!==j}function x(O,I,F,j){const L={},D=I.attributes;let z=0;const K=F.getAttributes();for(const re in K)if(K[re].location>=0){let G=D[re];G===void 0&&(re==="instanceMatrix"&&O.instanceMatrix&&(G=O.instanceMatrix),re==="instanceColor"&&O.instanceColor&&(G=O.instanceColor));const ne={};ne.attribute=G,G&&G.data&&(ne.data=G.data),L[re]=ne,z++}c.attributes=L,c.attributesNum=z,c.index=j}function _(){const O=c.newAttributes;for(let I=0,F=O.length;I<F;I++)O[I]=0}function b(O){w(O,0)}function w(O,I){const F=c.newAttributes,j=c.enabledAttributes,L=c.attributeDivisors;F[O]=1,j[O]===0&&(n.enableVertexAttribArray(O),j[O]=1),L[O]!==I&&((r.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](O,I),L[O]=I)}function E(){const O=c.newAttributes,I=c.enabledAttributes;for(let F=0,j=I.length;F<j;F++)I[F]!==O[F]&&(n.disableVertexAttribArray(F),I[F]=0)}function S(O,I,F,j,L,D,z){z===!0?n.vertexAttribIPointer(O,I,F,L,D):n.vertexAttribPointer(O,I,F,j,L,D)}function M(O,I,F,j){if(r.isWebGL2===!1&&(O.isInstancedMesh||j.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;_();const L=j.attributes,D=F.getAttributes(),z=I.defaultAttributeValues;for(const K in D){const re=D[K];if(re.location>=0){let Se=L[K];if(Se===void 0&&(K==="instanceMatrix"&&O.instanceMatrix&&(Se=O.instanceMatrix),K==="instanceColor"&&O.instanceColor&&(Se=O.instanceColor)),Se!==void 0){const G=Se.normalized,ne=Se.itemSize,ye=t.get(Se);if(ye===void 0)continue;const se=ye.buffer,U=ye.type,X=ye.bytesPerElement,pe=r.isWebGL2===!0&&(U===n.INT||U===n.UNSIGNED_INT||Se.gpuType===qI);if(Se.isInterleavedBufferAttribute){const ue=Se.data,B=ue.stride,He=Se.offset;if(ue.isInstancedInterleavedBuffer){for(let fe=0;fe<re.locationSize;fe++)w(re.location+fe,ue.meshPerAttribute);O.isInstancedMesh!==!0&&j._maxInstanceCount===void 0&&(j._maxInstanceCount=ue.meshPerAttribute*ue.count)}else for(let fe=0;fe<re.locationSize;fe++)b(re.location+fe);n.bindBuffer(n.ARRAY_BUFFER,se);for(let fe=0;fe<re.locationSize;fe++)S(re.location+fe,ne/re.locationSize,U,G,B*X,(He+ne/re.locationSize*fe)*X,pe)}else{if(Se.isInstancedBufferAttribute){for(let ue=0;ue<re.locationSize;ue++)w(re.location+ue,Se.meshPerAttribute);O.isInstancedMesh!==!0&&j._maxInstanceCount===void 0&&(j._maxInstanceCount=Se.meshPerAttribute*Se.count)}else for(let ue=0;ue<re.locationSize;ue++)b(re.location+ue);n.bindBuffer(n.ARRAY_BUFFER,se);for(let ue=0;ue<re.locationSize;ue++)S(re.location+ue,ne/re.locationSize,U,G,ne*X,ne/re.locationSize*ue*X,pe)}}else if(z!==void 0){const G=z[K];if(G!==void 0)switch(G.length){case 2:n.vertexAttrib2fv(re.location,G);break;case 3:n.vertexAttrib3fv(re.location,G);break;case 4:n.vertexAttrib4fv(re.location,G);break;default:n.vertexAttrib1fv(re.location,G)}}}}E()}function N(){H();for(const O in o){const I=o[O];for(const F in I){const j=I[F];for(const L in j)y(j[L].object),delete j[L];delete I[F]}delete o[O]}}function T(O){if(o[O.id]===void 0)return;const I=o[O.id];for(const F in I){const j=I[F];for(const L in j)y(j[L].object),delete j[L];delete I[F]}delete o[O.id]}function P(O){for(const I in o){const F=o[I];if(F[O.id]===void 0)continue;const j=F[O.id];for(const L in j)y(j[L].object),delete j[L];delete F[O.id]}}function H(){W(),u=!0,c!==l&&(c=l,p(c.object))}function W(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:d,reset:H,resetDefaultState:W,dispose:N,releaseStatesOfGeometry:T,releaseStatesOfProgram:P,initAttributes:_,enableAttribute:b,disableUnusedAttributes:E}}function gG(n,e,t,r){const i=r.isWebGL2;let s;function a(u){s=u}function o(u,d){n.drawArrays(s,u,d),t.update(d,s,1)}function l(u,d,h){if(h===0)return;let p,y;if(i)p=n,y="drawArraysInstanced";else if(p=e.get("ANGLE_instanced_arrays"),y="drawArraysInstancedANGLE",p===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}p[y](s,u,d,h),t.update(d,s,h)}function c(u,d,h){if(h===0)return;const p=e.get("WEBGL_multi_draw");if(p===null)for(let y=0;y<h;y++)this.render(u[y],d[y]);else{p.multiDrawArraysWEBGL(s,u,0,d,0,h);let y=0;for(let v=0;v<h;v++)y+=d[v];t.update(y,s,1)}}this.setMode=a,this.render=o,this.renderInstances=l,this.renderMultiDraw=c}function yG(n,e,t){let r;function i(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const S=e.get("EXT_texture_filter_anisotropic");r=n.getParameter(S.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function s(S){if(S==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";S="mediump"}return S==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const a=typeof WebGL2RenderingContext<"u"&&n.constructor.name==="WebGL2RenderingContext";let o=t.precision!==void 0?t.precision:"highp";const l=s(o);l!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",l,"instead."),o=l);const c=a||e.has("WEBGL_draw_buffers"),u=t.logarithmicDepthBuffer===!0,d=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),h=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),p=n.getParameter(n.MAX_TEXTURE_SIZE),y=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),v=n.getParameter(n.MAX_VERTEX_ATTRIBS),g=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),m=n.getParameter(n.MAX_VARYING_VECTORS),x=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),_=h>0,b=a||e.has("OES_texture_float"),w=_&&b,E=a?n.getParameter(n.MAX_SAMPLES):0;return{isWebGL2:a,drawBuffers:c,getMaxAnisotropy:i,getMaxPrecision:s,precision:o,logarithmicDepthBuffer:u,maxTextures:d,maxVertexTextures:h,maxTextureSize:p,maxCubemapSize:y,maxAttributes:v,maxVertexUniforms:g,maxVaryings:m,maxFragmentUniforms:x,vertexTextures:_,floatFragmentTextures:b,floatVertexTextures:w,maxSamples:E}}function vG(n){const e=this;let t=null,r=0,i=!1,s=!1;const a=new _l,o=new ct,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,h){const p=d.length!==0||h||r!==0||i;return i=h,r=d.length,p},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,h){t=u(d,h,0)},this.setState=function(d,h,p){const y=d.clippingPlanes,v=d.clipIntersection,g=d.clipShadows,m=n.get(d);if(!i||y===null||y.length===0||s&&!g)s?u(null):c();else{const x=s?0:r,_=x*4;let b=m.clippingState||null;l.value=b,b=u(y,h,_,p);for(let w=0;w!==_;++w)b[w]=t[w];m.clippingState=b,this.numIntersection=v?this.numPlanes:0,this.numPlanes+=x}};function c(){l.value!==t&&(l.value=t,l.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function u(d,h,p,y){const v=d!==null?d.length:0;let g=null;if(v!==0){if(g=l.value,y!==!0||g===null){const m=p+v*4,x=h.matrixWorldInverse;o.getNormalMatrix(x),(g===null||g.length<m)&&(g=new Float32Array(m));for(let _=0,b=p;_!==v;++_,b+=4)a.copy(d[_]).applyMatrix4(x,o),a.normal.toArray(g,b),g[b+3]=a.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=v,e.numIntersection=0,g}}function xG(n){let e=new WeakMap;function t(a,o){return o===mS?a.mapping=id:o===gS&&(a.mapping=sd),a}function r(a){if(a&&a.isTexture){const o=a.mapping;if(o===mS||o===gS)if(e.has(a)){const l=e.get(a).texture;return t(l,a.mapping)}else{const l=a.image;if(l&&l.height>0){const c=new PW(l.height);return c.fromEquirectangularTexture(n,a),e.set(a,c),a.addEventListener("dispose",i),t(c.texture,a.mapping)}else return null}}return a}function i(a){const o=a.target;o.removeEventListener("dispose",i);const l=e.get(o);l!==void 0&&(e.delete(o),l.dispose())}function s(){e=new WeakMap}return{get:r,dispose:s}}class _G extends hj{constructor(e=-1,t=1,r=1,i=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=r-e,a=r+e,o=i+t,l=i-t;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,a=s+c*this.view.width,o-=u*this.view.offsetY,l=o-u*this.view.height}this.projectionMatrix.makeOrthographic(s,a,o,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const Eu=4,IP=[.125,.215,.35,.446,.526,.582],Pl=20,D_=new _G,jP=new It;let I_=null,j_=0,F_=0;const bl=(1+Math.sqrt(5))/2,Wc=1/bl,FP=[new Q(1,1,1),new Q(-1,1,1),new Q(1,1,-1),new Q(-1,1,-1),new Q(0,bl,Wc),new Q(0,bl,-Wc),new Q(Wc,0,bl),new Q(-Wc,0,bl),new Q(bl,Wc,0),new Q(-bl,Wc,0)];class UP{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,i=100){I_=this._renderer.getRenderTarget(),j_=this._renderer.getActiveCubeFace(),F_=this._renderer.getActiveMipmapLevel(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,r,i,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=$P(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=zP(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(I_,j_,F_),e.scissorTest=!1,Km(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===id||e.mapping===sd?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),I_=this._renderer.getRenderTarget(),j_=this._renderer.getActiveCubeFace(),F_=this._renderer.getActiveMipmapLevel();const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:Rr,minFilter:Rr,generateMipmaps:!1,type:Kf,format:Gi,colorSpace:Jo,depthBuffer:!1},i=BP(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=BP(e,t,r);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=bG(s)),this._blurMaterial=wG(s,e,t)}return i}_compileMaterial(e){const t=new ga(this._lodPlanes[0],e);this._renderer.compile(t,D_)}_sceneToCubeUV(e,t,r,i){const o=new Ei(90,1,t,r),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,d=u.autoClear,h=u.toneMapping;u.getClearColor(jP),u.toneMapping=Lo,u.autoClear=!1;const p=new lj({name:"PMREM.Background",side:Br,depthWrite:!1,depthTest:!1}),y=new ga(new $p,p);let v=!1;const g=e.background;g?g.isColor&&(p.color.copy(g),e.background=null,v=!0):(p.color.copy(jP),v=!0);for(let m=0;m<6;m++){const x=m%3;x===0?(o.up.set(0,l[m],0),o.lookAt(c[m],0,0)):x===1?(o.up.set(0,0,l[m]),o.lookAt(0,c[m],0)):(o.up.set(0,l[m],0),o.lookAt(0,0,c[m]));const _=this._cubeSize;Km(i,x*_,m>2?_:0,_,_),u.setRenderTarget(i),v&&u.render(y,o),u.render(e,o)}y.geometry.dispose(),y.material.dispose(),u.toneMapping=h,u.autoClear=d,e.background=g}_textureToCubeUV(e,t){const r=this._renderer,i=e.mapping===id||e.mapping===sd;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=$P()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=zP());const s=i?this._cubemapMaterial:this._equirectMaterial,a=new ga(this._lodPlanes[0],s),o=s.uniforms;o.envMap.value=e;const l=this._cubeSize;Km(t,0,0,3*l,2*l),r.setRenderTarget(t),r.render(a,D_)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){const s=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),a=FP[(i-1)%FP.length];this._blur(e,i-1,i,s,a)}t.autoClear=r}_blur(e,t,r,i,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,r,i,"latitudinal",s),this._halfBlur(a,e,r,r,i,"longitudinal",s)}_halfBlur(e,t,r,i,s,a,o){const l=this._renderer,c=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const u=3,d=new ga(this._lodPlanes[i],c),h=c.uniforms,p=this._sizeLods[r]-1,y=isFinite(s)?Math.PI/(2*p):2*Math.PI/(2*Pl-1),v=s/y,g=isFinite(s)?1+Math.floor(u*v):Pl;g>Pl&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to ${Pl}`);const m=[];let x=0;for(let S=0;S<Pl;++S){const M=S/v,N=Math.exp(-M*M/2);m.push(N),S===0?x+=N:S<g&&(x+=2*N)}for(let S=0;S<m.length;S++)m[S]=m[S]/x;h.envMap.value=e.texture,h.samples.value=g,h.weights.value=m,h.latitudinal.value=a==="latitudinal",o&&(h.poleAxis.value=o);const{_lodMax:_}=this;h.dTheta.value=y,h.mipInt.value=_-r;const b=this._sizeLods[i],w=3*b*(i>_-Eu?i-_+Eu:0),E=4*(this._cubeSize-b);Km(t,w,E,3*b,2*b),l.setRenderTarget(t),l.render(d,D_)}}function bG(n){const e=[],t=[],r=[];let i=n;const s=n-Eu+1+IP.length;for(let a=0;a<s;a++){const o=Math.pow(2,i);t.push(o);let l=1/o;a>n-Eu?l=IP[a-n+Eu-1]:a===0&&(l=0),r.push(l);const c=1/(o-2),u=-c,d=1+c,h=[u,u,d,u,d,d,u,u,d,d,u,d],p=6,y=6,v=3,g=2,m=1,x=new Float32Array(v*y*p),_=new Float32Array(g*y*p),b=new Float32Array(m*y*p);for(let E=0;E<p;E++){const S=E%3*2/3-1,M=E>2?0:-1,N=[S,M,0,S+2/3,M,0,S+2/3,M+1,0,S,M,0,S+2/3,M+1,0,S,M+1,0];x.set(N,v*y*E),_.set(h,g*y*E);const T=[E,E,E,E,E,E];b.set(T,m*y*E)}const w=new ja;w.setAttribute("position",new Ji(x,v)),w.setAttribute("uv",new Ji(_,g)),w.setAttribute("faceIndex",new Ji(b,m)),e.push(w),i>Eu&&i--}return{lodPlanes:e,sizeLods:t,sigmas:r}}function BP(n,e,t){const r=new ac(n,e,t);return r.texture.mapping=vv,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function Km(n,e,t,r,i){n.viewport.set(e,t,r,i),n.scissor.set(e,t,r,i)}function wG(n,e,t){const r=new Float32Array(Pl),i=new Q(0,1,0);return new zo({name:"SphericalGaussianBlur",defines:{n:Pl,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:JE(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Oo,depthTest:!1,depthWrite:!1})}function zP(){return new zo({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:JE(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Oo,depthTest:!1,depthWrite:!1})}function $P(){return new zo({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:JE(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Oo,depthTest:!1,depthWrite:!1})}function JE(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function SG(n){let e=new WeakMap,t=null;function r(o){if(o&&o.isTexture){const l=o.mapping,c=l===mS||l===gS,u=l===id||l===sd;if(c||u)if(o.isRenderTargetTexture&&o.needsPMREMUpdate===!0){o.needsPMREMUpdate=!1;let d=e.get(o);return t===null&&(t=new UP(n)),d=c?t.fromEquirectangular(o,d):t.fromCubemap(o,d),e.set(o,d),d.texture}else{if(e.has(o))return e.get(o).texture;{const d=o.image;if(c&&d&&d.height>0||u&&d&&i(d)){t===null&&(t=new UP(n));const h=c?t.fromEquirectangular(o):t.fromCubemap(o);return e.set(o,h),o.addEventListener("dispose",s),h.texture}else return null}}}return o}function i(o){let l=0;const c=6;for(let u=0;u<c;u++)o[u]!==void 0&&l++;return l===c}function s(o){const l=o.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function a(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:r,dispose:a}}function EG(n){const e={};function t(r){if(e[r]!==void 0)return e[r];let i;switch(r){case"WEBGL_depth_texture":i=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=n.getExtension(r)}return e[r]=i,i}return{has:function(r){return t(r)!==null},init:function(r){r.isWebGL2?(t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance")):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(r){const i=t(r);return i===null&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),i}}}function TG(n,e,t,r){const i={},s=new WeakMap;function a(d){const h=d.target;h.index!==null&&e.remove(h.index);for(const y in h.attributes)e.remove(h.attributes[y]);for(const y in h.morphAttributes){const v=h.morphAttributes[y];for(let g=0,m=v.length;g<m;g++)e.remove(v[g])}h.removeEventListener("dispose",a),delete i[h.id];const p=s.get(h);p&&(e.remove(p),s.delete(h)),r.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,t.memory.geometries--}function o(d,h){return i[h.id]===!0||(h.addEventListener("dispose",a),i[h.id]=!0,t.memory.geometries++),h}function l(d){const h=d.attributes;for(const y in h)e.update(h[y],n.ARRAY_BUFFER);const p=d.morphAttributes;for(const y in p){const v=p[y];for(let g=0,m=v.length;g<m;g++)e.update(v[g],n.ARRAY_BUFFER)}}function c(d){const h=[],p=d.index,y=d.attributes.position;let v=0;if(p!==null){const x=p.array;v=p.version;for(let _=0,b=x.length;_<b;_+=3){const w=x[_+0],E=x[_+1],S=x[_+2];h.push(w,E,E,S,S,w)}}else if(y!==void 0){const x=y.array;v=y.version;for(let _=0,b=x.length/3-1;_<b;_+=3){const w=_+0,E=_+1,S=_+2;h.push(w,E,E,S,S,w)}}else return;const g=new(tj(h)?uj:cj)(h,1);g.version=v;const m=s.get(d);m&&e.remove(m),s.set(d,g)}function u(d){const h=s.get(d);if(h){const p=d.index;p!==null&&h.version<p.version&&c(d)}else c(d);return s.get(d)}return{get:o,update:l,getWireframeAttribute:u}}function MG(n,e,t,r){const i=r.isWebGL2;let s;function a(p){s=p}let o,l;function c(p){o=p.type,l=p.bytesPerElement}function u(p,y){n.drawElements(s,y,o,p*l),t.update(y,s,1)}function d(p,y,v){if(v===0)return;let g,m;if(i)g=n,m="drawElementsInstanced";else if(g=e.get("ANGLE_instanced_arrays"),m="drawElementsInstancedANGLE",g===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}g[m](s,y,o,p*l,v),t.update(y,s,v)}function h(p,y,v){if(v===0)return;const g=e.get("WEBGL_multi_draw");if(g===null)for(let m=0;m<v;m++)this.render(p[m]/l,y[m]);else{g.multiDrawElementsWEBGL(s,y,0,o,p,0,v);let m=0;for(let x=0;x<v;x++)m+=y[x];t.update(m,s,1)}}this.setMode=a,this.setIndex=c,this.render=u,this.renderInstances=d,this.renderMultiDraw=h}function kG(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(s,a,o){switch(t.calls++,a){case n.TRIANGLES:t.triangles+=o*(s/3);break;case n.LINES:t.lines+=o*(s/2);break;case n.LINE_STRIP:t.lines+=o*(s-1);break;case n.LINE_LOOP:t.lines+=o*s;break;case n.POINTS:t.points+=o*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function i(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:r}}function AG(n,e){return n[0]-e[0]}function PG(n,e){return Math.abs(e[1])-Math.abs(n[1])}function CG(n,e,t){const r={},i=new Float32Array(8),s=new WeakMap,a=new Un,o=[];for(let c=0;c<8;c++)o[c]=[c,0];function l(c,u,d){const h=c.morphTargetInfluences;if(e.isWebGL2===!0){const p=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,y=p!==void 0?p.length:0;let v=s.get(u);if(v===void 0||v.count!==y){let H=function(){T.dispose(),s.delete(u),u.removeEventListener("dispose",H)};v!==void 0&&v.texture.dispose();const g=u.morphAttributes.position!==void 0,m=u.morphAttributes.normal!==void 0,x=u.morphAttributes.color!==void 0,_=u.morphAttributes.position||[],b=u.morphAttributes.normal||[],w=u.morphAttributes.color||[];let E=0;g===!0&&(E=1),m===!0&&(E=2),x===!0&&(E=3);let S=u.attributes.position.count*E,M=1;S>e.maxTextureSize&&(M=Math.ceil(S/e.maxTextureSize),S=e.maxTextureSize);const N=new Float32Array(S*M*4*y),T=new ij(N,S,M,y);T.type=ha,T.needsUpdate=!0;const P=E*4;for(let W=0;W<y;W++){const O=_[W],I=b[W],F=w[W],j=S*M*4*W;for(let L=0;L<O.count;L++){const D=L*P;g===!0&&(a.fromBufferAttribute(O,L),N[j+D+0]=a.x,N[j+D+1]=a.y,N[j+D+2]=a.z,N[j+D+3]=0),m===!0&&(a.fromBufferAttribute(I,L),N[j+D+4]=a.x,N[j+D+5]=a.y,N[j+D+6]=a.z,N[j+D+7]=0),x===!0&&(a.fromBufferAttribute(F,L),N[j+D+8]=a.x,N[j+D+9]=a.y,N[j+D+10]=a.z,N[j+D+11]=F.itemSize===4?a.w:1)}}v={count:y,texture:T,size:new Rt(S,M)},s.set(u,v),u.addEventListener("dispose",H)}if(c.isInstancedMesh===!0&&c.morphTexture!==null)d.getUniforms().setValue(n,"morphTexture",c.morphTexture,t);else{let g=0;for(let x=0;x<h.length;x++)g+=h[x];const m=u.morphTargetsRelative?1:1-g;d.getUniforms().setValue(n,"morphTargetBaseInfluence",m),d.getUniforms().setValue(n,"morphTargetInfluences",h)}d.getUniforms().setValue(n,"morphTargetsTexture",v.texture,t),d.getUniforms().setValue(n,"morphTargetsTextureSize",v.size)}else{const p=h===void 0?0:h.length;let y=r[u.id];if(y===void 0||y.length!==p){y=[];for(let _=0;_<p;_++)y[_]=[_,0];r[u.id]=y}for(let _=0;_<p;_++){const b=y[_];b[0]=_,b[1]=h[_]}y.sort(PG);for(let _=0;_<8;_++)_<p&&y[_][1]?(o[_][0]=y[_][0],o[_][1]=y[_][1]):(o[_][0]=Number.MAX_SAFE_INTEGER,o[_][1]=0);o.sort(AG);const v=u.morphAttributes.position,g=u.morphAttributes.normal;let m=0;for(let _=0;_<8;_++){const b=o[_],w=b[0],E=b[1];w!==Number.MAX_SAFE_INTEGER&&E?(v&&u.getAttribute("morphTarget"+_)!==v[w]&&u.setAttribute("morphTarget"+_,v[w]),g&&u.getAttribute("morphNormal"+_)!==g[w]&&u.setAttribute("morphNormal"+_,g[w]),i[_]=E,m+=E):(v&&u.hasAttribute("morphTarget"+_)===!0&&u.deleteAttribute("morphTarget"+_),g&&u.hasAttribute("morphNormal"+_)===!0&&u.deleteAttribute("morphNormal"+_),i[_]=0)}const x=u.morphTargetsRelative?1:1-m;d.getUniforms().setValue(n,"morphTargetBaseInfluence",x),d.getUniforms().setValue(n,"morphTargetInfluences",i)}}return{update:l}}function RG(n,e,t,r){let i=new WeakMap;function s(l){const c=r.render.frame,u=l.geometry,d=e.get(l,u);if(i.get(d)!==c&&(e.update(d),i.set(d,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",o)===!1&&l.addEventListener("dispose",o),i.get(l)!==c&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,n.ARRAY_BUFFER),i.set(l,c))),l.isSkinnedMesh){const h=l.skeleton;i.get(h)!==c&&(h.update(),i.set(h,c))}return d}function a(){i=new WeakMap}function o(l){const c=l.target;c.removeEventListener("dispose",o),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:s,dispose:a}}class gj extends zr{constructor(e,t,r,i,s,a,o,l,c,u){if(u=u!==void 0?u:ql,u!==ql&&u!==ad)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&u===ql&&(r=xo),r===void 0&&u===ad&&(r=Gl),super(null,i,s,a,o,l,u,r,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=o!==void 0?o:gr,this.minFilter=l!==void 0?l:gr,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const yj=new zr,vj=new gj(1,1);vj.compareFunction=ej;const xj=new ij,_j=new hW,bj=new fj,VP=[],HP=[],WP=new Float32Array(16),GP=new Float32Array(9),qP=new Float32Array(4);function Ad(n,e,t){const r=n[0];if(r<=0||r>0)return n;const i=e*t;let s=VP[i];if(s===void 0&&(s=new Float32Array(i),VP[i]=s),e!==0){r.toArray(s,0);for(let a=1,o=0;a!==e;++a)o+=t,n[a].toArray(s,o)}return s}function Tn(n,e){if(n.length!==e.length)return!1;for(let t=0,r=n.length;t<r;t++)if(n[t]!==e[t])return!1;return!0}function Mn(n,e){for(let t=0,r=e.length;t<r;t++)n[t]=e[t]}function wv(n,e){let t=HP[e];t===void 0&&(t=new Int32Array(e),HP[e]=t);for(let r=0;r!==e;++r)t[r]=n.allocateTextureUnit();return t}function NG(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function OG(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Tn(t,e))return;n.uniform2fv(this.addr,e),Mn(t,e)}}function LG(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Tn(t,e))return;n.uniform3fv(this.addr,e),Mn(t,e)}}function DG(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Tn(t,e))return;n.uniform4fv(this.addr,e),Mn(t,e)}}function IG(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Tn(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Mn(t,e)}else{if(Tn(t,r))return;qP.set(r),n.uniformMatrix2fv(this.addr,!1,qP),Mn(t,r)}}function jG(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Tn(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Mn(t,e)}else{if(Tn(t,r))return;GP.set(r),n.uniformMatrix3fv(this.addr,!1,GP),Mn(t,r)}}function FG(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Tn(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Mn(t,e)}else{if(Tn(t,r))return;WP.set(r),n.uniformMatrix4fv(this.addr,!1,WP),Mn(t,r)}}function UG(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function BG(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Tn(t,e))return;n.uniform2iv(this.addr,e),Mn(t,e)}}function zG(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Tn(t,e))return;n.uniform3iv(this.addr,e),Mn(t,e)}}function $G(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Tn(t,e))return;n.uniform4iv(this.addr,e),Mn(t,e)}}function VG(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function HG(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Tn(t,e))return;n.uniform2uiv(this.addr,e),Mn(t,e)}}function WG(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Tn(t,e))return;n.uniform3uiv(this.addr,e),Mn(t,e)}}function GG(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Tn(t,e))return;n.uniform4uiv(this.addr,e),Mn(t,e)}}function qG(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i);const s=this.type===n.SAMPLER_2D_SHADOW?vj:yj;t.setTexture2D(e||s,i)}function XG(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture3D(e||_j,i)}function YG(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTextureCube(e||bj,i)}function KG(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture2DArray(e||xj,i)}function ZG(n){switch(n){case 5126:return NG;case 35664:return OG;case 35665:return LG;case 35666:return DG;case 35674:return IG;case 35675:return jG;case 35676:return FG;case 5124:case 35670:return UG;case 35667:case 35671:return BG;case 35668:case 35672:return zG;case 35669:case 35673:return $G;case 5125:return VG;case 36294:return HG;case 36295:return WG;case 36296:return GG;case 35678:case 36198:case 36298:case 36306:case 35682:return qG;case 35679:case 36299:case 36307:return XG;case 35680:case 36300:case 36308:case 36293:return YG;case 36289:case 36303:case 36311:case 36292:return KG}}function JG(n,e){n.uniform1fv(this.addr,e)}function QG(n,e){const t=Ad(e,this.size,2);n.uniform2fv(this.addr,t)}function e9(n,e){const t=Ad(e,this.size,3);n.uniform3fv(this.addr,t)}function t9(n,e){const t=Ad(e,this.size,4);n.uniform4fv(this.addr,t)}function n9(n,e){const t=Ad(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function r9(n,e){const t=Ad(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function i9(n,e){const t=Ad(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function s9(n,e){n.uniform1iv(this.addr,e)}function a9(n,e){n.uniform2iv(this.addr,e)}function o9(n,e){n.uniform3iv(this.addr,e)}function l9(n,e){n.uniform4iv(this.addr,e)}function c9(n,e){n.uniform1uiv(this.addr,e)}function u9(n,e){n.uniform2uiv(this.addr,e)}function d9(n,e){n.uniform3uiv(this.addr,e)}function h9(n,e){n.uniform4uiv(this.addr,e)}function f9(n,e,t){const r=this.cache,i=e.length,s=wv(t,i);Tn(r,s)||(n.uniform1iv(this.addr,s),Mn(r,s));for(let a=0;a!==i;++a)t.setTexture2D(e[a]||yj,s[a])}function p9(n,e,t){const r=this.cache,i=e.length,s=wv(t,i);Tn(r,s)||(n.uniform1iv(this.addr,s),Mn(r,s));for(let a=0;a!==i;++a)t.setTexture3D(e[a]||_j,s[a])}function m9(n,e,t){const r=this.cache,i=e.length,s=wv(t,i);Tn(r,s)||(n.uniform1iv(this.addr,s),Mn(r,s));for(let a=0;a!==i;++a)t.setTextureCube(e[a]||bj,s[a])}function g9(n,e,t){const r=this.cache,i=e.length,s=wv(t,i);Tn(r,s)||(n.uniform1iv(this.addr,s),Mn(r,s));for(let a=0;a!==i;++a)t.setTexture2DArray(e[a]||xj,s[a])}function y9(n){switch(n){case 5126:return JG;case 35664:return QG;case 35665:return e9;case 35666:return t9;case 35674:return n9;case 35675:return r9;case 35676:return i9;case 5124:case 35670:return s9;case 35667:case 35671:return a9;case 35668:case 35672:return o9;case 35669:case 35673:return l9;case 5125:return c9;case 36294:return u9;case 36295:return d9;case 36296:return h9;case 35678:case 36198:case 36298:case 36306:case 35682:return f9;case 35679:case 36299:case 36307:return p9;case 35680:case 36300:case 36308:case 36293:return m9;case 36289:case 36303:case 36311:case 36292:return g9}}class v9{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.setValue=ZG(t.type)}}class x9{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=y9(t.type)}}class _9{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const i=this.seq;for(let s=0,a=i.length;s!==a;++s){const o=i[s];o.setValue(e,t[o.id],r)}}}const U_=/(\w+)(\])?(\[|\.)?/g;function XP(n,e){n.seq.push(e),n.map[e.id]=e}function b9(n,e,t){const r=n.name,i=r.length;for(U_.lastIndex=0;;){const s=U_.exec(r),a=U_.lastIndex;let o=s[1];const l=s[2]==="]",c=s[3];if(l&&(o=o|0),c===void 0||c==="["&&a+2===i){XP(t,c===void 0?new v9(o,n,e):new x9(o,n,e));break}else{let d=t.map[o];d===void 0&&(d=new _9(o),XP(t,d)),t=d}}}class dy{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<r;++i){const s=e.getActiveUniform(t,i),a=e.getUniformLocation(t,s.name);b9(s,a,this)}}setValue(e,t,r,i){const s=this.map[t];s!==void 0&&s.setValue(e,r,i)}setOptional(e,t,r){const i=t[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let s=0,a=t.length;s!==a;++s){const o=t[s],l=r[o.id];l.needsUpdate!==!1&&o.setValue(e,l.value,i)}}static seqWithValue(e,t){const r=[];for(let i=0,s=e.length;i!==s;++i){const a=e[i];a.id in t&&r.push(a)}return r}}function YP(n,e,t){const r=n.createShader(e);return n.shaderSource(r,t),n.compileShader(r),r}const w9=37297;let S9=0;function E9(n,e){const t=n.split(`
`),r=[],i=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let a=i;a<s;a++){const o=a+1;r.push(`${o===e?">":" "} ${o}: ${t[a]}`)}return r.join(`
`)}function T9(n){const e=Ft.getPrimaries(Ft.workingColorSpace),t=Ft.getPrimaries(n);let r;switch(e===t?r="":e===n0&&t===t0?r="LinearDisplayP3ToLinearSRGB":e===t0&&t===n0&&(r="LinearSRGBToLinearDisplayP3"),n){case Jo:case xv:return[r,"LinearTransferOETF"];case bs:case ZE:return[r,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[r,"LinearTransferOETF"]}}function KP(n,e,t){const r=n.getShaderParameter(e,n.COMPILE_STATUS),i=n.getShaderInfoLog(e).trim();if(r&&i==="")return"";const s=/ERROR: 0:(\d+)/.exec(i);if(s){const a=parseInt(s[1]);return t.toUpperCase()+`

`+i+`

`+E9(n.getShaderSource(e),a)}else return i}function M9(n,e){const t=T9(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function k9(n,e){let t;switch(e){case OH:t="Linear";break;case LH:t="Reinhard";break;case DH:t="OptimizedCineon";break;case IH:t="ACESFilmic";break;case FH:t="AgX";break;case UH:t="Neutral";break;case jH:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function A9(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||n.alphaToCoverage||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Tu).join(`
`)}function P9(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Tu).join(`
`)}function C9(n){const e=[];for(const t in n){const r=n[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}function R9(n,e){const t={},r=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const s=n.getActiveAttrib(e,i),a=s.name;let o=1;s.type===n.FLOAT_MAT2&&(o=2),s.type===n.FLOAT_MAT3&&(o=3),s.type===n.FLOAT_MAT4&&(o=4),t[a]={type:s.type,location:n.getAttribLocation(e,a),locationSize:o}}return t}function Tu(n){return n!==""}function ZP(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function JP(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const N9=/^[ \t]*#include +<([\w\d./]+)>/gm;function wS(n){return n.replace(N9,L9)}const O9=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function L9(n,e){let t=ot[e];if(t===void 0){const r=O9.get(e);if(r!==void 0)t=ot[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return wS(t)}const D9=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function QP(n){return n.replace(D9,I9)}function I9(n,e,t,r){let i="";for(let s=parseInt(e);s<parseInt(t);s++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function eC(n){let e=`precision ${n.precision} float;
	precision ${n.precision} int;
	precision ${n.precision} sampler2D;
	precision ${n.precision} samplerCube;
	`;return n.isWebGL2&&(e+=`precision ${n.precision} sampler3D;
		precision ${n.precision} sampler2DArray;
		precision ${n.precision} sampler2DShadow;
		precision ${n.precision} samplerCubeShadow;
		precision ${n.precision} sampler2DArrayShadow;
		precision ${n.precision} isampler2D;
		precision ${n.precision} isampler3D;
		precision ${n.precision} isamplerCube;
		precision ${n.precision} isampler2DArray;
		precision ${n.precision} usampler2D;
		precision ${n.precision} usampler3D;
		precision ${n.precision} usamplerCube;
		precision ${n.precision} usampler2DArray;
		`),n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function j9(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===HI?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===oH?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===ta&&(e="SHADOWMAP_TYPE_VSM"),e}function F9(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case id:case sd:e="ENVMAP_TYPE_CUBE";break;case vv:e="ENVMAP_TYPE_CUBE_UV";break}return e}function U9(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case sd:e="ENVMAP_MODE_REFRACTION";break}return e}function B9(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case WI:e="ENVMAP_BLENDING_MULTIPLY";break;case RH:e="ENVMAP_BLENDING_MIX";break;case NH:e="ENVMAP_BLENDING_ADD";break}return e}function z9(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:r,maxMip:t}}function $9(n,e,t,r){const i=n.getContext(),s=t.defines;let a=t.vertexShader,o=t.fragmentShader;const l=j9(t),c=F9(t),u=U9(t),d=B9(t),h=z9(t),p=t.isWebGL2?"":A9(t),y=P9(t),v=C9(s),g=i.createProgram();let m,x,_=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(m=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v].filter(Tu).join(`
`),m.length>0&&(m+=`
`),x=[p,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v].filter(Tu).join(`
`),x.length>0&&(x+=`
`)):(m=[eC(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Tu).join(`
`),x=[p,eC(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Lo?"#define TONE_MAPPING":"",t.toneMapping!==Lo?ot.tonemapping_pars_fragment:"",t.toneMapping!==Lo?k9("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",ot.colorspace_pars_fragment,M9("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Tu).join(`
`)),a=wS(a),a=ZP(a,t),a=JP(a,t),o=wS(o),o=ZP(o,t),o=JP(o,t),a=QP(a),o=QP(o),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(_=`#version 300 es
`,m=[y,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+m,x=["precision mediump sampler2DArray;","#define varying in",t.glslVersion===gP?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===gP?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+x);const b=_+m+a,w=_+x+o,E=YP(i,i.VERTEX_SHADER,b),S=YP(i,i.FRAGMENT_SHADER,w);i.attachShader(g,E),i.attachShader(g,S),t.index0AttributeName!==void 0?i.bindAttribLocation(g,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(g,0,"position"),i.linkProgram(g);function M(H){if(n.debug.checkShaderErrors){const W=i.getProgramInfoLog(g).trim(),O=i.getShaderInfoLog(E).trim(),I=i.getShaderInfoLog(S).trim();let F=!0,j=!0;if(i.getProgramParameter(g,i.LINK_STATUS)===!1)if(F=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(i,g,E,S);else{const L=KP(i,E,"vertex"),D=KP(i,S,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(g,i.VALIDATE_STATUS)+`

Material Name: `+H.name+`
Material Type: `+H.type+`

Program Info Log: `+W+`
`+L+`
`+D)}else W!==""?console.warn("THREE.WebGLProgram: Program Info Log:",W):(O===""||I==="")&&(j=!1);j&&(H.diagnostics={runnable:F,programLog:W,vertexShader:{log:O,prefix:m},fragmentShader:{log:I,prefix:x}})}i.deleteShader(E),i.deleteShader(S),N=new dy(i,g),T=R9(i,g)}let N;this.getUniforms=function(){return N===void 0&&M(this),N};let T;this.getAttributes=function(){return T===void 0&&M(this),T};let P=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return P===!1&&(P=i.getProgramParameter(g,w9)),P},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(g),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=S9++,this.cacheKey=e,this.usedTimes=1,this.program=g,this.vertexShader=E,this.fragmentShader=S,this}let V9=0;class H9{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),s=this._getShaderStage(r),a=this._getShaderCacheForMaterial(e);return a.has(i)===!1&&(a.add(i),i.usedTimes++),a.has(s)===!1&&(a.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){const t=this.shaderCache;let r=t.get(e);return r===void 0&&(r=new W9(e),t.set(e,r)),r}}class W9{constructor(e){this.id=V9++,this.code=e,this.usedTimes=0}}function G9(n,e,t,r,i,s,a){const o=new aj,l=new H9,c=new Set,u=[],d=i.isWebGL2,h=i.logarithmicDepthBuffer,p=i.vertexTextures;let y=i.precision;const v={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function g(T){return c.add(T),T===0?"uv":`uv${T}`}function m(T,P,H,W,O){const I=W.fog,F=O.geometry,j=T.isMeshStandardMaterial?W.environment:null,L=(T.isMeshStandardMaterial?t:e).get(T.envMap||j),D=L&&L.mapping===vv?L.image.height:null,z=v[T.type];T.precision!==null&&(y=i.getMaxPrecision(T.precision),y!==T.precision&&console.warn("THREE.WebGLProgram.getParameters:",T.precision,"not supported, using",y,"instead."));const K=F.morphAttributes.position||F.morphAttributes.normal||F.morphAttributes.color,re=K!==void 0?K.length:0;let Se=0;F.morphAttributes.position!==void 0&&(Se=1),F.morphAttributes.normal!==void 0&&(Se=2),F.morphAttributes.color!==void 0&&(Se=3);let G,ne,ye,se;if(z){const Ut=Es[z];G=Ut.vertexShader,ne=Ut.fragmentShader}else G=T.vertexShader,ne=T.fragmentShader,l.update(T),ye=l.getVertexShaderID(T),se=l.getFragmentShaderID(T);const U=n.getRenderTarget(),X=O.isInstancedMesh===!0,pe=O.isBatchedMesh===!0,ue=!!T.map,B=!!T.matcap,He=!!L,fe=!!T.aoMap,me=!!T.lightMap,Ee=!!T.bumpMap,xe=!!T.normalMap,ce=!!T.displacementMap,V=!!T.emissiveMap,le=!!T.metalnessMap,C=!!T.roughnessMap,A=T.anisotropy>0,Y=T.clearcoat>0,de=T.iridescence>0,be=T.sheen>0,ge=T.transmission>0,Ze=A&&!!T.anisotropyMap,We=Y&&!!T.clearcoatMap,ae=Y&&!!T.clearcoatNormalMap,oe=Y&&!!T.clearcoatRoughnessMap,Pe=de&&!!T.iridescenceMap,he=de&&!!T.iridescenceThicknessMap,ze=be&&!!T.sheenColorMap,Ue=be&&!!T.sheenRoughnessMap,De=!!T.specularMap,Me=!!T.specularColorMap,Be=!!T.specularIntensityMap,St=ge&&!!T.transmissionMap,tt=ge&&!!T.thicknessMap,Yt=!!T.gradientMap,$=!!T.alphaMap,Ce=T.alphaTest>0,J=!!T.alphaHash,Te=!!T.extensions;let Ne=Lo;T.toneMapped&&(U===null||U.isXRRenderTarget===!0)&&(Ne=n.toneMapping);const vt={isWebGL2:d,shaderID:z,shaderType:T.type,shaderName:T.name,vertexShader:G,fragmentShader:ne,defines:T.defines,customVertexShaderID:ye,customFragmentShaderID:se,isRawShaderMaterial:T.isRawShaderMaterial===!0,glslVersion:T.glslVersion,precision:y,batching:pe,instancing:X,instancingColor:X&&O.instanceColor!==null,instancingMorph:X&&O.morphTexture!==null,supportsVertexTextures:p,outputColorSpace:U===null?n.outputColorSpace:U.isXRRenderTarget===!0?U.texture.colorSpace:Jo,alphaToCoverage:!!T.alphaToCoverage,map:ue,matcap:B,envMap:He,envMapMode:He&&L.mapping,envMapCubeUVHeight:D,aoMap:fe,lightMap:me,bumpMap:Ee,normalMap:xe,displacementMap:p&&ce,emissiveMap:V,normalMapObjectSpace:xe&&T.normalMapType===ZH,normalMapTangentSpace:xe&&T.normalMapType===KH,metalnessMap:le,roughnessMap:C,anisotropy:A,anisotropyMap:Ze,clearcoat:Y,clearcoatMap:We,clearcoatNormalMap:ae,clearcoatRoughnessMap:oe,iridescence:de,iridescenceMap:Pe,iridescenceThicknessMap:he,sheen:be,sheenColorMap:ze,sheenRoughnessMap:Ue,specularMap:De,specularColorMap:Me,specularIntensityMap:Be,transmission:ge,transmissionMap:St,thicknessMap:tt,gradientMap:Yt,opaque:T.transparent===!1&&T.blending===$u&&T.alphaToCoverage===!1,alphaMap:$,alphaTest:Ce,alphaHash:J,combine:T.combine,mapUv:ue&&g(T.map.channel),aoMapUv:fe&&g(T.aoMap.channel),lightMapUv:me&&g(T.lightMap.channel),bumpMapUv:Ee&&g(T.bumpMap.channel),normalMapUv:xe&&g(T.normalMap.channel),displacementMapUv:ce&&g(T.displacementMap.channel),emissiveMapUv:V&&g(T.emissiveMap.channel),metalnessMapUv:le&&g(T.metalnessMap.channel),roughnessMapUv:C&&g(T.roughnessMap.channel),anisotropyMapUv:Ze&&g(T.anisotropyMap.channel),clearcoatMapUv:We&&g(T.clearcoatMap.channel),clearcoatNormalMapUv:ae&&g(T.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:oe&&g(T.clearcoatRoughnessMap.channel),iridescenceMapUv:Pe&&g(T.iridescenceMap.channel),iridescenceThicknessMapUv:he&&g(T.iridescenceThicknessMap.channel),sheenColorMapUv:ze&&g(T.sheenColorMap.channel),sheenRoughnessMapUv:Ue&&g(T.sheenRoughnessMap.channel),specularMapUv:De&&g(T.specularMap.channel),specularColorMapUv:Me&&g(T.specularColorMap.channel),specularIntensityMapUv:Be&&g(T.specularIntensityMap.channel),transmissionMapUv:St&&g(T.transmissionMap.channel),thicknessMapUv:tt&&g(T.thicknessMap.channel),alphaMapUv:$&&g(T.alphaMap.channel),vertexTangents:!!F.attributes.tangent&&(xe||A),vertexColors:T.vertexColors,vertexAlphas:T.vertexColors===!0&&!!F.attributes.color&&F.attributes.color.itemSize===4,pointsUvs:O.isPoints===!0&&!!F.attributes.uv&&(ue||$),fog:!!I,useFog:T.fog===!0,fogExp2:!!I&&I.isFogExp2,flatShading:T.flatShading===!0,sizeAttenuation:T.sizeAttenuation===!0,logarithmicDepthBuffer:h,skinning:O.isSkinnedMesh===!0,morphTargets:F.morphAttributes.position!==void 0,morphNormals:F.morphAttributes.normal!==void 0,morphColors:F.morphAttributes.color!==void 0,morphTargetsCount:re,morphTextureStride:Se,numDirLights:P.directional.length,numPointLights:P.point.length,numSpotLights:P.spot.length,numSpotLightMaps:P.spotLightMap.length,numRectAreaLights:P.rectArea.length,numHemiLights:P.hemi.length,numDirLightShadows:P.directionalShadowMap.length,numPointLightShadows:P.pointShadowMap.length,numSpotLightShadows:P.spotShadowMap.length,numSpotLightShadowsWithMaps:P.numSpotLightShadowsWithMaps,numLightProbes:P.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:T.dithering,shadowMapEnabled:n.shadowMap.enabled&&H.length>0,shadowMapType:n.shadowMap.type,toneMapping:Ne,useLegacyLights:n._useLegacyLights,decodeVideoTexture:ue&&T.map.isVideoTexture===!0&&Ft.getTransfer(T.map.colorSpace)===Gt,premultipliedAlpha:T.premultipliedAlpha,doubleSided:T.side===da,flipSided:T.side===Br,useDepthPacking:T.depthPacking>=0,depthPacking:T.depthPacking||0,index0AttributeName:T.index0AttributeName,extensionDerivatives:Te&&T.extensions.derivatives===!0,extensionFragDepth:Te&&T.extensions.fragDepth===!0,extensionDrawBuffers:Te&&T.extensions.drawBuffers===!0,extensionShaderTextureLOD:Te&&T.extensions.shaderTextureLOD===!0,extensionClipCullDistance:Te&&T.extensions.clipCullDistance===!0&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:Te&&T.extensions.multiDraw===!0&&r.has("WEBGL_multi_draw"),rendererExtensionFragDepth:d||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||r.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:T.customProgramCacheKey()};return vt.vertexUv1s=c.has(1),vt.vertexUv2s=c.has(2),vt.vertexUv3s=c.has(3),c.clear(),vt}function x(T){const P=[];if(T.shaderID?P.push(T.shaderID):(P.push(T.customVertexShaderID),P.push(T.customFragmentShaderID)),T.defines!==void 0)for(const H in T.defines)P.push(H),P.push(T.defines[H]);return T.isRawShaderMaterial===!1&&(_(P,T),b(P,T),P.push(n.outputColorSpace)),P.push(T.customProgramCacheKey),P.join()}function _(T,P){T.push(P.precision),T.push(P.outputColorSpace),T.push(P.envMapMode),T.push(P.envMapCubeUVHeight),T.push(P.mapUv),T.push(P.alphaMapUv),T.push(P.lightMapUv),T.push(P.aoMapUv),T.push(P.bumpMapUv),T.push(P.normalMapUv),T.push(P.displacementMapUv),T.push(P.emissiveMapUv),T.push(P.metalnessMapUv),T.push(P.roughnessMapUv),T.push(P.anisotropyMapUv),T.push(P.clearcoatMapUv),T.push(P.clearcoatNormalMapUv),T.push(P.clearcoatRoughnessMapUv),T.push(P.iridescenceMapUv),T.push(P.iridescenceThicknessMapUv),T.push(P.sheenColorMapUv),T.push(P.sheenRoughnessMapUv),T.push(P.specularMapUv),T.push(P.specularColorMapUv),T.push(P.specularIntensityMapUv),T.push(P.transmissionMapUv),T.push(P.thicknessMapUv),T.push(P.combine),T.push(P.fogExp2),T.push(P.sizeAttenuation),T.push(P.morphTargetsCount),T.push(P.morphAttributeCount),T.push(P.numDirLights),T.push(P.numPointLights),T.push(P.numSpotLights),T.push(P.numSpotLightMaps),T.push(P.numHemiLights),T.push(P.numRectAreaLights),T.push(P.numDirLightShadows),T.push(P.numPointLightShadows),T.push(P.numSpotLightShadows),T.push(P.numSpotLightShadowsWithMaps),T.push(P.numLightProbes),T.push(P.shadowMapType),T.push(P.toneMapping),T.push(P.numClippingPlanes),T.push(P.numClipIntersection),T.push(P.depthPacking)}function b(T,P){o.disableAll(),P.isWebGL2&&o.enable(0),P.supportsVertexTextures&&o.enable(1),P.instancing&&o.enable(2),P.instancingColor&&o.enable(3),P.instancingMorph&&o.enable(4),P.matcap&&o.enable(5),P.envMap&&o.enable(6),P.normalMapObjectSpace&&o.enable(7),P.normalMapTangentSpace&&o.enable(8),P.clearcoat&&o.enable(9),P.iridescence&&o.enable(10),P.alphaTest&&o.enable(11),P.vertexColors&&o.enable(12),P.vertexAlphas&&o.enable(13),P.vertexUv1s&&o.enable(14),P.vertexUv2s&&o.enable(15),P.vertexUv3s&&o.enable(16),P.vertexTangents&&o.enable(17),P.anisotropy&&o.enable(18),P.alphaHash&&o.enable(19),P.batching&&o.enable(20),T.push(o.mask),o.disableAll(),P.fog&&o.enable(0),P.useFog&&o.enable(1),P.flatShading&&o.enable(2),P.logarithmicDepthBuffer&&o.enable(3),P.skinning&&o.enable(4),P.morphTargets&&o.enable(5),P.morphNormals&&o.enable(6),P.morphColors&&o.enable(7),P.premultipliedAlpha&&o.enable(8),P.shadowMapEnabled&&o.enable(9),P.useLegacyLights&&o.enable(10),P.doubleSided&&o.enable(11),P.flipSided&&o.enable(12),P.useDepthPacking&&o.enable(13),P.dithering&&o.enable(14),P.transmission&&o.enable(15),P.sheen&&o.enable(16),P.opaque&&o.enable(17),P.pointsUvs&&o.enable(18),P.decodeVideoTexture&&o.enable(19),P.alphaToCoverage&&o.enable(20),T.push(o.mask)}function w(T){const P=v[T.type];let H;if(P){const W=Es[P];H=TW.clone(W.uniforms)}else H=T.uniforms;return H}function E(T,P){let H;for(let W=0,O=u.length;W<O;W++){const I=u[W];if(I.cacheKey===P){H=I,++H.usedTimes;break}}return H===void 0&&(H=new $9(n,P,T,s),u.push(H)),H}function S(T){if(--T.usedTimes===0){const P=u.indexOf(T);u[P]=u[u.length-1],u.pop(),T.destroy()}}function M(T){l.remove(T)}function N(){l.dispose()}return{getParameters:m,getProgramCacheKey:x,getUniforms:w,acquireProgram:E,releaseProgram:S,releaseShaderCache:M,programs:u,dispose:N}}function q9(){let n=new WeakMap;function e(s){let a=n.get(s);return a===void 0&&(a={},n.set(s,a)),a}function t(s){n.delete(s)}function r(s,a,o){n.get(s)[a]=o}function i(){n=new WeakMap}return{get:e,remove:t,update:r,dispose:i}}function X9(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function tC(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function nC(){const n=[];let e=0;const t=[],r=[],i=[];function s(){e=0,t.length=0,r.length=0,i.length=0}function a(d,h,p,y,v,g){let m=n[e];return m===void 0?(m={id:d.id,object:d,geometry:h,material:p,groupOrder:y,renderOrder:d.renderOrder,z:v,group:g},n[e]=m):(m.id=d.id,m.object=d,m.geometry=h,m.material=p,m.groupOrder=y,m.renderOrder=d.renderOrder,m.z=v,m.group=g),e++,m}function o(d,h,p,y,v,g){const m=a(d,h,p,y,v,g);p.transmission>0?r.push(m):p.transparent===!0?i.push(m):t.push(m)}function l(d,h,p,y,v,g){const m=a(d,h,p,y,v,g);p.transmission>0?r.unshift(m):p.transparent===!0?i.unshift(m):t.unshift(m)}function c(d,h){t.length>1&&t.sort(d||X9),r.length>1&&r.sort(h||tC),i.length>1&&i.sort(h||tC)}function u(){for(let d=e,h=n.length;d<h;d++){const p=n[d];if(p.id===null)break;p.id=null,p.object=null,p.geometry=null,p.material=null,p.group=null}}return{opaque:t,transmissive:r,transparent:i,init:s,push:o,unshift:l,finish:u,sort:c}}function Y9(){let n=new WeakMap;function e(r,i){const s=n.get(r);let a;return s===void 0?(a=new nC,n.set(r,[a])):i>=s.length?(a=new nC,s.push(a)):a=s[i],a}function t(){n=new WeakMap}return{get:e,dispose:t}}function K9(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Q,color:new It};break;case"SpotLight":t={position:new Q,direction:new Q,color:new It,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Q,color:new It,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Q,skyColor:new It,groundColor:new It};break;case"RectAreaLight":t={color:new It,position:new Q,halfWidth:new Q,halfHeight:new Q};break}return n[e.id]=t,t}}}function Z9(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Rt};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Rt};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Rt,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let J9=0;function Q9(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function e7(n,e){const t=new K9,r=Z9(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)i.probe.push(new Q);const s=new Q,a=new xn,o=new xn;function l(u,d){let h=0,p=0,y=0;for(let H=0;H<9;H++)i.probe[H].set(0,0,0);let v=0,g=0,m=0,x=0,_=0,b=0,w=0,E=0,S=0,M=0,N=0;u.sort(Q9);const T=d===!0?Math.PI:1;for(let H=0,W=u.length;H<W;H++){const O=u[H],I=O.color,F=O.intensity,j=O.distance,L=O.shadow&&O.shadow.map?O.shadow.map.texture:null;if(O.isAmbientLight)h+=I.r*F*T,p+=I.g*F*T,y+=I.b*F*T;else if(O.isLightProbe){for(let D=0;D<9;D++)i.probe[D].addScaledVector(O.sh.coefficients[D],F);N++}else if(O.isDirectionalLight){const D=t.get(O);if(D.color.copy(O.color).multiplyScalar(O.intensity*T),O.castShadow){const z=O.shadow,K=r.get(O);K.shadowBias=z.bias,K.shadowNormalBias=z.normalBias,K.shadowRadius=z.radius,K.shadowMapSize=z.mapSize,i.directionalShadow[v]=K,i.directionalShadowMap[v]=L,i.directionalShadowMatrix[v]=O.shadow.matrix,b++}i.directional[v]=D,v++}else if(O.isSpotLight){const D=t.get(O);D.position.setFromMatrixPosition(O.matrixWorld),D.color.copy(I).multiplyScalar(F*T),D.distance=j,D.coneCos=Math.cos(O.angle),D.penumbraCos=Math.cos(O.angle*(1-O.penumbra)),D.decay=O.decay,i.spot[m]=D;const z=O.shadow;if(O.map&&(i.spotLightMap[S]=O.map,S++,z.updateMatrices(O),O.castShadow&&M++),i.spotLightMatrix[m]=z.matrix,O.castShadow){const K=r.get(O);K.shadowBias=z.bias,K.shadowNormalBias=z.normalBias,K.shadowRadius=z.radius,K.shadowMapSize=z.mapSize,i.spotShadow[m]=K,i.spotShadowMap[m]=L,E++}m++}else if(O.isRectAreaLight){const D=t.get(O);D.color.copy(I).multiplyScalar(F),D.halfWidth.set(O.width*.5,0,0),D.halfHeight.set(0,O.height*.5,0),i.rectArea[x]=D,x++}else if(O.isPointLight){const D=t.get(O);if(D.color.copy(O.color).multiplyScalar(O.intensity*T),D.distance=O.distance,D.decay=O.decay,O.castShadow){const z=O.shadow,K=r.get(O);K.shadowBias=z.bias,K.shadowNormalBias=z.normalBias,K.shadowRadius=z.radius,K.shadowMapSize=z.mapSize,K.shadowCameraNear=z.camera.near,K.shadowCameraFar=z.camera.far,i.pointShadow[g]=K,i.pointShadowMap[g]=L,i.pointShadowMatrix[g]=O.shadow.matrix,w++}i.point[g]=D,g++}else if(O.isHemisphereLight){const D=t.get(O);D.skyColor.copy(O.color).multiplyScalar(F*T),D.groundColor.copy(O.groundColor).multiplyScalar(F*T),i.hemi[_]=D,_++}}x>0&&(e.isWebGL2?n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=ke.LTC_FLOAT_1,i.rectAreaLTC2=ke.LTC_FLOAT_2):(i.rectAreaLTC1=ke.LTC_HALF_1,i.rectAreaLTC2=ke.LTC_HALF_2):n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=ke.LTC_FLOAT_1,i.rectAreaLTC2=ke.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(i.rectAreaLTC1=ke.LTC_HALF_1,i.rectAreaLTC2=ke.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=h,i.ambient[1]=p,i.ambient[2]=y;const P=i.hash;(P.directionalLength!==v||P.pointLength!==g||P.spotLength!==m||P.rectAreaLength!==x||P.hemiLength!==_||P.numDirectionalShadows!==b||P.numPointShadows!==w||P.numSpotShadows!==E||P.numSpotMaps!==S||P.numLightProbes!==N)&&(i.directional.length=v,i.spot.length=m,i.rectArea.length=x,i.point.length=g,i.hemi.length=_,i.directionalShadow.length=b,i.directionalShadowMap.length=b,i.pointShadow.length=w,i.pointShadowMap.length=w,i.spotShadow.length=E,i.spotShadowMap.length=E,i.directionalShadowMatrix.length=b,i.pointShadowMatrix.length=w,i.spotLightMatrix.length=E+S-M,i.spotLightMap.length=S,i.numSpotLightShadowsWithMaps=M,i.numLightProbes=N,P.directionalLength=v,P.pointLength=g,P.spotLength=m,P.rectAreaLength=x,P.hemiLength=_,P.numDirectionalShadows=b,P.numPointShadows=w,P.numSpotShadows=E,P.numSpotMaps=S,P.numLightProbes=N,i.version=J9++)}function c(u,d){let h=0,p=0,y=0,v=0,g=0;const m=d.matrixWorldInverse;for(let x=0,_=u.length;x<_;x++){const b=u[x];if(b.isDirectionalLight){const w=i.directional[h];w.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(m),h++}else if(b.isSpotLight){const w=i.spot[y];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(m),w.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(m),y++}else if(b.isRectAreaLight){const w=i.rectArea[v];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(m),o.identity(),a.copy(b.matrixWorld),a.premultiply(m),o.extractRotation(a),w.halfWidth.set(b.width*.5,0,0),w.halfHeight.set(0,b.height*.5,0),w.halfWidth.applyMatrix4(o),w.halfHeight.applyMatrix4(o),v++}else if(b.isPointLight){const w=i.point[p];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(m),p++}else if(b.isHemisphereLight){const w=i.hemi[g];w.direction.setFromMatrixPosition(b.matrixWorld),w.direction.transformDirection(m),g++}}}return{setup:l,setupView:c,state:i}}function rC(n,e){const t=new e7(n,e),r=[],i=[];function s(){r.length=0,i.length=0}function a(d){r.push(d)}function o(d){i.push(d)}function l(d){t.setup(r,d)}function c(d){t.setupView(r,d)}return{init:s,state:{lightsArray:r,shadowsArray:i,lights:t},setupLights:l,setupLightsView:c,pushLight:a,pushShadow:o}}function t7(n,e){let t=new WeakMap;function r(s,a=0){const o=t.get(s);let l;return o===void 0?(l=new rC(n,e),t.set(s,[l])):a>=o.length?(l=new rC(n,e),o.push(l)):l=o[a],l}function i(){t=new WeakMap}return{get:r,dispose:i}}class n7 extends zp{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=XH,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class r7 extends zp{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const i7=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,s7=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function a7(n,e,t){let r=new pj;const i=new Rt,s=new Rt,a=new Un,o=new n7({depthPacking:YH}),l=new r7,c={},u=t.maxTextureSize,d={[Bo]:Br,[Br]:Bo,[da]:da},h=new zo({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Rt},radius:{value:4}},vertexShader:i7,fragmentShader:s7}),p=h.clone();p.defines.HORIZONTAL_PASS=1;const y=new ja;y.setAttribute("position",new Ji(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const v=new ga(y,h),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=HI;let m=this.type;this.render=function(E,S,M){if(g.enabled===!1||g.autoUpdate===!1&&g.needsUpdate===!1||E.length===0)return;const N=n.getRenderTarget(),T=n.getActiveCubeFace(),P=n.getActiveMipmapLevel(),H=n.state;H.setBlending(Oo),H.buffers.color.setClear(1,1,1,1),H.buffers.depth.setTest(!0),H.setScissorTest(!1);const W=m!==ta&&this.type===ta,O=m===ta&&this.type!==ta;for(let I=0,F=E.length;I<F;I++){const j=E[I],L=j.shadow;if(L===void 0){console.warn("THREE.WebGLShadowMap:",j,"has no shadow.");continue}if(L.autoUpdate===!1&&L.needsUpdate===!1)continue;i.copy(L.mapSize);const D=L.getFrameExtents();if(i.multiply(D),s.copy(L.mapSize),(i.x>u||i.y>u)&&(i.x>u&&(s.x=Math.floor(u/D.x),i.x=s.x*D.x,L.mapSize.x=s.x),i.y>u&&(s.y=Math.floor(u/D.y),i.y=s.y*D.y,L.mapSize.y=s.y)),L.map===null||W===!0||O===!0){const K=this.type!==ta?{minFilter:gr,magFilter:gr}:{};L.map!==null&&L.map.dispose(),L.map=new ac(i.x,i.y,K),L.map.texture.name=j.name+".shadowMap",L.camera.updateProjectionMatrix()}n.setRenderTarget(L.map),n.clear();const z=L.getViewportCount();for(let K=0;K<z;K++){const re=L.getViewport(K);a.set(s.x*re.x,s.y*re.y,s.x*re.z,s.y*re.w),H.viewport(a),L.updateMatrices(j,K),r=L.getFrustum(),b(S,M,L.camera,j,this.type)}L.isPointLightShadow!==!0&&this.type===ta&&x(L,M),L.needsUpdate=!1}m=this.type,g.needsUpdate=!1,n.setRenderTarget(N,T,P)};function x(E,S){const M=e.update(v);h.defines.VSM_SAMPLES!==E.blurSamples&&(h.defines.VSM_SAMPLES=E.blurSamples,p.defines.VSM_SAMPLES=E.blurSamples,h.needsUpdate=!0,p.needsUpdate=!0),E.mapPass===null&&(E.mapPass=new ac(i.x,i.y)),h.uniforms.shadow_pass.value=E.map.texture,h.uniforms.resolution.value=E.mapSize,h.uniforms.radius.value=E.radius,n.setRenderTarget(E.mapPass),n.clear(),n.renderBufferDirect(S,null,M,h,v,null),p.uniforms.shadow_pass.value=E.mapPass.texture,p.uniforms.resolution.value=E.mapSize,p.uniforms.radius.value=E.radius,n.setRenderTarget(E.map),n.clear(),n.renderBufferDirect(S,null,M,p,v,null)}function _(E,S,M,N){let T=null;const P=M.isPointLight===!0?E.customDistanceMaterial:E.customDepthMaterial;if(P!==void 0)T=P;else if(T=M.isPointLight===!0?l:o,n.localClippingEnabled&&S.clipShadows===!0&&Array.isArray(S.clippingPlanes)&&S.clippingPlanes.length!==0||S.displacementMap&&S.displacementScale!==0||S.alphaMap&&S.alphaTest>0||S.map&&S.alphaTest>0){const H=T.uuid,W=S.uuid;let O=c[H];O===void 0&&(O={},c[H]=O);let I=O[W];I===void 0&&(I=T.clone(),O[W]=I,S.addEventListener("dispose",w)),T=I}if(T.visible=S.visible,T.wireframe=S.wireframe,N===ta?T.side=S.shadowSide!==null?S.shadowSide:S.side:T.side=S.shadowSide!==null?S.shadowSide:d[S.side],T.alphaMap=S.alphaMap,T.alphaTest=S.alphaTest,T.map=S.map,T.clipShadows=S.clipShadows,T.clippingPlanes=S.clippingPlanes,T.clipIntersection=S.clipIntersection,T.displacementMap=S.displacementMap,T.displacementScale=S.displacementScale,T.displacementBias=S.displacementBias,T.wireframeLinewidth=S.wireframeLinewidth,T.linewidth=S.linewidth,M.isPointLight===!0&&T.isMeshDistanceMaterial===!0){const H=n.properties.get(T);H.light=M}return T}function b(E,S,M,N,T){if(E.visible===!1)return;if(E.layers.test(S.layers)&&(E.isMesh||E.isLine||E.isPoints)&&(E.castShadow||E.receiveShadow&&T===ta)&&(!E.frustumCulled||r.intersectsObject(E))){E.modelViewMatrix.multiplyMatrices(M.matrixWorldInverse,E.matrixWorld);const W=e.update(E),O=E.material;if(Array.isArray(O)){const I=W.groups;for(let F=0,j=I.length;F<j;F++){const L=I[F],D=O[L.materialIndex];if(D&&D.visible){const z=_(E,D,N,T);E.onBeforeShadow(n,E,S,M,W,z,L),n.renderBufferDirect(M,null,W,z,E,L),E.onAfterShadow(n,E,S,M,W,z,L)}}}else if(O.visible){const I=_(E,O,N,T);E.onBeforeShadow(n,E,S,M,W,I,null),n.renderBufferDirect(M,null,W,I,E,null),E.onAfterShadow(n,E,S,M,W,I,null)}}const H=E.children;for(let W=0,O=H.length;W<O;W++)b(H[W],S,M,N,T)}function w(E){E.target.removeEventListener("dispose",w);for(const M in c){const N=c[M],T=E.target.uuid;T in N&&(N[T].dispose(),delete N[T])}}}function o7(n,e,t){const r=t.isWebGL2;function i(){let $=!1;const Ce=new Un;let J=null;const Te=new Un(0,0,0,0);return{setMask:function(Ne){J!==Ne&&!$&&(n.colorMask(Ne,Ne,Ne,Ne),J=Ne)},setLocked:function(Ne){$=Ne},setClear:function(Ne,vt,Ut,Dn,hi){hi===!0&&(Ne*=Dn,vt*=Dn,Ut*=Dn),Ce.set(Ne,vt,Ut,Dn),Te.equals(Ce)===!1&&(n.clearColor(Ne,vt,Ut,Dn),Te.copy(Ce))},reset:function(){$=!1,J=null,Te.set(-1,0,0,0)}}}function s(){let $=!1,Ce=null,J=null,Te=null;return{setTest:function(Ne){Ne?X(n.DEPTH_TEST):pe(n.DEPTH_TEST)},setMask:function(Ne){Ce!==Ne&&!$&&(n.depthMask(Ne),Ce=Ne)},setFunc:function(Ne){if(J!==Ne){switch(Ne){case EH:n.depthFunc(n.NEVER);break;case TH:n.depthFunc(n.ALWAYS);break;case MH:n.depthFunc(n.LESS);break;case Qy:n.depthFunc(n.LEQUAL);break;case kH:n.depthFunc(n.EQUAL);break;case AH:n.depthFunc(n.GEQUAL);break;case PH:n.depthFunc(n.GREATER);break;case CH:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}J=Ne}},setLocked:function(Ne){$=Ne},setClear:function(Ne){Te!==Ne&&(n.clearDepth(Ne),Te=Ne)},reset:function(){$=!1,Ce=null,J=null,Te=null}}}function a(){let $=!1,Ce=null,J=null,Te=null,Ne=null,vt=null,Ut=null,Dn=null,hi=null;return{setTest:function(Bt){$||(Bt?X(n.STENCIL_TEST):pe(n.STENCIL_TEST))},setMask:function(Bt){Ce!==Bt&&!$&&(n.stencilMask(Bt),Ce=Bt)},setFunc:function(Bt,cr,ds){(J!==Bt||Te!==cr||Ne!==ds)&&(n.stencilFunc(Bt,cr,ds),J=Bt,Te=cr,Ne=ds)},setOp:function(Bt,cr,ds){(vt!==Bt||Ut!==cr||Dn!==ds)&&(n.stencilOp(Bt,cr,ds),vt=Bt,Ut=cr,Dn=ds)},setLocked:function(Bt){$=Bt},setClear:function(Bt){hi!==Bt&&(n.clearStencil(Bt),hi=Bt)},reset:function(){$=!1,Ce=null,J=null,Te=null,Ne=null,vt=null,Ut=null,Dn=null,hi=null}}}const o=new i,l=new s,c=new a,u=new WeakMap,d=new WeakMap;let h={},p={},y=new WeakMap,v=[],g=null,m=!1,x=null,_=null,b=null,w=null,E=null,S=null,M=null,N=new It(0,0,0),T=0,P=!1,H=null,W=null,O=null,I=null,F=null;const j=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let L=!1,D=0;const z=n.getParameter(n.VERSION);z.indexOf("WebGL")!==-1?(D=parseFloat(/^WebGL (\d)/.exec(z)[1]),L=D>=1):z.indexOf("OpenGL ES")!==-1&&(D=parseFloat(/^OpenGL ES (\d)/.exec(z)[1]),L=D>=2);let K=null,re={};const Se=n.getParameter(n.SCISSOR_BOX),G=n.getParameter(n.VIEWPORT),ne=new Un().fromArray(Se),ye=new Un().fromArray(G);function se($,Ce,J,Te){const Ne=new Uint8Array(4),vt=n.createTexture();n.bindTexture($,vt),n.texParameteri($,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri($,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let Ut=0;Ut<J;Ut++)r&&($===n.TEXTURE_3D||$===n.TEXTURE_2D_ARRAY)?n.texImage3D(Ce,0,n.RGBA,1,1,Te,0,n.RGBA,n.UNSIGNED_BYTE,Ne):n.texImage2D(Ce+Ut,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Ne);return vt}const U={};U[n.TEXTURE_2D]=se(n.TEXTURE_2D,n.TEXTURE_2D,1),U[n.TEXTURE_CUBE_MAP]=se(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),r&&(U[n.TEXTURE_2D_ARRAY]=se(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),U[n.TEXTURE_3D]=se(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),o.setClear(0,0,0,1),l.setClear(1),c.setClear(0),X(n.DEPTH_TEST),l.setFunc(Qy),ce(!1),V(IA),X(n.CULL_FACE),Ee(Oo);function X($){h[$]!==!0&&(n.enable($),h[$]=!0)}function pe($){h[$]!==!1&&(n.disable($),h[$]=!1)}function ue($,Ce){return p[$]!==Ce?(n.bindFramebuffer($,Ce),p[$]=Ce,r&&($===n.DRAW_FRAMEBUFFER&&(p[n.FRAMEBUFFER]=Ce),$===n.FRAMEBUFFER&&(p[n.DRAW_FRAMEBUFFER]=Ce)),!0):!1}function B($,Ce){let J=v,Te=!1;if($){J=y.get(Ce),J===void 0&&(J=[],y.set(Ce,J));const Ne=$.textures;if(J.length!==Ne.length||J[0]!==n.COLOR_ATTACHMENT0){for(let vt=0,Ut=Ne.length;vt<Ut;vt++)J[vt]=n.COLOR_ATTACHMENT0+vt;J.length=Ne.length,Te=!0}}else J[0]!==n.BACK&&(J[0]=n.BACK,Te=!0);if(Te)if(t.isWebGL2)n.drawBuffers(J);else if(e.has("WEBGL_draw_buffers")===!0)e.get("WEBGL_draw_buffers").drawBuffersWEBGL(J);else throw new Error("THREE.WebGLState: Usage of gl.drawBuffers() require WebGL2 or WEBGL_draw_buffers extension")}function He($){return g!==$?(n.useProgram($),g=$,!0):!1}const fe={[Al]:n.FUNC_ADD,[cH]:n.FUNC_SUBTRACT,[uH]:n.FUNC_REVERSE_SUBTRACT};if(r)fe[BA]=n.MIN,fe[zA]=n.MAX;else{const $=e.get("EXT_blend_minmax");$!==null&&(fe[BA]=$.MIN_EXT,fe[zA]=$.MAX_EXT)}const me={[dH]:n.ZERO,[hH]:n.ONE,[fH]:n.SRC_COLOR,[fS]:n.SRC_ALPHA,[xH]:n.SRC_ALPHA_SATURATE,[yH]:n.DST_COLOR,[mH]:n.DST_ALPHA,[pH]:n.ONE_MINUS_SRC_COLOR,[pS]:n.ONE_MINUS_SRC_ALPHA,[vH]:n.ONE_MINUS_DST_COLOR,[gH]:n.ONE_MINUS_DST_ALPHA,[_H]:n.CONSTANT_COLOR,[bH]:n.ONE_MINUS_CONSTANT_COLOR,[wH]:n.CONSTANT_ALPHA,[SH]:n.ONE_MINUS_CONSTANT_ALPHA};function Ee($,Ce,J,Te,Ne,vt,Ut,Dn,hi,Bt){if($===Oo){m===!0&&(pe(n.BLEND),m=!1);return}if(m===!1&&(X(n.BLEND),m=!0),$!==lH){if($!==x||Bt!==P){if((_!==Al||E!==Al)&&(n.blendEquation(n.FUNC_ADD),_=Al,E=Al),Bt)switch($){case $u:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case jA:n.blendFunc(n.ONE,n.ONE);break;case FA:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case UA:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",$);break}else switch($){case $u:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case jA:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case FA:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case UA:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",$);break}b=null,w=null,S=null,M=null,N.set(0,0,0),T=0,x=$,P=Bt}return}Ne=Ne||Ce,vt=vt||J,Ut=Ut||Te,(Ce!==_||Ne!==E)&&(n.blendEquationSeparate(fe[Ce],fe[Ne]),_=Ce,E=Ne),(J!==b||Te!==w||vt!==S||Ut!==M)&&(n.blendFuncSeparate(me[J],me[Te],me[vt],me[Ut]),b=J,w=Te,S=vt,M=Ut),(Dn.equals(N)===!1||hi!==T)&&(n.blendColor(Dn.r,Dn.g,Dn.b,hi),N.copy(Dn),T=hi),x=$,P=!1}function xe($,Ce){$.side===da?pe(n.CULL_FACE):X(n.CULL_FACE);let J=$.side===Br;Ce&&(J=!J),ce(J),$.blending===$u&&$.transparent===!1?Ee(Oo):Ee($.blending,$.blendEquation,$.blendSrc,$.blendDst,$.blendEquationAlpha,$.blendSrcAlpha,$.blendDstAlpha,$.blendColor,$.blendAlpha,$.premultipliedAlpha),l.setFunc($.depthFunc),l.setTest($.depthTest),l.setMask($.depthWrite),o.setMask($.colorWrite);const Te=$.stencilWrite;c.setTest(Te),Te&&(c.setMask($.stencilWriteMask),c.setFunc($.stencilFunc,$.stencilRef,$.stencilFuncMask),c.setOp($.stencilFail,$.stencilZFail,$.stencilZPass)),C($.polygonOffset,$.polygonOffsetFactor,$.polygonOffsetUnits),$.alphaToCoverage===!0?X(n.SAMPLE_ALPHA_TO_COVERAGE):pe(n.SAMPLE_ALPHA_TO_COVERAGE)}function ce($){H!==$&&($?n.frontFace(n.CW):n.frontFace(n.CCW),H=$)}function V($){$!==sH?(X(n.CULL_FACE),$!==W&&($===IA?n.cullFace(n.BACK):$===aH?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):pe(n.CULL_FACE),W=$}function le($){$!==O&&(L&&n.lineWidth($),O=$)}function C($,Ce,J){$?(X(n.POLYGON_OFFSET_FILL),(I!==Ce||F!==J)&&(n.polygonOffset(Ce,J),I=Ce,F=J)):pe(n.POLYGON_OFFSET_FILL)}function A($){$?X(n.SCISSOR_TEST):pe(n.SCISSOR_TEST)}function Y($){$===void 0&&($=n.TEXTURE0+j-1),K!==$&&(n.activeTexture($),K=$)}function de($,Ce,J){J===void 0&&(K===null?J=n.TEXTURE0+j-1:J=K);let Te=re[J];Te===void 0&&(Te={type:void 0,texture:void 0},re[J]=Te),(Te.type!==$||Te.texture!==Ce)&&(K!==J&&(n.activeTexture(J),K=J),n.bindTexture($,Ce||U[$]),Te.type=$,Te.texture=Ce)}function be(){const $=re[K];$!==void 0&&$.type!==void 0&&(n.bindTexture($.type,null),$.type=void 0,$.texture=void 0)}function ge(){try{n.compressedTexImage2D.apply(n,arguments)}catch($){console.error("THREE.WebGLState:",$)}}function Ze(){try{n.compressedTexImage3D.apply(n,arguments)}catch($){console.error("THREE.WebGLState:",$)}}function We(){try{n.texSubImage2D.apply(n,arguments)}catch($){console.error("THREE.WebGLState:",$)}}function ae(){try{n.texSubImage3D.apply(n,arguments)}catch($){console.error("THREE.WebGLState:",$)}}function oe(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch($){console.error("THREE.WebGLState:",$)}}function Pe(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch($){console.error("THREE.WebGLState:",$)}}function he(){try{n.texStorage2D.apply(n,arguments)}catch($){console.error("THREE.WebGLState:",$)}}function ze(){try{n.texStorage3D.apply(n,arguments)}catch($){console.error("THREE.WebGLState:",$)}}function Ue(){try{n.texImage2D.apply(n,arguments)}catch($){console.error("THREE.WebGLState:",$)}}function De(){try{n.texImage3D.apply(n,arguments)}catch($){console.error("THREE.WebGLState:",$)}}function Me($){ne.equals($)===!1&&(n.scissor($.x,$.y,$.z,$.w),ne.copy($))}function Be($){ye.equals($)===!1&&(n.viewport($.x,$.y,$.z,$.w),ye.copy($))}function St($,Ce){let J=d.get(Ce);J===void 0&&(J=new WeakMap,d.set(Ce,J));let Te=J.get($);Te===void 0&&(Te=n.getUniformBlockIndex(Ce,$.name),J.set($,Te))}function tt($,Ce){const Te=d.get(Ce).get($);u.get(Ce)!==Te&&(n.uniformBlockBinding(Ce,Te,$.__bindingPointIndex),u.set(Ce,Te))}function Yt(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),r===!0&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),h={},K=null,re={},p={},y=new WeakMap,v=[],g=null,m=!1,x=null,_=null,b=null,w=null,E=null,S=null,M=null,N=new It(0,0,0),T=0,P=!1,H=null,W=null,O=null,I=null,F=null,ne.set(0,0,n.canvas.width,n.canvas.height),ye.set(0,0,n.canvas.width,n.canvas.height),o.reset(),l.reset(),c.reset()}return{buffers:{color:o,depth:l,stencil:c},enable:X,disable:pe,bindFramebuffer:ue,drawBuffers:B,useProgram:He,setBlending:Ee,setMaterial:xe,setFlipSided:ce,setCullFace:V,setLineWidth:le,setPolygonOffset:C,setScissorTest:A,activeTexture:Y,bindTexture:de,unbindTexture:be,compressedTexImage2D:ge,compressedTexImage3D:Ze,texImage2D:Ue,texImage3D:De,updateUBOMapping:St,uniformBlockBinding:tt,texStorage2D:he,texStorage3D:ze,texSubImage2D:We,texSubImage3D:ae,compressedTexSubImage2D:oe,compressedTexSubImage3D:Pe,scissor:Me,viewport:Be,reset:Yt}}function l7(n,e,t,r,i,s,a){const o=i.isWebGL2,l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,c=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),u=new Rt,d=new WeakMap;let h;const p=new WeakMap;let y=!1;try{y=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function v(C,A){return y?new OffscreenCanvas(C,A):i0("canvas")}function g(C,A,Y,de){let be=1;const ge=le(C);if((ge.width>de||ge.height>de)&&(be=de/Math.max(ge.width,ge.height)),be<1||A===!0)if(typeof HTMLImageElement<"u"&&C instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&C instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&C instanceof ImageBitmap||typeof VideoFrame<"u"&&C instanceof VideoFrame){const Ze=A?bS:Math.floor,We=Ze(be*ge.width),ae=Ze(be*ge.height);h===void 0&&(h=v(We,ae));const oe=Y?v(We,ae):h;return oe.width=We,oe.height=ae,oe.getContext("2d").drawImage(C,0,0,We,ae),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ge.width+"x"+ge.height+") to ("+We+"x"+ae+")."),oe}else return"data"in C&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ge.width+"x"+ge.height+")."),C;return C}function m(C){const A=le(C);return yP(A.width)&&yP(A.height)}function x(C){return o?!1:C.wrapS!==Wi||C.wrapT!==Wi||C.minFilter!==gr&&C.minFilter!==Rr}function _(C,A){return C.generateMipmaps&&A&&C.minFilter!==gr&&C.minFilter!==Rr}function b(C){n.generateMipmap(C)}function w(C,A,Y,de,be=!1){if(o===!1)return A;if(C!==null){if(n[C]!==void 0)return n[C];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+C+"'")}let ge=A;if(A===n.RED&&(Y===n.FLOAT&&(ge=n.R32F),Y===n.HALF_FLOAT&&(ge=n.R16F),Y===n.UNSIGNED_BYTE&&(ge=n.R8)),A===n.RED_INTEGER&&(Y===n.UNSIGNED_BYTE&&(ge=n.R8UI),Y===n.UNSIGNED_SHORT&&(ge=n.R16UI),Y===n.UNSIGNED_INT&&(ge=n.R32UI),Y===n.BYTE&&(ge=n.R8I),Y===n.SHORT&&(ge=n.R16I),Y===n.INT&&(ge=n.R32I)),A===n.RG&&(Y===n.FLOAT&&(ge=n.RG32F),Y===n.HALF_FLOAT&&(ge=n.RG16F),Y===n.UNSIGNED_BYTE&&(ge=n.RG8)),A===n.RG_INTEGER&&(Y===n.UNSIGNED_BYTE&&(ge=n.RG8UI),Y===n.UNSIGNED_SHORT&&(ge=n.RG16UI),Y===n.UNSIGNED_INT&&(ge=n.RG32UI),Y===n.BYTE&&(ge=n.RG8I),Y===n.SHORT&&(ge=n.RG16I),Y===n.INT&&(ge=n.RG32I)),A===n.RGBA){const Ze=be?e0:Ft.getTransfer(de);Y===n.FLOAT&&(ge=n.RGBA32F),Y===n.HALF_FLOAT&&(ge=n.RGBA16F),Y===n.UNSIGNED_BYTE&&(ge=Ze===Gt?n.SRGB8_ALPHA8:n.RGBA8),Y===n.UNSIGNED_SHORT_4_4_4_4&&(ge=n.RGBA4),Y===n.UNSIGNED_SHORT_5_5_5_1&&(ge=n.RGB5_A1)}return(ge===n.R16F||ge===n.R32F||ge===n.RG16F||ge===n.RG32F||ge===n.RGBA16F||ge===n.RGBA32F)&&e.get("EXT_color_buffer_float"),ge}function E(C,A,Y){return _(C,Y)===!0||C.isFramebufferTexture&&C.minFilter!==gr&&C.minFilter!==Rr?Math.log2(Math.max(A.width,A.height))+1:C.mipmaps!==void 0&&C.mipmaps.length>0?C.mipmaps.length:C.isCompressedTexture&&Array.isArray(C.image)?A.mipmaps.length:1}function S(C){return C===gr||C===$A||C===Jd?n.NEAREST:n.LINEAR}function M(C){const A=C.target;A.removeEventListener("dispose",M),T(A),A.isVideoTexture&&d.delete(A)}function N(C){const A=C.target;A.removeEventListener("dispose",N),H(A)}function T(C){const A=r.get(C);if(A.__webglInit===void 0)return;const Y=C.source,de=p.get(Y);if(de){const be=de[A.__cacheKey];be.usedTimes--,be.usedTimes===0&&P(C),Object.keys(de).length===0&&p.delete(Y)}r.remove(C)}function P(C){const A=r.get(C);n.deleteTexture(A.__webglTexture);const Y=C.source,de=p.get(Y);delete de[A.__cacheKey],a.memory.textures--}function H(C){const A=r.get(C);if(C.depthTexture&&C.depthTexture.dispose(),C.isWebGLCubeRenderTarget)for(let de=0;de<6;de++){if(Array.isArray(A.__webglFramebuffer[de]))for(let be=0;be<A.__webglFramebuffer[de].length;be++)n.deleteFramebuffer(A.__webglFramebuffer[de][be]);else n.deleteFramebuffer(A.__webglFramebuffer[de]);A.__webglDepthbuffer&&n.deleteRenderbuffer(A.__webglDepthbuffer[de])}else{if(Array.isArray(A.__webglFramebuffer))for(let de=0;de<A.__webglFramebuffer.length;de++)n.deleteFramebuffer(A.__webglFramebuffer[de]);else n.deleteFramebuffer(A.__webglFramebuffer);if(A.__webglDepthbuffer&&n.deleteRenderbuffer(A.__webglDepthbuffer),A.__webglMultisampledFramebuffer&&n.deleteFramebuffer(A.__webglMultisampledFramebuffer),A.__webglColorRenderbuffer)for(let de=0;de<A.__webglColorRenderbuffer.length;de++)A.__webglColorRenderbuffer[de]&&n.deleteRenderbuffer(A.__webglColorRenderbuffer[de]);A.__webglDepthRenderbuffer&&n.deleteRenderbuffer(A.__webglDepthRenderbuffer)}const Y=C.textures;for(let de=0,be=Y.length;de<be;de++){const ge=r.get(Y[de]);ge.__webglTexture&&(n.deleteTexture(ge.__webglTexture),a.memory.textures--),r.remove(Y[de])}r.remove(C)}let W=0;function O(){W=0}function I(){const C=W;return C>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+C+" texture units while this GPU supports only "+i.maxTextures),W+=1,C}function F(C){const A=[];return A.push(C.wrapS),A.push(C.wrapT),A.push(C.wrapR||0),A.push(C.magFilter),A.push(C.minFilter),A.push(C.anisotropy),A.push(C.internalFormat),A.push(C.format),A.push(C.type),A.push(C.generateMipmaps),A.push(C.premultiplyAlpha),A.push(C.flipY),A.push(C.unpackAlignment),A.push(C.colorSpace),A.join()}function j(C,A){const Y=r.get(C);if(C.isVideoTexture&&ce(C),C.isRenderTargetTexture===!1&&C.version>0&&Y.__version!==C.version){const de=C.image;if(de===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(de.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ye(Y,C,A);return}}t.bindTexture(n.TEXTURE_2D,Y.__webglTexture,n.TEXTURE0+A)}function L(C,A){const Y=r.get(C);if(C.version>0&&Y.__version!==C.version){ye(Y,C,A);return}t.bindTexture(n.TEXTURE_2D_ARRAY,Y.__webglTexture,n.TEXTURE0+A)}function D(C,A){const Y=r.get(C);if(C.version>0&&Y.__version!==C.version){ye(Y,C,A);return}t.bindTexture(n.TEXTURE_3D,Y.__webglTexture,n.TEXTURE0+A)}function z(C,A){const Y=r.get(C);if(C.version>0&&Y.__version!==C.version){se(Y,C,A);return}t.bindTexture(n.TEXTURE_CUBE_MAP,Y.__webglTexture,n.TEXTURE0+A)}const K={[yS]:n.REPEAT,[Wi]:n.CLAMP_TO_EDGE,[vS]:n.MIRRORED_REPEAT},re={[gr]:n.NEAREST,[$A]:n.NEAREST_MIPMAP_NEAREST,[Jd]:n.NEAREST_MIPMAP_LINEAR,[Rr]:n.LINEAR,[l_]:n.LINEAR_MIPMAP_NEAREST,[Dl]:n.LINEAR_MIPMAP_LINEAR},Se={[JH]:n.NEVER,[iW]:n.ALWAYS,[QH]:n.LESS,[ej]:n.LEQUAL,[eW]:n.EQUAL,[rW]:n.GEQUAL,[tW]:n.GREATER,[nW]:n.NOTEQUAL};function G(C,A,Y){if(A.type===ha&&e.has("OES_texture_float_linear")===!1&&(A.magFilter===Rr||A.magFilter===l_||A.magFilter===Jd||A.magFilter===Dl||A.minFilter===Rr||A.minFilter===l_||A.minFilter===Jd||A.minFilter===Dl)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),Y?(n.texParameteri(C,n.TEXTURE_WRAP_S,K[A.wrapS]),n.texParameteri(C,n.TEXTURE_WRAP_T,K[A.wrapT]),(C===n.TEXTURE_3D||C===n.TEXTURE_2D_ARRAY)&&n.texParameteri(C,n.TEXTURE_WRAP_R,K[A.wrapR]),n.texParameteri(C,n.TEXTURE_MAG_FILTER,re[A.magFilter]),n.texParameteri(C,n.TEXTURE_MIN_FILTER,re[A.minFilter])):(n.texParameteri(C,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(C,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(C===n.TEXTURE_3D||C===n.TEXTURE_2D_ARRAY)&&n.texParameteri(C,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(A.wrapS!==Wi||A.wrapT!==Wi)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(C,n.TEXTURE_MAG_FILTER,S(A.magFilter)),n.texParameteri(C,n.TEXTURE_MIN_FILTER,S(A.minFilter)),A.minFilter!==gr&&A.minFilter!==Rr&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),A.compareFunction&&(n.texParameteri(C,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(C,n.TEXTURE_COMPARE_FUNC,Se[A.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(A.magFilter===gr||A.minFilter!==Jd&&A.minFilter!==Dl||A.type===ha&&e.has("OES_texture_float_linear")===!1||o===!1&&A.type===Kf&&e.has("OES_texture_half_float_linear")===!1)return;if(A.anisotropy>1||r.get(A).__currentAnisotropy){const de=e.get("EXT_texture_filter_anisotropic");n.texParameterf(C,de.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(A.anisotropy,i.getMaxAnisotropy())),r.get(A).__currentAnisotropy=A.anisotropy}}}function ne(C,A){let Y=!1;C.__webglInit===void 0&&(C.__webglInit=!0,A.addEventListener("dispose",M));const de=A.source;let be=p.get(de);be===void 0&&(be={},p.set(de,be));const ge=F(A);if(ge!==C.__cacheKey){be[ge]===void 0&&(be[ge]={texture:n.createTexture(),usedTimes:0},a.memory.textures++,Y=!0),be[ge].usedTimes++;const Ze=be[C.__cacheKey];Ze!==void 0&&(be[C.__cacheKey].usedTimes--,Ze.usedTimes===0&&P(A)),C.__cacheKey=ge,C.__webglTexture=be[ge].texture}return Y}function ye(C,A,Y){let de=n.TEXTURE_2D;(A.isDataArrayTexture||A.isCompressedArrayTexture)&&(de=n.TEXTURE_2D_ARRAY),A.isData3DTexture&&(de=n.TEXTURE_3D);const be=ne(C,A),ge=A.source;t.bindTexture(de,C.__webglTexture,n.TEXTURE0+Y);const Ze=r.get(ge);if(ge.version!==Ze.__version||be===!0){t.activeTexture(n.TEXTURE0+Y);const We=Ft.getPrimaries(Ft.workingColorSpace),ae=A.colorSpace===fo?null:Ft.getPrimaries(A.colorSpace),oe=A.colorSpace===fo||We===ae?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,A.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,A.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,A.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,oe);const Pe=x(A)&&m(A.image)===!1;let he=g(A.image,Pe,!1,i.maxTextureSize);he=V(A,he);const ze=m(he)||o,Ue=s.convert(A.format,A.colorSpace);let De=s.convert(A.type),Me=w(A.internalFormat,Ue,De,A.colorSpace,A.isVideoTexture);G(de,A,ze);let Be;const St=A.mipmaps,tt=o&&A.isVideoTexture!==!0&&Me!==QI,Yt=Ze.__version===void 0||be===!0,$=ge.dataReady,Ce=E(A,he,ze);if(A.isDepthTexture)Me=n.DEPTH_COMPONENT,o?A.type===ha?Me=n.DEPTH_COMPONENT32F:A.type===xo?Me=n.DEPTH_COMPONENT24:A.type===Gl?Me=n.DEPTH24_STENCIL8:Me=n.DEPTH_COMPONENT16:A.type===ha&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),A.format===ql&&Me===n.DEPTH_COMPONENT&&A.type!==KE&&A.type!==xo&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),A.type=xo,De=s.convert(A.type)),A.format===ad&&Me===n.DEPTH_COMPONENT&&(Me=n.DEPTH_STENCIL,A.type!==Gl&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),A.type=Gl,De=s.convert(A.type))),Yt&&(tt?t.texStorage2D(n.TEXTURE_2D,1,Me,he.width,he.height):t.texImage2D(n.TEXTURE_2D,0,Me,he.width,he.height,0,Ue,De,null));else if(A.isDataTexture)if(St.length>0&&ze){tt&&Yt&&t.texStorage2D(n.TEXTURE_2D,Ce,Me,St[0].width,St[0].height);for(let J=0,Te=St.length;J<Te;J++)Be=St[J],tt?$&&t.texSubImage2D(n.TEXTURE_2D,J,0,0,Be.width,Be.height,Ue,De,Be.data):t.texImage2D(n.TEXTURE_2D,J,Me,Be.width,Be.height,0,Ue,De,Be.data);A.generateMipmaps=!1}else tt?(Yt&&t.texStorage2D(n.TEXTURE_2D,Ce,Me,he.width,he.height),$&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,he.width,he.height,Ue,De,he.data)):t.texImage2D(n.TEXTURE_2D,0,Me,he.width,he.height,0,Ue,De,he.data);else if(A.isCompressedTexture)if(A.isCompressedArrayTexture){tt&&Yt&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Ce,Me,St[0].width,St[0].height,he.depth);for(let J=0,Te=St.length;J<Te;J++)Be=St[J],A.format!==Gi?Ue!==null?tt?$&&t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,J,0,0,0,Be.width,Be.height,he.depth,Ue,Be.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,J,Me,Be.width,Be.height,he.depth,0,Be.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):tt?$&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,J,0,0,0,Be.width,Be.height,he.depth,Ue,De,Be.data):t.texImage3D(n.TEXTURE_2D_ARRAY,J,Me,Be.width,Be.height,he.depth,0,Ue,De,Be.data)}else{tt&&Yt&&t.texStorage2D(n.TEXTURE_2D,Ce,Me,St[0].width,St[0].height);for(let J=0,Te=St.length;J<Te;J++)Be=St[J],A.format!==Gi?Ue!==null?tt?$&&t.compressedTexSubImage2D(n.TEXTURE_2D,J,0,0,Be.width,Be.height,Ue,Be.data):t.compressedTexImage2D(n.TEXTURE_2D,J,Me,Be.width,Be.height,0,Be.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):tt?$&&t.texSubImage2D(n.TEXTURE_2D,J,0,0,Be.width,Be.height,Ue,De,Be.data):t.texImage2D(n.TEXTURE_2D,J,Me,Be.width,Be.height,0,Ue,De,Be.data)}else if(A.isDataArrayTexture)tt?(Yt&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Ce,Me,he.width,he.height,he.depth),$&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,he.width,he.height,he.depth,Ue,De,he.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,Me,he.width,he.height,he.depth,0,Ue,De,he.data);else if(A.isData3DTexture)tt?(Yt&&t.texStorage3D(n.TEXTURE_3D,Ce,Me,he.width,he.height,he.depth),$&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,he.width,he.height,he.depth,Ue,De,he.data)):t.texImage3D(n.TEXTURE_3D,0,Me,he.width,he.height,he.depth,0,Ue,De,he.data);else if(A.isFramebufferTexture){if(Yt)if(tt)t.texStorage2D(n.TEXTURE_2D,Ce,Me,he.width,he.height);else{let J=he.width,Te=he.height;for(let Ne=0;Ne<Ce;Ne++)t.texImage2D(n.TEXTURE_2D,Ne,Me,J,Te,0,Ue,De,null),J>>=1,Te>>=1}}else if(St.length>0&&ze){if(tt&&Yt){const J=le(St[0]);t.texStorage2D(n.TEXTURE_2D,Ce,Me,J.width,J.height)}for(let J=0,Te=St.length;J<Te;J++)Be=St[J],tt?$&&t.texSubImage2D(n.TEXTURE_2D,J,0,0,Ue,De,Be):t.texImage2D(n.TEXTURE_2D,J,Me,Ue,De,Be);A.generateMipmaps=!1}else if(tt){if(Yt){const J=le(he);t.texStorage2D(n.TEXTURE_2D,Ce,Me,J.width,J.height)}$&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,Ue,De,he)}else t.texImage2D(n.TEXTURE_2D,0,Me,Ue,De,he);_(A,ze)&&b(de),Ze.__version=ge.version,A.onUpdate&&A.onUpdate(A)}C.__version=A.version}function se(C,A,Y){if(A.image.length!==6)return;const de=ne(C,A),be=A.source;t.bindTexture(n.TEXTURE_CUBE_MAP,C.__webglTexture,n.TEXTURE0+Y);const ge=r.get(be);if(be.version!==ge.__version||de===!0){t.activeTexture(n.TEXTURE0+Y);const Ze=Ft.getPrimaries(Ft.workingColorSpace),We=A.colorSpace===fo?null:Ft.getPrimaries(A.colorSpace),ae=A.colorSpace===fo||Ze===We?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,A.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,A.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,A.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,ae);const oe=A.isCompressedTexture||A.image[0].isCompressedTexture,Pe=A.image[0]&&A.image[0].isDataTexture,he=[];for(let J=0;J<6;J++)!oe&&!Pe?he[J]=g(A.image[J],!1,!0,i.maxCubemapSize):he[J]=Pe?A.image[J].image:A.image[J],he[J]=V(A,he[J]);const ze=he[0],Ue=m(ze)||o,De=s.convert(A.format,A.colorSpace),Me=s.convert(A.type),Be=w(A.internalFormat,De,Me,A.colorSpace),St=o&&A.isVideoTexture!==!0,tt=ge.__version===void 0||de===!0,Yt=be.dataReady;let $=E(A,ze,Ue);G(n.TEXTURE_CUBE_MAP,A,Ue);let Ce;if(oe){St&&tt&&t.texStorage2D(n.TEXTURE_CUBE_MAP,$,Be,ze.width,ze.height);for(let J=0;J<6;J++){Ce=he[J].mipmaps;for(let Te=0;Te<Ce.length;Te++){const Ne=Ce[Te];A.format!==Gi?De!==null?St?Yt&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+J,Te,0,0,Ne.width,Ne.height,De,Ne.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+J,Te,Be,Ne.width,Ne.height,0,Ne.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):St?Yt&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+J,Te,0,0,Ne.width,Ne.height,De,Me,Ne.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+J,Te,Be,Ne.width,Ne.height,0,De,Me,Ne.data)}}}else{if(Ce=A.mipmaps,St&&tt){Ce.length>0&&$++;const J=le(he[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,$,Be,J.width,J.height)}for(let J=0;J<6;J++)if(Pe){St?Yt&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+J,0,0,0,he[J].width,he[J].height,De,Me,he[J].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+J,0,Be,he[J].width,he[J].height,0,De,Me,he[J].data);for(let Te=0;Te<Ce.length;Te++){const vt=Ce[Te].image[J].image;St?Yt&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+J,Te+1,0,0,vt.width,vt.height,De,Me,vt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+J,Te+1,Be,vt.width,vt.height,0,De,Me,vt.data)}}else{St?Yt&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+J,0,0,0,De,Me,he[J]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+J,0,Be,De,Me,he[J]);for(let Te=0;Te<Ce.length;Te++){const Ne=Ce[Te];St?Yt&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+J,Te+1,0,0,De,Me,Ne.image[J]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+J,Te+1,Be,De,Me,Ne.image[J])}}}_(A,Ue)&&b(n.TEXTURE_CUBE_MAP),ge.__version=be.version,A.onUpdate&&A.onUpdate(A)}C.__version=A.version}function U(C,A,Y,de,be,ge){const Ze=s.convert(Y.format,Y.colorSpace),We=s.convert(Y.type),ae=w(Y.internalFormat,Ze,We,Y.colorSpace);if(!r.get(A).__hasExternalTextures){const Pe=Math.max(1,A.width>>ge),he=Math.max(1,A.height>>ge);be===n.TEXTURE_3D||be===n.TEXTURE_2D_ARRAY?t.texImage3D(be,ge,ae,Pe,he,A.depth,0,Ze,We,null):t.texImage2D(be,ge,ae,Pe,he,0,Ze,We,null)}t.bindFramebuffer(n.FRAMEBUFFER,C),xe(A)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,de,be,r.get(Y).__webglTexture,0,Ee(A)):(be===n.TEXTURE_2D||be>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&be<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,de,be,r.get(Y).__webglTexture,ge),t.bindFramebuffer(n.FRAMEBUFFER,null)}function X(C,A,Y){if(n.bindRenderbuffer(n.RENDERBUFFER,C),A.depthBuffer&&!A.stencilBuffer){let de=o===!0?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(Y||xe(A)){const be=A.depthTexture;be&&be.isDepthTexture&&(be.type===ha?de=n.DEPTH_COMPONENT32F:be.type===xo&&(de=n.DEPTH_COMPONENT24));const ge=Ee(A);xe(A)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ge,de,A.width,A.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,ge,de,A.width,A.height)}else n.renderbufferStorage(n.RENDERBUFFER,de,A.width,A.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,C)}else if(A.depthBuffer&&A.stencilBuffer){const de=Ee(A);Y&&xe(A)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,de,n.DEPTH24_STENCIL8,A.width,A.height):xe(A)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,de,n.DEPTH24_STENCIL8,A.width,A.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,A.width,A.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,C)}else{const de=A.textures;for(let be=0;be<de.length;be++){const ge=de[be],Ze=s.convert(ge.format,ge.colorSpace),We=s.convert(ge.type),ae=w(ge.internalFormat,Ze,We,ge.colorSpace),oe=Ee(A);Y&&xe(A)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,oe,ae,A.width,A.height):xe(A)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,oe,ae,A.width,A.height):n.renderbufferStorage(n.RENDERBUFFER,ae,A.width,A.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function pe(C,A){if(A&&A.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,C),!(A.depthTexture&&A.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(A.depthTexture).__webglTexture||A.depthTexture.image.width!==A.width||A.depthTexture.image.height!==A.height)&&(A.depthTexture.image.width=A.width,A.depthTexture.image.height=A.height,A.depthTexture.needsUpdate=!0),j(A.depthTexture,0);const de=r.get(A.depthTexture).__webglTexture,be=Ee(A);if(A.depthTexture.format===ql)xe(A)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,de,0,be):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,de,0);else if(A.depthTexture.format===ad)xe(A)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,de,0,be):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,de,0);else throw new Error("Unknown depthTexture format")}function ue(C){const A=r.get(C),Y=C.isWebGLCubeRenderTarget===!0;if(C.depthTexture&&!A.__autoAllocateDepthBuffer){if(Y)throw new Error("target.depthTexture not supported in Cube render targets");pe(A.__webglFramebuffer,C)}else if(Y){A.__webglDepthbuffer=[];for(let de=0;de<6;de++)t.bindFramebuffer(n.FRAMEBUFFER,A.__webglFramebuffer[de]),A.__webglDepthbuffer[de]=n.createRenderbuffer(),X(A.__webglDepthbuffer[de],C,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,A.__webglFramebuffer),A.__webglDepthbuffer=n.createRenderbuffer(),X(A.__webglDepthbuffer,C,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function B(C,A,Y){const de=r.get(C);A!==void 0&&U(de.__webglFramebuffer,C,C.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),Y!==void 0&&ue(C)}function He(C){const A=C.texture,Y=r.get(C),de=r.get(A);C.addEventListener("dispose",N);const be=C.textures,ge=C.isWebGLCubeRenderTarget===!0,Ze=be.length>1,We=m(C)||o;if(Ze||(de.__webglTexture===void 0&&(de.__webglTexture=n.createTexture()),de.__version=A.version,a.memory.textures++),ge){Y.__webglFramebuffer=[];for(let ae=0;ae<6;ae++)if(o&&A.mipmaps&&A.mipmaps.length>0){Y.__webglFramebuffer[ae]=[];for(let oe=0;oe<A.mipmaps.length;oe++)Y.__webglFramebuffer[ae][oe]=n.createFramebuffer()}else Y.__webglFramebuffer[ae]=n.createFramebuffer()}else{if(o&&A.mipmaps&&A.mipmaps.length>0){Y.__webglFramebuffer=[];for(let ae=0;ae<A.mipmaps.length;ae++)Y.__webglFramebuffer[ae]=n.createFramebuffer()}else Y.__webglFramebuffer=n.createFramebuffer();if(Ze)if(i.drawBuffers)for(let ae=0,oe=be.length;ae<oe;ae++){const Pe=r.get(be[ae]);Pe.__webglTexture===void 0&&(Pe.__webglTexture=n.createTexture(),a.memory.textures++)}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(o&&C.samples>0&&xe(C)===!1){Y.__webglMultisampledFramebuffer=n.createFramebuffer(),Y.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,Y.__webglMultisampledFramebuffer);for(let ae=0;ae<be.length;ae++){const oe=be[ae];Y.__webglColorRenderbuffer[ae]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,Y.__webglColorRenderbuffer[ae]);const Pe=s.convert(oe.format,oe.colorSpace),he=s.convert(oe.type),ze=w(oe.internalFormat,Pe,he,oe.colorSpace,C.isXRRenderTarget===!0),Ue=Ee(C);n.renderbufferStorageMultisample(n.RENDERBUFFER,Ue,ze,C.width,C.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+ae,n.RENDERBUFFER,Y.__webglColorRenderbuffer[ae])}n.bindRenderbuffer(n.RENDERBUFFER,null),C.depthBuffer&&(Y.__webglDepthRenderbuffer=n.createRenderbuffer(),X(Y.__webglDepthRenderbuffer,C,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(ge){t.bindTexture(n.TEXTURE_CUBE_MAP,de.__webglTexture),G(n.TEXTURE_CUBE_MAP,A,We);for(let ae=0;ae<6;ae++)if(o&&A.mipmaps&&A.mipmaps.length>0)for(let oe=0;oe<A.mipmaps.length;oe++)U(Y.__webglFramebuffer[ae][oe],C,A,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+ae,oe);else U(Y.__webglFramebuffer[ae],C,A,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+ae,0);_(A,We)&&b(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Ze){for(let ae=0,oe=be.length;ae<oe;ae++){const Pe=be[ae],he=r.get(Pe);t.bindTexture(n.TEXTURE_2D,he.__webglTexture),G(n.TEXTURE_2D,Pe,We),U(Y.__webglFramebuffer,C,Pe,n.COLOR_ATTACHMENT0+ae,n.TEXTURE_2D,0),_(Pe,We)&&b(n.TEXTURE_2D)}t.unbindTexture()}else{let ae=n.TEXTURE_2D;if((C.isWebGL3DRenderTarget||C.isWebGLArrayRenderTarget)&&(o?ae=C.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(ae,de.__webglTexture),G(ae,A,We),o&&A.mipmaps&&A.mipmaps.length>0)for(let oe=0;oe<A.mipmaps.length;oe++)U(Y.__webglFramebuffer[oe],C,A,n.COLOR_ATTACHMENT0,ae,oe);else U(Y.__webglFramebuffer,C,A,n.COLOR_ATTACHMENT0,ae,0);_(A,We)&&b(ae),t.unbindTexture()}C.depthBuffer&&ue(C)}function fe(C){const A=m(C)||o,Y=C.textures;for(let de=0,be=Y.length;de<be;de++){const ge=Y[de];if(_(ge,A)){const Ze=C.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,We=r.get(ge).__webglTexture;t.bindTexture(Ze,We),b(Ze),t.unbindTexture()}}}function me(C){if(o&&C.samples>0&&xe(C)===!1){const A=C.textures,Y=C.width,de=C.height;let be=n.COLOR_BUFFER_BIT;const ge=[],Ze=C.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,We=r.get(C),ae=A.length>1;if(ae)for(let oe=0;oe<A.length;oe++)t.bindFramebuffer(n.FRAMEBUFFER,We.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+oe,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,We.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+oe,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,We.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,We.__webglFramebuffer);for(let oe=0;oe<A.length;oe++){ge.push(n.COLOR_ATTACHMENT0+oe),C.depthBuffer&&ge.push(Ze);const Pe=We.__ignoreDepthValues!==void 0?We.__ignoreDepthValues:!1;if(Pe===!1&&(C.depthBuffer&&(be|=n.DEPTH_BUFFER_BIT),C.stencilBuffer&&(be|=n.STENCIL_BUFFER_BIT)),ae&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,We.__webglColorRenderbuffer[oe]),Pe===!0&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[Ze]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[Ze])),ae){const he=r.get(A[oe]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,he,0)}n.blitFramebuffer(0,0,Y,de,0,0,Y,de,be,n.NEAREST),c&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,ge)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),ae)for(let oe=0;oe<A.length;oe++){t.bindFramebuffer(n.FRAMEBUFFER,We.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+oe,n.RENDERBUFFER,We.__webglColorRenderbuffer[oe]);const Pe=r.get(A[oe]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,We.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+oe,n.TEXTURE_2D,Pe,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,We.__webglMultisampledFramebuffer)}}function Ee(C){return Math.min(i.maxSamples,C.samples)}function xe(C){const A=r.get(C);return o&&C.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&A.__useRenderToTexture!==!1}function ce(C){const A=a.render.frame;d.get(C)!==A&&(d.set(C,A),C.update())}function V(C,A){const Y=C.colorSpace,de=C.format,be=C.type;return C.isCompressedTexture===!0||C.isVideoTexture===!0||C.format===xS||Y!==Jo&&Y!==fo&&(Ft.getTransfer(Y)===Gt?o===!1?e.has("EXT_sRGB")===!0&&de===Gi?(C.format=xS,C.minFilter=Rr,C.generateMipmaps=!1):A=nj.sRGBToLinear(A):(de!==Gi||be!==Do)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Y)),A}function le(C){return typeof HTMLImageElement<"u"&&C instanceof HTMLImageElement?(u.width=C.naturalWidth||C.width,u.height=C.naturalHeight||C.height):typeof VideoFrame<"u"&&C instanceof VideoFrame?(u.width=C.displayWidth,u.height=C.displayHeight):(u.width=C.width,u.height=C.height),u}this.allocateTextureUnit=I,this.resetTextureUnits=O,this.setTexture2D=j,this.setTexture2DArray=L,this.setTexture3D=D,this.setTextureCube=z,this.rebindTextures=B,this.setupRenderTarget=He,this.updateRenderTargetMipmap=fe,this.updateMultisampleRenderTarget=me,this.setupDepthRenderbuffer=ue,this.setupFrameBufferTexture=U,this.useMultisampledRTT=xe}function c7(n,e,t){const r=t.isWebGL2;function i(s,a=fo){let o;const l=Ft.getTransfer(a);if(s===Do)return n.UNSIGNED_BYTE;if(s===XI)return n.UNSIGNED_SHORT_4_4_4_4;if(s===YI)return n.UNSIGNED_SHORT_5_5_5_1;if(s===BH)return n.BYTE;if(s===zH)return n.SHORT;if(s===KE)return n.UNSIGNED_SHORT;if(s===qI)return n.INT;if(s===xo)return n.UNSIGNED_INT;if(s===ha)return n.FLOAT;if(s===Kf)return r?n.HALF_FLOAT:(o=e.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(s===$H)return n.ALPHA;if(s===Gi)return n.RGBA;if(s===VH)return n.LUMINANCE;if(s===HH)return n.LUMINANCE_ALPHA;if(s===ql)return n.DEPTH_COMPONENT;if(s===ad)return n.DEPTH_STENCIL;if(s===xS)return o=e.get("EXT_sRGB"),o!==null?o.SRGB_ALPHA_EXT:null;if(s===WH)return n.RED;if(s===KI)return n.RED_INTEGER;if(s===GH)return n.RG;if(s===ZI)return n.RG_INTEGER;if(s===JI)return n.RGBA_INTEGER;if(s===c_||s===u_||s===d_||s===h_)if(l===Gt)if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(s===c_)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===u_)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===d_)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===h_)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=e.get("WEBGL_compressed_texture_s3tc"),o!==null){if(s===c_)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===u_)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===d_)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===h_)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===VA||s===HA||s===WA||s===GA)if(o=e.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(s===VA)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===HA)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===WA)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===GA)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===QI)return o=e.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===qA||s===XA)if(o=e.get("WEBGL_compressed_texture_etc"),o!==null){if(s===qA)return l===Gt?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(s===XA)return l===Gt?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===YA||s===KA||s===ZA||s===JA||s===QA||s===eP||s===tP||s===nP||s===rP||s===iP||s===sP||s===aP||s===oP||s===lP)if(o=e.get("WEBGL_compressed_texture_astc"),o!==null){if(s===YA)return l===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===KA)return l===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===ZA)return l===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===JA)return l===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===QA)return l===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===eP)return l===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===tP)return l===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===nP)return l===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===rP)return l===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===iP)return l===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===sP)return l===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===aP)return l===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===oP)return l===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===lP)return l===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===f_||s===cP||s===uP)if(o=e.get("EXT_texture_compression_bptc"),o!==null){if(s===f_)return l===Gt?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(s===cP)return o.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(s===uP)return o.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(s===qH||s===dP||s===hP||s===fP)if(o=e.get("EXT_texture_compression_rgtc"),o!==null){if(s===f_)return o.COMPRESSED_RED_RGTC1_EXT;if(s===dP)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===hP)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===fP)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===Gl?r?n.UNSIGNED_INT_24_8:(o=e.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null):n[s]!==void 0?n[s]:null}return{convert:i}}class u7 extends Ei{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Zm extends $r{constructor(){super(),this.isGroup=!0,this.type="Group"}}const d7={type:"move"};class B_{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Zm,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Zm,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Q,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Q),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Zm,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Q,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Q),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let i=null,s=null,a=null;const o=this._targetRay,l=this._grip,c=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(c&&e.hand){a=!0;for(const v of e.hand.values()){const g=t.getJointPose(v,r),m=this._getHandJoint(c,v);g!==null&&(m.matrix.fromArray(g.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.matrixWorldNeedsUpdate=!0,m.jointRadius=g.radius),m.visible=g!==null}const u=c.joints["index-finger-tip"],d=c.joints["thumb-tip"],h=u.position.distanceTo(d.position),p=.02,y=.005;c.inputState.pinching&&h>p+y?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&h<=p-y&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,r),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));o!==null&&(i=t.getPose(e.targetRaySpace,r),i===null&&s!==null&&(i=s),i!==null&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(d7)))}return o!==null&&(o.visible=i!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const r=new Zm;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}}const h7=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,f7=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepthEXT = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepthEXT = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class p7{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,r){if(this.texture===null){const i=new zr,s=e.properties.get(i);s.__webglTexture=t.texture,(t.depthNear!=r.depthNear||t.depthFar!=r.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=i}}render(e,t){if(this.texture!==null){if(this.mesh===null){const r=t.cameras[0].viewport,i=new zo({extensions:{fragDepth:!0},vertexShader:h7,fragmentShader:f7,uniforms:{depthColor:{value:this.texture},depthWidth:{value:r.z},depthHeight:{value:r.w}}});this.mesh=new ga(new bv(20,20),i)}e.render(this.mesh,t)}}reset(){this.texture=null,this.mesh=null}}class m7 extends kd{constructor(e,t){super();const r=this;let i=null,s=1,a=null,o="local-floor",l=1,c=null,u=null,d=null,h=null,p=null,y=null;const v=new p7,g=t.getContextAttributes();let m=null,x=null;const _=[],b=[],w=new Rt;let E=null;const S=new Ei;S.layers.enable(1),S.viewport=new Un;const M=new Ei;M.layers.enable(2),M.viewport=new Un;const N=[S,M],T=new u7;T.layers.enable(1),T.layers.enable(2);let P=null,H=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(G){let ne=_[G];return ne===void 0&&(ne=new B_,_[G]=ne),ne.getTargetRaySpace()},this.getControllerGrip=function(G){let ne=_[G];return ne===void 0&&(ne=new B_,_[G]=ne),ne.getGripSpace()},this.getHand=function(G){let ne=_[G];return ne===void 0&&(ne=new B_,_[G]=ne),ne.getHandSpace()};function W(G){const ne=b.indexOf(G.inputSource);if(ne===-1)return;const ye=_[ne];ye!==void 0&&(ye.update(G.inputSource,G.frame,c||a),ye.dispatchEvent({type:G.type,data:G.inputSource}))}function O(){i.removeEventListener("select",W),i.removeEventListener("selectstart",W),i.removeEventListener("selectend",W),i.removeEventListener("squeeze",W),i.removeEventListener("squeezestart",W),i.removeEventListener("squeezeend",W),i.removeEventListener("end",O),i.removeEventListener("inputsourceschange",I);for(let G=0;G<_.length;G++){const ne=b[G];ne!==null&&(b[G]=null,_[G].disconnect(ne))}P=null,H=null,v.reset(),e.setRenderTarget(m),p=null,h=null,d=null,i=null,x=null,Se.stop(),r.isPresenting=!1,e.setPixelRatio(E),e.setSize(w.width,w.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(G){s=G,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(G){o=G,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||a},this.setReferenceSpace=function(G){c=G},this.getBaseLayer=function(){return h!==null?h:p},this.getBinding=function(){return d},this.getFrame=function(){return y},this.getSession=function(){return i},this.setSession=async function(G){if(i=G,i!==null){if(m=e.getRenderTarget(),i.addEventListener("select",W),i.addEventListener("selectstart",W),i.addEventListener("selectend",W),i.addEventListener("squeeze",W),i.addEventListener("squeezestart",W),i.addEventListener("squeezeend",W),i.addEventListener("end",O),i.addEventListener("inputsourceschange",I),g.xrCompatible!==!0&&await t.makeXRCompatible(),E=e.getPixelRatio(),e.getSize(w),i.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const ne={antialias:i.renderState.layers===void 0?g.antialias:!0,alpha:!0,depth:g.depth,stencil:g.stencil,framebufferScaleFactor:s};p=new XRWebGLLayer(i,t,ne),i.updateRenderState({baseLayer:p}),e.setPixelRatio(1),e.setSize(p.framebufferWidth,p.framebufferHeight,!1),x=new ac(p.framebufferWidth,p.framebufferHeight,{format:Gi,type:Do,colorSpace:e.outputColorSpace,stencilBuffer:g.stencil})}else{let ne=null,ye=null,se=null;g.depth&&(se=g.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,ne=g.stencil?ad:ql,ye=g.stencil?Gl:xo);const U={colorFormat:t.RGBA8,depthFormat:se,scaleFactor:s};d=new XRWebGLBinding(i,t),h=d.createProjectionLayer(U),i.updateRenderState({layers:[h]}),e.setPixelRatio(1),e.setSize(h.textureWidth,h.textureHeight,!1),x=new ac(h.textureWidth,h.textureHeight,{format:Gi,type:Do,depthTexture:new gj(h.textureWidth,h.textureHeight,ye,void 0,void 0,void 0,void 0,void 0,void 0,ne),stencilBuffer:g.stencil,colorSpace:e.outputColorSpace,samples:g.antialias?4:0});const X=e.properties.get(x);X.__ignoreDepthValues=h.ignoreDepthValues}x.isXRRenderTarget=!0,this.setFoveation(l),c=null,a=await i.requestReferenceSpace(o),Se.setContext(i),Se.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode};function I(G){for(let ne=0;ne<G.removed.length;ne++){const ye=G.removed[ne],se=b.indexOf(ye);se>=0&&(b[se]=null,_[se].disconnect(ye))}for(let ne=0;ne<G.added.length;ne++){const ye=G.added[ne];let se=b.indexOf(ye);if(se===-1){for(let X=0;X<_.length;X++)if(X>=b.length){b.push(ye),se=X;break}else if(b[X]===null){b[X]=ye,se=X;break}if(se===-1)break}const U=_[se];U&&U.connect(ye)}}const F=new Q,j=new Q;function L(G,ne,ye){F.setFromMatrixPosition(ne.matrixWorld),j.setFromMatrixPosition(ye.matrixWorld);const se=F.distanceTo(j),U=ne.projectionMatrix.elements,X=ye.projectionMatrix.elements,pe=U[14]/(U[10]-1),ue=U[14]/(U[10]+1),B=(U[9]+1)/U[5],He=(U[9]-1)/U[5],fe=(U[8]-1)/U[0],me=(X[8]+1)/X[0],Ee=pe*fe,xe=pe*me,ce=se/(-fe+me),V=ce*-fe;ne.matrixWorld.decompose(G.position,G.quaternion,G.scale),G.translateX(V),G.translateZ(ce),G.matrixWorld.compose(G.position,G.quaternion,G.scale),G.matrixWorldInverse.copy(G.matrixWorld).invert();const le=pe+ce,C=ue+ce,A=Ee-V,Y=xe+(se-V),de=B*ue/C*le,be=He*ue/C*le;G.projectionMatrix.makePerspective(A,Y,de,be,le,C),G.projectionMatrixInverse.copy(G.projectionMatrix).invert()}function D(G,ne){ne===null?G.matrixWorld.copy(G.matrix):G.matrixWorld.multiplyMatrices(ne.matrixWorld,G.matrix),G.matrixWorldInverse.copy(G.matrixWorld).invert()}this.updateCamera=function(G){if(i===null)return;v.texture!==null&&(G.near=v.depthNear,G.far=v.depthFar),T.near=M.near=S.near=G.near,T.far=M.far=S.far=G.far,(P!==T.near||H!==T.far)&&(i.updateRenderState({depthNear:T.near,depthFar:T.far}),P=T.near,H=T.far,S.near=P,S.far=H,M.near=P,M.far=H,S.updateProjectionMatrix(),M.updateProjectionMatrix(),G.updateProjectionMatrix());const ne=G.parent,ye=T.cameras;D(T,ne);for(let se=0;se<ye.length;se++)D(ye[se],ne);ye.length===2?L(T,S,M):T.projectionMatrix.copy(S.projectionMatrix),z(G,T,ne)};function z(G,ne,ye){ye===null?G.matrix.copy(ne.matrixWorld):(G.matrix.copy(ye.matrixWorld),G.matrix.invert(),G.matrix.multiply(ne.matrixWorld)),G.matrix.decompose(G.position,G.quaternion,G.scale),G.updateMatrixWorld(!0),G.projectionMatrix.copy(ne.projectionMatrix),G.projectionMatrixInverse.copy(ne.projectionMatrixInverse),G.isPerspectiveCamera&&(G.fov=_S*2*Math.atan(1/G.projectionMatrix.elements[5]),G.zoom=1)}this.getCamera=function(){return T},this.getFoveation=function(){if(!(h===null&&p===null))return l},this.setFoveation=function(G){l=G,h!==null&&(h.fixedFoveation=G),p!==null&&p.fixedFoveation!==void 0&&(p.fixedFoveation=G)},this.hasDepthSensing=function(){return v.texture!==null};let K=null;function re(G,ne){if(u=ne.getViewerPose(c||a),y=ne,u!==null){const ye=u.views;p!==null&&(e.setRenderTargetFramebuffer(x,p.framebuffer),e.setRenderTarget(x));let se=!1;ye.length!==T.cameras.length&&(T.cameras.length=0,se=!0);for(let X=0;X<ye.length;X++){const pe=ye[X];let ue=null;if(p!==null)ue=p.getViewport(pe);else{const He=d.getViewSubImage(h,pe);ue=He.viewport,X===0&&(e.setRenderTargetTextures(x,He.colorTexture,h.ignoreDepthValues?void 0:He.depthStencilTexture),e.setRenderTarget(x))}let B=N[X];B===void 0&&(B=new Ei,B.layers.enable(X),B.viewport=new Un,N[X]=B),B.matrix.fromArray(pe.transform.matrix),B.matrix.decompose(B.position,B.quaternion,B.scale),B.projectionMatrix.fromArray(pe.projectionMatrix),B.projectionMatrixInverse.copy(B.projectionMatrix).invert(),B.viewport.set(ue.x,ue.y,ue.width,ue.height),X===0&&(T.matrix.copy(B.matrix),T.matrix.decompose(T.position,T.quaternion,T.scale)),se===!0&&T.cameras.push(B)}const U=i.enabledFeatures;if(U&&U.includes("depth-sensing")){const X=d.getDepthInformation(ye[0]);X&&X.isValid&&X.texture&&v.init(e,X,i.renderState)}}for(let ye=0;ye<_.length;ye++){const se=b[ye],U=_[ye];se!==null&&U!==void 0&&U.update(se,ne,c||a)}v.render(e,T),K&&K(G,ne),ne.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:ne}),y=null}const Se=new mj;Se.setAnimationLoop(re),this.setAnimationLoop=function(G){K=G},this.dispose=function(){}}}const cl=new Na,g7=new xn;function y7(n,e){function t(g,m){g.matrixAutoUpdate===!0&&g.updateMatrix(),m.value.copy(g.matrix)}function r(g,m){m.color.getRGB(g.fogColor.value,dj(n)),m.isFog?(g.fogNear.value=m.near,g.fogFar.value=m.far):m.isFogExp2&&(g.fogDensity.value=m.density)}function i(g,m,x,_,b){m.isMeshBasicMaterial||m.isMeshLambertMaterial?s(g,m):m.isMeshToonMaterial?(s(g,m),d(g,m)):m.isMeshPhongMaterial?(s(g,m),u(g,m)):m.isMeshStandardMaterial?(s(g,m),h(g,m),m.isMeshPhysicalMaterial&&p(g,m,b)):m.isMeshMatcapMaterial?(s(g,m),y(g,m)):m.isMeshDepthMaterial?s(g,m):m.isMeshDistanceMaterial?(s(g,m),v(g,m)):m.isMeshNormalMaterial?s(g,m):m.isLineBasicMaterial?(a(g,m),m.isLineDashedMaterial&&o(g,m)):m.isPointsMaterial?l(g,m,x,_):m.isSpriteMaterial?c(g,m):m.isShadowMaterial?(g.color.value.copy(m.color),g.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}function s(g,m){g.opacity.value=m.opacity,m.color&&g.diffuse.value.copy(m.color),m.emissive&&g.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(g.map.value=m.map,t(m.map,g.mapTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,t(m.alphaMap,g.alphaMapTransform)),m.bumpMap&&(g.bumpMap.value=m.bumpMap,t(m.bumpMap,g.bumpMapTransform),g.bumpScale.value=m.bumpScale,m.side===Br&&(g.bumpScale.value*=-1)),m.normalMap&&(g.normalMap.value=m.normalMap,t(m.normalMap,g.normalMapTransform),g.normalScale.value.copy(m.normalScale),m.side===Br&&g.normalScale.value.negate()),m.displacementMap&&(g.displacementMap.value=m.displacementMap,t(m.displacementMap,g.displacementMapTransform),g.displacementScale.value=m.displacementScale,g.displacementBias.value=m.displacementBias),m.emissiveMap&&(g.emissiveMap.value=m.emissiveMap,t(m.emissiveMap,g.emissiveMapTransform)),m.specularMap&&(g.specularMap.value=m.specularMap,t(m.specularMap,g.specularMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest);const x=e.get(m),_=x.envMap,b=x.envMapRotation;if(_&&(g.envMap.value=_,cl.copy(b),cl.x*=-1,cl.y*=-1,cl.z*=-1,_.isCubeTexture&&_.isRenderTargetTexture===!1&&(cl.y*=-1,cl.z*=-1),g.envMapRotation.value.setFromMatrix4(g7.makeRotationFromEuler(cl)),g.flipEnvMap.value=_.isCubeTexture&&_.isRenderTargetTexture===!1?-1:1,g.reflectivity.value=m.reflectivity,g.ior.value=m.ior,g.refractionRatio.value=m.refractionRatio),m.lightMap){g.lightMap.value=m.lightMap;const w=n._useLegacyLights===!0?Math.PI:1;g.lightMapIntensity.value=m.lightMapIntensity*w,t(m.lightMap,g.lightMapTransform)}m.aoMap&&(g.aoMap.value=m.aoMap,g.aoMapIntensity.value=m.aoMapIntensity,t(m.aoMap,g.aoMapTransform))}function a(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,m.map&&(g.map.value=m.map,t(m.map,g.mapTransform))}function o(g,m){g.dashSize.value=m.dashSize,g.totalSize.value=m.dashSize+m.gapSize,g.scale.value=m.scale}function l(g,m,x,_){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.size.value=m.size*x,g.scale.value=_*.5,m.map&&(g.map.value=m.map,t(m.map,g.uvTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,t(m.alphaMap,g.alphaMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest)}function c(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.rotation.value=m.rotation,m.map&&(g.map.value=m.map,t(m.map,g.mapTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,t(m.alphaMap,g.alphaMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest)}function u(g,m){g.specular.value.copy(m.specular),g.shininess.value=Math.max(m.shininess,1e-4)}function d(g,m){m.gradientMap&&(g.gradientMap.value=m.gradientMap)}function h(g,m){g.metalness.value=m.metalness,m.metalnessMap&&(g.metalnessMap.value=m.metalnessMap,t(m.metalnessMap,g.metalnessMapTransform)),g.roughness.value=m.roughness,m.roughnessMap&&(g.roughnessMap.value=m.roughnessMap,t(m.roughnessMap,g.roughnessMapTransform)),e.get(m).envMap&&(g.envMapIntensity.value=m.envMapIntensity)}function p(g,m,x){g.ior.value=m.ior,m.sheen>0&&(g.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),g.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(g.sheenColorMap.value=m.sheenColorMap,t(m.sheenColorMap,g.sheenColorMapTransform)),m.sheenRoughnessMap&&(g.sheenRoughnessMap.value=m.sheenRoughnessMap,t(m.sheenRoughnessMap,g.sheenRoughnessMapTransform))),m.clearcoat>0&&(g.clearcoat.value=m.clearcoat,g.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(g.clearcoatMap.value=m.clearcoatMap,t(m.clearcoatMap,g.clearcoatMapTransform)),m.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap,t(m.clearcoatRoughnessMap,g.clearcoatRoughnessMapTransform)),m.clearcoatNormalMap&&(g.clearcoatNormalMap.value=m.clearcoatNormalMap,t(m.clearcoatNormalMap,g.clearcoatNormalMapTransform),g.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),m.side===Br&&g.clearcoatNormalScale.value.negate())),m.iridescence>0&&(g.iridescence.value=m.iridescence,g.iridescenceIOR.value=m.iridescenceIOR,g.iridescenceThicknessMinimum.value=m.iridescenceThicknessRange[0],g.iridescenceThicknessMaximum.value=m.iridescenceThicknessRange[1],m.iridescenceMap&&(g.iridescenceMap.value=m.iridescenceMap,t(m.iridescenceMap,g.iridescenceMapTransform)),m.iridescenceThicknessMap&&(g.iridescenceThicknessMap.value=m.iridescenceThicknessMap,t(m.iridescenceThicknessMap,g.iridescenceThicknessMapTransform))),m.transmission>0&&(g.transmission.value=m.transmission,g.transmissionSamplerMap.value=x.texture,g.transmissionSamplerSize.value.set(x.width,x.height),m.transmissionMap&&(g.transmissionMap.value=m.transmissionMap,t(m.transmissionMap,g.transmissionMapTransform)),g.thickness.value=m.thickness,m.thicknessMap&&(g.thicknessMap.value=m.thicknessMap,t(m.thicknessMap,g.thicknessMapTransform)),g.attenuationDistance.value=m.attenuationDistance,g.attenuationColor.value.copy(m.attenuationColor)),m.anisotropy>0&&(g.anisotropyVector.value.set(m.anisotropy*Math.cos(m.anisotropyRotation),m.anisotropy*Math.sin(m.anisotropyRotation)),m.anisotropyMap&&(g.anisotropyMap.value=m.anisotropyMap,t(m.anisotropyMap,g.anisotropyMapTransform))),g.specularIntensity.value=m.specularIntensity,g.specularColor.value.copy(m.specularColor),m.specularColorMap&&(g.specularColorMap.value=m.specularColorMap,t(m.specularColorMap,g.specularColorMapTransform)),m.specularIntensityMap&&(g.specularIntensityMap.value=m.specularIntensityMap,t(m.specularIntensityMap,g.specularIntensityMapTransform))}function y(g,m){m.matcap&&(g.matcap.value=m.matcap)}function v(g,m){const x=e.get(m).light;g.referencePosition.value.setFromMatrixPosition(x.matrixWorld),g.nearDistance.value=x.shadow.camera.near,g.farDistance.value=x.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function v7(n,e,t,r){let i={},s={},a=[];const o=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(x,_){const b=_.program;r.uniformBlockBinding(x,b)}function c(x,_){let b=i[x.id];b===void 0&&(y(x),b=u(x),i[x.id]=b,x.addEventListener("dispose",g));const w=_.program;r.updateUBOMapping(x,w);const E=e.render.frame;s[x.id]!==E&&(h(x),s[x.id]=E)}function u(x){const _=d();x.__bindingPointIndex=_;const b=n.createBuffer(),w=x.__size,E=x.usage;return n.bindBuffer(n.UNIFORM_BUFFER,b),n.bufferData(n.UNIFORM_BUFFER,w,E),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,_,b),b}function d(){for(let x=0;x<o;x++)if(a.indexOf(x)===-1)return a.push(x),x;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function h(x){const _=i[x.id],b=x.uniforms,w=x.__cache;n.bindBuffer(n.UNIFORM_BUFFER,_);for(let E=0,S=b.length;E<S;E++){const M=Array.isArray(b[E])?b[E]:[b[E]];for(let N=0,T=M.length;N<T;N++){const P=M[N];if(p(P,E,N,w)===!0){const H=P.__offset,W=Array.isArray(P.value)?P.value:[P.value];let O=0;for(let I=0;I<W.length;I++){const F=W[I],j=v(F);typeof F=="number"||typeof F=="boolean"?(P.__data[0]=F,n.bufferSubData(n.UNIFORM_BUFFER,H+O,P.__data)):F.isMatrix3?(P.__data[0]=F.elements[0],P.__data[1]=F.elements[1],P.__data[2]=F.elements[2],P.__data[3]=0,P.__data[4]=F.elements[3],P.__data[5]=F.elements[4],P.__data[6]=F.elements[5],P.__data[7]=0,P.__data[8]=F.elements[6],P.__data[9]=F.elements[7],P.__data[10]=F.elements[8],P.__data[11]=0):(F.toArray(P.__data,O),O+=j.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,H,P.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function p(x,_,b,w){const E=x.value,S=_+"_"+b;if(w[S]===void 0)return typeof E=="number"||typeof E=="boolean"?w[S]=E:w[S]=E.clone(),!0;{const M=w[S];if(typeof E=="number"||typeof E=="boolean"){if(M!==E)return w[S]=E,!0}else if(M.equals(E)===!1)return M.copy(E),!0}return!1}function y(x){const _=x.uniforms;let b=0;const w=16;for(let S=0,M=_.length;S<M;S++){const N=Array.isArray(_[S])?_[S]:[_[S]];for(let T=0,P=N.length;T<P;T++){const H=N[T],W=Array.isArray(H.value)?H.value:[H.value];for(let O=0,I=W.length;O<I;O++){const F=W[O],j=v(F),L=b%w;L!==0&&w-L<j.boundary&&(b+=w-L),H.__data=new Float32Array(j.storage/Float32Array.BYTES_PER_ELEMENT),H.__offset=b,b+=j.storage}}}const E=b%w;return E>0&&(b+=w-E),x.__size=b,x.__cache={},this}function v(x){const _={boundary:0,storage:0};return typeof x=="number"||typeof x=="boolean"?(_.boundary=4,_.storage=4):x.isVector2?(_.boundary=8,_.storage=8):x.isVector3||x.isColor?(_.boundary=16,_.storage=12):x.isVector4?(_.boundary=16,_.storage=16):x.isMatrix3?(_.boundary=48,_.storage=48):x.isMatrix4?(_.boundary=64,_.storage=64):x.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",x),_}function g(x){const _=x.target;_.removeEventListener("dispose",g);const b=a.indexOf(_.__bindingPointIndex);a.splice(b,1),n.deleteBuffer(i[_.id]),delete i[_.id],delete s[_.id]}function m(){for(const x in i)n.deleteBuffer(i[x]);a=[],i={},s={}}return{bind:l,update:c,dispose:m}}class wj{constructor(e={}){const{canvas:t=aW(),context:r=null,depth:i=!0,stencil:s=!0,alpha:a=!1,antialias:o=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:d=!1}=e;this.isWebGLRenderer=!0;let h;r!==null?h=r.getContextAttributes().alpha:h=a;const p=new Uint32Array(4),y=new Int32Array(4);let v=null,g=null;const m=[],x=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=bs,this._useLegacyLights=!1,this.toneMapping=Lo,this.toneMappingExposure=1;const _=this;let b=!1,w=0,E=0,S=null,M=-1,N=null;const T=new Un,P=new Un;let H=null;const W=new It(0);let O=0,I=t.width,F=t.height,j=1,L=null,D=null;const z=new Un(0,0,I,F),K=new Un(0,0,I,F);let re=!1;const Se=new pj;let G=!1,ne=!1,ye=null;const se=new xn,U=new Rt,X=new Q,pe={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function ue(){return S===null?j:1}let B=r;function He(R,q){for(let ee=0;ee<R.length;ee++){const te=R[ee],Z=t.getContext(te,q);if(Z!==null)return Z}return null}try{const R={alpha:!0,depth:i,stencil:s,antialias:o,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:d};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${YE}`),t.addEventListener("webglcontextlost",Yt,!1),t.addEventListener("webglcontextrestored",$,!1),t.addEventListener("webglcontextcreationerror",Ce,!1),B===null){const q=["webgl2","webgl","experimental-webgl"];if(_.isWebGL1Renderer===!0&&q.shift(),B=He(q,R),B===null)throw He(q)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&B instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),B.getShaderPrecisionFormat===void 0&&(B.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(R){throw console.error("THREE.WebGLRenderer: "+R.message),R}let fe,me,Ee,xe,ce,V,le,C,A,Y,de,be,ge,Ze,We,ae,oe,Pe,he,ze,Ue,De,Me,Be;function St(){fe=new EG(B),me=new yG(B,fe,e),fe.init(me),De=new c7(B,fe,me),Ee=new o7(B,fe,me),xe=new kG(B),ce=new q9,V=new l7(B,fe,Ee,ce,me,De,xe),le=new xG(_),C=new SG(_),A=new NW(B,me),Me=new mG(B,fe,A,me),Y=new TG(B,A,xe,Me),de=new RG(B,Y,A,xe),he=new CG(B,me,V),ae=new vG(ce),be=new G9(_,le,C,fe,me,Me,ae),ge=new y7(_,ce),Ze=new Y9,We=new t7(fe,me),Pe=new pG(_,le,C,Ee,de,h,l),oe=new a7(_,de,me),Be=new v7(B,xe,me,Ee),ze=new gG(B,fe,xe,me),Ue=new MG(B,fe,xe,me),xe.programs=be.programs,_.capabilities=me,_.extensions=fe,_.properties=ce,_.renderLists=Ze,_.shadowMap=oe,_.state=Ee,_.info=xe}St();const tt=new m7(_,B);this.xr=tt,this.getContext=function(){return B},this.getContextAttributes=function(){return B.getContextAttributes()},this.forceContextLoss=function(){const R=fe.get("WEBGL_lose_context");R&&R.loseContext()},this.forceContextRestore=function(){const R=fe.get("WEBGL_lose_context");R&&R.restoreContext()},this.getPixelRatio=function(){return j},this.setPixelRatio=function(R){R!==void 0&&(j=R,this.setSize(I,F,!1))},this.getSize=function(R){return R.set(I,F)},this.setSize=function(R,q,ee=!0){if(tt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}I=R,F=q,t.width=Math.floor(R*j),t.height=Math.floor(q*j),ee===!0&&(t.style.width=R+"px",t.style.height=q+"px"),this.setViewport(0,0,R,q)},this.getDrawingBufferSize=function(R){return R.set(I*j,F*j).floor()},this.setDrawingBufferSize=function(R,q,ee){I=R,F=q,j=ee,t.width=Math.floor(R*ee),t.height=Math.floor(q*ee),this.setViewport(0,0,R,q)},this.getCurrentViewport=function(R){return R.copy(T)},this.getViewport=function(R){return R.copy(z)},this.setViewport=function(R,q,ee,te){R.isVector4?z.set(R.x,R.y,R.z,R.w):z.set(R,q,ee,te),Ee.viewport(T.copy(z).multiplyScalar(j).round())},this.getScissor=function(R){return R.copy(K)},this.setScissor=function(R,q,ee,te){R.isVector4?K.set(R.x,R.y,R.z,R.w):K.set(R,q,ee,te),Ee.scissor(P.copy(K).multiplyScalar(j).round())},this.getScissorTest=function(){return re},this.setScissorTest=function(R){Ee.setScissorTest(re=R)},this.setOpaqueSort=function(R){L=R},this.setTransparentSort=function(R){D=R},this.getClearColor=function(R){return R.copy(Pe.getClearColor())},this.setClearColor=function(){Pe.setClearColor.apply(Pe,arguments)},this.getClearAlpha=function(){return Pe.getClearAlpha()},this.setClearAlpha=function(){Pe.setClearAlpha.apply(Pe,arguments)},this.clear=function(R=!0,q=!0,ee=!0){let te=0;if(R){let Z=!1;if(S!==null){const Ie=S.texture.format;Z=Ie===JI||Ie===ZI||Ie===KI}if(Z){const Ie=S.texture.type,$e=Ie===Do||Ie===xo||Ie===KE||Ie===Gl||Ie===XI||Ie===YI,qe=Pe.getClearColor(),Ke=Pe.getClearAlpha(),dt=qe.r,Je=qe.g,nt=qe.b;$e?(p[0]=dt,p[1]=Je,p[2]=nt,p[3]=Ke,B.clearBufferuiv(B.COLOR,0,p)):(y[0]=dt,y[1]=Je,y[2]=nt,y[3]=Ke,B.clearBufferiv(B.COLOR,0,y))}else te|=B.COLOR_BUFFER_BIT}q&&(te|=B.DEPTH_BUFFER_BIT),ee&&(te|=B.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),B.clear(te)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Yt,!1),t.removeEventListener("webglcontextrestored",$,!1),t.removeEventListener("webglcontextcreationerror",Ce,!1),Ze.dispose(),We.dispose(),ce.dispose(),le.dispose(),C.dispose(),de.dispose(),Me.dispose(),Be.dispose(),be.dispose(),tt.dispose(),tt.removeEventListener("sessionstart",hi),tt.removeEventListener("sessionend",Bt),ye&&(ye.dispose(),ye=null),cr.stop()};function Yt(R){R.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),b=!0}function $(){console.log("THREE.WebGLRenderer: Context Restored."),b=!1;const R=xe.autoReset,q=oe.enabled,ee=oe.autoUpdate,te=oe.needsUpdate,Z=oe.type;St(),xe.autoReset=R,oe.enabled=q,oe.autoUpdate=ee,oe.needsUpdate=te,oe.type=Z}function Ce(R){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",R.statusMessage)}function J(R){const q=R.target;q.removeEventListener("dispose",J),Te(q)}function Te(R){Ne(R),ce.remove(R)}function Ne(R){const q=ce.get(R).programs;q!==void 0&&(q.forEach(function(ee){be.releaseProgram(ee)}),R.isShaderMaterial&&be.releaseShaderCache(R))}this.renderBufferDirect=function(R,q,ee,te,Z,Ie){q===null&&(q=pe);const $e=Z.isMesh&&Z.matrixWorld.determinant()<0,qe=Dz(R,q,ee,te,Z);Ee.setMaterial(te,$e);let Ke=ee.index,dt=1;if(te.wireframe===!0){if(Ke=Y.getWireframeAttribute(ee),Ke===void 0)return;dt=2}const Je=ee.drawRange,nt=ee.attributes.position;let un=Je.start*dt,Wr=(Je.start+Je.count)*dt;Ie!==null&&(un=Math.max(un,Ie.start*dt),Wr=Math.min(Wr,(Ie.start+Ie.count)*dt)),Ke!==null?(un=Math.max(un,0),Wr=Math.min(Wr,Ke.count)):nt!=null&&(un=Math.max(un,0),Wr=Math.min(Wr,nt.count));const kn=Wr-un;if(kn<0||kn===1/0)return;Me.setup(Z,te,qe,ee,Ke);let Vs,Jt=ze;if(Ke!==null&&(Vs=A.get(Ke),Jt=Ue,Jt.setIndex(Vs)),Z.isMesh)te.wireframe===!0?(Ee.setLineWidth(te.wireframeLinewidth*ue()),Jt.setMode(B.LINES)):Jt.setMode(B.TRIANGLES);else if(Z.isLine){let it=te.linewidth;it===void 0&&(it=1),Ee.setLineWidth(it*ue()),Z.isLineSegments?Jt.setMode(B.LINES):Z.isLineLoop?Jt.setMode(B.LINE_LOOP):Jt.setMode(B.LINE_STRIP)}else Z.isPoints?Jt.setMode(B.POINTS):Z.isSprite&&Jt.setMode(B.TRIANGLES);if(Z.isBatchedMesh)Jt.renderMultiDraw(Z._multiDrawStarts,Z._multiDrawCounts,Z._multiDrawCount);else if(Z.isInstancedMesh)Jt.renderInstances(un,kn,Z.count);else if(ee.isInstancedBufferGeometry){const it=ee._maxInstanceCount!==void 0?ee._maxInstanceCount:1/0,Rx=Math.min(ee.instanceCount,it);Jt.renderInstances(un,kn,Rx)}else Jt.render(un,kn)};function vt(R,q,ee){R.transparent===!0&&R.side===da&&R.forceSinglePass===!1?(R.side=Br,R.needsUpdate=!0,hm(R,q,ee),R.side=Bo,R.needsUpdate=!0,hm(R,q,ee),R.side=da):hm(R,q,ee)}this.compile=function(R,q,ee=null){ee===null&&(ee=R),g=We.get(ee),g.init(),x.push(g),ee.traverseVisible(function(Z){Z.isLight&&Z.layers.test(q.layers)&&(g.pushLight(Z),Z.castShadow&&g.pushShadow(Z))}),R!==ee&&R.traverseVisible(function(Z){Z.isLight&&Z.layers.test(q.layers)&&(g.pushLight(Z),Z.castShadow&&g.pushShadow(Z))}),g.setupLights(_._useLegacyLights);const te=new Set;return R.traverse(function(Z){const Ie=Z.material;if(Ie)if(Array.isArray(Ie))for(let $e=0;$e<Ie.length;$e++){const qe=Ie[$e];vt(qe,ee,Z),te.add(qe)}else vt(Ie,ee,Z),te.add(Ie)}),x.pop(),g=null,te},this.compileAsync=function(R,q,ee=null){const te=this.compile(R,q,ee);return new Promise(Z=>{function Ie(){if(te.forEach(function($e){ce.get($e).currentProgram.isReady()&&te.delete($e)}),te.size===0){Z(R);return}setTimeout(Ie,10)}fe.get("KHR_parallel_shader_compile")!==null?Ie():setTimeout(Ie,10)})};let Ut=null;function Dn(R){Ut&&Ut(R)}function hi(){cr.stop()}function Bt(){cr.start()}const cr=new mj;cr.setAnimationLoop(Dn),typeof self<"u"&&cr.setContext(self),this.setAnimationLoop=function(R){Ut=R,tt.setAnimationLoop(R),R===null?cr.stop():cr.start()},tt.addEventListener("sessionstart",hi),tt.addEventListener("sessionend",Bt),this.render=function(R,q){if(q!==void 0&&q.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(b===!0)return;R.matrixWorldAutoUpdate===!0&&R.updateMatrixWorld(),q.parent===null&&q.matrixWorldAutoUpdate===!0&&q.updateMatrixWorld(),tt.enabled===!0&&tt.isPresenting===!0&&(tt.cameraAutoUpdate===!0&&tt.updateCamera(q),q=tt.getCamera()),R.isScene===!0&&R.onBeforeRender(_,R,q,S),g=We.get(R,x.length),g.init(),x.push(g),se.multiplyMatrices(q.projectionMatrix,q.matrixWorldInverse),Se.setFromProjectionMatrix(se),ne=this.localClippingEnabled,G=ae.init(this.clippingPlanes,ne),v=Ze.get(R,m.length),v.init(),m.push(v),ds(R,q,0,_.sortObjects),v.finish(),_.sortObjects===!0&&v.sort(L,D),this.info.render.frame++,G===!0&&ae.beginShadows();const ee=g.state.shadowsArray;if(oe.render(ee,R,q),G===!0&&ae.endShadows(),this.info.autoReset===!0&&this.info.reset(),(tt.enabled===!1||tt.isPresenting===!1||tt.hasDepthSensing()===!1)&&Pe.render(v,R),g.setupLights(_._useLegacyLights),q.isArrayCamera){const te=q.cameras;for(let Z=0,Ie=te.length;Z<Ie;Z++){const $e=te[Z];fk(v,R,$e,$e.viewport)}}else fk(v,R,q);S!==null&&(V.updateMultisampleRenderTarget(S),V.updateRenderTargetMipmap(S)),R.isScene===!0&&R.onAfterRender(_,R,q),Me.resetDefaultState(),M=-1,N=null,x.pop(),x.length>0?g=x[x.length-1]:g=null,m.pop(),m.length>0?v=m[m.length-1]:v=null};function ds(R,q,ee,te){if(R.visible===!1)return;if(R.layers.test(q.layers)){if(R.isGroup)ee=R.renderOrder;else if(R.isLOD)R.autoUpdate===!0&&R.update(q);else if(R.isLight)g.pushLight(R),R.castShadow&&g.pushShadow(R);else if(R.isSprite){if(!R.frustumCulled||Se.intersectsSprite(R)){te&&X.setFromMatrixPosition(R.matrixWorld).applyMatrix4(se);const $e=de.update(R),qe=R.material;qe.visible&&v.push(R,$e,qe,ee,X.z,null)}}else if((R.isMesh||R.isLine||R.isPoints)&&(!R.frustumCulled||Se.intersectsObject(R))){const $e=de.update(R),qe=R.material;if(te&&(R.boundingSphere!==void 0?(R.boundingSphere===null&&R.computeBoundingSphere(),X.copy(R.boundingSphere.center)):($e.boundingSphere===null&&$e.computeBoundingSphere(),X.copy($e.boundingSphere.center)),X.applyMatrix4(R.matrixWorld).applyMatrix4(se)),Array.isArray(qe)){const Ke=$e.groups;for(let dt=0,Je=Ke.length;dt<Je;dt++){const nt=Ke[dt],un=qe[nt.materialIndex];un&&un.visible&&v.push(R,$e,un,ee,X.z,nt)}}else qe.visible&&v.push(R,$e,qe,ee,X.z,null)}}const Ie=R.children;for(let $e=0,qe=Ie.length;$e<qe;$e++)ds(Ie[$e],q,ee,te)}function fk(R,q,ee,te){const Z=R.opaque,Ie=R.transmissive,$e=R.transparent;g.setupLightsView(ee),G===!0&&ae.setGlobalState(_.clippingPlanes,ee),Ie.length>0&&Lz(Z,Ie,q,ee),te&&Ee.viewport(T.copy(te)),Z.length>0&&dm(Z,q,ee),Ie.length>0&&dm(Ie,q,ee),$e.length>0&&dm($e,q,ee),Ee.buffers.depth.setTest(!0),Ee.buffers.depth.setMask(!0),Ee.buffers.color.setMask(!0),Ee.setPolygonOffset(!1)}function Lz(R,q,ee,te){if((ee.isScene===!0?ee.overrideMaterial:null)!==null)return;const Ie=me.isWebGL2;ye===null&&(ye=new ac(1,1,{generateMipmaps:!0,type:fe.has("EXT_color_buffer_half_float")?Kf:Do,minFilter:Dl,samples:Ie?4:0})),_.getDrawingBufferSize(U),Ie?ye.setSize(U.x,U.y):ye.setSize(bS(U.x),bS(U.y));const $e=_.getRenderTarget();_.setRenderTarget(ye),_.getClearColor(W),O=_.getClearAlpha(),O<1&&_.setClearColor(16777215,.5),_.clear();const qe=_.toneMapping;_.toneMapping=Lo,dm(R,ee,te),V.updateMultisampleRenderTarget(ye),V.updateRenderTargetMipmap(ye);let Ke=!1;for(let dt=0,Je=q.length;dt<Je;dt++){const nt=q[dt],un=nt.object,Wr=nt.geometry,kn=nt.material,Vs=nt.group;if(kn.side===da&&un.layers.test(te.layers)){const Jt=kn.side;kn.side=Br,kn.needsUpdate=!0,pk(un,ee,te,Wr,kn,Vs),kn.side=Jt,kn.needsUpdate=!0,Ke=!0}}Ke===!0&&(V.updateMultisampleRenderTarget(ye),V.updateRenderTargetMipmap(ye)),_.setRenderTarget($e),_.setClearColor(W,O),_.toneMapping=qe}function dm(R,q,ee){const te=q.isScene===!0?q.overrideMaterial:null;for(let Z=0,Ie=R.length;Z<Ie;Z++){const $e=R[Z],qe=$e.object,Ke=$e.geometry,dt=te===null?$e.material:te,Je=$e.group;qe.layers.test(ee.layers)&&pk(qe,q,ee,Ke,dt,Je)}}function pk(R,q,ee,te,Z,Ie){R.onBeforeRender(_,q,ee,te,Z,Ie),R.modelViewMatrix.multiplyMatrices(ee.matrixWorldInverse,R.matrixWorld),R.normalMatrix.getNormalMatrix(R.modelViewMatrix),Z.onBeforeRender(_,q,ee,te,R,Ie),Z.transparent===!0&&Z.side===da&&Z.forceSinglePass===!1?(Z.side=Br,Z.needsUpdate=!0,_.renderBufferDirect(ee,q,te,Z,R,Ie),Z.side=Bo,Z.needsUpdate=!0,_.renderBufferDirect(ee,q,te,Z,R,Ie),Z.side=da):_.renderBufferDirect(ee,q,te,Z,R,Ie),R.onAfterRender(_,q,ee,te,Z,Ie)}function hm(R,q,ee){q.isScene!==!0&&(q=pe);const te=ce.get(R),Z=g.state.lights,Ie=g.state.shadowsArray,$e=Z.state.version,qe=be.getParameters(R,Z.state,Ie,q,ee),Ke=be.getProgramCacheKey(qe);let dt=te.programs;te.environment=R.isMeshStandardMaterial?q.environment:null,te.fog=q.fog,te.envMap=(R.isMeshStandardMaterial?C:le).get(R.envMap||te.environment),te.envMapRotation=te.environment!==null&&R.envMap===null?q.environmentRotation:R.envMapRotation,dt===void 0&&(R.addEventListener("dispose",J),dt=new Map,te.programs=dt);let Je=dt.get(Ke);if(Je!==void 0){if(te.currentProgram===Je&&te.lightsStateVersion===$e)return gk(R,qe),Je}else qe.uniforms=be.getUniforms(R),R.onBuild(ee,qe,_),R.onBeforeCompile(qe,_),Je=be.acquireProgram(qe,Ke),dt.set(Ke,Je),te.uniforms=qe.uniforms;const nt=te.uniforms;return(!R.isShaderMaterial&&!R.isRawShaderMaterial||R.clipping===!0)&&(nt.clippingPlanes=ae.uniform),gk(R,qe),te.needsLights=jz(R),te.lightsStateVersion=$e,te.needsLights&&(nt.ambientLightColor.value=Z.state.ambient,nt.lightProbe.value=Z.state.probe,nt.directionalLights.value=Z.state.directional,nt.directionalLightShadows.value=Z.state.directionalShadow,nt.spotLights.value=Z.state.spot,nt.spotLightShadows.value=Z.state.spotShadow,nt.rectAreaLights.value=Z.state.rectArea,nt.ltc_1.value=Z.state.rectAreaLTC1,nt.ltc_2.value=Z.state.rectAreaLTC2,nt.pointLights.value=Z.state.point,nt.pointLightShadows.value=Z.state.pointShadow,nt.hemisphereLights.value=Z.state.hemi,nt.directionalShadowMap.value=Z.state.directionalShadowMap,nt.directionalShadowMatrix.value=Z.state.directionalShadowMatrix,nt.spotShadowMap.value=Z.state.spotShadowMap,nt.spotLightMatrix.value=Z.state.spotLightMatrix,nt.spotLightMap.value=Z.state.spotLightMap,nt.pointShadowMap.value=Z.state.pointShadowMap,nt.pointShadowMatrix.value=Z.state.pointShadowMatrix),te.currentProgram=Je,te.uniformsList=null,Je}function mk(R){if(R.uniformsList===null){const q=R.currentProgram.getUniforms();R.uniformsList=dy.seqWithValue(q.seq,R.uniforms)}return R.uniformsList}function gk(R,q){const ee=ce.get(R);ee.outputColorSpace=q.outputColorSpace,ee.batching=q.batching,ee.instancing=q.instancing,ee.instancingColor=q.instancingColor,ee.instancingMorph=q.instancingMorph,ee.skinning=q.skinning,ee.morphTargets=q.morphTargets,ee.morphNormals=q.morphNormals,ee.morphColors=q.morphColors,ee.morphTargetsCount=q.morphTargetsCount,ee.numClippingPlanes=q.numClippingPlanes,ee.numIntersection=q.numClipIntersection,ee.vertexAlphas=q.vertexAlphas,ee.vertexTangents=q.vertexTangents,ee.toneMapping=q.toneMapping}function Dz(R,q,ee,te,Z){q.isScene!==!0&&(q=pe),V.resetTextureUnits();const Ie=q.fog,$e=te.isMeshStandardMaterial?q.environment:null,qe=S===null?_.outputColorSpace:S.isXRRenderTarget===!0?S.texture.colorSpace:Jo,Ke=(te.isMeshStandardMaterial?C:le).get(te.envMap||$e),dt=te.vertexColors===!0&&!!ee.attributes.color&&ee.attributes.color.itemSize===4,Je=!!ee.attributes.tangent&&(!!te.normalMap||te.anisotropy>0),nt=!!ee.morphAttributes.position,un=!!ee.morphAttributes.normal,Wr=!!ee.morphAttributes.color;let kn=Lo;te.toneMapped&&(S===null||S.isXRRenderTarget===!0)&&(kn=_.toneMapping);const Vs=ee.morphAttributes.position||ee.morphAttributes.normal||ee.morphAttributes.color,Jt=Vs!==void 0?Vs.length:0,it=ce.get(te),Rx=g.state.lights;if(G===!0&&(ne===!0||R!==N)){const fi=R===N&&te.id===M;ae.setState(te,R,fi)}let Kt=!1;te.version===it.__version?(it.needsLights&&it.lightsStateVersion!==Rx.state.version||it.outputColorSpace!==qe||Z.isBatchedMesh&&it.batching===!1||!Z.isBatchedMesh&&it.batching===!0||Z.isInstancedMesh&&it.instancing===!1||!Z.isInstancedMesh&&it.instancing===!0||Z.isSkinnedMesh&&it.skinning===!1||!Z.isSkinnedMesh&&it.skinning===!0||Z.isInstancedMesh&&it.instancingColor===!0&&Z.instanceColor===null||Z.isInstancedMesh&&it.instancingColor===!1&&Z.instanceColor!==null||Z.isInstancedMesh&&it.instancingMorph===!0&&Z.morphTexture===null||Z.isInstancedMesh&&it.instancingMorph===!1&&Z.morphTexture!==null||it.envMap!==Ke||te.fog===!0&&it.fog!==Ie||it.numClippingPlanes!==void 0&&(it.numClippingPlanes!==ae.numPlanes||it.numIntersection!==ae.numIntersection)||it.vertexAlphas!==dt||it.vertexTangents!==Je||it.morphTargets!==nt||it.morphNormals!==un||it.morphColors!==Wr||it.toneMapping!==kn||me.isWebGL2===!0&&it.morphTargetsCount!==Jt)&&(Kt=!0):(Kt=!0,it.__version=te.version);let nl=it.currentProgram;Kt===!0&&(nl=hm(te,q,Z));let yk=!1,Vd=!1,Nx=!1;const $n=nl.getUniforms(),rl=it.uniforms;if(Ee.useProgram(nl.program)&&(yk=!0,Vd=!0,Nx=!0),te.id!==M&&(M=te.id,Vd=!0),yk||N!==R){$n.setValue(B,"projectionMatrix",R.projectionMatrix),$n.setValue(B,"viewMatrix",R.matrixWorldInverse);const fi=$n.map.cameraPosition;fi!==void 0&&fi.setValue(B,X.setFromMatrixPosition(R.matrixWorld)),me.logarithmicDepthBuffer&&$n.setValue(B,"logDepthBufFC",2/(Math.log(R.far+1)/Math.LN2)),(te.isMeshPhongMaterial||te.isMeshToonMaterial||te.isMeshLambertMaterial||te.isMeshBasicMaterial||te.isMeshStandardMaterial||te.isShaderMaterial)&&$n.setValue(B,"isOrthographic",R.isOrthographicCamera===!0),N!==R&&(N=R,Vd=!0,Nx=!0)}if(Z.isSkinnedMesh){$n.setOptional(B,Z,"bindMatrix"),$n.setOptional(B,Z,"bindMatrixInverse");const fi=Z.skeleton;fi&&(me.floatVertexTextures?(fi.boneTexture===null&&fi.computeBoneTexture(),$n.setValue(B,"boneTexture",fi.boneTexture,V)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}Z.isBatchedMesh&&($n.setOptional(B,Z,"batchingTexture"),$n.setValue(B,"batchingTexture",Z._matricesTexture,V));const Ox=ee.morphAttributes;if((Ox.position!==void 0||Ox.normal!==void 0||Ox.color!==void 0&&me.isWebGL2===!0)&&he.update(Z,ee,nl),(Vd||it.receiveShadow!==Z.receiveShadow)&&(it.receiveShadow=Z.receiveShadow,$n.setValue(B,"receiveShadow",Z.receiveShadow)),te.isMeshGouraudMaterial&&te.envMap!==null&&(rl.envMap.value=Ke,rl.flipEnvMap.value=Ke.isCubeTexture&&Ke.isRenderTargetTexture===!1?-1:1),Vd&&($n.setValue(B,"toneMappingExposure",_.toneMappingExposure),it.needsLights&&Iz(rl,Nx),Ie&&te.fog===!0&&ge.refreshFogUniforms(rl,Ie),ge.refreshMaterialUniforms(rl,te,j,F,ye),dy.upload(B,mk(it),rl,V)),te.isShaderMaterial&&te.uniformsNeedUpdate===!0&&(dy.upload(B,mk(it),rl,V),te.uniformsNeedUpdate=!1),te.isSpriteMaterial&&$n.setValue(B,"center",Z.center),$n.setValue(B,"modelViewMatrix",Z.modelViewMatrix),$n.setValue(B,"normalMatrix",Z.normalMatrix),$n.setValue(B,"modelMatrix",Z.matrixWorld),te.isShaderMaterial||te.isRawShaderMaterial){const fi=te.uniformsGroups;for(let Lx=0,Fz=fi.length;Lx<Fz;Lx++)if(me.isWebGL2){const vk=fi[Lx];Be.update(vk,nl),Be.bind(vk,nl)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return nl}function Iz(R,q){R.ambientLightColor.needsUpdate=q,R.lightProbe.needsUpdate=q,R.directionalLights.needsUpdate=q,R.directionalLightShadows.needsUpdate=q,R.pointLights.needsUpdate=q,R.pointLightShadows.needsUpdate=q,R.spotLights.needsUpdate=q,R.spotLightShadows.needsUpdate=q,R.rectAreaLights.needsUpdate=q,R.hemisphereLights.needsUpdate=q}function jz(R){return R.isMeshLambertMaterial||R.isMeshToonMaterial||R.isMeshPhongMaterial||R.isMeshStandardMaterial||R.isShadowMaterial||R.isShaderMaterial&&R.lights===!0}this.getActiveCubeFace=function(){return w},this.getActiveMipmapLevel=function(){return E},this.getRenderTarget=function(){return S},this.setRenderTargetTextures=function(R,q,ee){ce.get(R.texture).__webglTexture=q,ce.get(R.depthTexture).__webglTexture=ee;const te=ce.get(R);te.__hasExternalTextures=!0,te.__autoAllocateDepthBuffer=ee===void 0,te.__autoAllocateDepthBuffer||fe.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),te.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(R,q){const ee=ce.get(R);ee.__webglFramebuffer=q,ee.__useDefaultFramebuffer=q===void 0},this.setRenderTarget=function(R,q=0,ee=0){S=R,w=q,E=ee;let te=!0,Z=null,Ie=!1,$e=!1;if(R){const Ke=ce.get(R);Ke.__useDefaultFramebuffer!==void 0?(Ee.bindFramebuffer(B.FRAMEBUFFER,null),te=!1):Ke.__webglFramebuffer===void 0?V.setupRenderTarget(R):Ke.__hasExternalTextures&&V.rebindTextures(R,ce.get(R.texture).__webglTexture,ce.get(R.depthTexture).__webglTexture);const dt=R.texture;(dt.isData3DTexture||dt.isDataArrayTexture||dt.isCompressedArrayTexture)&&($e=!0);const Je=ce.get(R).__webglFramebuffer;R.isWebGLCubeRenderTarget?(Array.isArray(Je[q])?Z=Je[q][ee]:Z=Je[q],Ie=!0):me.isWebGL2&&R.samples>0&&V.useMultisampledRTT(R)===!1?Z=ce.get(R).__webglMultisampledFramebuffer:Array.isArray(Je)?Z=Je[ee]:Z=Je,T.copy(R.viewport),P.copy(R.scissor),H=R.scissorTest}else T.copy(z).multiplyScalar(j).floor(),P.copy(K).multiplyScalar(j).floor(),H=re;if(Ee.bindFramebuffer(B.FRAMEBUFFER,Z)&&me.drawBuffers&&te&&Ee.drawBuffers(R,Z),Ee.viewport(T),Ee.scissor(P),Ee.setScissorTest(H),Ie){const Ke=ce.get(R.texture);B.framebufferTexture2D(B.FRAMEBUFFER,B.COLOR_ATTACHMENT0,B.TEXTURE_CUBE_MAP_POSITIVE_X+q,Ke.__webglTexture,ee)}else if($e){const Ke=ce.get(R.texture),dt=q||0;B.framebufferTextureLayer(B.FRAMEBUFFER,B.COLOR_ATTACHMENT0,Ke.__webglTexture,ee||0,dt)}M=-1},this.readRenderTargetPixels=function(R,q,ee,te,Z,Ie,$e){if(!(R&&R.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let qe=ce.get(R).__webglFramebuffer;if(R.isWebGLCubeRenderTarget&&$e!==void 0&&(qe=qe[$e]),qe){Ee.bindFramebuffer(B.FRAMEBUFFER,qe);try{const Ke=R.texture,dt=Ke.format,Je=Ke.type;if(dt!==Gi&&De.convert(dt)!==B.getParameter(B.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const nt=Je===Kf&&(fe.has("EXT_color_buffer_half_float")||me.isWebGL2&&fe.has("EXT_color_buffer_float"));if(Je!==Do&&De.convert(Je)!==B.getParameter(B.IMPLEMENTATION_COLOR_READ_TYPE)&&!(Je===ha&&(me.isWebGL2||fe.has("OES_texture_float")||fe.has("WEBGL_color_buffer_float")))&&!nt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}q>=0&&q<=R.width-te&&ee>=0&&ee<=R.height-Z&&B.readPixels(q,ee,te,Z,De.convert(dt),De.convert(Je),Ie)}finally{const Ke=S!==null?ce.get(S).__webglFramebuffer:null;Ee.bindFramebuffer(B.FRAMEBUFFER,Ke)}}},this.copyFramebufferToTexture=function(R,q,ee=0){const te=Math.pow(2,-ee),Z=Math.floor(q.image.width*te),Ie=Math.floor(q.image.height*te);V.setTexture2D(q,0),B.copyTexSubImage2D(B.TEXTURE_2D,ee,0,0,R.x,R.y,Z,Ie),Ee.unbindTexture()},this.copyTextureToTexture=function(R,q,ee,te=0){const Z=q.image.width,Ie=q.image.height,$e=De.convert(ee.format),qe=De.convert(ee.type);V.setTexture2D(ee,0),B.pixelStorei(B.UNPACK_FLIP_Y_WEBGL,ee.flipY),B.pixelStorei(B.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ee.premultiplyAlpha),B.pixelStorei(B.UNPACK_ALIGNMENT,ee.unpackAlignment),q.isDataTexture?B.texSubImage2D(B.TEXTURE_2D,te,R.x,R.y,Z,Ie,$e,qe,q.image.data):q.isCompressedTexture?B.compressedTexSubImage2D(B.TEXTURE_2D,te,R.x,R.y,q.mipmaps[0].width,q.mipmaps[0].height,$e,q.mipmaps[0].data):B.texSubImage2D(B.TEXTURE_2D,te,R.x,R.y,$e,qe,q.image),te===0&&ee.generateMipmaps&&B.generateMipmap(B.TEXTURE_2D),Ee.unbindTexture()},this.copyTextureToTexture3D=function(R,q,ee,te,Z=0){if(_.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Ie=Math.round(R.max.x-R.min.x),$e=Math.round(R.max.y-R.min.y),qe=R.max.z-R.min.z+1,Ke=De.convert(te.format),dt=De.convert(te.type);let Je;if(te.isData3DTexture)V.setTexture3D(te,0),Je=B.TEXTURE_3D;else if(te.isDataArrayTexture||te.isCompressedArrayTexture)V.setTexture2DArray(te,0),Je=B.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}B.pixelStorei(B.UNPACK_FLIP_Y_WEBGL,te.flipY),B.pixelStorei(B.UNPACK_PREMULTIPLY_ALPHA_WEBGL,te.premultiplyAlpha),B.pixelStorei(B.UNPACK_ALIGNMENT,te.unpackAlignment);const nt=B.getParameter(B.UNPACK_ROW_LENGTH),un=B.getParameter(B.UNPACK_IMAGE_HEIGHT),Wr=B.getParameter(B.UNPACK_SKIP_PIXELS),kn=B.getParameter(B.UNPACK_SKIP_ROWS),Vs=B.getParameter(B.UNPACK_SKIP_IMAGES),Jt=ee.isCompressedTexture?ee.mipmaps[Z]:ee.image;B.pixelStorei(B.UNPACK_ROW_LENGTH,Jt.width),B.pixelStorei(B.UNPACK_IMAGE_HEIGHT,Jt.height),B.pixelStorei(B.UNPACK_SKIP_PIXELS,R.min.x),B.pixelStorei(B.UNPACK_SKIP_ROWS,R.min.y),B.pixelStorei(B.UNPACK_SKIP_IMAGES,R.min.z),ee.isDataTexture||ee.isData3DTexture?B.texSubImage3D(Je,Z,q.x,q.y,q.z,Ie,$e,qe,Ke,dt,Jt.data):te.isCompressedArrayTexture?B.compressedTexSubImage3D(Je,Z,q.x,q.y,q.z,Ie,$e,qe,Ke,Jt.data):B.texSubImage3D(Je,Z,q.x,q.y,q.z,Ie,$e,qe,Ke,dt,Jt),B.pixelStorei(B.UNPACK_ROW_LENGTH,nt),B.pixelStorei(B.UNPACK_IMAGE_HEIGHT,un),B.pixelStorei(B.UNPACK_SKIP_PIXELS,Wr),B.pixelStorei(B.UNPACK_SKIP_ROWS,kn),B.pixelStorei(B.UNPACK_SKIP_IMAGES,Vs),Z===0&&te.generateMipmaps&&B.generateMipmap(Je),Ee.unbindTexture()},this.initTexture=function(R){R.isCubeTexture?V.setTextureCube(R,0):R.isData3DTexture?V.setTexture3D(R,0):R.isDataArrayTexture||R.isCompressedArrayTexture?V.setTexture2DArray(R,0):V.setTexture2D(R,0),Ee.unbindTexture()},this.resetState=function(){w=0,E=0,S=null,Ee.reset(),Me.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return ma}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===ZE?"display-p3":"srgb",t.unpackColorSpace=Ft.workingColorSpace===xv?"display-p3":"srgb"}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class x7 extends wj{}x7.prototype.isWebGL1Renderer=!0;class _7 extends $r{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Na,this.environmentRotation=new Na,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class Sj extends zp{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new It(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const iC=new xn,SS=new sj,Jm=new _v,Qm=new Q;class b7 extends $r{constructor(e=new ja,t=new Sj){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Points.threshold,a=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),Jm.copy(r.boundingSphere),Jm.applyMatrix4(i),Jm.radius+=s,e.ray.intersectsSphere(Jm)===!1)return;iC.copy(i).invert(),SS.copy(e.ray).applyMatrix4(iC);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,c=r.index,d=r.attributes.position;if(c!==null){const h=Math.max(0,a.start),p=Math.min(c.count,a.start+a.count);for(let y=h,v=p;y<v;y++){const g=c.getX(y);Qm.fromBufferAttribute(d,g),sC(Qm,g,l,i,e,t,this)}}else{const h=Math.max(0,a.start),p=Math.min(d.count,a.start+a.count);for(let y=h,v=p;y<v;y++)Qm.fromBufferAttribute(d,y),sC(Qm,y,l,i,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}function sC(n,e,t,r,i,s,a){const o=SS.distanceSqToPoint(n);if(o<t){const l=new Q;SS.closestPointToPoint(n,l),l.applyMatrix4(r);const c=i.ray.origin.distanceTo(l);if(c<i.near||c>i.far)return;s.push({distance:c,distanceToRay:Math.sqrt(o),point:l,index:e,face:null,object:a})}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:YE}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=YE);const w7=()=>{const n=k.useRef(null),e=k.useRef(null),t=k.useRef(null),r=k.useRef(null),i=k.useRef(null);return k.useEffect(()=>{if(!n.current)return;e.current=new _7,t.current=new Ei(75,window.innerWidth/window.innerHeight,.1,1e3),t.current.position.z=5,r.current=new wj({alpha:!0}),r.current.setSize(window.innerWidth,window.innerHeight),n.current.appendChild(r.current.domElement);const s=new ja,a=5e3,o=new Float32Array(a*3);for(let u=0;u<a*3;u++)o[u]=(Math.random()-.5)*10;s.setAttribute("position",new Ji(o,3));const l=new Sj({size:.005,color:"#00ff88",transparent:!0,opacity:.8});i.current=new b7(s,l),e.current.add(i.current);const c=()=>{requestAnimationFrame(c),i.current&&(i.current.rotation.x+=1e-4,i.current.rotation.y+=1e-4),r.current&&e.current&&t.current&&r.current.render(e.current,t.current)};return c(),()=>{n.current&&r.current&&n.current.removeChild(r.current.domElement)}},[]),f.jsx("div",{ref:n,className:"fixed inset-0 -z-10"})};var Ej={exports:{}},Vp={},ES={exports:{}};(function(n,e){(function(t,r){r(e)})(ai,function(t){function r(U){return function(pe,ue,B,He,fe,me,Ee){return U(pe,ue,Ee)}}function i(U){return function(pe,ue,B,He){if(!pe||!ue||typeof pe!="object"||typeof ue!="object")return U(pe,ue,B,He);var fe=He.get(pe),me=He.get(ue);if(fe&&me)return fe===ue&&me===pe;He.set(pe,ue),He.set(ue,pe);var Ee=U(pe,ue,B,He);return He.delete(pe),He.delete(ue),Ee}}function s(U,X){var pe={};for(var ue in U)pe[ue]=U[ue];for(var ue in X)pe[ue]=X[ue];return pe}function a(U){return U.constructor===Object||U.constructor==null}function o(U){return typeof U.then=="function"}function l(U,X){return U===X||U!==U&&X!==X}var c="[object Arguments]",u="[object Boolean]",d="[object Date]",h="[object RegExp]",p="[object Map]",y="[object Number]",v="[object Object]",g="[object Set]",m="[object String]",x=Object.prototype.toString;function _(U){var X=U.areArraysEqual,pe=U.areDatesEqual,ue=U.areMapsEqual,B=U.areObjectsEqual,He=U.areRegExpsEqual,fe=U.areSetsEqual,me=U.createIsNestedEqual,Ee=me(xe);function xe(ce,V,le){if(ce===V)return!0;if(!ce||!V||typeof ce!="object"||typeof V!="object")return ce!==ce&&V!==V;if(a(ce)&&a(V))return B(ce,V,Ee,le);var C=Array.isArray(ce),A=Array.isArray(V);if(C||A)return C===A&&X(ce,V,Ee,le);var Y=x.call(ce);return Y!==x.call(V)?!1:Y===d?pe(ce,V,Ee,le):Y===h?He(ce,V,Ee,le):Y===p?ue(ce,V,Ee,le):Y===g?fe(ce,V,Ee,le):Y===v||Y===c?o(ce)||o(V)?!1:B(ce,V,Ee,le):Y===u||Y===y||Y===m?l(ce.valueOf(),V.valueOf()):!1}return xe}function b(U,X,pe,ue){var B=U.length;if(X.length!==B)return!1;for(;B-- >0;)if(!pe(U[B],X[B],B,B,U,X,ue))return!1;return!0}var w=i(b);function E(U,X){return l(U.valueOf(),X.valueOf())}function S(U,X,pe,ue){var B=U.size===X.size;if(!B)return!1;if(!U.size)return!0;var He={},fe=0;return U.forEach(function(me,Ee){if(B){var xe=!1,ce=0;X.forEach(function(V,le){!xe&&!He[ce]&&(xe=pe(Ee,le,fe,ce,U,X,ue)&&pe(me,V,Ee,le,U,X,ue))&&(He[ce]=!0),ce++}),fe++,B=xe}}),B}var M=i(S),N="_owner",T=Object.prototype.hasOwnProperty;function P(U,X,pe,ue){var B=Object.keys(U),He=B.length;if(Object.keys(X).length!==He)return!1;for(var fe;He-- >0;){if(fe=B[He],fe===N){var me=!!U.$$typeof,Ee=!!X.$$typeof;if((me||Ee)&&me!==Ee)return!1}if(!T.call(X,fe)||!pe(U[fe],X[fe],fe,fe,U,X,ue))return!1}return!0}var H=i(P);function W(U,X){return U.source===X.source&&U.flags===X.flags}function O(U,X,pe,ue){var B=U.size===X.size;if(!B)return!1;if(!U.size)return!0;var He={};return U.forEach(function(fe,me){if(B){var Ee=!1,xe=0;X.forEach(function(ce,V){!Ee&&!He[xe]&&(Ee=pe(fe,ce,me,V,U,X,ue))&&(He[xe]=!0),xe++}),B=Ee}}),B}var I=i(O),F=Object.freeze({areArraysEqual:b,areDatesEqual:E,areMapsEqual:S,areObjectsEqual:P,areRegExpsEqual:W,areSetsEqual:O,createIsNestedEqual:r}),j=Object.freeze({areArraysEqual:w,areDatesEqual:E,areMapsEqual:M,areObjectsEqual:H,areRegExpsEqual:W,areSetsEqual:I,createIsNestedEqual:r}),L=_(F);function D(U,X){return L(U,X,void 0)}var z=_(s(F,{createIsNestedEqual:function(){return l}}));function K(U,X){return z(U,X,void 0)}var re=_(j);function Se(U,X){return re(U,X,new WeakMap)}var G=_(s(j,{createIsNestedEqual:function(){return l}}));function ne(U,X){return G(U,X,new WeakMap)}function ye(U){return _(s(F,U(F)))}function se(U){var X=_(s(j,U(j)));return function(pe,ue,B){return B===void 0&&(B=new WeakMap),X(pe,ue,B)}}t.circularDeepEqual=Se,t.circularShallowEqual=ne,t.createCustomCircularEqual=se,t.createCustomEqual=ye,t.deepEqual=D,t.sameValueZeroEqual=l,t.shallowEqual=K,Object.defineProperty(t,"__esModule",{value:!0})})})(ES,ES.exports);var QE=ES.exports,TS={exports:{}};function Tj(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(e=0;e<i;e++)n[e]&&(t=Tj(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function aC(){for(var n,e,t=0,r="",i=arguments.length;t<i;t++)(n=arguments[t])&&(e=Tj(n))&&(r&&(r+=" "),r+=e);return r}TS.exports=aC,TS.exports.clsx=aC;var eT=TS.exports,mt={},S7=function(e,t,r){return e===t?!0:e.className===t.className&&r(e.style,t.style)&&e.width===t.width&&e.autoSize===t.autoSize&&e.cols===t.cols&&e.draggableCancel===t.draggableCancel&&e.draggableHandle===t.draggableHandle&&r(e.verticalCompact,t.verticalCompact)&&r(e.compactType,t.compactType)&&r(e.layout,t.layout)&&r(e.margin,t.margin)&&r(e.containerPadding,t.containerPadding)&&e.rowHeight===t.rowHeight&&e.maxRows===t.maxRows&&e.isBounded===t.isBounded&&e.isDraggable===t.isDraggable&&e.isResizable===t.isResizable&&e.allowOverlap===t.allowOverlap&&e.preventCollision===t.preventCollision&&e.useCSSTransforms===t.useCSSTransforms&&e.transformScale===t.transformScale&&e.isDroppable===t.isDroppable&&r(e.resizeHandles,t.resizeHandles)&&r(e.resizeHandle,t.resizeHandle)&&e.onLayoutChange===t.onLayoutChange&&e.onDragStart===t.onDragStart&&e.onDrag===t.onDrag&&e.onDragStop===t.onDragStop&&e.onResizeStart===t.onResizeStart&&e.onResize===t.onResize&&e.onResizeStop===t.onResizeStop&&e.onDrop===t.onDrop&&r(e.droppingItem,t.droppingItem)&&r(e.innerRef,t.innerRef)};Object.defineProperty(mt,"__esModule",{value:!0});mt.bottom=tT;mt.childrenEqual=M7;mt.cloneLayout=Mj;mt.cloneLayoutItem=Yl;mt.collides=Sv;mt.compact=Aj;mt.compactItem=Pj;mt.compactType=B7;mt.correctBounds=Cj;mt.fastPositionEqual=k7;mt.fastRGLPropsEqual=void 0;mt.getAllCollisions=Rj;mt.getFirstCollision=Il;mt.getLayoutItem=nT;mt.getStatics=rT;mt.modifyLayout=kj;mt.moveElement=Bh;mt.moveElementAwayFromCollision=kS;mt.noop=void 0;mt.perc=P7;mt.resizeItemInDirection=D7;mt.setTopLeft=j7;mt.setTransform=I7;mt.sortLayoutItems=cT;mt.sortLayoutItemsByColRow=Ij;mt.sortLayoutItemsByRowCol=Dj;mt.synchronizeLayoutWithChildren=F7;mt.validateLayout=U7;mt.withLayoutItem=T7;var oC=QE,Uh=E7(k);function E7(n){return n&&n.__esModule?n:{default:n}}function tT(n){let e=0,t;for(let r=0,i=n.length;r<i;r++)t=n[r].y+n[r].h,t>e&&(e=t);return e}function Mj(n){const e=Array(n.length);for(let t=0,r=n.length;t<r;t++)e[t]=Yl(n[t]);return e}function kj(n,e){const t=Array(n.length);for(let r=0,i=n.length;r<i;r++)e.i===n[r].i?t[r]=e:t[r]=n[r];return t}function T7(n,e,t){let r=nT(n,e);return r?(r=t(Yl(r)),n=kj(n,r),[n,r]):[n,null]}function Yl(n){return{w:n.w,h:n.h,x:n.x,y:n.y,i:n.i,minW:n.minW,maxW:n.maxW,minH:n.minH,maxH:n.maxH,moved:!!n.moved,static:!!n.static,isDraggable:n.isDraggable,isResizable:n.isResizable,resizeHandles:n.resizeHandles,isBounded:n.isBounded}}function M7(n,e){return(0,oC.deepEqual)(Uh.default.Children.map(n,t=>t==null?void 0:t.key),Uh.default.Children.map(e,t=>t==null?void 0:t.key))&&(0,oC.deepEqual)(Uh.default.Children.map(n,t=>t==null?void 0:t.props["data-grid"]),Uh.default.Children.map(e,t=>t==null?void 0:t.props["data-grid"]))}mt.fastRGLPropsEqual=S7;function k7(n,e){return n.left===e.left&&n.top===e.top&&n.width===e.width&&n.height===e.height}function Sv(n,e){return!(n.i===e.i||n.x+n.w<=e.x||n.x>=e.x+e.w||n.y+n.h<=e.y||n.y>=e.y+e.h)}function Aj(n,e,t,r){const i=rT(n),s=cT(n,e),a=Array(n.length);for(let o=0,l=s.length;o<l;o++){let c=Yl(s[o]);c.static||(c=Pj(i,c,e,t,s,r),i.push(c)),a[n.indexOf(s[o])]=c,c.moved=!1}return a}const A7={x:"w",y:"h"};function MS(n,e,t,r){const i=A7[r];e[r]+=1;const s=n.map(a=>a.i).indexOf(e.i);for(let a=s+1;a<n.length;a++){const o=n[a];if(!o.static){if(o.y>e.y+e.h)break;Sv(e,o)&&MS(n,o,t+e[i],r)}}e[r]=t}function Pj(n,e,t,r,i,s){const a=t==="vertical",o=t==="horizontal";if(a)for(e.y=Math.min(tT(n),e.y);e.y>0&&!Il(n,e);)e.y--;else if(o)for(;e.x>0&&!Il(n,e);)e.x--;let l;for(;(l=Il(n,e))&&!(t===null&&s);)if(o?MS(i,e,l.x+l.w,"x"):MS(i,e,l.y+l.h,"y"),o&&e.x+e.w>r)for(e.x=r-e.w,e.y++;e.x>0&&!Il(n,e);)e.x--;return e.y=Math.max(e.y,0),e.x=Math.max(e.x,0),e}function Cj(n,e){const t=rT(n);for(let r=0,i=n.length;r<i;r++){const s=n[r];if(s.x+s.w>e.cols&&(s.x=e.cols-s.w),s.x<0&&(s.x=0,s.w=e.cols),!s.static)t.push(s);else for(;Il(t,s);)s.y++}return n}function nT(n,e){for(let t=0,r=n.length;t<r;t++)if(n[t].i===e)return n[t]}function Il(n,e){for(let t=0,r=n.length;t<r;t++)if(Sv(n[t],e))return n[t]}function Rj(n,e){return n.filter(t=>Sv(t,e))}function rT(n){return n.filter(e=>e.static)}function Bh(n,e,t,r,i,s,a,o,l){if(e.static&&e.isDraggable!==!0||e.y===r&&e.x===t)return n;`${e.i}${String(t)}${String(r)}${e.x}${e.y}`;const c=e.x,u=e.y;typeof t=="number"&&(e.x=t),typeof r=="number"&&(e.y=r),e.moved=!0;let d=cT(n,a);(a==="vertical"&&typeof r=="number"?u>=r:a==="horizontal"&&typeof t=="number"?c>=t:!1)&&(d=d.reverse());const p=Rj(d,e),y=p.length>0;if(y&&l)return Mj(n);if(y&&s)return`${e.i}`,e.x=c,e.y=u,e.moved=!1,n;for(let v=0,g=p.length;v<g;v++){const m=p[v];`${e.i}${e.x}${e.y}${m.i}${m.x}${m.y}`,!m.moved&&(m.static?n=kS(n,m,e,i,a):n=kS(n,e,m,i,a))}return n}function kS(n,e,t,r,i,s){const a=i==="horizontal",o=i==="vertical",l=e.static;if(r){r=!1;const d={x:a?Math.max(e.x-t.w,0):t.x,y:o?Math.max(e.y-t.h,0):t.y,w:t.w,h:t.h,i:"-1"},h=Il(n,d),p=h&&h.y+h.h>e.y,y=h&&e.x+e.w>h.x;if(h){if(p&&o)return Bh(n,t,void 0,e.y+1,r,l,i);if(p&&i==null)return e.y=t.y,t.y=t.y+t.h,n;if(y&&a)return Bh(n,e,t.x,void 0,r,l,i)}else return`${t.i}${d.x}${d.y}`,Bh(n,t,a?d.x:void 0,o?d.y:void 0,r,l,i)}const c=a?t.x+1:void 0,u=o?t.y+1:void 0;return c==null&&u==null?n:Bh(n,t,a?t.x+1:void 0,o?t.y+1:void 0,r,l,i)}function P7(n){return n*100+"%"}const Nj=(n,e,t,r)=>n+t>r?e:t,Oj=(n,e,t)=>n<0?e:t,Lj=n=>Math.max(0,n),iT=n=>Math.max(0,n),sT=(n,e,t)=>{let{left:r,height:i,width:s}=e;const a=n.top-(i-n.height);return{left:r,width:s,height:Oj(a,n.height,i),top:iT(a)}},aT=(n,e,t)=>{let{top:r,left:i,height:s,width:a}=e;return{top:r,height:s,width:Nj(n.left,n.width,a,t),left:Lj(i)}},oT=(n,e,t)=>{let{top:r,height:i,width:s}=e;const a=n.left-(s-n.width);return{height:i,width:a<0?n.width:Nj(n.left,n.width,s,t),top:iT(r),left:Lj(a)}},lT=(n,e,t)=>{let{top:r,left:i,height:s,width:a}=e;return{width:a,left:i,height:Oj(r,n.height,s),top:iT(r)}},C7=function(){return sT(arguments.length<=0?void 0:arguments[0],aT(...arguments))},R7=function(){return sT(arguments.length<=0?void 0:arguments[0],oT(...arguments))},N7=function(){return lT(arguments.length<=0?void 0:arguments[0],aT(...arguments))},O7=function(){return lT(arguments.length<=0?void 0:arguments[0],oT(...arguments))},L7={n:sT,ne:C7,e:aT,se:N7,s:lT,sw:O7,w:oT,nw:R7};function D7(n,e,t,r){const i=L7[n];return i?i(e,{...e,...t},r):t}function I7(n){let{top:e,left:t,width:r,height:i}=n;const s=`translate(${t}px,${e}px)`;return{transform:s,WebkitTransform:s,MozTransform:s,msTransform:s,OTransform:s,width:`${r}px`,height:`${i}px`,position:"absolute"}}function j7(n){let{top:e,left:t,width:r,height:i}=n;return{top:`${e}px`,left:`${t}px`,width:`${r}px`,height:`${i}px`,position:"absolute"}}function cT(n,e){return e==="horizontal"?Ij(n):e==="vertical"?Dj(n):n}function Dj(n){return n.slice(0).sort(function(e,t){return e.y>t.y||e.y===t.y&&e.x>t.x?1:e.y===t.y&&e.x===t.x?0:-1})}function Ij(n){return n.slice(0).sort(function(e,t){return e.x>t.x||e.x===t.x&&e.y>t.y?1:-1})}function F7(n,e,t,r,i){n=n||[];const s=[];Uh.default.Children.forEach(e,o=>{if((o==null?void 0:o.key)==null)return;const l=nT(n,String(o.key)),c=o.props["data-grid"];l&&c==null?s.push(Yl(l)):c?s.push(Yl({...c,i:o.key})):s.push(Yl({w:1,h:1,x:0,y:tT(s),i:String(o.key)}))});const a=Cj(s,{cols:t});return i?a:Aj(a,r,t)}function U7(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Layout";const t=["x","y","w","h"];if(!Array.isArray(n))throw new Error(e+" must be an array!");for(let r=0,i=n.length;r<i;r++){const s=n[r];for(let a=0;a<t.length;a++){const o=t[a],l=s[o];if(typeof l!="number"||Number.isNaN(l))throw new Error(`ReactGridLayout: ${e}[${r}].${o} must be a number! Received: ${l} (${typeof l})`)}if(typeof s.i<"u"&&typeof s.i!="string")throw new Error(`ReactGridLayout: ${e}[${r}].i must be a string! Received: ${s.i} (${typeof s.i})`)}}function B7(n){const{verticalCompact:e,compactType:t}=n||{};return e===!1?null:t}const z7=()=>{};mt.noop=z7;var Us={};Object.defineProperty(Us,"__esModule",{value:!0});Us.calcGridColWidth=Ev;Us.calcGridItemPosition=$7;Us.calcGridItemWHPx=AS;Us.calcWH=H7;Us.calcXY=V7;Us.clamp=jl;function Ev(n){const{margin:e,containerPadding:t,containerWidth:r,cols:i}=n;return(r-e[0]*(i-1)-t[0]*2)/i}function AS(n,e,t){return Number.isFinite(n)?Math.round(e*n+Math.max(0,n-1)*t):n}function $7(n,e,t,r,i,s){const{margin:a,containerPadding:o,rowHeight:l}=n,c=Ev(n),u={};return s&&s.resizing?(u.width=Math.round(s.resizing.width),u.height=Math.round(s.resizing.height)):(u.width=AS(r,c,a[0]),u.height=AS(i,l,a[1])),s&&s.dragging?(u.top=Math.round(s.dragging.top),u.left=Math.round(s.dragging.left)):s&&s.resizing&&typeof s.resizing.top=="number"&&typeof s.resizing.left=="number"?(u.top=Math.round(s.resizing.top),u.left=Math.round(s.resizing.left)):(u.top=Math.round((l+a[1])*t+o[1]),u.left=Math.round((c+a[0])*e+o[0])),u}function V7(n,e,t,r,i){const{margin:s,containerPadding:a,cols:o,rowHeight:l,maxRows:c}=n,u=Ev(n);let d=Math.round((t-a[0])/(u+s[0])),h=Math.round((e-a[1])/(l+s[1]));return d=jl(d,0,o-r),h=jl(h,0,c-i),{x:d,y:h}}function H7(n,e,t,r,i,s){const{margin:a,maxRows:o,cols:l,rowHeight:c}=n,u=Ev(n);let d=Math.round((e+a[0])/(u+a[0])),h=Math.round((t+a[1])/(c+a[1])),p=jl(d,0,l-r),y=jl(h,0,o-i);return["sw","w","nw"].indexOf(s)!==-1&&(p=jl(d,0,l)),["nw","n","ne"].indexOf(s)!==-1&&(y=jl(h,0,o)),{w:p,h:y}}function jl(n,e,t){return Math.max(Math.min(n,t),e)}var Tv={},jj={exports:{}},W7="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",G7=W7,q7=G7;function Fj(){}function Uj(){}Uj.resetWarningCache=Fj;var X7=function(){function n(r,i,s,a,o,l){if(l!==q7){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}n.isRequired=n;function e(){return n}var t={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:e,element:n,elementType:n,instanceOf:e,node:n,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:Uj,resetWarningCache:Fj};return t.PropTypes=t,t};jj.exports=X7();var Qo=jj.exports,Mv={exports:{}},Bj={};function zj(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n))for(e=0;e<n.length;e++)n[e]&&(t=zj(n[e]))&&(r&&(r+=" "),r+=t);else for(e in n)n[e]&&(r&&(r+=" "),r+=e);return r}function lC(){for(var n,e,t=0,r="";t<arguments.length;)(n=arguments[t++])&&(e=zj(n))&&(r&&(r+=" "),r+=e);return r}const Y7=Object.freeze(Object.defineProperty({__proto__:null,clsx:lC,default:lC},Symbol.toStringTag,{value:"Module"})),K7=K1(Y7);var cn={},Bs={};Object.defineProperty(Bs,"__esModule",{value:!0});Bs.dontSetMe=tq;Bs.findInArray=Z7;Bs.int=eq;Bs.isFunction=J7;Bs.isNum=Q7;function Z7(n,e){for(let t=0,r=n.length;t<r;t++)if(e.apply(e,[n[t],t,n]))return n[t]}function J7(n){return typeof n=="function"||Object.prototype.toString.call(n)==="[object Function]"}function Q7(n){return typeof n=="number"&&!isNaN(n)}function eq(n){return parseInt(n,10)}function tq(n,e,t){if(n[e])return new Error("Invalid prop ".concat(e," passed to ").concat(t," - do not set this, set it on the child."))}var wc={};Object.defineProperty(wc,"__esModule",{value:!0});wc.browserPrefixToKey=Vj;wc.browserPrefixToStyle=nq;wc.default=void 0;wc.getPrefix=$j;const z_=["Moz","Webkit","O","ms"];function $j(){var n;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const t=(n=window.document)===null||n===void 0||(n=n.documentElement)===null||n===void 0?void 0:n.style;if(!t||e in t)return"";for(let r=0;r<z_.length;r++)if(Vj(e,z_[r])in t)return z_[r];return""}function Vj(n,e){return e?"".concat(e).concat(rq(n)):n}function nq(n,e){return e?"-".concat(e.toLowerCase(),"-").concat(n):n}function rq(n){let e="",t=!0;for(let r=0;r<n.length;r++)t?(e+=n[r].toUpperCase(),t=!1):n[r]==="-"?t=!0:e+=n[r];return e}wc.default=$j();Object.defineProperty(cn,"__esModule",{value:!0});cn.addClassName=Gj;cn.addEvent=aq;cn.addUserSelectStyles=yq;cn.createCSSTransform=fq;cn.createSVGTransform=pq;cn.getTouch=mq;cn.getTouchIdentifier=gq;cn.getTranslation=uT;cn.innerHeight=uq;cn.innerWidth=dq;cn.matchesSelector=Wj;cn.matchesSelectorAndParentsTo=sq;cn.offsetXYFromParent=hq;cn.outerHeight=lq;cn.outerWidth=cq;cn.removeClassName=qj;cn.removeEvent=oq;cn.removeUserSelectStyles=vq;var ni=Bs,cC=iq(wc);function Hj(n){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(Hj=function(r){return r?t:e})(n)}function iq(n,e){if(n&&n.__esModule)return n;if(n===null||typeof n!="object"&&typeof n!="function")return{default:n};var t=Hj(e);if(t&&t.has(n))return t.get(n);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in n)if(s!=="default"&&Object.prototype.hasOwnProperty.call(n,s)){var a=i?Object.getOwnPropertyDescriptor(n,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=n[s]}return r.default=n,t&&t.set(n,r),r}let eg="";function Wj(n,e){return eg||(eg=(0,ni.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(t){return(0,ni.isFunction)(n[t])})),(0,ni.isFunction)(n[eg])?n[eg](e):!1}function sq(n,e,t){let r=n;do{if(Wj(r,e))return!0;if(r===t)return!1;r=r.parentNode}while(r);return!1}function aq(n,e,t,r){if(!n)return;const i={capture:!0,...r};n.addEventListener?n.addEventListener(e,t,i):n.attachEvent?n.attachEvent("on"+e,t):n["on"+e]=t}function oq(n,e,t,r){if(!n)return;const i={capture:!0,...r};n.removeEventListener?n.removeEventListener(e,t,i):n.detachEvent?n.detachEvent("on"+e,t):n["on"+e]=null}function lq(n){let e=n.clientHeight;const t=n.ownerDocument.defaultView.getComputedStyle(n);return e+=(0,ni.int)(t.borderTopWidth),e+=(0,ni.int)(t.borderBottomWidth),e}function cq(n){let e=n.clientWidth;const t=n.ownerDocument.defaultView.getComputedStyle(n);return e+=(0,ni.int)(t.borderLeftWidth),e+=(0,ni.int)(t.borderRightWidth),e}function uq(n){let e=n.clientHeight;const t=n.ownerDocument.defaultView.getComputedStyle(n);return e-=(0,ni.int)(t.paddingTop),e-=(0,ni.int)(t.paddingBottom),e}function dq(n){let e=n.clientWidth;const t=n.ownerDocument.defaultView.getComputedStyle(n);return e-=(0,ni.int)(t.paddingLeft),e-=(0,ni.int)(t.paddingRight),e}function hq(n,e,t){const i=e===e.ownerDocument.body?{left:0,top:0}:e.getBoundingClientRect(),s=(n.clientX+e.scrollLeft-i.left)/t,a=(n.clientY+e.scrollTop-i.top)/t;return{x:s,y:a}}function fq(n,e){const t=uT(n,e,"px");return{[(0,cC.browserPrefixToKey)("transform",cC.default)]:t}}function pq(n,e){return uT(n,e,"")}function uT(n,e,t){let{x:r,y:i}=n,s="translate(".concat(r).concat(t,",").concat(i).concat(t,")");if(e){const a="".concat(typeof e.x=="string"?e.x:e.x+t),o="".concat(typeof e.y=="string"?e.y:e.y+t);s="translate(".concat(a,", ").concat(o,")")+s}return s}function mq(n,e){return n.targetTouches&&(0,ni.findInArray)(n.targetTouches,t=>e===t.identifier)||n.changedTouches&&(0,ni.findInArray)(n.changedTouches,t=>e===t.identifier)}function gq(n){if(n.targetTouches&&n.targetTouches[0])return n.targetTouches[0].identifier;if(n.changedTouches&&n.changedTouches[0])return n.changedTouches[0].identifier}function yq(n){if(!n)return;let e=n.getElementById("react-draggable-style-el");e||(e=n.createElement("style"),e.type="text/css",e.id="react-draggable-style-el",e.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,e.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,n.getElementsByTagName("head")[0].appendChild(e)),n.body&&Gj(n.body,"react-draggable-transparent-selection")}function vq(n){if(n)try{if(n.body&&qj(n.body,"react-draggable-transparent-selection"),n.selection)n.selection.empty();else{const e=(n.defaultView||window).getSelection();e&&e.type!=="Caret"&&e.removeAllRanges()}}catch{}}function Gj(n,e){n.classList?n.classList.add(e):n.className.match(new RegExp("(?:^|\\s)".concat(e,"(?!\\S)")))||(n.className+=" ".concat(e))}function qj(n,e){n.classList?n.classList.remove(e):n.className=n.className.replace(new RegExp("(?:^|\\s)".concat(e,"(?!\\S)"),"g"),"")}var zs={};Object.defineProperty(zs,"__esModule",{value:!0});zs.canDragX=bq;zs.canDragY=wq;zs.createCoreData=Eq;zs.createDraggableData=Tq;zs.getBoundPosition=xq;zs.getControlPosition=Sq;zs.snapToGrid=_q;var Xr=Bs,Mu=cn;function xq(n,e,t){if(!n.props.bounds)return[e,t];let{bounds:r}=n.props;r=typeof r=="string"?r:Mq(r);const i=dT(n);if(typeof r=="string"){const{ownerDocument:s}=i,a=s.defaultView;let o;if(r==="parent"?o=i.parentNode:o=s.querySelector(r),!(o instanceof a.HTMLElement))throw new Error('Bounds selector "'+r+'" could not find an element.');const l=o,c=a.getComputedStyle(i),u=a.getComputedStyle(l);r={left:-i.offsetLeft+(0,Xr.int)(u.paddingLeft)+(0,Xr.int)(c.marginLeft),top:-i.offsetTop+(0,Xr.int)(u.paddingTop)+(0,Xr.int)(c.marginTop),right:(0,Mu.innerWidth)(l)-(0,Mu.outerWidth)(i)-i.offsetLeft+(0,Xr.int)(u.paddingRight)-(0,Xr.int)(c.marginRight),bottom:(0,Mu.innerHeight)(l)-(0,Mu.outerHeight)(i)-i.offsetTop+(0,Xr.int)(u.paddingBottom)-(0,Xr.int)(c.marginBottom)}}return(0,Xr.isNum)(r.right)&&(e=Math.min(e,r.right)),(0,Xr.isNum)(r.bottom)&&(t=Math.min(t,r.bottom)),(0,Xr.isNum)(r.left)&&(e=Math.max(e,r.left)),(0,Xr.isNum)(r.top)&&(t=Math.max(t,r.top)),[e,t]}function _q(n,e,t){const r=Math.round(e/n[0])*n[0],i=Math.round(t/n[1])*n[1];return[r,i]}function bq(n){return n.props.axis==="both"||n.props.axis==="x"}function wq(n){return n.props.axis==="both"||n.props.axis==="y"}function Sq(n,e,t){const r=typeof e=="number"?(0,Mu.getTouch)(n,e):null;if(typeof e=="number"&&!r)return null;const i=dT(t),s=t.props.offsetParent||i.offsetParent||i.ownerDocument.body;return(0,Mu.offsetXYFromParent)(r||n,s,t.props.scale)}function Eq(n,e,t){const r=!(0,Xr.isNum)(n.lastX),i=dT(n);return r?{node:i,deltaX:0,deltaY:0,lastX:e,lastY:t,x:e,y:t}:{node:i,deltaX:e-n.lastX,deltaY:t-n.lastY,lastX:n.lastX,lastY:n.lastY,x:e,y:t}}function Tq(n,e){const t=n.props.scale;return{node:e.node,x:n.state.x+e.deltaX/t,y:n.state.y+e.deltaY/t,deltaX:e.deltaX/t,deltaY:e.deltaY/t,lastX:n.state.x,lastY:n.state.y}}function Mq(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom}}function dT(n){const e=n.findDOMNode();if(!e)throw new Error("<DraggableCore>: Unmounted during event!");return e}var kv={},Av={};Object.defineProperty(Av,"__esModule",{value:!0});Av.default=kq;function kq(){}Object.defineProperty(kv,"__esModule",{value:!0});kv.default=void 0;var $_=Pq(k),Mr=hT(Qo),Aq=hT(GE),qn=cn,Ga=zs,V_=Bs,ih=hT(Av);function hT(n){return n&&n.__esModule?n:{default:n}}function Xj(n){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(Xj=function(r){return r?t:e})(n)}function Pq(n,e){if(n&&n.__esModule)return n;if(n===null||typeof n!="object"&&typeof n!="function")return{default:n};var t=Xj(e);if(t&&t.has(n))return t.get(n);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in n)if(s!=="default"&&Object.prototype.hasOwnProperty.call(n,s)){var a=i?Object.getOwnPropertyDescriptor(n,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=n[s]}return r.default=n,t&&t.set(n,r),r}function fr(n,e,t){return e=Cq(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Cq(n){var e=Rq(n,"string");return typeof e=="symbol"?e:String(e)}function Rq(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Ui={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let qa=Ui.mouse,Pv=class extends $_.Component{constructor(){super(...arguments),fr(this,"dragging",!1),fr(this,"lastX",NaN),fr(this,"lastY",NaN),fr(this,"touchIdentifier",null),fr(this,"mounted",!1),fr(this,"handleDragStart",e=>{if(this.props.onMouseDown(e),!this.props.allowAnyClick&&typeof e.button=="number"&&e.button!==0)return!1;const t=this.findDOMNode();if(!t||!t.ownerDocument||!t.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:r}=t;if(this.props.disabled||!(e.target instanceof r.defaultView.Node)||this.props.handle&&!(0,qn.matchesSelectorAndParentsTo)(e.target,this.props.handle,t)||this.props.cancel&&(0,qn.matchesSelectorAndParentsTo)(e.target,this.props.cancel,t))return;e.type==="touchstart"&&e.preventDefault();const i=(0,qn.getTouchIdentifier)(e);this.touchIdentifier=i;const s=(0,Ga.getControlPosition)(e,i,this);if(s==null)return;const{x:a,y:o}=s,l=(0,Ga.createCoreData)(this,a,o);(0,ih.default)("DraggableCore: handleDragStart: %j",l),(0,ih.default)("calling",this.props.onStart),!(this.props.onStart(e,l)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,qn.addUserSelectStyles)(r),this.dragging=!0,this.lastX=a,this.lastY=o,(0,qn.addEvent)(r,qa.move,this.handleDrag),(0,qn.addEvent)(r,qa.stop,this.handleDragStop))}),fr(this,"handleDrag",e=>{const t=(0,Ga.getControlPosition)(e,this.touchIdentifier,this);if(t==null)return;let{x:r,y:i}=t;if(Array.isArray(this.props.grid)){let o=r-this.lastX,l=i-this.lastY;if([o,l]=(0,Ga.snapToGrid)(this.props.grid,o,l),!o&&!l)return;r=this.lastX+o,i=this.lastY+l}const s=(0,Ga.createCoreData)(this,r,i);if((0,ih.default)("DraggableCore: handleDrag: %j",s),this.props.onDrag(e,s)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const l=document.createEvent("MouseEvents");l.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(l)}return}this.lastX=r,this.lastY=i}),fr(this,"handleDragStop",e=>{if(!this.dragging)return;const t=(0,Ga.getControlPosition)(e,this.touchIdentifier,this);if(t==null)return;let{x:r,y:i}=t;if(Array.isArray(this.props.grid)){let l=r-this.lastX||0,c=i-this.lastY||0;[l,c]=(0,Ga.snapToGrid)(this.props.grid,l,c),r=this.lastX+l,i=this.lastY+c}const s=(0,Ga.createCoreData)(this,r,i);if(this.props.onStop(e,s)===!1||this.mounted===!1)return!1;const o=this.findDOMNode();o&&this.props.enableUserSelectHack&&(0,qn.removeUserSelectStyles)(o.ownerDocument),(0,ih.default)("DraggableCore: handleDragStop: %j",s),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,o&&((0,ih.default)("DraggableCore: Removing handlers"),(0,qn.removeEvent)(o.ownerDocument,qa.move,this.handleDrag),(0,qn.removeEvent)(o.ownerDocument,qa.stop,this.handleDragStop))}),fr(this,"onMouseDown",e=>(qa=Ui.mouse,this.handleDragStart(e))),fr(this,"onMouseUp",e=>(qa=Ui.mouse,this.handleDragStop(e))),fr(this,"onTouchStart",e=>(qa=Ui.touch,this.handleDragStart(e))),fr(this,"onTouchEnd",e=>(qa=Ui.touch,this.handleDragStop(e)))}componentDidMount(){this.mounted=!0;const e=this.findDOMNode();e&&(0,qn.addEvent)(e,Ui.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const e=this.findDOMNode();if(e){const{ownerDocument:t}=e;(0,qn.removeEvent)(t,Ui.mouse.move,this.handleDrag),(0,qn.removeEvent)(t,Ui.touch.move,this.handleDrag),(0,qn.removeEvent)(t,Ui.mouse.stop,this.handleDragStop),(0,qn.removeEvent)(t,Ui.touch.stop,this.handleDragStop),(0,qn.removeEvent)(e,Ui.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,qn.removeUserSelectStyles)(t)}}findDOMNode(){var e,t;return(e=this.props)!==null&&e!==void 0&&e.nodeRef?(t=this.props)===null||t===void 0||(t=t.nodeRef)===null||t===void 0?void 0:t.current:Aq.default.findDOMNode(this)}render(){return $_.cloneElement($_.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};kv.default=Pv;fr(Pv,"displayName","DraggableCore");fr(Pv,"propTypes",{allowAnyClick:Mr.default.bool,children:Mr.default.node.isRequired,disabled:Mr.default.bool,enableUserSelectHack:Mr.default.bool,offsetParent:function(n,e){if(n[e]&&n[e].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:Mr.default.arrayOf(Mr.default.number),handle:Mr.default.string,cancel:Mr.default.string,nodeRef:Mr.default.object,onStart:Mr.default.func,onDrag:Mr.default.func,onStop:Mr.default.func,onMouseDown:Mr.default.func,scale:Mr.default.number,className:V_.dontSetMe,style:V_.dontSetMe,transform:V_.dontSetMe});fr(Pv,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1});(function(n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"DraggableCore",{enumerable:!0,get:function(){return l.default}}),n.default=void 0;var e=h(k),t=u(Qo),r=u(GE),i=u(K7),s=cn,a=zs,o=Bs,l=u(kv),c=u(Av);function u(x){return x&&x.__esModule?x:{default:x}}function d(x){if(typeof WeakMap!="function")return null;var _=new WeakMap,b=new WeakMap;return(d=function(w){return w?b:_})(x)}function h(x,_){if(x&&x.__esModule)return x;if(x===null||typeof x!="object"&&typeof x!="function")return{default:x};var b=d(_);if(b&&b.has(x))return b.get(x);var w={},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var S in x)if(S!=="default"&&Object.prototype.hasOwnProperty.call(x,S)){var M=E?Object.getOwnPropertyDescriptor(x,S):null;M&&(M.get||M.set)?Object.defineProperty(w,S,M):w[S]=x[S]}return w.default=x,b&&b.set(x,w),w}function p(){return p=Object.assign?Object.assign.bind():function(x){for(var _=1;_<arguments.length;_++){var b=arguments[_];for(var w in b)Object.prototype.hasOwnProperty.call(b,w)&&(x[w]=b[w])}return x},p.apply(this,arguments)}function y(x,_,b){return _=v(_),_ in x?Object.defineProperty(x,_,{value:b,enumerable:!0,configurable:!0,writable:!0}):x[_]=b,x}function v(x){var _=g(x,"string");return typeof _=="symbol"?_:String(_)}function g(x,_){if(typeof x!="object"||x===null)return x;var b=x[Symbol.toPrimitive];if(b!==void 0){var w=b.call(x,_||"default");if(typeof w!="object")return w;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_==="string"?String:Number)(x)}class m extends e.Component{static getDerivedStateFromProps(_,b){let{position:w}=_,{prevPropsPosition:E}=b;return w&&(!E||w.x!==E.x||w.y!==E.y)?((0,c.default)("Draggable: getDerivedStateFromProps %j",{position:w,prevPropsPosition:E}),{x:w.x,y:w.y,prevPropsPosition:{...w}}):null}constructor(_){super(_),y(this,"onDragStart",(b,w)=>{if((0,c.default)("Draggable: onDragStart: %j",w),this.props.onStart(b,(0,a.createDraggableData)(this,w))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),y(this,"onDrag",(b,w)=>{if(!this.state.dragging)return!1;(0,c.default)("Draggable: onDrag: %j",w);const E=(0,a.createDraggableData)(this,w),S={x:E.x,y:E.y,slackX:0,slackY:0};if(this.props.bounds){const{x:N,y:T}=S;S.x+=this.state.slackX,S.y+=this.state.slackY;const[P,H]=(0,a.getBoundPosition)(this,S.x,S.y);S.x=P,S.y=H,S.slackX=this.state.slackX+(N-S.x),S.slackY=this.state.slackY+(T-S.y),E.x=S.x,E.y=S.y,E.deltaX=S.x-this.state.x,E.deltaY=S.y-this.state.y}if(this.props.onDrag(b,E)===!1)return!1;this.setState(S)}),y(this,"onDragStop",(b,w)=>{if(!this.state.dragging||this.props.onStop(b,(0,a.createDraggableData)(this,w))===!1)return!1;(0,c.default)("Draggable: onDragStop: %j",w);const S={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){const{x:N,y:T}=this.props.position;S.x=N,S.y=T}this.setState(S)}),this.state={dragging:!1,dragged:!1,x:_.position?_.position.x:_.defaultPosition.x,y:_.position?_.position.y:_.defaultPosition.y,prevPropsPosition:{..._.position},slackX:0,slackY:0,isElementSVG:!1},_.position&&!(_.onDrag||_.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.setState({dragging:!1})}findDOMNode(){var _,b;return(_=(b=this.props)===null||b===void 0||(b=b.nodeRef)===null||b===void 0?void 0:b.current)!==null&&_!==void 0?_:r.default.findDOMNode(this)}render(){const{axis:_,bounds:b,children:w,defaultPosition:E,defaultClassName:S,defaultClassNameDragging:M,defaultClassNameDragged:N,position:T,positionOffset:P,scale:H,...W}=this.props;let O={},I=null;const j=!!!T||this.state.dragging,L=T||E,D={x:(0,a.canDragX)(this)&&j?this.state.x:L.x,y:(0,a.canDragY)(this)&&j?this.state.y:L.y};this.state.isElementSVG?I=(0,s.createSVGTransform)(D,P):O=(0,s.createCSSTransform)(D,P);const z=(0,i.default)(w.props.className||"",S,{[M]:this.state.dragging,[N]:this.state.dragged});return e.createElement(l.default,p({},W,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),e.cloneElement(e.Children.only(w),{className:z,style:{...w.props.style,...O},transform:I}))}}n.default=m,y(m,"displayName","Draggable"),y(m,"propTypes",{...l.default.propTypes,axis:t.default.oneOf(["both","x","y","none"]),bounds:t.default.oneOfType([t.default.shape({left:t.default.number,right:t.default.number,top:t.default.number,bottom:t.default.number}),t.default.string,t.default.oneOf([!1])]),defaultClassName:t.default.string,defaultClassNameDragging:t.default.string,defaultClassNameDragged:t.default.string,defaultPosition:t.default.shape({x:t.default.number,y:t.default.number}),positionOffset:t.default.shape({x:t.default.oneOfType([t.default.number,t.default.string]),y:t.default.oneOfType([t.default.number,t.default.string])}),position:t.default.shape({x:t.default.number,y:t.default.number}),className:o.dontSetMe,style:o.dontSetMe,transform:o.dontSetMe}),y(m,"defaultProps",{...l.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})})(Bj);const{default:Yj,DraggableCore:Nq}=Bj;Mv.exports=Yj;Mv.exports.default=Yj;Mv.exports.DraggableCore=Nq;var Kj=Mv.exports,Cv={exports:{}},Hp={},fT={};fT.__esModule=!0;fT.cloneElement=Fq;var Oq=Lq(k);function Lq(n){return n&&n.__esModule?n:{default:n}}function uC(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function dC(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?uC(Object(t),!0).forEach(function(r){Dq(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):uC(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Dq(n,e,t){return e=Iq(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Iq(n){var e=jq(n,"string");return typeof e=="symbol"?e:String(e)}function jq(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Fq(n,e){return e.style&&n.props.style&&(e.style=dC(dC({},n.props.style),e.style)),e.className&&n.props.className&&(e.className=n.props.className+" "+e.className),Oq.default.cloneElement(n,e)}var Wp={};Wp.__esModule=!0;Wp.resizableProps=void 0;var rt=Uq(Qo);function Uq(n){return n&&n.__esModule?n:{default:n}}var Bq={axis:rt.default.oneOf(["both","x","y","none"]),className:rt.default.string,children:rt.default.element.isRequired,draggableOpts:rt.default.shape({allowAnyClick:rt.default.bool,cancel:rt.default.string,children:rt.default.node,disabled:rt.default.bool,enableUserSelectHack:rt.default.bool,offsetParent:rt.default.node,grid:rt.default.arrayOf(rt.default.number),handle:rt.default.string,nodeRef:rt.default.object,onStart:rt.default.func,onDrag:rt.default.func,onStop:rt.default.func,onMouseDown:rt.default.func,scale:rt.default.number}),height:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[0];if(i.axis==="both"||i.axis==="y"){var s;return(s=rt.default.number).isRequired.apply(s,t)}return rt.default.number.apply(rt.default,t)},handle:rt.default.oneOfType([rt.default.node,rt.default.func]),handleSize:rt.default.arrayOf(rt.default.number),lockAspectRatio:rt.default.bool,maxConstraints:rt.default.arrayOf(rt.default.number),minConstraints:rt.default.arrayOf(rt.default.number),onResizeStop:rt.default.func,onResizeStart:rt.default.func,onResize:rt.default.func,resizeHandles:rt.default.arrayOf(rt.default.oneOf(["s","w","e","n","sw","nw","se","ne"])),transformScale:rt.default.number,width:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[0];if(i.axis==="both"||i.axis==="x"){var s;return(s=rt.default.number).isRequired.apply(s,t)}return rt.default.number.apply(rt.default,t)}};Wp.resizableProps=Bq;Hp.__esModule=!0;Hp.default=void 0;var sh=Wq(k),zq=Kj,$q=fT,Vq=Wp,Hq=["children","className","draggableOpts","width","height","handle","handleSize","lockAspectRatio","axis","minConstraints","maxConstraints","onResize","onResizeStop","onResizeStart","resizeHandles","transformScale"];function Zj(n){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(Zj=function(i){return i?t:e})(n)}function Wq(n,e){if(n&&n.__esModule)return n;if(n===null||typeof n!="object"&&typeof n!="function")return{default:n};var t=Zj(e);if(t&&t.has(n))return t.get(n);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in n)if(s!=="default"&&Object.prototype.hasOwnProperty.call(n,s)){var a=i?Object.getOwnPropertyDescriptor(n,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=n[s]}return r.default=n,t&&t.set(n,r),r}function PS(){return PS=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},PS.apply(this,arguments)}function Gq(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function hC(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function H_(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?hC(Object(t),!0).forEach(function(r){qq(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):hC(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function qq(n,e,t){return e=Xq(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Xq(n){var e=Yq(n,"string");return typeof e=="symbol"?e:String(e)}function Yq(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Kq(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,CS(n,e)}function CS(n,e){return CS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},CS(n,e)}var pT=function(n){Kq(e,n);function e(){for(var r,i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return r=n.call.apply(n,[this].concat(s))||this,r.handleRefs={},r.lastHandleRect=null,r.slack=null,r}var t=e.prototype;return t.componentWillUnmount=function(){this.resetData()},t.resetData=function(){this.lastHandleRect=this.slack=null},t.runConstraints=function(i,s){var a=this.props,o=a.minConstraints,l=a.maxConstraints,c=a.lockAspectRatio;if(!o&&!l&&!c)return[i,s];if(c){var u=this.props.width/this.props.height,d=i-this.props.width,h=s-this.props.height;Math.abs(d)>Math.abs(h*u)?s=i/u:i=s*u}var p=i,y=s,v=this.slack||[0,0],g=v[0],m=v[1];return i+=g,s+=m,o&&(i=Math.max(o[0],i),s=Math.max(o[1],s)),l&&(i=Math.min(l[0],i),s=Math.min(l[1],s)),this.slack=[g+(p-i),m+(y-s)],[i,s]},t.resizeHandler=function(i,s){var a=this;return function(o,l){var c=l.node,u=l.deltaX,d=l.deltaY;i==="onResizeStart"&&a.resetData();var h=(a.props.axis==="both"||a.props.axis==="x")&&s!=="n"&&s!=="s",p=(a.props.axis==="both"||a.props.axis==="y")&&s!=="e"&&s!=="w";if(!(!h&&!p)){var y=s[0],v=s[s.length-1],g=c.getBoundingClientRect();if(a.lastHandleRect!=null){if(v==="w"){var m=g.left-a.lastHandleRect.left;u+=m}if(y==="n"){var x=g.top-a.lastHandleRect.top;d+=x}}a.lastHandleRect=g,v==="w"&&(u=-u),y==="n"&&(d=-d);var _=a.props.width+(h?u/a.props.transformScale:0),b=a.props.height+(p?d/a.props.transformScale:0),w=a.runConstraints(_,b);_=w[0],b=w[1];var E=_!==a.props.width||b!==a.props.height,S=typeof a.props[i]=="function"?a.props[i]:null,M=i==="onResize"&&!E;S&&!M&&(o.persist==null||o.persist(),S(o,{node:c,size:{width:_,height:b},handle:s})),i==="onResizeStop"&&a.resetData()}}},t.renderResizeHandle=function(i,s){var a=this.props.handle;if(!a)return sh.createElement("span",{className:"react-resizable-handle react-resizable-handle-"+i,ref:s});if(typeof a=="function")return a(i,s);var o=typeof a.type=="string",l=H_({ref:s},o?{}:{handleAxis:i});return sh.cloneElement(a,l)},t.render=function(){var i=this,s=this.props,a=s.children,o=s.className,l=s.draggableOpts;s.width,s.height,s.handle,s.handleSize,s.lockAspectRatio,s.axis,s.minConstraints,s.maxConstraints,s.onResize,s.onResizeStop,s.onResizeStart;var c=s.resizeHandles;s.transformScale;var u=Gq(s,Hq);return(0,$q.cloneElement)(a,H_(H_({},u),{},{className:(o?o+" ":"")+"react-resizable",children:[].concat(a.props.children,c.map(function(d){var h,p=(h=i.handleRefs[d])!=null?h:i.handleRefs[d]=sh.createRef();return sh.createElement(zq.DraggableCore,PS({},l,{nodeRef:p,key:"resizableHandle-"+d,onStop:i.resizeHandler("onResizeStop",d),onStart:i.resizeHandler("onResizeStart",d),onDrag:i.resizeHandler("onResize",d)}),i.renderResizeHandle(d,p))}))}))},e}(sh.Component);Hp.default=pT;pT.propTypes=Vq.resizableProps;pT.defaultProps={axis:"both",handleSize:[20,20],lockAspectRatio:!1,minConstraints:[20,20],maxConstraints:[1/0,1/0],resizeHandles:["se"],transformScale:1};var Rv={};Rv.__esModule=!0;Rv.default=void 0;var W_=tX(k),Zq=Jj(Qo),Jq=Jj(Hp),Qq=Wp,eX=["handle","handleSize","onResize","onResizeStart","onResizeStop","draggableOpts","minConstraints","maxConstraints","lockAspectRatio","axis","width","height","resizeHandles","style","transformScale"];function Jj(n){return n&&n.__esModule?n:{default:n}}function Qj(n){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(Qj=function(i){return i?t:e})(n)}function tX(n,e){if(n&&n.__esModule)return n;if(n===null||typeof n!="object"&&typeof n!="function")return{default:n};var t=Qj(e);if(t&&t.has(n))return t.get(n);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in n)if(s!=="default"&&Object.prototype.hasOwnProperty.call(n,s)){var a=i?Object.getOwnPropertyDescriptor(n,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=n[s]}return r.default=n,t&&t.set(n,r),r}function RS(){return RS=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},RS.apply(this,arguments)}function fC(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function s0(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?fC(Object(t),!0).forEach(function(r){nX(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):fC(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function nX(n,e,t){return e=rX(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function rX(n){var e=iX(n,"string");return typeof e=="symbol"?e:String(e)}function iX(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function sX(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function aX(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,NS(n,e)}function NS(n,e){return NS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},NS(n,e)}var e3=function(n){aX(e,n);function e(){for(var r,i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return r=n.call.apply(n,[this].concat(s))||this,r.state={width:r.props.width,height:r.props.height,propsWidth:r.props.width,propsHeight:r.props.height},r.onResize=function(o,l){var c=l.size;r.props.onResize?(o.persist==null||o.persist(),r.setState(c,function(){return r.props.onResize&&r.props.onResize(o,l)})):r.setState(c)},r}e.getDerivedStateFromProps=function(i,s){return s.propsWidth!==i.width||s.propsHeight!==i.height?{width:i.width,height:i.height,propsWidth:i.width,propsHeight:i.height}:null};var t=e.prototype;return t.render=function(){var i=this.props,s=i.handle,a=i.handleSize;i.onResize;var o=i.onResizeStart,l=i.onResizeStop,c=i.draggableOpts,u=i.minConstraints,d=i.maxConstraints,h=i.lockAspectRatio,p=i.axis;i.width,i.height;var y=i.resizeHandles,v=i.style,g=i.transformScale,m=sX(i,eX);return W_.createElement(Jq.default,{axis:p,draggableOpts:c,handle:s,handleSize:a,height:this.state.height,lockAspectRatio:h,maxConstraints:d,minConstraints:u,onResizeStart:o,onResize:this.onResize,onResizeStop:l,resizeHandles:y,transformScale:g,width:this.state.width},W_.createElement("div",RS({},m,{style:s0(s0({},v),{},{width:this.state.width+"px",height:this.state.height+"px"})})))},e}(W_.Component);Rv.default=e3;e3.propTypes=s0(s0({},Qq.resizableProps),{},{children:Zq.default.element});Cv.exports=function(){throw new Error("Don't instantiate Resizable directly! Use require('react-resizable').Resizable")};Cv.exports.Resizable=Hp.default;Cv.exports.ResizableBox=Rv.default;var oX=Cv.exports,wa={};Object.defineProperty(wa,"__esModule",{value:!0});wa.resizeHandleType=wa.resizeHandleAxesType=wa.default=void 0;var at=t3(Qo),lX=t3(k);function t3(n){return n&&n.__esModule?n:{default:n}}const cX=wa.resizeHandleAxesType=at.default.arrayOf(at.default.oneOf(["s","w","e","n","sw","nw","se","ne"])),uX=wa.resizeHandleType=at.default.oneOfType([at.default.node,at.default.func]);wa.default={className:at.default.string,style:at.default.object,width:at.default.number,autoSize:at.default.bool,cols:at.default.number,draggableCancel:at.default.string,draggableHandle:at.default.string,verticalCompact:function(n){n.verticalCompact},compactType:at.default.oneOf(["vertical","horizontal"]),layout:function(n){var e=n.layout;e!==void 0&&mt.validateLayout(e,"layout")},margin:at.default.arrayOf(at.default.number),containerPadding:at.default.arrayOf(at.default.number),rowHeight:at.default.number,maxRows:at.default.number,isBounded:at.default.bool,isDraggable:at.default.bool,isResizable:at.default.bool,allowOverlap:at.default.bool,preventCollision:at.default.bool,useCSSTransforms:at.default.bool,transformScale:at.default.number,isDroppable:at.default.bool,resizeHandles:cX,resizeHandle:uX,onLayoutChange:at.default.func,onDragStart:at.default.func,onDrag:at.default.func,onDragStop:at.default.func,onResizeStart:at.default.func,onResize:at.default.func,onResizeStop:at.default.func,onDrop:at.default.func,droppingItem:at.default.shape({i:at.default.string.isRequired,w:at.default.number.isRequired,h:at.default.number.isRequired}),children:function(n,e){const t=n[e],r={};lX.default.Children.forEach(t,function(i){if((i==null?void 0:i.key)!=null){if(r[i.key])throw new Error('Duplicate child key "'+i.key+'" found! This will cause problems in ReactGridLayout.');r[i.key]=!0}})},innerRef:at.default.any};Object.defineProperty(Tv,"__esModule",{value:!0});Tv.default=void 0;var Gc=mT(k),kt=mT(Qo),dX=Kj,hX=oX,qc=mt,In=Us,pC=wa,fX=mT(eT);function mT(n){return n&&n.__esModule?n:{default:n}}function xs(n,e,t){return e=pX(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function pX(n){var e=mX(n,"string");return typeof e=="symbol"?e:String(e)}function mX(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class gT extends Gc.default.Component{constructor(){super(...arguments),xs(this,"state",{resizing:null,dragging:null,className:""}),xs(this,"elementRef",Gc.default.createRef()),xs(this,"onDragStart",(e,t)=>{let{node:r}=t;const{onDragStart:i,transformScale:s}=this.props;if(!i)return;const a={top:0,left:0},{offsetParent:o}=r;if(!o)return;const l=o.getBoundingClientRect(),c=r.getBoundingClientRect(),u=c.left/s,d=l.left/s,h=c.top/s,p=l.top/s;a.left=u-d+o.scrollLeft,a.top=h-p+o.scrollTop,this.setState({dragging:a});const{x:y,y:v}=(0,In.calcXY)(this.getPositionParams(),a.top,a.left,this.props.w,this.props.h);return i.call(this,this.props.i,y,v,{e,node:r,newPosition:a})}),xs(this,"onDrag",(e,t)=>{let{node:r,deltaX:i,deltaY:s}=t;const{onDrag:a}=this.props;if(!a)return;if(!this.state.dragging)throw new Error("onDrag called before onDragStart.");let o=this.state.dragging.top+s,l=this.state.dragging.left+i;const{isBounded:c,i:u,w:d,h,containerWidth:p}=this.props,y=this.getPositionParams();if(c){const{offsetParent:x}=r;if(x){const{margin:_,rowHeight:b,containerPadding:w}=this.props,E=x.clientHeight-(0,In.calcGridItemWHPx)(h,b,_[1]);o=(0,In.clamp)(o-w[1],0,E);const S=(0,In.calcGridColWidth)(y),M=p-(0,In.calcGridItemWHPx)(d,S,_[0]);l=(0,In.clamp)(l-w[0],0,M)}}const v={top:o,left:l};this.setState({dragging:v});const{x:g,y:m}=(0,In.calcXY)(y,o,l,d,h);return a.call(this,u,g,m,{e,node:r,newPosition:v})}),xs(this,"onDragStop",(e,t)=>{let{node:r}=t;const{onDragStop:i}=this.props;if(!i)return;if(!this.state.dragging)throw new Error("onDragEnd called before onDragStart.");const{w:s,h:a,i:o}=this.props,{left:l,top:c}=this.state.dragging,u={top:c,left:l};this.setState({dragging:null});const{x:d,y:h}=(0,In.calcXY)(this.getPositionParams(),c,l,s,a);return i.call(this,o,d,h,{e,node:r,newPosition:u})}),xs(this,"onResizeStop",(e,t,r)=>this.onResizeHandler(e,t,r,"onResizeStop")),xs(this,"onResizeStart",(e,t,r)=>this.onResizeHandler(e,t,r,"onResizeStart")),xs(this,"onResize",(e,t,r)=>this.onResizeHandler(e,t,r,"onResize"))}shouldComponentUpdate(e,t){if(this.props.children!==e.children||this.props.droppingPosition!==e.droppingPosition)return!0;const r=(0,In.calcGridItemPosition)(this.getPositionParams(this.props),this.props.x,this.props.y,this.props.w,this.props.h,this.state),i=(0,In.calcGridItemPosition)(this.getPositionParams(e),e.x,e.y,e.w,e.h,t);return!(0,qc.fastPositionEqual)(r,i)||this.props.useCSSTransforms!==e.useCSSTransforms}componentDidMount(){this.moveDroppingItem({})}componentDidUpdate(e){this.moveDroppingItem(e)}moveDroppingItem(e){const{droppingPosition:t}=this.props;if(!t)return;const r=this.elementRef.current;if(!r)return;const i=e.droppingPosition||{left:0,top:0},{dragging:s}=this.state,a=s&&t.left!==i.left||t.top!==i.top;if(!s)this.onDragStart(t.e,{node:r,deltaX:t.left,deltaY:t.top});else if(a){const o=t.left-s.left,l=t.top-s.top;this.onDrag(t.e,{node:r,deltaX:o,deltaY:l})}}getPositionParams(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props;return{cols:e.cols,containerPadding:e.containerPadding,containerWidth:e.containerWidth,margin:e.margin,maxRows:e.maxRows,rowHeight:e.rowHeight}}createStyle(e){const{usePercentages:t,containerWidth:r,useCSSTransforms:i}=this.props;let s;return i?s=(0,qc.setTransform)(e):(s=(0,qc.setTopLeft)(e),t&&(s.left=(0,qc.perc)(e.left/r),s.width=(0,qc.perc)(e.width/r))),s}mixinDraggable(e,t){return Gc.default.createElement(dX.DraggableCore,{disabled:!t,onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop,handle:this.props.handle,cancel:".react-resizable-handle"+(this.props.cancel?","+this.props.cancel:""),scale:this.props.transformScale,nodeRef:this.elementRef},e)}curryResizeHandler(e,t){return(r,i)=>t(r,i,e)}mixinResizable(e,t,r){const{cols:i,minW:s,minH:a,maxW:o,maxH:l,transformScale:c,resizeHandles:u,resizeHandle:d}=this.props,h=this.getPositionParams(),p=(0,In.calcGridItemPosition)(h,0,0,i,0).width,y=(0,In.calcGridItemPosition)(h,0,0,s,a),v=(0,In.calcGridItemPosition)(h,0,0,o,l),g=[y.width,y.height],m=[Math.min(v.width,p),Math.min(v.height,1/0)];return Gc.default.createElement(hX.Resizable,{draggableOpts:{disabled:!r},className:r?void 0:"react-resizable-hide",width:t.width,height:t.height,minConstraints:g,maxConstraints:m,onResizeStop:this.curryResizeHandler(t,this.onResizeStop),onResizeStart:this.curryResizeHandler(t,this.onResizeStart),onResize:this.curryResizeHandler(t,this.onResize),transformScale:c,resizeHandles:u,handle:d},e)}onResizeHandler(e,t,r,i){let{node:s,size:a,handle:o}=t;const l=this.props[i];if(!l)return;const{x:c,y:u,i:d,maxH:h,minH:p,containerWidth:y}=this.props,{minW:v,maxW:g}=this.props;let m=a;s&&(m=(0,qc.resizeItemInDirection)(o,r,a,y),this.setState({resizing:i==="onResizeStop"?null:m}));let{w:x,h:_}=(0,In.calcWH)(this.getPositionParams(),m.width,m.height,c,u,o);x=(0,In.clamp)(x,Math.max(v,1),g),_=(0,In.clamp)(_,p,h),l.call(this,d,x,_,{e,node:s,size:m,handle:o})}render(){const{x:e,y:t,w:r,h:i,isDraggable:s,isResizable:a,droppingPosition:o,useCSSTransforms:l}=this.props,c=(0,In.calcGridItemPosition)(this.getPositionParams(),e,t,r,i,this.state),u=Gc.default.Children.only(this.props.children);let d=Gc.default.cloneElement(u,{ref:this.elementRef,className:(0,fX.default)("react-grid-item",u.props.className,this.props.className,{static:this.props.static,resizing:!!this.state.resizing,"react-draggable":s,"react-draggable-dragging":!!this.state.dragging,dropping:!!o,cssTransforms:l}),style:{...this.props.style,...u.props.style,...this.createStyle(c)}});return d=this.mixinResizable(d,c,a),d=this.mixinDraggable(d,s),d}}Tv.default=gT;xs(gT,"propTypes",{children:kt.default.element,cols:kt.default.number.isRequired,containerWidth:kt.default.number.isRequired,rowHeight:kt.default.number.isRequired,margin:kt.default.array.isRequired,maxRows:kt.default.number.isRequired,containerPadding:kt.default.array.isRequired,x:kt.default.number.isRequired,y:kt.default.number.isRequired,w:kt.default.number.isRequired,h:kt.default.number.isRequired,minW:function(n,e){const t=n[e];if(typeof t!="number")return new Error("minWidth not Number");if(t>n.w||t>n.maxW)return new Error("minWidth larger than item width/maxWidth")},maxW:function(n,e){const t=n[e];if(typeof t!="number")return new Error("maxWidth not Number");if(t<n.w||t<n.minW)return new Error("maxWidth smaller than item width/minWidth")},minH:function(n,e){const t=n[e];if(typeof t!="number")return new Error("minHeight not Number");if(t>n.h||t>n.maxH)return new Error("minHeight larger than item height/maxHeight")},maxH:function(n,e){const t=n[e];if(typeof t!="number")return new Error("maxHeight not Number");if(t<n.h||t<n.minH)return new Error("maxHeight smaller than item height/minHeight")},i:kt.default.string.isRequired,resizeHandles:pC.resizeHandleAxesType,resizeHandle:pC.resizeHandleType,onDragStop:kt.default.func,onDragStart:kt.default.func,onDrag:kt.default.func,onResizeStop:kt.default.func,onResizeStart:kt.default.func,onResize:kt.default.func,isDraggable:kt.default.bool.isRequired,isResizable:kt.default.bool.isRequired,isBounded:kt.default.bool.isRequired,static:kt.default.bool,useCSSTransforms:kt.default.bool.isRequired,transformScale:kt.default.number,className:kt.default.string,handle:kt.default.string,cancel:kt.default.string,droppingPosition:kt.default.shape({e:kt.default.object.isRequired,left:kt.default.number.isRequired,top:kt.default.number.isRequired})});xs(gT,"defaultProps",{className:"",cancel:"",handle:"",minH:1,minW:1,maxH:1/0,maxW:1/0,transformScale:1});Object.defineProperty(Vp,"__esModule",{value:!0});Vp.default=void 0;var ul=xX(k),G_=QE,gX=yT(eT),Ye=mt,yX=Us,mC=yT(Tv),vX=yT(wa);function yT(n){return n&&n.__esModule?n:{default:n}}function n3(n){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(n3=function(r){return r?t:e})(n)}function xX(n,e){if(n&&n.__esModule)return n;if(n===null||typeof n!="object"&&typeof n!="function")return{default:n};var t=n3(e);if(t&&t.has(n))return t.get(n);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in n)if(s!=="default"&&Object.prototype.hasOwnProperty.call(n,s)){var a=i?Object.getOwnPropertyDescriptor(n,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=n[s]}return r.default=n,t&&t.set(n,r),r}function Kn(n,e,t){return e=_X(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _X(n){var e=bX(n,"string");return typeof e=="symbol"?e:String(e)}function bX(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const gC="react-grid-layout";let r3=!1;try{r3=/firefox/i.test(navigator.userAgent)}catch{}class Nv extends ul.Component{constructor(){super(...arguments),Kn(this,"state",{activeDrag:null,layout:(0,Ye.synchronizeLayoutWithChildren)(this.props.layout,this.props.children,this.props.cols,(0,Ye.compactType)(this.props),this.props.allowOverlap),mounted:!1,oldDragItem:null,oldLayout:null,oldResizeItem:null,resizing:!1,droppingDOMNode:null,children:[]}),Kn(this,"dragEnterCounter",0),Kn(this,"onDragStart",(e,t,r,i)=>{let{e:s,node:a}=i;const{layout:o}=this.state,l=(0,Ye.getLayoutItem)(o,e);if(!l)return;const c={w:l.w,h:l.h,x:l.x,y:l.y,placeholder:!0,i:e};return this.setState({oldDragItem:(0,Ye.cloneLayoutItem)(l),oldLayout:o,activeDrag:c}),this.props.onDragStart(o,l,l,null,s,a)}),Kn(this,"onDrag",(e,t,r,i)=>{let{e:s,node:a}=i;const{oldDragItem:o}=this.state;let{layout:l}=this.state;const{cols:c,allowOverlap:u,preventCollision:d}=this.props,h=(0,Ye.getLayoutItem)(l,e);if(!h)return;const p={w:h.w,h:h.h,x:h.x,y:h.y,placeholder:!0,i:e};l=(0,Ye.moveElement)(l,h,t,r,!0,d,(0,Ye.compactType)(this.props),c,u),this.props.onDrag(l,o,h,p,s,a),this.setState({layout:u?l:(0,Ye.compact)(l,(0,Ye.compactType)(this.props),c),activeDrag:p})}),Kn(this,"onDragStop",(e,t,r,i)=>{let{e:s,node:a}=i;if(!this.state.activeDrag)return;const{oldDragItem:o}=this.state;let{layout:l}=this.state;const{cols:c,preventCollision:u,allowOverlap:d}=this.props,h=(0,Ye.getLayoutItem)(l,e);if(!h)return;l=(0,Ye.moveElement)(l,h,t,r,!0,u,(0,Ye.compactType)(this.props),c,d);const y=d?l:(0,Ye.compact)(l,(0,Ye.compactType)(this.props),c);this.props.onDragStop(y,o,h,null,s,a);const{oldLayout:v}=this.state;this.setState({activeDrag:null,layout:y,oldDragItem:null,oldLayout:null}),this.onLayoutMaybeChanged(y,v)}),Kn(this,"onResizeStart",(e,t,r,i)=>{let{e:s,node:a}=i;const{layout:o}=this.state,l=(0,Ye.getLayoutItem)(o,e);l&&(this.setState({oldResizeItem:(0,Ye.cloneLayoutItem)(l),oldLayout:this.state.layout,resizing:!0}),this.props.onResizeStart(o,l,l,null,s,a))}),Kn(this,"onResize",(e,t,r,i)=>{let{e:s,node:a,size:o,handle:l}=i;const{oldResizeItem:c}=this.state,{layout:u}=this.state,{cols:d,preventCollision:h,allowOverlap:p}=this.props;let y=!1,v,g,m;const[x,_]=(0,Ye.withLayoutItem)(u,e,w=>{let E;return g=w.x,m=w.y,["sw","w","nw","n","ne"].indexOf(l)!==-1&&(["sw","nw","w"].indexOf(l)!==-1&&(g=w.x+(w.w-t),t=w.x!==g&&g<0?w.w:t,g=g<0?0:g),["ne","n","nw"].indexOf(l)!==-1&&(m=w.y+(w.h-r),r=w.y!==m&&m<0?w.h:r,m=m<0?0:m),y=!0),h&&!p&&(E=(0,Ye.getAllCollisions)(u,{...w,w:t,h:r,x:g,y:m}).filter(M=>M.i!==w.i).length>0,E&&(m=w.y,r=w.h,g=w.x,t=w.w,y=!1)),w.w=t,w.h=r,w});if(!_)return;v=x,y&&(v=(0,Ye.moveElement)(x,_,g,m,!0,this.props.preventCollision,(0,Ye.compactType)(this.props),d,p));const b={w:_.w,h:_.h,x:_.x,y:_.y,static:!0,i:e};this.props.onResize(v,c,_,b,s,a),this.setState({layout:p?v:(0,Ye.compact)(v,(0,Ye.compactType)(this.props),d),activeDrag:b})}),Kn(this,"onResizeStop",(e,t,r,i)=>{let{e:s,node:a}=i;const{layout:o,oldResizeItem:l}=this.state,{cols:c,allowOverlap:u}=this.props,d=(0,Ye.getLayoutItem)(o,e),h=u?o:(0,Ye.compact)(o,(0,Ye.compactType)(this.props),c);this.props.onResizeStop(h,l,d,null,s,a);const{oldLayout:p}=this.state;this.setState({activeDrag:null,layout:h,oldResizeItem:null,oldLayout:null,resizing:!1}),this.onLayoutMaybeChanged(h,p)}),Kn(this,"onDragOver",e=>{var x;if(e.preventDefault(),e.stopPropagation(),r3&&!((x=e.nativeEvent.target)!=null&&x.classList.contains(gC)))return!1;const{droppingItem:t,onDropDragOver:r,margin:i,cols:s,rowHeight:a,maxRows:o,width:l,containerPadding:c,transformScale:u}=this.props,d=r==null?void 0:r(e);if(d===!1)return this.state.droppingDOMNode&&this.removeDroppingPlaceholder(),!1;const h={...t,...d},{layout:p}=this.state,y=e.currentTarget.getBoundingClientRect(),v=e.clientX-y.left,g=e.clientY-y.top,m={left:v/u,top:g/u,e};if(this.state.droppingDOMNode){if(this.state.droppingPosition){const{left:_,top:b}=this.state.droppingPosition;(_!=v||b!=g)&&this.setState({droppingPosition:m})}}else{const _={cols:s,margin:i,maxRows:o,rowHeight:a,containerWidth:l,containerPadding:c||i},b=(0,yX.calcXY)(_,g,v,h.w,h.h);this.setState({droppingDOMNode:ul.createElement("div",{key:h.i}),droppingPosition:m,layout:[...p,{...h,x:b.x,y:b.y,static:!1,isDraggable:!0}]})}}),Kn(this,"removeDroppingPlaceholder",()=>{const{droppingItem:e,cols:t}=this.props,{layout:r}=this.state,i=(0,Ye.compact)(r.filter(s=>s.i!==e.i),(0,Ye.compactType)(this.props),t,this.props.allowOverlap);this.setState({layout:i,droppingDOMNode:null,activeDrag:null,droppingPosition:void 0})}),Kn(this,"onDragLeave",e=>{e.preventDefault(),e.stopPropagation(),this.dragEnterCounter--,this.dragEnterCounter===0&&this.removeDroppingPlaceholder()}),Kn(this,"onDragEnter",e=>{e.preventDefault(),e.stopPropagation(),this.dragEnterCounter++}),Kn(this,"onDrop",e=>{e.preventDefault(),e.stopPropagation();const{droppingItem:t}=this.props,{layout:r}=this.state,i=r.find(s=>s.i===t.i);this.dragEnterCounter=0,this.removeDroppingPlaceholder(),this.props.onDrop(r,i,e)})}componentDidMount(){this.setState({mounted:!0}),this.onLayoutMaybeChanged(this.state.layout,this.props.layout)}static getDerivedStateFromProps(e,t){let r;return t.activeDrag?null:(!(0,G_.deepEqual)(e.layout,t.propsLayout)||e.compactType!==t.compactType?r=e.layout:(0,Ye.childrenEqual)(e.children,t.children)||(r=t.layout),r?{layout:(0,Ye.synchronizeLayoutWithChildren)(r,e.children,e.cols,(0,Ye.compactType)(e),e.allowOverlap),compactType:e.compactType,children:e.children,propsLayout:e.layout}:null)}shouldComponentUpdate(e,t){return this.props.children!==e.children||!(0,Ye.fastRGLPropsEqual)(this.props,e,G_.deepEqual)||this.state.activeDrag!==t.activeDrag||this.state.mounted!==t.mounted||this.state.droppingPosition!==t.droppingPosition}componentDidUpdate(e,t){if(!this.state.activeDrag){const r=this.state.layout,i=t.layout;this.onLayoutMaybeChanged(r,i)}}containerHeight(){if(!this.props.autoSize)return;const e=(0,Ye.bottom)(this.state.layout),t=this.props.containerPadding?this.props.containerPadding[1]:this.props.margin[1];return e*this.props.rowHeight+(e-1)*this.props.margin[1]+t*2+"px"}onLayoutMaybeChanged(e,t){t||(t=this.state.layout),(0,G_.deepEqual)(t,e)||this.props.onLayoutChange(e)}placeholder(){const{activeDrag:e}=this.state;if(!e)return null;const{width:t,cols:r,margin:i,containerPadding:s,rowHeight:a,maxRows:o,useCSSTransforms:l,transformScale:c}=this.props;return ul.createElement(mC.default,{w:e.w,h:e.h,x:e.x,y:e.y,i:e.i,className:`react-grid-placeholder ${this.state.resizing?"placeholder-resizing":""}`,containerWidth:t,cols:r,margin:i,containerPadding:s||i,maxRows:o,rowHeight:a,isDraggable:!1,isResizable:!1,isBounded:!1,useCSSTransforms:l,transformScale:c},ul.createElement("div",null))}processGridItem(e,t){if(!e||!e.key)return;const r=(0,Ye.getLayoutItem)(this.state.layout,String(e.key));if(!r)return null;const{width:i,cols:s,margin:a,containerPadding:o,rowHeight:l,maxRows:c,isDraggable:u,isResizable:d,isBounded:h,useCSSTransforms:p,transformScale:y,draggableCancel:v,draggableHandle:g,resizeHandles:m,resizeHandle:x}=this.props,{mounted:_,droppingPosition:b}=this.state,w=typeof r.isDraggable=="boolean"?r.isDraggable:!r.static&&u,E=typeof r.isResizable=="boolean"?r.isResizable:!r.static&&d,S=r.resizeHandles||m,M=w&&h&&r.isBounded!==!1;return ul.createElement(mC.default,{containerWidth:i,cols:s,margin:a,containerPadding:o||a,maxRows:c,rowHeight:l,cancel:v,handle:g,onDragStop:this.onDragStop,onDragStart:this.onDragStart,onDrag:this.onDrag,onResizeStart:this.onResizeStart,onResize:this.onResize,onResizeStop:this.onResizeStop,isDraggable:w,isResizable:E,isBounded:M,useCSSTransforms:p&&_,usePercentages:!_,transformScale:y,w:r.w,h:r.h,x:r.x,y:r.y,i:r.i,minH:r.minH,minW:r.minW,maxH:r.maxH,maxW:r.maxW,static:r.static,droppingPosition:t?b:void 0,resizeHandles:S,resizeHandle:x},e)}render(){const{className:e,style:t,isDroppable:r,innerRef:i}=this.props,s=(0,gX.default)(gC,e),a={height:this.containerHeight(),...t};return ul.createElement("div",{ref:i,className:s,style:a,onDrop:r?this.onDrop:Ye.noop,onDragLeave:r?this.onDragLeave:Ye.noop,onDragEnter:r?this.onDragEnter:Ye.noop,onDragOver:r?this.onDragOver:Ye.noop},ul.Children.map(this.props.children,o=>this.processGridItem(o)),r&&this.state.droppingDOMNode&&this.processGridItem(this.state.droppingDOMNode,!0),this.placeholder())}}Vp.default=Nv;Kn(Nv,"displayName","ReactGridLayout");Kn(Nv,"propTypes",vX.default);Kn(Nv,"defaultProps",{autoSize:!0,cols:12,className:"",style:{},draggableHandle:"",draggableCancel:"",containerPadding:null,rowHeight:150,maxRows:1/0,layout:[],margin:[10,10],isBounded:!1,isDraggable:!0,isResizable:!0,allowOverlap:!1,isDroppable:!1,useCSSTransforms:!0,transformScale:1,verticalCompact:!0,compactType:"vertical",preventCollision:!1,droppingItem:{i:"__dropping-elem__",h:1,w:1},resizeHandles:["se"],onLayoutChange:Ye.noop,onDragStart:Ye.noop,onDrag:Ye.noop,onDragStop:Ye.noop,onResizeStart:Ye.noop,onResize:Ye.noop,onResizeStop:Ye.noop,onDrop:Ye.noop,onDropDragOver:Ye.noop});var Ov={},Sc={};Object.defineProperty(Sc,"__esModule",{value:!0});Sc.findOrGenerateResponsiveLayout=EX;Sc.getBreakpointFromWidth=wX;Sc.getColsFromBreakpoint=SX;Sc.sortBreakpoints=vT;var tg=mt;function wX(n,e){const t=vT(n);let r=t[0];for(let i=1,s=t.length;i<s;i++){const a=t[i];e>n[a]&&(r=a)}return r}function SX(n,e){if(!e[n])throw new Error("ResponsiveReactGridLayout: `cols` entry for breakpoint "+n+" is missing!");return e[n]}function EX(n,e,t,r,i,s){if(n[t])return(0,tg.cloneLayout)(n[t]);let a=n[r];const o=vT(e),l=o.slice(o.indexOf(t));for(let c=0,u=l.length;c<u;c++){const d=l[c];if(n[d]){a=n[d];break}}return a=(0,tg.cloneLayout)(a||[]),(0,tg.compact)((0,tg.correctBounds)(a,{cols:i}),s,i)}function vT(n){return Object.keys(n).sort(function(t,r){return n[t]-n[r]})}Object.defineProperty(Ov,"__esModule",{value:!0});Ov.default=void 0;var yC=MX(k),kr=i3(Qo),q_=QE,Hu=mt,dl=Sc,TX=i3(Vp);function i3(n){return n&&n.__esModule?n:{default:n}}function s3(n){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(s3=function(r){return r?t:e})(n)}function MX(n,e){if(n&&n.__esModule)return n;if(n===null||typeof n!="object"&&typeof n!="function")return{default:n};var t=s3(e);if(t&&t.has(n))return t.get(n);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in n)if(s!=="default"&&Object.prototype.hasOwnProperty.call(n,s)){var a=i?Object.getOwnPropertyDescriptor(n,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=n[s]}return r.default=n,t&&t.set(n,r),r}function OS(){return OS=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},OS.apply(this,arguments)}function a0(n,e,t){return e=kX(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function kX(n){var e=AX(n,"string");return typeof e=="symbol"?e:String(e)}function AX(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const vC=n=>Object.prototype.toString.call(n);function ng(n,e){return n==null?null:Array.isArray(n)?n:n[e]}class xT extends yC.Component{constructor(){super(...arguments),a0(this,"state",this.generateInitialState()),a0(this,"onLayoutChange",e=>{this.props.onLayoutChange(e,{...this.props.layouts,[this.state.breakpoint]:e})})}generateInitialState(){const{width:e,breakpoints:t,layouts:r,cols:i}=this.props,s=(0,dl.getBreakpointFromWidth)(t,e),a=(0,dl.getColsFromBreakpoint)(s,i),o=this.props.verticalCompact===!1?null:this.props.compactType;return{layout:(0,dl.findOrGenerateResponsiveLayout)(r,t,s,s,a,o),breakpoint:s,cols:a}}static getDerivedStateFromProps(e,t){if(!(0,q_.deepEqual)(e.layouts,t.layouts)){const{breakpoint:r,cols:i}=t;return{layout:(0,dl.findOrGenerateResponsiveLayout)(e.layouts,e.breakpoints,r,r,i,e.compactType),layouts:e.layouts}}return null}componentDidUpdate(e){(this.props.width!=e.width||this.props.breakpoint!==e.breakpoint||!(0,q_.deepEqual)(this.props.breakpoints,e.breakpoints)||!(0,q_.deepEqual)(this.props.cols,e.cols))&&this.onWidthChange(e)}onWidthChange(e){const{breakpoints:t,cols:r,layouts:i,compactType:s}=this.props,a=this.props.breakpoint||(0,dl.getBreakpointFromWidth)(this.props.breakpoints,this.props.width),o=this.state.breakpoint,l=(0,dl.getColsFromBreakpoint)(a,r),c={...i};if(o!==a||e.breakpoints!==t||e.cols!==r){o in c||(c[o]=(0,Hu.cloneLayout)(this.state.layout));let h=(0,dl.findOrGenerateResponsiveLayout)(c,t,a,o,l,s);h=(0,Hu.synchronizeLayoutWithChildren)(h,this.props.children,l,s,this.props.allowOverlap),c[a]=h,this.props.onBreakpointChange(a,l),this.props.onLayoutChange(h,c),this.setState({breakpoint:a,layout:h,cols:l})}const u=ng(this.props.margin,a),d=ng(this.props.containerPadding,a);this.props.onWidthChange(this.props.width,u,l,d)}render(){const{breakpoint:e,breakpoints:t,cols:r,layouts:i,margin:s,containerPadding:a,onBreakpointChange:o,onLayoutChange:l,onWidthChange:c,...u}=this.props;return yC.createElement(TX.default,OS({},u,{margin:ng(s,this.state.breakpoint),containerPadding:ng(a,this.state.breakpoint),onLayoutChange:this.onLayoutChange,layout:this.state.layout,cols:this.state.cols}))}}Ov.default=xT;a0(xT,"propTypes",{breakpoint:kr.default.string,breakpoints:kr.default.object,allowOverlap:kr.default.bool,cols:kr.default.object,margin:kr.default.oneOfType([kr.default.array,kr.default.object]),containerPadding:kr.default.oneOfType([kr.default.array,kr.default.object]),layouts(n,e){if(vC(n[e])!=="[object Object]")throw new Error("Layout property must be an object. Received: "+vC(n[e]));Object.keys(n[e]).forEach(t=>{if(!(t in n.breakpoints))throw new Error("Each key in layouts must align with a key in breakpoints.");(0,Hu.validateLayout)(n.layouts[t],"layouts."+t)})},width:kr.default.number.isRequired,onBreakpointChange:kr.default.func,onLayoutChange:kr.default.func,onWidthChange:kr.default.func});a0(xT,"defaultProps",{breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:10,sm:6,xs:4,xxs:2},containerPadding:{lg:null,md:null,sm:null,xs:null,xxs:null},layouts:{},margin:[10,10],allowOverlap:!1,onBreakpointChange:Hu.noop,onLayoutChange:Hu.noop,onWidthChange:Hu.noop});var _T={},a3=function(){if(typeof Map<"u")return Map;function n(e,t){var r=-1;return e.some(function(i,s){return i[0]===t?(r=s,!0):!1}),r}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(t){var r=n(this.__entries__,t),i=this.__entries__[r];return i&&i[1]},e.prototype.set=function(t,r){var i=n(this.__entries__,t);~i?this.__entries__[i][1]=r:this.__entries__.push([t,r])},e.prototype.delete=function(t){var r=this.__entries__,i=n(r,t);~i&&r.splice(i,1)},e.prototype.has=function(t){return!!~n(this.__entries__,t)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,r){r===void 0&&(r=null);for(var i=0,s=this.__entries__;i<s.length;i++){var a=s[i];t.call(r,a[1],a[0])}},e}()}(),LS=typeof window<"u"&&typeof document<"u"&&window.document===document,o0=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),PX=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(o0):function(n){return setTimeout(function(){return n(Date.now())},1e3/60)}}(),CX=2;function RX(n,e){var t=!1,r=!1,i=0;function s(){t&&(t=!1,n()),r&&o()}function a(){PX(s)}function o(){var l=Date.now();if(t){if(l-i<CX)return;r=!0}else t=!0,r=!1,setTimeout(a,e);i=l}return o}var NX=20,OX=["top","right","bottom","left","width","height","size","weight"],LX=typeof MutationObserver<"u",DX=function(){function n(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=RX(this.refresh.bind(this),NX)}return n.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},n.prototype.removeObserver=function(e){var t=this.observers_,r=t.indexOf(e);~r&&t.splice(r,1),!t.length&&this.connected_&&this.disconnect_()},n.prototype.refresh=function(){var e=this.updateObservers_();e&&this.refresh()},n.prototype.updateObservers_=function(){var e=this.observers_.filter(function(t){return t.gatherActive(),t.hasActive()});return e.forEach(function(t){return t.broadcastActive()}),e.length>0},n.prototype.connect_=function(){!LS||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),LX?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},n.prototype.disconnect_=function(){!LS||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},n.prototype.onTransitionEnd_=function(e){var t=e.propertyName,r=t===void 0?"":t,i=OX.some(function(s){return!!~r.indexOf(s)});i&&this.refresh()},n.getInstance=function(){return this.instance_||(this.instance_=new n),this.instance_},n.instance_=null,n}(),o3=function(n,e){for(var t=0,r=Object.keys(e);t<r.length;t++){var i=r[t];Object.defineProperty(n,i,{value:e[i],enumerable:!1,writable:!1,configurable:!0})}return n},ld=function(n){var e=n&&n.ownerDocument&&n.ownerDocument.defaultView;return e||o0},l3=Lv(0,0,0,0);function l0(n){return parseFloat(n)||0}function xC(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return e.reduce(function(r,i){var s=n["border-"+i+"-width"];return r+l0(s)},0)}function IX(n){for(var e=["top","right","bottom","left"],t={},r=0,i=e;r<i.length;r++){var s=i[r],a=n["padding-"+s];t[s]=l0(a)}return t}function jX(n){var e=n.getBBox();return Lv(0,0,e.width,e.height)}function FX(n){var e=n.clientWidth,t=n.clientHeight;if(!e&&!t)return l3;var r=ld(n).getComputedStyle(n),i=IX(r),s=i.left+i.right,a=i.top+i.bottom,o=l0(r.width),l=l0(r.height);if(r.boxSizing==="border-box"&&(Math.round(o+s)!==e&&(o-=xC(r,"left","right")+s),Math.round(l+a)!==t&&(l-=xC(r,"top","bottom")+a)),!BX(n)){var c=Math.round(o+s)-e,u=Math.round(l+a)-t;Math.abs(c)!==1&&(o-=c),Math.abs(u)!==1&&(l-=u)}return Lv(i.left,i.top,o,l)}var UX=function(){return typeof SVGGraphicsElement<"u"?function(n){return n instanceof ld(n).SVGGraphicsElement}:function(n){return n instanceof ld(n).SVGElement&&typeof n.getBBox=="function"}}();function BX(n){return n===ld(n).document.documentElement}function zX(n){return LS?UX(n)?jX(n):FX(n):l3}function $X(n){var e=n.x,t=n.y,r=n.width,i=n.height,s=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,a=Object.create(s.prototype);return o3(a,{x:e,y:t,width:r,height:i,top:t,right:e+r,bottom:i+t,left:e}),a}function Lv(n,e,t,r){return{x:n,y:e,width:t,height:r}}var VX=function(){function n(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Lv(0,0,0,0),this.target=e}return n.prototype.isActive=function(){var e=zX(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},n.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},n}(),HX=function(){function n(e,t){var r=$X(t);o3(this,{target:e,contentRect:r})}return n}(),WX=function(){function n(e,t,r){if(this.activeObservations_=[],this.observations_=new a3,typeof e!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=r}return n.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof ld(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new VX(e)),this.controller_.addObserver(this),this.controller_.refresh())}},n.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof ld(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},n.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},n.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(t){t.isActive()&&e.activeObservations_.push(t)})},n.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map(function(r){return new HX(r.target,r.broadcastRect())});this.callback_.call(e,t,e),this.clearActive()}},n.prototype.clearActive=function(){this.activeObservations_.splice(0)},n.prototype.hasActive=function(){return this.activeObservations_.length>0},n}(),c3=typeof WeakMap<"u"?new WeakMap:new a3,u3=function(){function n(e){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var t=DX.getInstance(),r=new WX(e,t,this);c3.set(this,r)}return n}();["observe","unobserve","disconnect"].forEach(function(n){u3.prototype[n]=function(){var e;return(e=c3.get(this))[n].apply(e,arguments)}});var GX=function(){return typeof o0.ResizeObserver<"u"?o0.ResizeObserver:u3}();const qX=Object.freeze(Object.defineProperty({__proto__:null,default:GX},Symbol.toStringTag,{value:"Module"})),XX=K1(qX);Object.defineProperty(_T,"__esModule",{value:!0});_T.default=nY;var rg=JX(k),YX=bT(Qo),KX=bT(XX),ZX=bT(eT);function bT(n){return n&&n.__esModule?n:{default:n}}function d3(n){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(d3=function(r){return r?t:e})(n)}function JX(n,e){if(n&&n.__esModule)return n;if(n===null||typeof n!="object"&&typeof n!="function")return{default:n};var t=d3(e);if(t&&t.has(n))return t.get(n);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in n)if(s!=="default"&&Object.prototype.hasOwnProperty.call(n,s)){var a=i?Object.getOwnPropertyDescriptor(n,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=n[s]}return r.default=n,t&&t.set(n,r),r}function DS(){return DS=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},DS.apply(this,arguments)}function Xc(n,e,t){return e=QX(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function QX(n){var e=eY(n,"string");return typeof e=="symbol"?e:String(e)}function eY(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const tY="react-grid-layout";function nY(n){var e;return e=class extends rg.Component{constructor(){super(...arguments),Xc(this,"state",{width:1280}),Xc(this,"elementRef",rg.createRef()),Xc(this,"mounted",!1),Xc(this,"resizeObserver",void 0)}componentDidMount(){this.mounted=!0,this.resizeObserver=new KX.default(i=>{if(this.elementRef.current instanceof HTMLElement){const a=i[0].contentRect.width;this.setState({width:a})}});const r=this.elementRef.current;r instanceof HTMLElement&&this.resizeObserver.observe(r)}componentWillUnmount(){this.mounted=!1;const r=this.elementRef.current;r instanceof HTMLElement&&this.resizeObserver.unobserve(r),this.resizeObserver.disconnect()}render(){const{measureBeforeMount:r,...i}=this.props;return r&&!this.mounted?rg.createElement("div",{className:(0,ZX.default)(this.props.className,tY),style:this.props.style,ref:this.elementRef}):rg.createElement(n,DS({innerRef:this.elementRef},i,this.state))}},Xc(e,"defaultProps",{measureBeforeMount:!1}),Xc(e,"propTypes",{measureBeforeMount:YX.default.bool}),e}(function(n){n.exports=Vp.default,n.exports.utils=mt,n.exports.calculateUtils=Us,n.exports.Responsive=Ov.default,n.exports.Responsive.utils=Sc,n.exports.WidthProvider=_T.default})(Ej);var h3=Ej.exports;const rY=Cp(h3);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var iY={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sY=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Le=(n,e)=>{const t=k.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,...c},u)=>k.createElement("svg",{ref:u,...iY,width:i,height:i,stroke:r,strokeWidth:a?Number(s)*24/Number(i):s,className:["lucide",`lucide-${sY(n)}`,o].join(" "),...c},[...e.map(([d,h])=>k.createElement(d,h)),...Array.isArray(l)?l:[l]]));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pd=Le("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aY=Le("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oY=Le("ArrowDownToLine",[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f3=Le("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p3=Le("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const au=Le("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m3=Le("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g3=Le("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _C=Le("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zf=Le("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lY=Le("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cY=Le("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y3=Le("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v3=Le("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lf=Le("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dv=Le("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uY=Le("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wT=Le("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cf=Le("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uf=Le("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dY=Le("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bC=Le("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x3=Le("CircleUserRound",[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c0=Le("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hY=Le("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fY=Le("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _3=Le("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pY=Le("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mY=Le("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gY=Le("Grid2x2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M12 3v18",key:"108xh3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yY=Le("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u0=Le("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vY=Le("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xY=Le("Import",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m8 11 4 4 4-4",key:"1dohi6"}],["path",{d:"M8 5H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-4",key:"1ywtjm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _Y=Le("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IS=Le("LineChart",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cd=Le("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bY=Le("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wY=Le("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SY=Le("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wC=Le("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d0=Le("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EY=Le("MessageSquarePlus",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=Le("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SC=Le("Minimize",[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TY=Le("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ah=Le("Newspaper",[["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2",key:"7pis2x"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M10 6h8v4h-8V6Z",key:"smlsk5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MY=Le("PanelsTopLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EC=Le("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jS=Le("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iv=Le("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kY=Le("SendHorizontal",[["path",{d:"m3 3 3 9-3 9 19-9Z",key:"1aobqy"}],["path",{d:"M6 12h16",key:"s4cdu5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FS=Le("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jv=Le("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ST=Le("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b3=Le("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AY=Le("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PY=Le("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CY=Le("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RY=Le("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NY=Le("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OY=Le("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fv=Le("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ud=Le("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TC=Le("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hy=Le("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LY=Le("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ET=Le("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yr=Le("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function w3(n,e){return function(){return n.apply(e,arguments)}}const{toString:DY}=Object.prototype,{getPrototypeOf:TT}=Object,Uv=(n=>e=>{const t=DY.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),os=n=>(n=n.toLowerCase(),e=>Uv(e)===n),Bv=n=>e=>typeof e===n,{isArray:Cd}=Array,Jf=Bv("undefined");function IY(n){return n!==null&&!Jf(n)&&n.constructor!==null&&!Jf(n.constructor)&&ri(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const S3=os("ArrayBuffer");function jY(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&S3(n.buffer),e}const FY=Bv("string"),ri=Bv("function"),E3=Bv("number"),zv=n=>n!==null&&typeof n=="object",UY=n=>n===!0||n===!1,fy=n=>{if(Uv(n)!=="object")return!1;const e=TT(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},BY=os("Date"),zY=os("File"),$Y=os("Blob"),VY=os("FileList"),HY=n=>zv(n)&&ri(n.pipe),WY=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||ri(n.append)&&((e=Uv(n))==="formdata"||e==="object"&&ri(n.toString)&&n.toString()==="[object FormData]"))},GY=os("URLSearchParams"),[qY,XY,YY,KY]=["ReadableStream","Request","Response","Headers"].map(os),ZY=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Gp(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let r,i;if(typeof n!="object"&&(n=[n]),Cd(n))for(r=0,i=n.length;r<i;r++)e.call(null,n[r],r,n);else{const s=t?Object.getOwnPropertyNames(n):Object.keys(n),a=s.length;let o;for(r=0;r<a;r++)o=s[r],e.call(null,n[o],o,n)}}function T3(n,e){e=e.toLowerCase();const t=Object.keys(n);let r=t.length,i;for(;r-- >0;)if(i=t[r],e===i.toLowerCase())return i;return null}const Fl=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,M3=n=>!Jf(n)&&n!==Fl;function US(){const{caseless:n}=M3(this)&&this||{},e={},t=(r,i)=>{const s=n&&T3(e,i)||i;fy(e[s])&&fy(r)?e[s]=US(e[s],r):fy(r)?e[s]=US({},r):Cd(r)?e[s]=r.slice():e[s]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&Gp(arguments[r],t);return e}const JY=(n,e,t,{allOwnKeys:r}={})=>(Gp(e,(i,s)=>{t&&ri(i)?n[s]=w3(i,t):n[s]=i},{allOwnKeys:r}),n),QY=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),eK=(n,e,t,r)=>{n.prototype=Object.create(e.prototype,r),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},tK=(n,e,t,r)=>{let i,s,a;const o={};if(e=e||{},n==null)return e;do{for(i=Object.getOwnPropertyNames(n),s=i.length;s-- >0;)a=i[s],(!r||r(a,n,e))&&!o[a]&&(e[a]=n[a],o[a]=!0);n=t!==!1&&TT(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},nK=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const r=n.indexOf(e,t);return r!==-1&&r===t},rK=n=>{if(!n)return null;if(Cd(n))return n;let e=n.length;if(!E3(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},iK=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&TT(Uint8Array)),sK=(n,e)=>{const r=(n&&n[Symbol.iterator]).call(n);let i;for(;(i=r.next())&&!i.done;){const s=i.value;e.call(n,s[0],s[1])}},aK=(n,e)=>{let t;const r=[];for(;(t=n.exec(e))!==null;)r.push(t);return r},oK=os("HTMLFormElement"),lK=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,i){return r.toUpperCase()+i}),MC=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),cK=os("RegExp"),k3=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),r={};Gp(t,(i,s)=>{let a;(a=e(i,s,n))!==!1&&(r[s]=a||i)}),Object.defineProperties(n,r)},uK=n=>{k3(n,(e,t)=>{if(ri(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=n[t];if(ri(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},dK=(n,e)=>{const t={},r=i=>{i.forEach(s=>{t[s]=!0})};return Cd(n)?r(n):r(String(n).split(e)),t},hK=()=>{},fK=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e;function pK(n){return!!(n&&ri(n.append)&&n[Symbol.toStringTag]==="FormData"&&n[Symbol.iterator])}const mK=n=>{const e=new Array(10),t=(r,i)=>{if(zv(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[i]=r;const s=Cd(r)?[]:{};return Gp(r,(a,o)=>{const l=t(a,i+1);!Jf(l)&&(s[o]=l)}),e[i]=void 0,s}}return r};return t(n,0)},gK=os("AsyncFunction"),yK=n=>n&&(zv(n)||ri(n))&&ri(n.then)&&ri(n.catch),A3=((n,e)=>n?setImmediate:e?((t,r)=>(Fl.addEventListener("message",({source:i,data:s})=>{i===Fl&&s===t&&r.length&&r.shift()()},!1),i=>{r.push(i),Fl.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",ri(Fl.postMessage)),vK=typeof queueMicrotask<"u"?queueMicrotask.bind(Fl):typeof process<"u"&&process.nextTick||A3,ie={isArray:Cd,isArrayBuffer:S3,isBuffer:IY,isFormData:WY,isArrayBufferView:jY,isString:FY,isNumber:E3,isBoolean:UY,isObject:zv,isPlainObject:fy,isReadableStream:qY,isRequest:XY,isResponse:YY,isHeaders:KY,isUndefined:Jf,isDate:BY,isFile:zY,isBlob:$Y,isRegExp:cK,isFunction:ri,isStream:HY,isURLSearchParams:GY,isTypedArray:iK,isFileList:VY,forEach:Gp,merge:US,extend:JY,trim:ZY,stripBOM:QY,inherits:eK,toFlatObject:tK,kindOf:Uv,kindOfTest:os,endsWith:nK,toArray:rK,forEachEntry:sK,matchAll:aK,isHTMLForm:oK,hasOwnProperty:MC,hasOwnProp:MC,reduceDescriptors:k3,freezeMethods:uK,toObjectSet:dK,toCamelCase:lK,noop:hK,toFiniteNumber:fK,findKey:T3,global:Fl,isContextDefined:M3,isSpecCompliantForm:pK,toJSONObject:mK,isAsyncFn:gK,isThenable:yK,setImmediate:A3,asap:vK};function Qe(n,e,t,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}ie.inherits(Qe,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ie.toJSONObject(this.config),code:this.code,status:this.status}}});const P3=Qe.prototype,C3={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{C3[n]={value:n}});Object.defineProperties(Qe,C3);Object.defineProperty(P3,"isAxiosError",{value:!0});Qe.from=(n,e,t,r,i,s)=>{const a=Object.create(P3);return ie.toFlatObject(n,a,function(l){return l!==Error.prototype},o=>o!=="isAxiosError"),Qe.call(a,n.message,e,t,r,i),a.cause=n,a.name=n.name,s&&Object.assign(a,s),a};const xK=null;function BS(n){return ie.isPlainObject(n)||ie.isArray(n)}function R3(n){return ie.endsWith(n,"[]")?n.slice(0,-2):n}function kC(n,e,t){return n?n.concat(e).map(function(i,s){return i=R3(i),!t&&s?"["+i+"]":i}).join(t?".":""):e}function _K(n){return ie.isArray(n)&&!n.some(BS)}const bK=ie.toFlatObject(ie,{},null,function(e){return/^is[A-Z]/.test(e)});function $v(n,e,t){if(!ie.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=ie.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(v,g){return!ie.isUndefined(g[v])});const r=t.metaTokens,i=t.visitor||u,s=t.dots,a=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&ie.isSpecCompliantForm(e);if(!ie.isFunction(i))throw new TypeError("visitor must be a function");function c(y){if(y===null)return"";if(ie.isDate(y))return y.toISOString();if(!l&&ie.isBlob(y))throw new Qe("Blob is not supported. Use a Buffer instead.");return ie.isArrayBuffer(y)||ie.isTypedArray(y)?l&&typeof Blob=="function"?new Blob([y]):Buffer.from(y):y}function u(y,v,g){let m=y;if(y&&!g&&typeof y=="object"){if(ie.endsWith(v,"{}"))v=r?v:v.slice(0,-2),y=JSON.stringify(y);else if(ie.isArray(y)&&_K(y)||(ie.isFileList(y)||ie.endsWith(v,"[]"))&&(m=ie.toArray(y)))return v=R3(v),m.forEach(function(_,b){!(ie.isUndefined(_)||_===null)&&e.append(a===!0?kC([v],b,s):a===null?v:v+"[]",c(_))}),!1}return BS(y)?!0:(e.append(kC(g,v,s),c(y)),!1)}const d=[],h=Object.assign(bK,{defaultVisitor:u,convertValue:c,isVisitable:BS});function p(y,v){if(!ie.isUndefined(y)){if(d.indexOf(y)!==-1)throw Error("Circular reference detected in "+v.join("."));d.push(y),ie.forEach(y,function(m,x){(!(ie.isUndefined(m)||m===null)&&i.call(e,m,ie.isString(x)?x.trim():x,v,h))===!0&&p(m,v?v.concat(x):[x])}),d.pop()}}if(!ie.isObject(n))throw new TypeError("data must be an object");return p(n),e}function AC(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function MT(n,e){this._pairs=[],n&&$v(n,this,e)}const N3=MT.prototype;N3.append=function(e,t){this._pairs.push([e,t])};N3.toString=function(e){const t=e?function(r){return e.call(this,r,AC)}:AC;return this._pairs.map(function(i){return t(i[0])+"="+t(i[1])},"").join("&")};function wK(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function O3(n,e,t){if(!e)return n;const r=t&&t.encode||wK;ie.isFunction(t)&&(t={serialize:t});const i=t&&t.serialize;let s;if(i?s=i(e,t):s=ie.isURLSearchParams(e)?e.toString():new MT(e,t).toString(r),s){const a=n.indexOf("#");a!==-1&&(n=n.slice(0,a)),n+=(n.indexOf("?")===-1?"?":"&")+s}return n}class PC{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){ie.forEach(this.handlers,function(r){r!==null&&e(r)})}}const L3={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},SK=typeof URLSearchParams<"u"?URLSearchParams:MT,EK=typeof FormData<"u"?FormData:null,TK=typeof Blob<"u"?Blob:null,MK={isBrowser:!0,classes:{URLSearchParams:SK,FormData:EK,Blob:TK},protocols:["http","https","file","blob","url","data"]},kT=typeof window<"u"&&typeof document<"u",zS=typeof navigator=="object"&&navigator||void 0,kK=kT&&(!zS||["ReactNative","NativeScript","NS"].indexOf(zS.product)<0),AK=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",PK=kT&&window.location.href||"http://localhost",CK=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:kT,hasStandardBrowserEnv:kK,hasStandardBrowserWebWorkerEnv:AK,navigator:zS,origin:PK},Symbol.toStringTag,{value:"Module"})),er={...CK,...MK};function RK(n,e){return $v(n,new er.classes.URLSearchParams,Object.assign({visitor:function(t,r,i,s){return er.isNode&&ie.isBuffer(t)?(this.append(r,t.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},e))}function NK(n){return ie.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function OK(n){const e={},t=Object.keys(n);let r;const i=t.length;let s;for(r=0;r<i;r++)s=t[r],e[s]=n[s];return e}function D3(n){function e(t,r,i,s){let a=t[s++];if(a==="__proto__")return!0;const o=Number.isFinite(+a),l=s>=t.length;return a=!a&&ie.isArray(i)?i.length:a,l?(ie.hasOwnProp(i,a)?i[a]=[i[a],r]:i[a]=r,!o):((!i[a]||!ie.isObject(i[a]))&&(i[a]=[]),e(t,r,i[a],s)&&ie.isArray(i[a])&&(i[a]=OK(i[a])),!o)}if(ie.isFormData(n)&&ie.isFunction(n.entries)){const t={};return ie.forEachEntry(n,(r,i)=>{e(NK(r),i,t,0)}),t}return null}function LK(n,e,t){if(ie.isString(n))try{return(e||JSON.parse)(n),ie.trim(n)}catch(r){if(r.name!=="SyntaxError")throw r}return(0,JSON.stringify)(n)}const qp={transitional:L3,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",i=r.indexOf("application/json")>-1,s=ie.isObject(e);if(s&&ie.isHTMLForm(e)&&(e=new FormData(e)),ie.isFormData(e))return i?JSON.stringify(D3(e)):e;if(ie.isArrayBuffer(e)||ie.isBuffer(e)||ie.isStream(e)||ie.isFile(e)||ie.isBlob(e)||ie.isReadableStream(e))return e;if(ie.isArrayBufferView(e))return e.buffer;if(ie.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return RK(e,this.formSerializer).toString();if((o=ie.isFileList(e))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return $v(o?{"files[]":e}:e,l&&new l,this.formSerializer)}}return s||i?(t.setContentType("application/json",!1),LK(e)):e}],transformResponse:[function(e){const t=this.transitional||qp.transitional,r=t&&t.forcedJSONParsing,i=this.responseType==="json";if(ie.isResponse(e)||ie.isReadableStream(e))return e;if(e&&ie.isString(e)&&(r&&!this.responseType||i)){const a=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(o){if(a)throw o.name==="SyntaxError"?Qe.from(o,Qe.ERR_BAD_RESPONSE,this,null,this.response):o}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:er.classes.FormData,Blob:er.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ie.forEach(["delete","get","head","post","put","patch"],n=>{qp.headers[n]={}});const DK=ie.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),IK=n=>{const e={};let t,r,i;return n&&n.split(`
`).forEach(function(a){i=a.indexOf(":"),t=a.substring(0,i).trim().toLowerCase(),r=a.substring(i+1).trim(),!(!t||e[t]&&DK[t])&&(t==="set-cookie"?e[t]?e[t].push(r):e[t]=[r]:e[t]=e[t]?e[t]+", "+r:r)}),e},CC=Symbol("internals");function oh(n){return n&&String(n).trim().toLowerCase()}function py(n){return n===!1||n==null?n:ie.isArray(n)?n.map(py):String(n)}function jK(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(n);)e[r[1]]=r[2];return e}const FK=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function X_(n,e,t,r,i){if(ie.isFunction(r))return r.call(this,e,t);if(i&&(e=t),!!ie.isString(e)){if(ie.isString(r))return e.indexOf(r)!==-1;if(ie.isRegExp(r))return r.test(e)}}function UK(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}function BK(n,e){const t=ie.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(n,r+t,{value:function(i,s,a){return this[r].call(this,e,i,s,a)},configurable:!0})})}class Vr{constructor(e){e&&this.set(e)}set(e,t,r){const i=this;function s(o,l,c){const u=oh(l);if(!u)throw new Error("header name must be a non-empty string");const d=ie.findKey(i,u);(!d||i[d]===void 0||c===!0||c===void 0&&i[d]!==!1)&&(i[d||l]=py(o))}const a=(o,l)=>ie.forEach(o,(c,u)=>s(c,u,l));if(ie.isPlainObject(e)||e instanceof this.constructor)a(e,t);else if(ie.isString(e)&&(e=e.trim())&&!FK(e))a(IK(e),t);else if(ie.isHeaders(e))for(const[o,l]of e.entries())s(l,o,r);else e!=null&&s(t,e,r);return this}get(e,t){if(e=oh(e),e){const r=ie.findKey(this,e);if(r){const i=this[r];if(!t)return i;if(t===!0)return jK(i);if(ie.isFunction(t))return t.call(this,i,r);if(ie.isRegExp(t))return t.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=oh(e),e){const r=ie.findKey(this,e);return!!(r&&this[r]!==void 0&&(!t||X_(this,this[r],r,t)))}return!1}delete(e,t){const r=this;let i=!1;function s(a){if(a=oh(a),a){const o=ie.findKey(r,a);o&&(!t||X_(r,r[o],o,t))&&(delete r[o],i=!0)}}return ie.isArray(e)?e.forEach(s):s(e),i}clear(e){const t=Object.keys(this);let r=t.length,i=!1;for(;r--;){const s=t[r];(!e||X_(this,this[s],s,e,!0))&&(delete this[s],i=!0)}return i}normalize(e){const t=this,r={};return ie.forEach(this,(i,s)=>{const a=ie.findKey(r,s);if(a){t[a]=py(i),delete t[s];return}const o=e?UK(s):String(s).trim();o!==s&&delete t[s],t[o]=py(i),r[o]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return ie.forEach(this,(r,i)=>{r!=null&&r!==!1&&(t[i]=e&&ie.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach(i=>r.set(i)),r}static accessor(e){const r=(this[CC]=this[CC]={accessors:{}}).accessors,i=this.prototype;function s(a){const o=oh(a);r[o]||(BK(i,a),r[o]=!0)}return ie.isArray(e)?e.forEach(s):s(e),this}}Vr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ie.reduceDescriptors(Vr.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(r){this[t]=r}}});ie.freezeMethods(Vr);function Y_(n,e){const t=this||qp,r=e||t,i=Vr.from(r.headers);let s=r.data;return ie.forEach(n,function(o){s=o.call(t,s,i.normalize(),e?e.status:void 0)}),i.normalize(),s}function I3(n){return!!(n&&n.__CANCEL__)}function Rd(n,e,t){Qe.call(this,n??"canceled",Qe.ERR_CANCELED,e,t),this.name="CanceledError"}ie.inherits(Rd,Qe,{__CANCEL__:!0});function j3(n,e,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?n(t):e(new Qe("Request failed with status code "+t.status,[Qe.ERR_BAD_REQUEST,Qe.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function zK(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function $K(n,e){n=n||10;const t=new Array(n),r=new Array(n);let i=0,s=0,a;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),u=r[s];a||(a=c),t[i]=l,r[i]=c;let d=s,h=0;for(;d!==i;)h+=t[d++],d=d%n;if(i=(i+1)%n,i===s&&(s=(s+1)%n),c-a<e)return;const p=u&&c-u;return p?Math.round(h*1e3/p):void 0}}function VK(n,e){let t=0,r=1e3/e,i,s;const a=(c,u=Date.now())=>{t=u,i=null,s&&(clearTimeout(s),s=null),n.apply(null,c)};return[(...c)=>{const u=Date.now(),d=u-t;d>=r?a(c,u):(i=c,s||(s=setTimeout(()=>{s=null,a(i)},r-d)))},()=>i&&a(i)]}const h0=(n,e,t=3)=>{let r=0;const i=$K(50,250);return VK(s=>{const a=s.loaded,o=s.lengthComputable?s.total:void 0,l=a-r,c=i(l),u=a<=o;r=a;const d={loaded:a,total:o,progress:o?a/o:void 0,bytes:l,rate:c||void 0,estimated:c&&o&&u?(o-a)/c:void 0,event:s,lengthComputable:o!=null,[e?"download":"upload"]:!0};n(d)},t)},RC=(n,e)=>{const t=n!=null;return[r=>e[0]({lengthComputable:t,total:n,loaded:r}),e[1]]},NC=n=>(...e)=>ie.asap(()=>n(...e)),HK=er.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,er.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(er.origin),er.navigator&&/(msie|trident)/i.test(er.navigator.userAgent)):()=>!0,WK=er.hasStandardBrowserEnv?{write(n,e,t,r,i,s){const a=[n+"="+encodeURIComponent(e)];ie.isNumber(t)&&a.push("expires="+new Date(t).toGMTString()),ie.isString(r)&&a.push("path="+r),ie.isString(i)&&a.push("domain="+i),s===!0&&a.push("secure"),document.cookie=a.join("; ")},read(n){const e=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function GK(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function qK(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function F3(n,e,t){let r=!GK(e);return n&&r||t==!1?qK(n,e):e}const OC=n=>n instanceof Vr?{...n}:n;function oc(n,e){e=e||{};const t={};function r(c,u,d,h){return ie.isPlainObject(c)&&ie.isPlainObject(u)?ie.merge.call({caseless:h},c,u):ie.isPlainObject(u)?ie.merge({},u):ie.isArray(u)?u.slice():u}function i(c,u,d,h){if(ie.isUndefined(u)){if(!ie.isUndefined(c))return r(void 0,c,d,h)}else return r(c,u,d,h)}function s(c,u){if(!ie.isUndefined(u))return r(void 0,u)}function a(c,u){if(ie.isUndefined(u)){if(!ie.isUndefined(c))return r(void 0,c)}else return r(void 0,u)}function o(c,u,d){if(d in e)return r(c,u);if(d in n)return r(void 0,c)}const l={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(c,u,d)=>i(OC(c),OC(u),d,!0)};return ie.forEach(Object.keys(Object.assign({},n,e)),function(u){const d=l[u]||i,h=d(n[u],e[u],u);ie.isUndefined(h)&&d!==o||(t[u]=h)}),t}const U3=n=>{const e=oc({},n);let{data:t,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:s,headers:a,auth:o}=e;e.headers=a=Vr.from(a),e.url=O3(F3(e.baseURL,e.url),n.params,n.paramsSerializer),o&&a.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):"")));let l;if(ie.isFormData(t)){if(er.hasStandardBrowserEnv||er.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if((l=a.getContentType())!==!1){const[c,...u]=l?l.split(";").map(d=>d.trim()).filter(Boolean):[];a.setContentType([c||"multipart/form-data",...u].join("; "))}}if(er.hasStandardBrowserEnv&&(r&&ie.isFunction(r)&&(r=r(e)),r||r!==!1&&HK(e.url))){const c=i&&s&&WK.read(s);c&&a.set(i,c)}return e},XK=typeof XMLHttpRequest<"u",YK=XK&&function(n){return new Promise(function(t,r){const i=U3(n);let s=i.data;const a=Vr.from(i.headers).normalize();let{responseType:o,onUploadProgress:l,onDownloadProgress:c}=i,u,d,h,p,y;function v(){p&&p(),y&&y(),i.cancelToken&&i.cancelToken.unsubscribe(u),i.signal&&i.signal.removeEventListener("abort",u)}let g=new XMLHttpRequest;g.open(i.method.toUpperCase(),i.url,!0),g.timeout=i.timeout;function m(){if(!g)return;const _=Vr.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),w={data:!o||o==="text"||o==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:_,config:n,request:g};j3(function(S){t(S),v()},function(S){r(S),v()},w),g=null}"onloadend"in g?g.onloadend=m:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(m)},g.onabort=function(){g&&(r(new Qe("Request aborted",Qe.ECONNABORTED,n,g)),g=null)},g.onerror=function(){r(new Qe("Network Error",Qe.ERR_NETWORK,n,g)),g=null},g.ontimeout=function(){let b=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const w=i.transitional||L3;i.timeoutErrorMessage&&(b=i.timeoutErrorMessage),r(new Qe(b,w.clarifyTimeoutError?Qe.ETIMEDOUT:Qe.ECONNABORTED,n,g)),g=null},s===void 0&&a.setContentType(null),"setRequestHeader"in g&&ie.forEach(a.toJSON(),function(b,w){g.setRequestHeader(w,b)}),ie.isUndefined(i.withCredentials)||(g.withCredentials=!!i.withCredentials),o&&o!=="json"&&(g.responseType=i.responseType),c&&([h,y]=h0(c,!0),g.addEventListener("progress",h)),l&&g.upload&&([d,p]=h0(l),g.upload.addEventListener("progress",d),g.upload.addEventListener("loadend",p)),(i.cancelToken||i.signal)&&(u=_=>{g&&(r(!_||_.type?new Rd(null,n,g):_),g.abort(),g=null)},i.cancelToken&&i.cancelToken.subscribe(u),i.signal&&(i.signal.aborted?u():i.signal.addEventListener("abort",u)));const x=zK(i.url);if(x&&er.protocols.indexOf(x)===-1){r(new Qe("Unsupported protocol "+x+":",Qe.ERR_BAD_REQUEST,n));return}g.send(s||null)})},KK=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let r=new AbortController,i;const s=function(c){if(!i){i=!0,o();const u=c instanceof Error?c:this.reason;r.abort(u instanceof Qe?u:new Rd(u instanceof Error?u.message:u))}};let a=e&&setTimeout(()=>{a=null,s(new Qe(`timeout ${e} of ms exceeded`,Qe.ETIMEDOUT))},e);const o=()=>{n&&(a&&clearTimeout(a),a=null,n.forEach(c=>{c.unsubscribe?c.unsubscribe(s):c.removeEventListener("abort",s)}),n=null)};n.forEach(c=>c.addEventListener("abort",s));const{signal:l}=r;return l.unsubscribe=()=>ie.asap(o),l}},ZK=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let r=0,i;for(;r<t;)i=r+e,yield n.slice(r,i),r=i},JK=async function*(n,e){for await(const t of QK(n))yield*ZK(t,e)},QK=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)break;yield r}}finally{await e.cancel()}},LC=(n,e,t,r)=>{const i=JK(n,e);let s=0,a,o=l=>{a||(a=!0,r&&r(l))};return new ReadableStream({async pull(l){try{const{done:c,value:u}=await i.next();if(c){o(),l.close();return}let d=u.byteLength;if(t){let h=s+=d;t(h)}l.enqueue(new Uint8Array(u))}catch(c){throw o(c),c}},cancel(l){return o(l),i.return()}},{highWaterMark:2})},Vv=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",B3=Vv&&typeof ReadableStream=="function",eZ=Vv&&(typeof TextEncoder=="function"?(n=>e=>n.encode(e))(new TextEncoder):async n=>new Uint8Array(await new Response(n).arrayBuffer())),z3=(n,...e)=>{try{return!!n(...e)}catch{return!1}},tZ=B3&&z3(()=>{let n=!1;const e=new Request(er.origin,{body:new ReadableStream,method:"POST",get duplex(){return n=!0,"half"}}).headers.has("Content-Type");return n&&!e}),DC=64*1024,$S=B3&&z3(()=>ie.isReadableStream(new Response("").body)),f0={stream:$S&&(n=>n.body)};Vv&&(n=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!f0[e]&&(f0[e]=ie.isFunction(n[e])?t=>t[e]():(t,r)=>{throw new Qe(`Response type '${e}' is not supported`,Qe.ERR_NOT_SUPPORT,r)})})})(new Response);const nZ=async n=>{if(n==null)return 0;if(ie.isBlob(n))return n.size;if(ie.isSpecCompliantForm(n))return(await new Request(er.origin,{method:"POST",body:n}).arrayBuffer()).byteLength;if(ie.isArrayBufferView(n)||ie.isArrayBuffer(n))return n.byteLength;if(ie.isURLSearchParams(n)&&(n=n+""),ie.isString(n))return(await eZ(n)).byteLength},rZ=async(n,e)=>{const t=ie.toFiniteNumber(n.getContentLength());return t??nZ(e)},iZ=Vv&&(async n=>{let{url:e,method:t,data:r,signal:i,cancelToken:s,timeout:a,onDownloadProgress:o,onUploadProgress:l,responseType:c,headers:u,withCredentials:d="same-origin",fetchOptions:h}=U3(n);c=c?(c+"").toLowerCase():"text";let p=KK([i,s&&s.toAbortSignal()],a),y;const v=p&&p.unsubscribe&&(()=>{p.unsubscribe()});let g;try{if(l&&tZ&&t!=="get"&&t!=="head"&&(g=await rZ(u,r))!==0){let w=new Request(e,{method:"POST",body:r,duplex:"half"}),E;if(ie.isFormData(r)&&(E=w.headers.get("content-type"))&&u.setContentType(E),w.body){const[S,M]=RC(g,h0(NC(l)));r=LC(w.body,DC,S,M)}}ie.isString(d)||(d=d?"include":"omit");const m="credentials"in Request.prototype;y=new Request(e,{...h,signal:p,method:t.toUpperCase(),headers:u.normalize().toJSON(),body:r,duplex:"half",credentials:m?d:void 0});let x=await fetch(y);const _=$S&&(c==="stream"||c==="response");if($S&&(o||_&&v)){const w={};["status","statusText","headers"].forEach(N=>{w[N]=x[N]});const E=ie.toFiniteNumber(x.headers.get("content-length")),[S,M]=o&&RC(E,h0(NC(o),!0))||[];x=new Response(LC(x.body,DC,S,()=>{M&&M(),v&&v()}),w)}c=c||"text";let b=await f0[ie.findKey(f0,c)||"text"](x,n);return!_&&v&&v(),await new Promise((w,E)=>{j3(w,E,{data:b,headers:Vr.from(x.headers),status:x.status,statusText:x.statusText,config:n,request:y})})}catch(m){throw v&&v(),m&&m.name==="TypeError"&&/fetch/i.test(m.message)?Object.assign(new Qe("Network Error",Qe.ERR_NETWORK,n,y),{cause:m.cause||m}):Qe.from(m,m&&m.code,n,y)}}),VS={http:xK,xhr:YK,fetch:iZ};ie.forEach(VS,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const IC=n=>`- ${n}`,sZ=n=>ie.isFunction(n)||n===null||n===!1,$3={getAdapter:n=>{n=ie.isArray(n)?n:[n];const{length:e}=n;let t,r;const i={};for(let s=0;s<e;s++){t=n[s];let a;if(r=t,!sZ(t)&&(r=VS[(a=String(t)).toLowerCase()],r===void 0))throw new Qe(`Unknown adapter '${a}'`);if(r)break;i[a||"#"+s]=r}if(!r){const s=Object.entries(i).map(([o,l])=>`adapter ${o} `+(l===!1?"is not supported by the environment":"is not available in the build"));let a=e?s.length>1?`since :
`+s.map(IC).join(`
`):" "+IC(s[0]):"as no adapter specified";throw new Qe("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return r},adapters:VS};function K_(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new Rd(null,n)}function jC(n){return K_(n),n.headers=Vr.from(n.headers),n.data=Y_.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),$3.getAdapter(n.adapter||qp.adapter)(n).then(function(r){return K_(n),r.data=Y_.call(n,n.transformResponse,r),r.headers=Vr.from(r.headers),r},function(r){return I3(r)||(K_(n),r&&r.response&&(r.response.data=Y_.call(n,n.transformResponse,r.response),r.response.headers=Vr.from(r.response.headers))),Promise.reject(r)})}const V3="1.8.1",Hv={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{Hv[n]=function(r){return typeof r===n||"a"+(e<1?"n ":" ")+n}});const FC={};Hv.transitional=function(e,t,r){function i(s,a){return"[Axios v"+V3+"] Transitional option '"+s+"'"+a+(r?". "+r:"")}return(s,a,o)=>{if(e===!1)throw new Qe(i(a," has been removed"+(t?" in "+t:"")),Qe.ERR_DEPRECATED);return t&&!FC[a]&&(FC[a]=!0,console.warn(i(a," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(s,a,o):!0}};Hv.spelling=function(e){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function aZ(n,e,t){if(typeof n!="object")throw new Qe("options must be an object",Qe.ERR_BAD_OPTION_VALUE);const r=Object.keys(n);let i=r.length;for(;i-- >0;){const s=r[i],a=e[s];if(a){const o=n[s],l=o===void 0||a(o,s,n);if(l!==!0)throw new Qe("option "+s+" must be "+l,Qe.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Qe("Unknown option "+s,Qe.ERR_BAD_OPTION)}}const my={assertOptions:aZ,validators:Hv},fs=my.validators;class Kl{constructor(e){this.defaults=e,this.interceptors={request:new PC,response:new PC}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?s&&!String(r.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+s):r.stack=s}catch{}}throw r}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=oc(this.defaults,t);const{transitional:r,paramsSerializer:i,headers:s}=t;r!==void 0&&my.assertOptions(r,{silentJSONParsing:fs.transitional(fs.boolean),forcedJSONParsing:fs.transitional(fs.boolean),clarifyTimeoutError:fs.transitional(fs.boolean)},!1),i!=null&&(ie.isFunction(i)?t.paramsSerializer={serialize:i}:my.assertOptions(i,{encode:fs.function,serialize:fs.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),my.assertOptions(t,{baseUrl:fs.spelling("baseURL"),withXsrfToken:fs.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let a=s&&ie.merge(s.common,s[t.method]);s&&ie.forEach(["delete","get","head","post","put","patch","common"],y=>{delete s[y]}),t.headers=Vr.concat(a,s);const o=[];let l=!0;this.interceptors.request.forEach(function(v){typeof v.runWhen=="function"&&v.runWhen(t)===!1||(l=l&&v.synchronous,o.unshift(v.fulfilled,v.rejected))});const c=[];this.interceptors.response.forEach(function(v){c.push(v.fulfilled,v.rejected)});let u,d=0,h;if(!l){const y=[jC.bind(this),void 0];for(y.unshift.apply(y,o),y.push.apply(y,c),h=y.length,u=Promise.resolve(t);d<h;)u=u.then(y[d++],y[d++]);return u}h=o.length;let p=t;for(d=0;d<h;){const y=o[d++],v=o[d++];try{p=y(p)}catch(g){v.call(this,g);break}}try{u=jC.call(this,p)}catch(y){return Promise.reject(y)}for(d=0,h=c.length;d<h;)u=u.then(c[d++],c[d++]);return u}getUri(e){e=oc(this.defaults,e);const t=F3(e.baseURL,e.url,e.allowAbsoluteUrls);return O3(t,e.params,e.paramsSerializer)}}ie.forEach(["delete","get","head","options"],function(e){Kl.prototype[e]=function(t,r){return this.request(oc(r||{},{method:e,url:t,data:(r||{}).data}))}});ie.forEach(["post","put","patch"],function(e){function t(r){return function(s,a,o){return this.request(oc(o||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:a}))}}Kl.prototype[e]=t(),Kl.prototype[e+"Form"]=t(!0)});class AT{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(s){t=s});const r=this;this.promise.then(i=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](i);r._listeners=null}),this.promise.then=i=>{let s;const a=new Promise(o=>{r.subscribe(o),s=o}).then(i);return a.cancel=function(){r.unsubscribe(s)},a},e(function(s,a,o){r.reason||(r.reason=new Rd(s,a,o),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=r=>{e.abort(r)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new AT(function(i){e=i}),cancel:e}}}function oZ(n){return function(t){return n.apply(null,t)}}function lZ(n){return ie.isObject(n)&&n.isAxiosError===!0}const HS={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HS).forEach(([n,e])=>{HS[e]=n});function H3(n){const e=new Kl(n),t=w3(Kl.prototype.request,e);return ie.extend(t,Kl.prototype,e,{allOwnKeys:!0}),ie.extend(t,e,null,{allOwnKeys:!0}),t.create=function(i){return H3(oc(n,i))},t}const Vt=H3(qp);Vt.Axios=Kl;Vt.CanceledError=Rd;Vt.CancelToken=AT;Vt.isCancel=I3;Vt.VERSION=V3;Vt.toFormData=$v;Vt.AxiosError=Qe;Vt.Cancel=Vt.CanceledError;Vt.all=function(e){return Promise.all(e)};Vt.spread=oZ;Vt.isAxiosError=lZ;Vt.mergeConfig=oc;Vt.AxiosHeaders=Vr;Vt.formToJSON=n=>D3(ie.isHTMLForm(n)?new FormData(n):n);Vt.getAdapter=$3.getAdapter;Vt.HttpStatusCode=HS;Vt.default=Vt;const ws="CG-qsva2ctaarLBpZ3KDqYmzu6p",W3="BSAuJKLeeGVBZjJkUbDc2ji5yB_lv68",WS="fc-828bccc4148b4ec0ab4df0eeb4190bf3",G3=["solana","raydium","bonk","jito","pyth-network","render-token","serum","bonfida","step-finance","oxygen","mango-markets","star-atlas","samoyedcoin","marinade-staked-sol","jito-staked-sol"],aa=Vt.create({baseURL:"https://pro-api.coingecko.com/api/v3",timeout:15e3,headers:{"x-cg-pro-api-key":ws,"Content-Type":"application/json"}}),q3=Vt.create({baseURL:"https://api.search.brave.com/res/v1",timeout:1e4,headers:{Accept:"application/json","Accept-Encoding":"gzip","X-Subscription-Token":W3}}),p0=Vt.create({baseURL:"https://api.firecrawl.dev",timeout:3e4,headers:{"Content-Type":"application/json",Authorization:`Bearer ${WS}`}});aa.interceptors.request.use(n=>{const e=Date.now();return n.params={...n.params,_t:e,x_cg_pro_api_key:ws},n},n=>Promise.reject(n));aa.interceptors.response.use(n=>n,async n=>{var i,s;const e=((s=(i=n.response)==null?void 0:i.data)==null?void 0:s.error)||n.message||"An unknown error occurred";if(console.error("API Error:",e),n.code==="ECONNABORTED")throw new Error("Request timed out. Please try again.");if(!n.response)throw new Error("Network error. Please check your connection.");const{status:t,data:r}=n.response;switch(t){case 401:throw new Error("API key is missing or invalid. Please check your VITE_COINGECKO_API_KEY.");case 429:throw new Error("Rate limit exceeded. Please try again later.");case 403:throw new Error("API key invalid or expired.");case 404:throw new Error("Resource not found.");default:throw new Error(e)}});q3.interceptors.response.use(n=>n,async n=>{var r,i;const e=((i=(r=n.response)==null?void 0:r.data)==null?void 0:i.error)||n.message||"An unknown error occurred";if(console.error("Brave API Error:",e),n.code==="ECONNABORTED")throw new Error("Request timed out. Please try again.");if(!n.response)throw new Error("Network error. Please check your connection.");const{status:t}=n.response;switch(t){case 401:throw new Error("Brave API key is missing or invalid.");case 429:throw new Error("Brave API rate limit exceeded. Please try again later.");case 403:throw new Error("Brave API key invalid or expired.");case 404:throw new Error("Resource not found.");default:throw new Error(e)}});p0.interceptors.response.use(n=>(console.log("Firecrawl API request successful:",n.config.url),n),async n=>{const{config:e,response:t}=n;if(console.warn("Firecrawl API error:",{url:e==null?void 0:e.url,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText,data:t==null?void 0:t.data}),t&&t.status>=500&&e&&!e._retry)return console.log("Retrying Firecrawl API request due to server error"),e._retry=!0,await new Promise(r=>setTimeout(r,1e3)),p0(e);if(t)switch(t.status){case 401:console.error("Firecrawl API error: Unauthorized - Invalid API key");break;case 429:console.error("Firecrawl API error: Rate limit exceeded");break;case 403:console.error("Firecrawl API error: Forbidden - Account restrictions");break;case 404:console.error("Firecrawl API error: Resource not found");break}else console.error("Firecrawl API network error:",n.message);return Promise.reject(n)});const Z_=n=>n.map(t=>{const r={solana:122.45,raydium:.874,bonk:2953e-8,jito:3.24,"pyth-network":.542,"render-token":7.82,samoyedcoin:.0065}[t]||1,i={solana:55453245123,raydium:1253412515,bonk:1851123456,jito:985632145,"pyth-network":725412365,"render-token":3121489536,samoyedcoin:412563254}[t]||1e9,s=Math.random()*10-5;return{id:t,symbol:t.split("-")[0],name:t.split("-").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" "),image:`https://via.placeholder.com/64/1c4532/FFFFFF?text=${t.charAt(0).toUpperCase()}`,current_price:r,market_cap:i,market_cap_rank:Math.floor(Math.random()*200)+1,fully_diluted_valuation:i*1.5,total_volume:i*(Math.random()*.2),high_24h:r*(1+Math.random()*.1),low_24h:r*(1-Math.random()*.1),price_change_24h:r*(s/100),price_change_percentage_24h:s,price_change_percentage_7d:Math.random()*20-10,price_change_percentage_30d:Math.random()*40-20,market_cap_change_24h:i*(s/100),market_cap_change_percentage_24h:s,circulating_supply:i/r,total_supply:i/r*1.5,max_supply:i/r*2,ath:r*2,ath_change_percentage:-50,ath_date:"2021-11-01T00:00:00.000Z",atl:r*.1,atl_change_percentage:1e3,atl_date:"2020-01-01T00:00:00.000Z",last_updated:new Date().toISOString(),sparkline_in_7d:{price:Array(168).fill(0).map((a,o)=>[Date.now()-o*36e5,r*(1+(Math.random()*.2-.1))])}}}),lh=(n=10)=>{const e=["CryptoNews","SolanaDaily","DeFiPulse","BlockchainReport","CoinInsider"],t=["Solana","Bitcoin","Ethereum","DeFi","NFTs","Memecoins","Web3","Raydium","Jito","Bonk"],r=["reaches new all-time high as DeFi activity surges","adoption growing amid institutional interest","ecosystem expands with new protocols","price rallies as market sentiment improves","developers announce major protocol upgrade","trading volume spikes amid market volatility","leads crypto market recovery","gains traction with new strategic partnerships","becomes focus of regulatory discussions","community grows as new projects launch","sees increased integration across DeFi protocols","transaction volume sets new record"];return Array.from({length:n},(i,s)=>{const a=t[Math.floor(Math.random()*t.length)],o=r[Math.floor(Math.random()*r.length)];return{id:`news_${Date.now()}_${s}`,title:`${a} ${o}`,source:e[Math.floor(Math.random()*e.length)],summary:`Latest updates on ${a} show significant progress as the project continues to gain momentum. ${a} ${o.toLowerCase()} according to recent reports.`,url:"https://example.com/crypto-news",imageUrl:`https://via.placeholder.com/300/1c4532/FFFFFF?text=${a}`,publishedAt:new Date(Date.now()-Math.floor(Math.random()*864e5*3)).toISOString(),topics:[a.toLowerCase(),"crypto","blockchain"],sentiment:Math.random()>.3?"positive":Math.random()>.5?"neutral":"negative"}})},ya={getCoinDetails:async n=>{try{const{data:e}=await aa.get(`/coins/${n}`,{params:{localization:!1,tickers:!0,market_data:!0,community_data:!1,developer_data:!1,sparkline:!0}});return e}catch{return console.warn("Falling back to mock data due to API error"),Z_([n])[0]}},getOHLCData:async(n,e=1,t="usd")=>{try{const{data:r}=await aa.get(`/coins/${n}/ohlc`,{params:{vs_currency:t,days:e,precision:"full"}});return r}catch{return console.warn("Falling back to mock data due to API error"),dZ(n,e)}},getCoinMarketChart:async(n,e=1,t="usd")=>{try{const{data:r}=await aa.get(`/coins/${n}/market_chart`,{params:{vs_currency:t,days:e,interval:e===1?"minute":e<=90?"hourly":"daily",precision:"full"}});return r}catch{return console.warn("Falling back to mock data due to API error"),hZ(n,e)}},searchCoins:async n=>{try{if(!(n!=null&&n.trim()))return{coins:[]};const{data:e}=await aa.get("/search",{params:{query:n.trim()}});if(!e||!Array.isArray(e.coins))throw new Error("Invalid API response format");const t=e.coins.filter(r=>r&&r.id&&r.symbol).sort((r,i)=>(r.market_cap_rank||999999)-(i.market_cap_rank||999999)).slice(0,6);return{...e,coins:t}}catch(e){return console.error("Search API error:",e),console.warn("Falling back to mock search results"),fZ(n)}},getMarketData:async(n,e="usd")=>{try{if(!n.length)return[];const{data:t}=await aa.get("/coins/markets",{params:{vs_currency:e,ids:n.join(","),order:"market_cap_desc",per_page:100,page:1,sparkline:!0,price_change_percentage:"24h,7d,30d",include_market_cap:!0,include_24h_vol:!0,include_24h_change:!0,include_last_updated_at:!0,precision:"full"}});if(!t||!Array.isArray(t))throw new Error("Invalid response format");return t}catch(t){return console.warn("Falling back to mock market data due to API error:",t),Z_(n)}},getTrendingCoins:async()=>{try{const{data:n}=await aa.get("/search/trending",{params:{include_platform:!1}}),e=n.coins.slice(0,5);return{...n,coins:e}}catch{return console.warn("Falling back to mock trending data due to API error"),{coins:G3.slice(0,5).map(e=>({item:{id:e,name:e.split("-").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "),symbol:e.split("-")[0].toUpperCase(),market_cap_rank:Math.floor(Math.random()*100)+1}}))}}},getGlobalData:async()=>{try{return(await aa.get("/global")).data}catch{return console.warn("Falling back to mock global data due to API error"),pZ()}},getMockMarketData:n=>Z_(n),getNews:async(n=10,e)=>{var i,s;const t=e!=null&&e.length?e.join(" "):"crypto blockchain defi";console.log("Fetching news with topics:",t);let r="coingecko";try{console.log("Attempting to fetch trending coins from CoinGecko");const a=await Vt.get("https://api.coingecko.com/api/v3/search/trending");if(a.data&&((i=a.data.coins)==null?void 0:i.length)>0)return console.log(`CoinGecko API returned ${a.data.coins.length} trending coins`),{status:"success",source:"coingecko",data:await Promise.all(a.data.coins.slice(0,n).map(async(l,c)=>{var x;const u=l.item;let d=null,h=null,p=u.market_cap_rank,y="neutral";if(c<5)try{const _=await Vt.get(`https://api.coingecko.com/api/v3/coins/${u.id}?localization=false&tickers=false&market_data=true&community_data=false&developer_data=false&sparkline=false`);_.data&&(d=_.data,h=(x=d.market_data)==null?void 0:x.price_change_percentage_24h,p=d.market_cap_rank||u.market_cap_rank,h>5?y="positive":h<-5&&(y="negative"))}catch(_){console.warn(`Could not fetch detailed data for ${u.id}:`,_)}let v="",g="";d&&h!==null?h>0?(v=`${u.name} (${u.symbol.toUpperCase()}) Surges ${Math.abs(h).toFixed(2)}% in Past 24 Hours`,g=`${u.name} has shown significant positive movement, gaining ${Math.abs(h).toFixed(2)}% in the last 24 hours. Currently trending at #${c+1} on CoinGecko with market cap rank #${p}.`):h<0?(v=`${u.name} (${u.symbol.toUpperCase()}) Drops ${Math.abs(h).toFixed(2)}% in Past 24 Hours`,g=`${u.name} has experienced a decline of ${Math.abs(h).toFixed(2)}% in the last 24 hours. Despite this, it's trending at #${c+1} on CoinGecko with market cap rank #${p}.`):(v=`${u.name} (${u.symbol.toUpperCase()}) Shows Stability as It Trends on CoinGecko`,g=`${u.name} is maintaining stable prices over the last 24 hours. It's currently trending at #${c+1} on CoinGecko with market cap rank #${p}.`):(v=`${u.name} (${u.symbol.toUpperCase()}) Trending at #${c+1} on CoinGecko`,g=`${u.name} is gaining significant attention in the crypto market, currently trending at #${c+1} on CoinGecko with market cap rank #${p||"N/A"}.`);const m=[u.id,u.symbol.toLowerCase(),"trending","crypto",p<=100?"top100":"altcoin",y];return{id:`coingecko_trending_${Date.now()}_${u.id}`,title:v,source:"CoinGecko Trends",summary:g,publishedAt:new Date().toISOString(),topics:m,sentiment:y,url:`https://www.coingecko.com/en/coins/${u.id}`}}))};console.warn("CoinGecko trending API returned empty results, falling back to Firecrawl"),r="firecrawl"}catch(a){console.error("Error fetching trending news from CoinGecko:",a),console.warn("Falling back to Firecrawl API for news"),r="firecrawl"}if(r==="firecrawl"&&WS)try{console.log("Attempting to fetch news from Firecrawl API with query:",t);const a=await p0.post("/search",{query:t,limit:n});if(a.data&&((s=a.data.results)==null?void 0:s.length)>0)return console.log(`Firecrawl API returned ${a.data.results.length} results`),{status:"success",source:"firecrawl",data:a.data.results.map(l=>{const c=[...new Set([...t.split(" "),...(l.title||"").toLowerCase().split(/\s+/).filter(v=>v.length>4)])],u={positive:["bull","bullish","surge","soar","rally","gain","rise","up","high","growth"],negative:["bear","bearish","crash","drop","fall","loss","down","low","decline"]},d=`${l.title||""} ${l.snippet||""}`.toLowerCase();let h="neutral";const p=u.positive.filter(v=>d.includes(v)).length,y=u.negative.filter(v=>d.includes(v)).length;return p>y?h="positive":y>p&&(h="negative"),{id:l.id||`firecrawl_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,title:l.title||"Untitled News",source:l.source||"Firecrawl News",summary:l.snippet||"No summary available",url:l.url,publishedAt:l.published||new Date().toISOString(),topics:c.slice(0,5),sentiment:h}})};console.warn("Firecrawl API returned empty results, falling back to mock data"),r="mock"}catch(a){console.error("Error fetching news from Firecrawl API:",a),r="mock"}else r==="firecrawl"&&(console.warn("No Firecrawl API key found, falling back to mock data"),r="mock");return console.log("Using mock news data as fallback"),{status:"success",source:"mock",data:lh(n)}},getMarketNews:async(n,e=5)=>{try{const t=lh(e);if(n){const r=n.split("-").map(i=>i.charAt(0).toUpperCase()+i.slice(1)).join(" ");return{status:"success",count:e,data:t.map((i,s)=>s<3?{...i,title:i.title.replace(/(Solana|Bitcoin|Ethereum|DeFi)/,r),topics:[...i.topics,n]}:i)}}return{status:"success",count:t.length,data:t}}catch{return console.warn("Error fetching market news, falling back to mock data"),{status:"error",count:0,data:lh(e)}}},getBraveNews:async(n,e=10,t="us",r="en")=>{try{console.log("Attempting to fetch news from Brave Search API with query:",n);const i=new URLSearchParams({q:n,count:e.toString(),country:t,search_lang:r,spellcheck:"1"});console.log("Making Brave Search API request with params:",i.toString());const s=await q3.get(`/news/search?${i}`);console.log("Brave Search API raw response:",s.status);const a=s.data;if(!a.results||a.results.length===0){console.warn("No news found, falling back to mock data");const l=lh(e,[n]);return{status:"success",count:l.length,data:l,source:"mock"}}const o=a.results.map((l,c)=>{const u=new Date(l.published_timestamp*1e3).toISOString(),d=[n],h=l.title.toLowerCase().split(/\s+/),p=["blockchain","crypto","token","coin","defi","nft","market"];h.forEach(v=>{(v.length>3&&!p.includes(v)||p.includes(v))&&d.push(v)});const y=[...new Set(d)].slice(0,5);return{id:`brave_${Date.now()}_${c}`,title:l.title,source:l.publisher,summary:l.description,url:l.url,imageUrl:l.image_url||`https://via.placeholder.com/300/1c4532/FFFFFF?text=${encodeURIComponent(n)}`,publishedAt:u,topics:y,sentiment:uZ(l.title+" "+l.description)}});return console.log(`Transformed ${o.length} news items from Brave API`),{status:"success",count:o.length,data:o,source:"brave"}}catch(i){console.error("Error fetching news from Brave:",i),console.warn("Falling back to mock data");const s=lh(e);return{status:"success",count:s.length,data:s,source:"mock"}}},getTokenNews:async(n,e=10)=>{var a,o,l,c,u,d,h,p,y,v,g;let t=n.split("-").join(" "),r="";console.log(`Fetching news for token ID: ${n}`);try{const m=await getCoinDetails(n);m!=null&&m.name&&(t=m.name,console.log(`Found token name: ${t} for ID: ${n}`))}catch(m){console.warn(`Could not get token name for ${n}, using formatted ID instead:`,m)}let i="coingecko";try{console.log("Attempting to fetch detailed coin data from CoinGecko");const m=await Vt.get(`https://api.coingecko.com/api/v3/coins/${n}?localization=false&tickers=false&market_data=true&community_data=true&developer_data=false&sparkline=false`);if(m.data){console.log(`CoinGecko API returned detailed data for ${n}`);const x=m.data,_=[],b=(a=x.market_data)==null?void 0:a.price_change_percentage_24h,w=(o=x.market_data)==null?void 0:o.price_change_percentage_7d,E=(c=(l=x.market_data)==null?void 0:l.current_price)==null?void 0:c.usd,S=x.market_cap_rank;if(b!==void 0){const M=b>3?"positive":b<-3?"negative":"neutral",N=Math.abs(b).toFixed(2);let T,P;b>3?(T=`${t} Surges ${N}% in the Last 24 Hours`,P=`${t} (${x.symbol.toUpperCase()}) has shown significant bullish momentum, gaining ${N}% in just 24 hours. The token is currently trading at $${(E==null?void 0:E.toFixed(2))||"N/A"}.`):b<-3?(T=`${t} Drops ${N}% in the Last 24 Hours`,P=`${t} (${x.symbol.toUpperCase()}) has experienced a notable decline, falling ${N}% over the past 24 hours. The token is currently trading at $${(E==null?void 0:E.toFixed(2))||"N/A"}.`):(T=`${t} Shows Stability in Recent Trading`,P=`${t} (${x.symbol.toUpperCase()}) has maintained relative price stability, with only a ${b>0?"gain":"loss"} of ${N}% in the last 24 hours. The token is currently valued at $${(E==null?void 0:E.toFixed(2))||"N/A"}.`),_.push({id:`coingecko_${n}_price_24h_${Date.now()}`,title:T,source:"CoinGecko Market Data",summary:P,publishedAt:new Date().toISOString(),topics:[n,x.symbol.toLowerCase(),"price","market",M],sentiment:M,url:`https://www.coingecko.com/en/coins/${n}`})}if(w!==void 0&&_.length<e){const M=w>10?"positive":w<-10?"negative":"neutral",N=Math.abs(w).toFixed(2);let T,P;w>10?(T=`${t} Shows Strong Week with ${N}% 7-Day Gain`,P=`${t} has demonstrated significant strength over the past week, with a ${N}% increase over the 7-day period. Market observers are noting increased interest in the token, which currently ranks #${S||"N/A"} by market cap.`):w<-10?(T=`${t} Faces Pressure with ${N}% 7-Day Decline`,P=`${t} has experienced downward pressure over the past week, with a ${N}% decrease during the 7-day period. Despite this, the token maintains its position at #${S||"N/A"} in the market cap rankings.`):(T=`${t} Maintains Steady Performance Over Past Week`,P=`${t} has shown relatively stable performance over the past 7 days, with a modest ${w>0?"gain":"loss"} of ${N}%. The token currently holds position #${S||"N/A"} in the global cryptocurrency rankings.`),_.push({id:`coingecko_${n}_price_7d_${Date.now()}`,title:T,source:"CoinGecko Weekly Trends",summary:P,publishedAt:new Date(Date.now()-864e5).toISOString(),topics:[n,x.symbol.toLowerCase(),"weekly","trend",M],sentiment:M,url:`https://www.coingecko.com/en/coins/${n}`})}if((d=(u=x.market_data)==null?void 0:u.market_cap)!=null&&d.usd&&_.length<e){const M=x.market_data.market_cap.usd,N=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",notation:"compact",maximumFractionDigits:2}).format(M),T=`${t} Market Cap Currently at ${N}`,P=`${t} (${x.symbol.toUpperCase()}) currently has a market capitalization of ${N}, ranking #${S||"N/A"} among all cryptocurrencies. ${b?`The token has ${b>0?"gained":"lost"} ${Math.abs(b).toFixed(2)}% in the last 24 hours.`:""}`;_.push({id:`coingecko_${n}_marketcap_${Date.now()}`,title:T,source:"CoinGecko Market Analysis",summary:P,publishedAt:new Date(Date.now()-1728e5).toISOString(),topics:[n,x.symbol.toLowerCase(),"market cap","analysis"],sentiment:"neutral",url:`https://www.coingecko.com/en/coins/${n}`})}if(_.length<e)try{const M=await Vt.get("https://api.coingecko.com/api/v3/search/trending");M.data&&M.data.coins&&M.data.coins.some(T=>T.item.id===n||T.item.symbol.toLowerCase()===x.symbol.toLowerCase())&&_.length<e&&_.push({id:`coingecko_${n}_trending_${Date.now()}`,title:`${t} Gains Popularity as It Trends on CoinGecko`,source:"CoinGecko Trends",summary:`${t} (${x.symbol.toUpperCase()}) is currently trending on CoinGecko, showing increased interest from traders and investors. The token has attracted significant attention in the crypto community.`,publishedAt:new Date(Date.now()-432e5).toISOString(),topics:[n,x.symbol.toLowerCase(),"trending","popular"],sentiment:"positive",url:`https://www.coingecko.com/en/coins/${n}`})}catch(M){console.warn("Error fetching trending data:",M)}if(_.length<e){const M=[{title:`Understanding ${t}'s Market Position and Future Potential`,summary:`${t} (${x.symbol.toUpperCase()}) currently ranks #${S||"N/A"} by market capitalization. This analysis explores the token's market position, recent developments, and factors that could influence its future performance.`,source:"CoinGecko Insights",topics:[n,x.symbol.toLowerCase(),"analysis","market"],sentiment:"neutral"},{title:`${t} Trading Volume Indicates Market Interest`,summary:`${t} has recorded a 24-hour trading volume of $${(p=(h=x.market_data)==null?void 0:h.total_volume)!=null&&p.usd?new Intl.NumberFormat("en-US").format(x.market_data.total_volume.usd):"N/A"}, suggesting ${((v=(y=x.market_data)==null?void 0:y.total_volume)==null?void 0:v.usd)>1e7?"significant":"moderate"} market activity and interest in the token.`,source:"CoinGecko Volume Watch",topics:[n,x.symbol.toLowerCase(),"volume","trading"],sentiment:"neutral"}];for(const N of M)_.length<e&&_.push({id:`coingecko_${n}_context_${Date.now()}_${_.length}`,title:N.title,source:N.source,summary:N.summary,publishedAt:new Date(Date.now()-(2592e5+_.length*36e5)).toISOString(),topics:N.topics,sentiment:N.sentiment,url:`https://www.coingecko.com/en/coins/${n}`})}return{status:"success",source:"coingecko",data:_.slice(0,e)}}}catch(m){console.error("Error fetching token data from CoinGecko:",m),console.warn("Falling back to Firecrawl API for token news"),i="firecrawl"}if(r=`${t} ${n.replace(/-/g," ")} crypto news`,console.log(`Using search query for token news: "${r}"`),i==="firecrawl"&&WS)try{console.log("Attempting to fetch token news from Firecrawl API");const m=await p0.post("/search",{query:r,limit:e});if(m.data&&((g=m.data.results)==null?void 0:g.length)>0)return console.log(`Firecrawl API returned ${m.data.results.length} token news results`),{status:"success",source:"firecrawl",data:m.data.results.map(_=>{const b=[...new Set([...queryTopics.split(" "),...(_.title||"").toLowerCase().split(/\s+/).filter(T=>T.length>4)])],w={positive:["bull","bullish","surge","soar","rally","gain","rise","up","high","growth"],negative:["bear","bearish","crash","drop","fall","loss","down","low","decline"]},E=`${_.title||""} ${_.snippet||""}`.toLowerCase();let S="neutral";const M=w.positive.filter(T=>E.includes(T)).length,N=w.negative.filter(T=>E.includes(T)).length;return M>N?S="positive":N>M&&(S="negative"),{id:_.id||`firecrawl_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,title:_.title||"Untitled News",source:_.source||"Firecrawl News",summary:_.snippet||"No summary available",url:_.url,publishedAt:_.published||new Date().toISOString(),topics:b.slice(0,5),sentiment:S}})};console.warn("Firecrawl API returned empty results, falling back to mock data"),i="mock"}catch(m){console.error("Error fetching news from Firecrawl API:",m),i="mock"}else i==="firecrawl"&&(console.warn("No Firecrawl API key found, falling back to mock data"),i="mock");return console.log(`Using mock data for ${t} news as fallback`),{status:"success",source:"mock",data:Array.from({length:e},(m,x)=>{const _=Math.random()>.5,b=[`${t} ${_?"Surges":"Dips"} as Markets React to Recent Developments`,`Analysts Predict Strong ${_?"Growth":"Challenges"} for ${t} in Coming Months`,`New ${t} Partnership Announcement ${_?"Excites":"Concerns"} Investors`,`${t} ${_?"Outperforms":"Struggles Against"} Major Market Competitors`,`Technical Analysis: ${t} Shows ${_?"Bullish":"Bearish"} Patterns`],w=Math.floor(Math.random()*7),E=new Date;return E.setDate(E.getDate()-w),{id:`mock_${n}_${Date.now()}_${x}`,title:b[x%b.length],source:["CryptoPulse","TokenInsider","BlockchainToday","CoinAnalyst","MarketWatch"][x%5],summary:`The latest ${_?"positive":"concerning"} developments surrounding ${t} have caught the attention of crypto enthusiasts and investors alike. Market experts are closely monitoring the situation.`,url:`https://example.com/crypto/${n}/news/${Date.now()}`,publishedAt:E.toISOString(),topics:[n,t.toLowerCase(),"crypto",_?"bullish":"bearish","analysis"],sentiment:_?"positive":"negative"}})}}},cZ=!ws,uZ=n=>{const e=n.toLowerCase(),t=["gain","bull","surge","rally","rise","boom","soar","jump","increase","grow","profit","success","positive","up","high","breakthrough","promising","opportunity","bullish","adoption"],r=["crash","bear","drop","fall","plunge","tumble","sink","dive","decrease","shrink","loss","fail","negative","down","low","risk","warning","concern","bearish","trouble"];let i=0,s=0;for(const a of t)e.includes(a)&&i++;for(const a of r)e.includes(a)&&s++;return i>s?"positive":s>i?"negative":"neutral"},dZ=(n,e)=>{const t={solana:122.45,raydium:.874,bonk:2953e-8,jito:3.24,"pyth-network":.542,"render-token":7.82,samoyedcoin:.0065}[n]||1,r=.05,i=e===1?24:e===7?7*24:30,s=Date.now(),a=e*24*60*60*1e3/i;return Array(i).fill(0).map((o,l)=>{const c=s-l*a,u=t*(1+(Math.random()*2*r-r)),d=u*(1+(Math.random()*2*r-r)),h=Math.max(u,d)*(1+Math.random()*r),p=Math.min(u,d)*(1-Math.random()*r);return[c,u,h,p,d]}).sort((o,l)=>o[0]-l[0])},hZ=(n,e)=>{const t={solana:122.45,raydium:.874,bonk:2953e-8,jito:3.24,"pyth-network":.542,"render-token":7.82,samoyedcoin:.0065}[n]||1,r=.05,i=e===1?24*60:e===7?7*24:30,s=Date.now(),a=e*24*60*60*1e3/i,o=Array(i).fill(0).map((u,d)=>{const h=s-d*a,p=t*(1+(Math.random()*2*r-r));return[h,p]}).sort((u,d)=>u[0]-d[0]),l=o.map(([u,d])=>[u,d*1e9*(1+(Math.random()*.1-.05))]),c=o.map(([u])=>[u,t*1e8*Math.random()]);return{prices:o,market_caps:l,total_volumes:c}},fZ=n=>{const e=n.toLowerCase();return{coins:G3.filter(i=>i.toLowerCase().includes(e)).map(i=>({id:i,name:i.split("-").map(s=>s.charAt(0).toUpperCase()+s.slice(1)).join(" "),api_symbol:i.split("-")[0],symbol:i.split("-")[0].toUpperCase(),market_cap_rank:Math.floor(Math.random()*100)+1,thumb:`https://via.placeholder.com/32/1c4532/FFFFFF?text=${i.charAt(0).toUpperCase()}`,large:`https://via.placeholder.com/64/1c4532/FFFFFF?text=${i.charAt(0).toUpperCase()}`}))}},pZ=()=>({data:{active_cryptocurrencies:12735,upcoming_icos:0,ongoing_icos:49,ended_icos:3376,markets:880,total_market_cap:{usd:25875654746222627e-4},total_volume:{usd:704661953657751e-4},market_cap_percentage:{btc:52.83766771422481,eth:16.798544008242114,usdt:7.190608117344986,sol:2.7301863448898134,xrp:1.7838051304290397},market_cap_change_percentage_24h_usd:.24781514788481296,updated_at:1679116437}});function X3(n,e){const[t,r]=k.useState(n);return k.useEffect(()=>{const i=setTimeout(()=>{r(n)},e);return()=>{clearTimeout(i)}},[n,e]),t}const Y3=k.createContext(void 0),mZ=({children:n})=>{const[e,t]=k.useState(null),[r,i]=k.useState(!1),[s,a]=k.useState(null),o=async l=>{if(l){i(!0),a(null);try{let c;if(cZ||(c=(await ya.getMarketData([l]))[0]),c){const u={id:c.id,symbol:c.symbol.toUpperCase(),name:c.name,image:c.image,current_price:c.current_price,market_cap:c.market_cap,price_change_percentage_24h:c.price_change_percentage_24h};t(u)}else a("Token not found"),t(null)}catch(c){console.error("Error fetching token:",c),a("Failed to load token details"),t(null)}finally{i(!1)}}};return f.jsx(Y3.Provider,{value:{selectedToken:e,setSelectedToken:t,selectTokenById:o,loadingToken:r,tokenError:s},children:n})},PT=()=>{const n=k.useContext(Y3);if(n===void 0)throw new Error("useToken must be used within a TokenProvider");return n};function gZ(n){if(typeof n>"u")return null;try{return JSON.parse(n)}catch{}let e="";const t=[];let r=!1,i=!1;for(let s of n){if(r)s==='"'&&!i?r=!1:s===`
`&&!i?s="\\n":s==="\\"?i=!i:i=!1;else if(s==='"')r=!0,i=!1;else if(s==="{")t.push("}");else if(s==="[")t.push("]");else if(s==="}"||s==="]")if(t&&t[t.length-1]===s)t.pop();else return null;e+=s}r&&(e+='"');for(let s=t.length-1;s>=0;s-=1)e+=t[s];try{return JSON.parse(e)}catch{return null}}var yZ=function(n,e){if(typeof n!="string")throw new TypeError("Expected a string");return e=typeof e>"u"?"_":e,n.replace(/([a-z\d])([A-Z])/g,"$1"+e+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+e+"$2").toLowerCase()};const vZ=Cp(yZ);var K3={exports:{}};const xZ=/[\p{Lu}]/u,_Z=/[\p{Ll}]/u,UC=/^[\p{Lu}](?![\p{Lu}])/gu,Z3=/([\p{Alpha}\p{N}_]|$)/u,J3=/[_.\- ]+/,bZ=new RegExp("^"+J3.source),BC=new RegExp(J3.source+Z3.source,"gu"),zC=new RegExp("\\d+"+Z3.source,"gu"),wZ=(n,e,t)=>{let r=!1,i=!1,s=!1;for(let a=0;a<n.length;a++){const o=n[a];r&&xZ.test(o)?(n=n.slice(0,a)+"-"+n.slice(a),r=!1,s=i,i=!0,a++):i&&s&&_Z.test(o)?(n=n.slice(0,a-1)+"-"+n.slice(a-1),s=i,i=!1,r=!0):(r=e(o)===o&&t(o)!==o,s=i,i=t(o)===o&&e(o)!==o)}return n},SZ=(n,e)=>(UC.lastIndex=0,n.replace(UC,t=>e(t))),EZ=(n,e)=>(BC.lastIndex=0,zC.lastIndex=0,n.replace(BC,(t,r)=>e(r)).replace(zC,t=>e(t))),Q3=(n,e)=>{if(!(typeof n=="string"||Array.isArray(n)))throw new TypeError("Expected the input to be `string | string[]`");if(e={pascalCase:!1,preserveConsecutiveUppercase:!1,...e},Array.isArray(n)?n=n.map(s=>s.trim()).filter(s=>s.length).join("-"):n=n.trim(),n.length===0)return"";const t=e.locale===!1?s=>s.toLowerCase():s=>s.toLocaleLowerCase(e.locale),r=e.locale===!1?s=>s.toUpperCase():s=>s.toLocaleUpperCase(e.locale);return n.length===1?e.pascalCase?r(n):t(n):(n!==t(n)&&(n=wZ(n,t,r)),n=n.replace(bZ,""),e.preserveConsecutiveUppercase?n=SZ(n,t):n=t(n),e.pascalCase&&(n=r(n.charAt(0))+n.slice(1)),EZ(n,r))};K3.exports=Q3;K3.exports.default=Q3;function TZ(n,e){return(e==null?void 0:e[n])||vZ(n)}function MZ(n,e,t){const r={};for(const i in n)Object.hasOwn(n,i)&&(r[e(i,t)]=n[i]);return r}function $C(n){return Array.isArray(n)?[...n]:{...n}}function kZ(n,e){const t=$C(n);for(const[r,i]of Object.entries(e)){const[s,...a]=r.split(".").reverse();let o=t;for(const l of a.reverse()){if(o[l]===void 0)break;o[l]=$C(o[l]),o=o[l]}o[s]!==void 0&&(o[s]={lc:1,type:"secret",id:[i]})}return t}function eF(n){const e=Object.getPrototypeOf(n);return typeof n.lc_name=="function"&&(typeof e.lc_name!="function"||n.lc_name()!==e.lc_name())?n.lc_name():n.name}class lc{static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,eF(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}constructor(e,...t){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_kwargs=e||{}}toJSON(){if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof lc||typeof this.lc_kwargs!="object"||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();const e={},t={},r=Object.keys(this.lc_kwargs).reduce((i,s)=>(i[s]=s in this?this[s]:this.lc_kwargs[s],i),{});for(let i=Object.getPrototypeOf(this);i;i=Object.getPrototypeOf(i))Object.assign(e,Reflect.get(i,"lc_aliases",this)),Object.assign(t,Reflect.get(i,"lc_secrets",this)),Object.assign(r,Reflect.get(i,"lc_attributes",this));return Object.keys(t).forEach(i=>{let s=this,a=r;const[o,...l]=i.split(".").reverse();for(const c of l.reverse()){if(!(c in s)||s[c]===void 0)return;(!(c in a)||a[c]===void 0)&&(typeof s[c]=="object"&&s[c]!=null?a[c]={}:Array.isArray(s[c])&&(a[c]=[])),s=s[c],a=a[c]}o in s&&s[o]!==void 0&&(a[o]=a[o]||s[o])}),{lc:1,type:"constructor",id:this.lc_id,kwargs:MZ(Object.keys(t).length?kZ(r,t):r,TZ,e)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}}function AZ(n,e){return typeof n=="string"?typeof e=="string"?n+e:[{type:"text",text:n},...e]:Array.isArray(e)?CT(n,e)??[...n,...e]:[...n,{type:"text",text:e}]}function PZ(n,e){function t(r,i){if(typeof r!="object"||r===null||r===void 0)return r;if(i>=e)return Array.isArray(r)?"[Array]":"[Object]";if(Array.isArray(r))return r.map(a=>t(a,i+1));const s={};for(const a of Object.keys(r))s[a]=t(r[a],i+1);return s}return JSON.stringify(t(n,0),null,2)}class Sa extends lc{get lc_aliases(){return{additional_kwargs:"additional_kwargs",response_metadata:"response_metadata"}}get text(){return typeof this.content=="string"?this.content:""}constructor(e,t){typeof e=="string"&&(e={content:e,additional_kwargs:t,response_metadata:{}}),e.additional_kwargs||(e.additional_kwargs={}),e.response_metadata||(e.response_metadata={}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","messages"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.content=e.content,this.additional_kwargs=e.additional_kwargs,this.response_metadata=e.response_metadata,this.id=e.id}toDict(){return{type:this._getType(),data:this.toJSON().kwargs}}static lc_name(){return"BaseMessage"}get _printableFields(){return{id:this.id,content:this.content,name:this.name,additional_kwargs:this.additional_kwargs,response_metadata:this.response_metadata}}_updateId(e){this.id=e,this.lc_kwargs.id=e}get[Symbol.toStringTag](){return this.constructor.lc_name()}[Symbol.for("nodejs.util.inspect.custom")](e){if(e===null)return this;const t=PZ(this._printableFields,Math.max(4,e));return`${this.constructor.lc_name()} ${t}`}}function m0(n,e){const t={...n};for(const[r,i]of Object.entries(e))if(t[r]==null)t[r]=i;else{if(i==null)continue;if(typeof t[r]!=typeof i||Array.isArray(t[r])!==Array.isArray(i))throw new Error(`field[${r}] already exists in the message chunk, but with a different type.`);if(typeof t[r]=="string"){if(r==="type")continue;t[r]+=i}else if(typeof t[r]=="object"&&!Array.isArray(t[r]))t[r]=m0(t[r],i);else if(Array.isArray(t[r]))t[r]=CT(t[r],i);else{if(t[r]===i)continue;console.warn(`field[${r}] already exists in this message chunk and value has unsupported type.`)}}return t}function CT(n,e){if(!(n===void 0&&e===void 0)){if(n===void 0||e===void 0)return n||e;{const t=[...n];for(const r of e)if(typeof r=="object"&&"index"in r&&typeof r.index=="number"){const i=t.findIndex(s=>s.index===r.index);i!==-1?t[i]=m0(t[i],r):t.push(r)}else{if(typeof r=="object"&&"text"in r&&r.text==="")continue;t.push(r)}return t}}}class CZ extends Sa{}function RZ(n){return typeof n.role=="string"}function tF(n){return typeof(n==null?void 0:n._getType)=="function"}class NZ extends Sa{static lc_name(){return"ToolMessage"}get lc_aliases(){return{tool_call_id:"tool_call_id"}}constructor(e,t,r){typeof e=="string"&&(e={content:e,name:r,tool_call_id:t}),super(e),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}_getType(){return"tool"}static isInstance(e){return e._getType()==="tool"}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}}function OZ(n){const e=[],t=[];for(const r of n)if(r.function){const i=r.function.name;try{const s=JSON.parse(r.function.arguments),a={name:i||"",args:s||{},id:r.id};e.push(a)}catch{t.push({name:i,args:r.function.arguments,id:r.id,error:"Malformed args."})}}else continue;return[e,t]}class dd extends Sa{get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls"}}constructor(e,t){var i;let r;if(typeof e=="string")r={content:e,tool_calls:[],invalid_tool_calls:[],additional_kwargs:t??{}};else{r=e;const s=(i=r.additional_kwargs)==null?void 0:i.tool_calls,a=r.tool_calls;s!=null&&s.length>0&&(a===void 0||a.length===0)&&console.warn(["New LangChain packages are available that more efficiently handle",`tool calling.

Please upgrade your packages to versions that set`,"message tool calls. e.g., `yarn add @langchain/anthropic`,","yarn add @langchain/openai`, etc."].join(" "));try{if(s!=null&&a===void 0){const[o,l]=OZ(s);r.tool_calls=o??[],r.invalid_tool_calls=l??[]}else r.tool_calls=r.tool_calls??[],r.invalid_tool_calls=r.invalid_tool_calls??[]}catch{r.tool_calls=[],r.invalid_tool_calls=[]}}super(r),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof r!="string"&&(this.tool_calls=r.tool_calls??this.tool_calls,this.invalid_tool_calls=r.invalid_tool_calls??this.invalid_tool_calls),this.usage_metadata=r.usage_metadata}static lc_name(){return"AIMessage"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}}function LZ(n){return n._getType()==="ai"}class pr extends CZ{constructor(e){let t;if(typeof e=="string")t={content:e,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else if(e.tool_call_chunks===void 0)t={...e,tool_calls:e.tool_calls??[],invalid_tool_calls:[],tool_call_chunks:[]};else{const r=[],i=[];for(const s of e.tool_call_chunks){let a={};try{if(a=gZ(s.args||"{}"),a===null||typeof a!="object"||Array.isArray(a))throw new Error("Malformed tool call chunk args.");r.push({name:s.name??"",args:a,id:s.id,type:"tool_call"})}catch{i.push({name:s.name,args:s.args,id:s.id,error:"Malformed args.",type:"invalid_tool_call"})}}t={...e,tool_calls:r,invalid_tool_calls:i}}super(t),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tool_call_chunks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_chunks=t.tool_call_chunks??this.tool_call_chunks,this.tool_calls=t.tool_calls??this.tool_calls,this.invalid_tool_calls=t.invalid_tool_calls??this.invalid_tool_calls,this.usage_metadata=t.usage_metadata}get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls",tool_call_chunks:"tool_call_chunks"}}static lc_name(){return"AIMessageChunk"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,tool_call_chunks:this.tool_call_chunks,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}concat(e){const t={content:AZ(this.content,e.content),additional_kwargs:m0(this.additional_kwargs,e.additional_kwargs),response_metadata:m0(this.response_metadata,e.response_metadata),tool_call_chunks:[],id:this.id??e.id};if(this.tool_call_chunks!==void 0||e.tool_call_chunks!==void 0){const r=CT(this.tool_call_chunks,e.tool_call_chunks);r!==void 0&&r.length>0&&(t.tool_call_chunks=r)}if(this.usage_metadata!==void 0||e.usage_metadata!==void 0){const r=this.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},i=e.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},s={input_tokens:r.input_tokens+i.input_tokens,output_tokens:r.output_tokens+i.output_tokens,total_tokens:r.total_tokens+i.total_tokens};t.usage_metadata=s}return new pr(t)}}class Wv extends Sa{static lc_name(){return"ChatMessage"}static _chatMessageClass(){return Wv}constructor(e,t){typeof e=="string"&&(e={content:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}static isInstance(e){return e._getType()==="generic"}get _printableFields(){return{...super._printableFields,role:this.role}}}class Ds extends Sa{static lc_name(){return"HumanMessage"}_getType(){return"human"}}class nF extends Sa{static lc_name(){return"SystemMessage"}_getType(){return"system"}}function rF(n){return!!(n&&typeof n=="object"&&"type"in n&&n.type==="tool_call")}class DZ extends Error{constructor(e,t){super(e),Object.defineProperty(this,"output",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.output=t}}function IZ(n){return rF(n)?n:typeof n.id=="string"&&n.type==="function"&&typeof n.function=="object"&&n.function!==null&&"arguments"in n.function&&typeof n.function.arguments=="string"&&"name"in n.function&&typeof n.function.name=="string"?{id:n.id,args:JSON.parse(n.function.arguments),name:n.function.name,type:"tool_call"}:n}function J_(n){const{type:e,...t}=n;if(e==="human"||e==="user")return new Ds(t);if(e==="ai"||e==="assistant"){const{tool_calls:r,...i}=t;if(!Array.isArray(r))return new dd(t);const s=r.map(IZ);return new dd({...i,tool_calls:s})}else{if(e==="system")return new nF(t);if(e==="tool"&&"tool_call_id"in t)return new NZ({...t,content:t.content,tool_call_id:t.tool_call_id,name:t.name});throw new Error("Unable to coerce message from array: only human, AI, or system message coercion is currently supported.")}}function _o(n){if(typeof n=="string")return new Ds(n);if(tF(n))return n;if(Array.isArray(n)){const[e,t]=n;return J_({type:e,content:t})}else if(RZ(n)){const{role:e,...t}=n;return J_({...t,type:e})}else return J_(n)}function iF(n,e="Human",t="AI"){const r=[];for(const i of n){let s;if(i._getType()==="human")s=e;else if(i._getType()==="ai")s=t;else if(i._getType()==="system")s="System";else if(i._getType()==="function")s="Function";else if(i._getType()==="tool")s="Tool";else if(i._getType()==="generic")s=i.role;else throw new Error(`Got unsupported message type: ${i._getType()}`);const a=i.name?`${i.name}, `:"",o=typeof i.content=="string"?i.content:JSON.stringify(i.content,null,2);r.push(`${s}: ${a}${o}`)}return r.join(`
`)}var Tt;(function(n){n.assertEqual=i=>i;function e(i){}n.assertIs=e;function t(i){throw new Error}n.assertNever=t,n.arrayToEnum=i=>{const s={};for(const a of i)s[a]=a;return s},n.getValidEnumValues=i=>{const s=n.objectKeys(i).filter(o=>typeof i[i[o]]!="number"),a={};for(const o of s)a[o]=i[o];return n.objectValues(a)},n.objectValues=i=>n.objectKeys(i).map(function(s){return i[s]}),n.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const s=[];for(const a in i)Object.prototype.hasOwnProperty.call(i,a)&&s.push(a);return s},n.find=(i,s)=>{for(const a of i)if(s(a))return a},n.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&isFinite(i)&&Math.floor(i)===i;function r(i,s=" | "){return i.map(a=>typeof a=="string"?`'${a}'`:a).join(s)}n.joinValues=r,n.jsonStringifyReplacer=(i,s)=>typeof s=="bigint"?s.toString():s})(Tt||(Tt={}));var GS;(function(n){n.mergeShapes=(e,t)=>({...e,...t})})(GS||(GS={}));const Oe=Tt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ca=n=>{switch(typeof n){case"undefined":return Oe.undefined;case"string":return Oe.string;case"number":return isNaN(n)?Oe.nan:Oe.number;case"boolean":return Oe.boolean;case"function":return Oe.function;case"bigint":return Oe.bigint;case"symbol":return Oe.symbol;case"object":return Array.isArray(n)?Oe.array:n===null?Oe.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?Oe.promise:typeof Map<"u"&&n instanceof Map?Oe.map:typeof Set<"u"&&n instanceof Set?Oe.set:typeof Date<"u"&&n instanceof Date?Oe.date:Oe.object;default:return Oe.unknown}},ve=Tt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),jZ=n=>JSON.stringify(n,null,2).replace(/"([^"]+)":/g,"$1:");class ii extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(s){return s.message},r={_errors:[]},i=s=>{for(const a of s.issues)if(a.code==="invalid_union")a.unionErrors.map(i);else if(a.code==="invalid_return_type")i(a.returnTypeError);else if(a.code==="invalid_arguments")i(a.argumentsError);else if(a.path.length===0)r._errors.push(t(a));else{let o=r,l=0;for(;l<a.path.length;){const c=a.path[l];l===a.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(t(a))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return i(this),r}static assert(e){if(!(e instanceof ii))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Tt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},r=[];for(const i of this.issues)i.path.length>0?(t[i.path[0]]=t[i.path[0]]||[],t[i.path[0]].push(e(i))):r.push(e(i));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}ii.create=n=>new ii(n);const hd=(n,e)=>{let t;switch(n.code){case ve.invalid_type:n.received===Oe.undefined?t="Required":t=`Expected ${n.expected}, received ${n.received}`;break;case ve.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(n.expected,Tt.jsonStringifyReplacer)}`;break;case ve.unrecognized_keys:t=`Unrecognized key(s) in object: ${Tt.joinValues(n.keys,", ")}`;break;case ve.invalid_union:t="Invalid input";break;case ve.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${Tt.joinValues(n.options)}`;break;case ve.invalid_enum_value:t=`Invalid enum value. Expected ${Tt.joinValues(n.options)}, received '${n.received}'`;break;case ve.invalid_arguments:t="Invalid function arguments";break;case ve.invalid_return_type:t="Invalid function return type";break;case ve.invalid_date:t="Invalid date";break;case ve.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(t=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?t=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?t=`Invalid input: must end with "${n.validation.endsWith}"`:Tt.assertNever(n.validation):n.validation!=="regex"?t=`Invalid ${n.validation}`:t="Invalid";break;case ve.too_small:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:t="Invalid input";break;case ve.too_big:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?t=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:t="Invalid input";break;case ve.custom:t="Invalid input";break;case ve.invalid_intersection_types:t="Intersection results could not be merged";break;case ve.not_multiple_of:t=`Number must be a multiple of ${n.multipleOf}`;break;case ve.not_finite:t="Number must be finite";break;default:t=e.defaultError,Tt.assertNever(n)}return{message:t}};let sF=hd;function FZ(n){sF=n}function g0(){return sF}const y0=n=>{const{data:e,path:t,errorMaps:r,issueData:i}=n,s=[...t,...i.path||[]],a={...i,path:s};if(i.message!==void 0)return{...i,path:s,message:i.message};let o="";const l=r.filter(c=>!!c).slice().reverse();for(const c of l)o=c(a,{data:e,defaultError:o}).message;return{...i,path:s,message:o}},UZ=[];function Ae(n,e){const t=g0(),r=y0({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,t,t===hd?void 0:hd].filter(i=>!!i)});n.common.issues.push(r)}class ar{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const i of t){if(i.status==="aborted")return Xe;i.status==="dirty"&&e.dirty(),r.push(i.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const i of t){const s=await i.key,a=await i.value;r.push({key:s,value:a})}return ar.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const i of t){const{key:s,value:a}=i;if(s.status==="aborted"||a.status==="aborted")return Xe;s.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof a.value<"u"||i.alwaysSet)&&(r[s.value]=a.value)}return{status:e.value,value:r}}}const Xe=Object.freeze({status:"aborted"}),ku=n=>({status:"dirty",value:n}),_r=n=>({status:"valid",value:n}),qS=n=>n.status==="aborted",XS=n=>n.status==="dirty",cc=n=>n.status==="valid",Qf=n=>typeof Promise<"u"&&n instanceof Promise;function v0(n,e,t,r){if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(n)}function aF(n,e,t,r,i){if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(n,t),t}var Fe;(function(n){n.errToObj=e=>typeof e=="string"?{message:e}:e||{},n.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(Fe||(Fe={}));var zh,$h;class Is{constructor(e,t,r,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const VC=(n,e)=>{if(cc(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new ii(n.common.issues);return this._error=t,this._error}}};function et(n){if(!n)return{};const{errorMap:e,invalid_type_error:t,required_error:r,description:i}=n;if(e&&(t||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(a,o)=>{var l,c;const{message:u}=n;return a.code==="invalid_enum_value"?{message:u??o.defaultError}:typeof o.data>"u"?{message:(l=u??r)!==null&&l!==void 0?l:o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:(c=u??t)!==null&&c!==void 0?c:o.defaultError}},description:i}}class ut{get description(){return this._def.description}_getType(e){return ca(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:ca(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ar,ctx:{common:e.parent.common,data:e.data,parsedType:ca(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Qf(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;const i={common:{issues:[],async:(r=t==null?void 0:t.async)!==null&&r!==void 0?r:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ca(e)},s=this._parseSync({data:e,path:i.path,parent:i});return VC(i,s)}"~validate"(e){var t,r;const i={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ca(e)};if(!this["~standard"].async)try{const s=this._parseSync({data:e,path:[],parent:i});return cc(s)?{value:s.value}:{issues:i.common.issues}}catch(s){!((r=(t=s==null?void 0:s.message)===null||t===void 0?void 0:t.toLowerCase())===null||r===void 0)&&r.includes("encountered")&&(this["~standard"].async=!0),i.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:i}).then(s=>cc(s)?{value:s.value}:{issues:i.common.issues})}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ca(e)},i=this._parse({data:e,path:r.path,parent:r}),s=await(Qf(i)?i:Promise.resolve(i));return VC(r,s)}refine(e,t){const r=i=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(i):t;return this._refinement((i,s)=>{const a=e(i),o=()=>s.addIssue({code:ve.custom,...r(i)});return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(e,t){return this._refinement((r,i)=>e(r)?!0:(i.addIssue(typeof t=="function"?t(r,i):t),!1))}_refinement(e){return new is({schema:this,typeName:we.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return es.create(this,this._def)}nullable(){return Wo.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Qi.create(this)}promise(){return pd.create(this,this._def)}or(e){return rp.create([this,e],this._def)}and(e){return ip.create(this,e,this._def)}transform(e){return new is({...et(this._def),schema:this,typeName:we.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new cp({...et(this._def),innerType:this,defaultValue:t,typeName:we.ZodDefault})}brand(){return new RT({typeName:we.ZodBranded,type:this,...et(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new up({...et(this._def),innerType:this,catchValue:t,typeName:we.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Xp.create(this,e)}readonly(){return dp.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const BZ=/^c[^\s-]{8,}$/i,zZ=/^[0-9a-z]+$/,$Z=/^[0-9A-HJKMNP-TV-Z]{26}$/i,VZ=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,HZ=/^[a-z0-9_-]{21}$/i,WZ=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,GZ=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,qZ=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,XZ="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Q_;const YZ=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,KZ=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ZZ=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,JZ=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,QZ=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,eJ=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,oF="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",tJ=new RegExp(`^${oF}$`);function lF(n){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return n.precision?e=`${e}\\.\\d{${n.precision}}`:n.precision==null&&(e=`${e}(\\.\\d+)?`),e}function nJ(n){return new RegExp(`^${lF(n)}$`)}function cF(n){let e=`${oF}T${lF(n)}`;const t=[];return t.push(n.local?"Z?":"Z"),n.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function rJ(n,e){return!!((e==="v4"||!e)&&YZ.test(n)||(e==="v6"||!e)&&ZZ.test(n))}function iJ(n,e){if(!WZ.test(n))return!1;try{const[t]=n.split("."),r=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),i=JSON.parse(atob(r));return!(typeof i!="object"||i===null||!i.typ||!i.alg||e&&i.alg!==e)}catch{return!1}}function sJ(n,e){return!!((e==="v4"||!e)&&KZ.test(n)||(e==="v6"||!e)&&JZ.test(n))}class qi extends ut{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Oe.string){const s=this._getOrReturnCtx(e);return Ae(s,{code:ve.invalid_type,expected:Oe.string,received:s.parsedType}),Xe}const r=new ar;let i;for(const s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(i=this._getOrReturnCtx(e,i),Ae(i,{code:ve.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="max")e.data.length>s.value&&(i=this._getOrReturnCtx(e,i),Ae(i,{code:ve.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="length"){const a=e.data.length>s.value,o=e.data.length<s.value;(a||o)&&(i=this._getOrReturnCtx(e,i),a?Ae(i,{code:ve.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):o&&Ae(i,{code:ve.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),r.dirty())}else if(s.kind==="email")qZ.test(e.data)||(i=this._getOrReturnCtx(e,i),Ae(i,{validation:"email",code:ve.invalid_string,message:s.message}),r.dirty());else if(s.kind==="emoji")Q_||(Q_=new RegExp(XZ,"u")),Q_.test(e.data)||(i=this._getOrReturnCtx(e,i),Ae(i,{validation:"emoji",code:ve.invalid_string,message:s.message}),r.dirty());else if(s.kind==="uuid")VZ.test(e.data)||(i=this._getOrReturnCtx(e,i),Ae(i,{validation:"uuid",code:ve.invalid_string,message:s.message}),r.dirty());else if(s.kind==="nanoid")HZ.test(e.data)||(i=this._getOrReturnCtx(e,i),Ae(i,{validation:"nanoid",code:ve.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid")BZ.test(e.data)||(i=this._getOrReturnCtx(e,i),Ae(i,{validation:"cuid",code:ve.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid2")zZ.test(e.data)||(i=this._getOrReturnCtx(e,i),Ae(i,{validation:"cuid2",code:ve.invalid_string,message:s.message}),r.dirty());else if(s.kind==="ulid")$Z.test(e.data)||(i=this._getOrReturnCtx(e,i),Ae(i,{validation:"ulid",code:ve.invalid_string,message:s.message}),r.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),Ae(i,{validation:"url",code:ve.invalid_string,message:s.message}),r.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),Ae(i,{validation:"regex",code:ve.invalid_string,message:s.message}),r.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(i=this._getOrReturnCtx(e,i),Ae(i,{code:ve.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),r.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(i=this._getOrReturnCtx(e,i),Ae(i,{code:ve.invalid_string,validation:{startsWith:s.value},message:s.message}),r.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(i=this._getOrReturnCtx(e,i),Ae(i,{code:ve.invalid_string,validation:{endsWith:s.value},message:s.message}),r.dirty()):s.kind==="datetime"?cF(s).test(e.data)||(i=this._getOrReturnCtx(e,i),Ae(i,{code:ve.invalid_string,validation:"datetime",message:s.message}),r.dirty()):s.kind==="date"?tJ.test(e.data)||(i=this._getOrReturnCtx(e,i),Ae(i,{code:ve.invalid_string,validation:"date",message:s.message}),r.dirty()):s.kind==="time"?nJ(s).test(e.data)||(i=this._getOrReturnCtx(e,i),Ae(i,{code:ve.invalid_string,validation:"time",message:s.message}),r.dirty()):s.kind==="duration"?GZ.test(e.data)||(i=this._getOrReturnCtx(e,i),Ae(i,{validation:"duration",code:ve.invalid_string,message:s.message}),r.dirty()):s.kind==="ip"?rJ(e.data,s.version)||(i=this._getOrReturnCtx(e,i),Ae(i,{validation:"ip",code:ve.invalid_string,message:s.message}),r.dirty()):s.kind==="jwt"?iJ(e.data,s.alg)||(i=this._getOrReturnCtx(e,i),Ae(i,{validation:"jwt",code:ve.invalid_string,message:s.message}),r.dirty()):s.kind==="cidr"?sJ(e.data,s.version)||(i=this._getOrReturnCtx(e,i),Ae(i,{validation:"cidr",code:ve.invalid_string,message:s.message}),r.dirty()):s.kind==="base64"?QZ.test(e.data)||(i=this._getOrReturnCtx(e,i),Ae(i,{validation:"base64",code:ve.invalid_string,message:s.message}),r.dirty()):s.kind==="base64url"?eJ.test(e.data)||(i=this._getOrReturnCtx(e,i),Ae(i,{validation:"base64url",code:ve.invalid_string,message:s.message}),r.dirty()):Tt.assertNever(s);return{status:r.value,value:e.data}}_regex(e,t,r){return this.refinement(i=>e.test(i),{validation:t,code:ve.invalid_string,...Fe.errToObj(r)})}_addCheck(e){return new qi({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Fe.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Fe.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Fe.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Fe.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Fe.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Fe.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Fe.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Fe.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Fe.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...Fe.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...Fe.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Fe.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...Fe.errToObj(e)})}datetime(e){var t,r;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(t=e==null?void 0:e.offset)!==null&&t!==void 0?t:!1,local:(r=e==null?void 0:e.local)!==null&&r!==void 0?r:!1,...Fe.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...Fe.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...Fe.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...Fe.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...Fe.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...Fe.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...Fe.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...Fe.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...Fe.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...Fe.errToObj(t)})}nonempty(e){return this.min(1,Fe.errToObj(e))}trim(){return new qi({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new qi({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new qi({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}qi.create=n=>{var e;return new qi({checks:[],typeName:we.ZodString,coerce:(e=n==null?void 0:n.coerce)!==null&&e!==void 0?e:!1,...et(n)})};function aJ(n,e){const t=(n.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,i=t>r?t:r,s=parseInt(n.toFixed(i).replace(".","")),a=parseInt(e.toFixed(i).replace(".",""));return s%a/Math.pow(10,i)}class $o extends ut{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Oe.number){const s=this._getOrReturnCtx(e);return Ae(s,{code:ve.invalid_type,expected:Oe.number,received:s.parsedType}),Xe}let r;const i=new ar;for(const s of this._def.checks)s.kind==="int"?Tt.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),Ae(r,{code:ve.invalid_type,expected:"integer",received:"float",message:s.message}),i.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),Ae(r,{code:ve.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),Ae(r,{code:ve.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="multipleOf"?aJ(e.data,s.value)!==0&&(r=this._getOrReturnCtx(e,r),Ae(r,{code:ve.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),Ae(r,{code:ve.not_finite,message:s.message}),i.dirty()):Tt.assertNever(s);return{status:i.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Fe.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Fe.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Fe.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Fe.toString(t))}setLimit(e,t,r,i){return new $o({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:Fe.toString(i)}]})}_addCheck(e){return new $o({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Fe.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Fe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Fe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Fe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Fe.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Fe.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:Fe.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Fe.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Fe.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Tt.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(t===null||r.value>t)&&(t=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}$o.create=n=>new $o({checks:[],typeName:we.ZodNumber,coerce:(n==null?void 0:n.coerce)||!1,...et(n)});class Vo extends ut{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==Oe.bigint)return this._getInvalidInput(e);let r;const i=new ar;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),Ae(r,{code:ve.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),Ae(r,{code:ve.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),Ae(r,{code:ve.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):Tt.assertNever(s);return{status:i.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return Ae(t,{code:ve.invalid_type,expected:Oe.bigint,received:t.parsedType}),Xe}gte(e,t){return this.setLimit("min",e,!0,Fe.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Fe.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Fe.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Fe.toString(t))}setLimit(e,t,r,i){return new Vo({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:Fe.toString(i)}]})}_addCheck(e){return new Vo({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Fe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Fe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Fe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Fe.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Fe.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Vo.create=n=>{var e;return new Vo({checks:[],typeName:we.ZodBigInt,coerce:(e=n==null?void 0:n.coerce)!==null&&e!==void 0?e:!1,...et(n)})};class ep extends ut{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Oe.boolean){const r=this._getOrReturnCtx(e);return Ae(r,{code:ve.invalid_type,expected:Oe.boolean,received:r.parsedType}),Xe}return _r(e.data)}}ep.create=n=>new ep({typeName:we.ZodBoolean,coerce:(n==null?void 0:n.coerce)||!1,...et(n)});class uc extends ut{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Oe.date){const s=this._getOrReturnCtx(e);return Ae(s,{code:ve.invalid_type,expected:Oe.date,received:s.parsedType}),Xe}if(isNaN(e.data.getTime())){const s=this._getOrReturnCtx(e);return Ae(s,{code:ve.invalid_date}),Xe}const r=new ar;let i;for(const s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(i=this._getOrReturnCtx(e,i),Ae(i,{code:ve.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),r.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(i=this._getOrReturnCtx(e,i),Ae(i,{code:ve.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),r.dirty()):Tt.assertNever(s);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new uc({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:Fe.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:Fe.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}uc.create=n=>new uc({checks:[],coerce:(n==null?void 0:n.coerce)||!1,typeName:we.ZodDate,...et(n)});class x0 extends ut{_parse(e){if(this._getType(e)!==Oe.symbol){const r=this._getOrReturnCtx(e);return Ae(r,{code:ve.invalid_type,expected:Oe.symbol,received:r.parsedType}),Xe}return _r(e.data)}}x0.create=n=>new x0({typeName:we.ZodSymbol,...et(n)});class tp extends ut{_parse(e){if(this._getType(e)!==Oe.undefined){const r=this._getOrReturnCtx(e);return Ae(r,{code:ve.invalid_type,expected:Oe.undefined,received:r.parsedType}),Xe}return _r(e.data)}}tp.create=n=>new tp({typeName:we.ZodUndefined,...et(n)});class np extends ut{_parse(e){if(this._getType(e)!==Oe.null){const r=this._getOrReturnCtx(e);return Ae(r,{code:ve.invalid_type,expected:Oe.null,received:r.parsedType}),Xe}return _r(e.data)}}np.create=n=>new np({typeName:we.ZodNull,...et(n)});class fd extends ut{constructor(){super(...arguments),this._any=!0}_parse(e){return _r(e.data)}}fd.create=n=>new fd({typeName:we.ZodAny,...et(n)});class Zl extends ut{constructor(){super(...arguments),this._unknown=!0}_parse(e){return _r(e.data)}}Zl.create=n=>new Zl({typeName:we.ZodUnknown,...et(n)});class La extends ut{_parse(e){const t=this._getOrReturnCtx(e);return Ae(t,{code:ve.invalid_type,expected:Oe.never,received:t.parsedType}),Xe}}La.create=n=>new La({typeName:we.ZodNever,...et(n)});class _0 extends ut{_parse(e){if(this._getType(e)!==Oe.undefined){const r=this._getOrReturnCtx(e);return Ae(r,{code:ve.invalid_type,expected:Oe.void,received:r.parsedType}),Xe}return _r(e.data)}}_0.create=n=>new _0({typeName:we.ZodVoid,...et(n)});class Qi extends ut{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),i=this._def;if(t.parsedType!==Oe.array)return Ae(t,{code:ve.invalid_type,expected:Oe.array,received:t.parsedType}),Xe;if(i.exactLength!==null){const a=t.data.length>i.exactLength.value,o=t.data.length<i.exactLength.value;(a||o)&&(Ae(t,{code:a?ve.too_big:ve.too_small,minimum:o?i.exactLength.value:void 0,maximum:a?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(i.minLength!==null&&t.data.length<i.minLength.value&&(Ae(t,{code:ve.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),i.maxLength!==null&&t.data.length>i.maxLength.value&&(Ae(t,{code:ve.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((a,o)=>i.type._parseAsync(new Is(t,a,t.path,o)))).then(a=>ar.mergeArray(r,a));const s=[...t.data].map((a,o)=>i.type._parseSync(new Is(t,a,t.path,o)));return ar.mergeArray(r,s)}get element(){return this._def.type}min(e,t){return new Qi({...this._def,minLength:{value:e,message:Fe.toString(t)}})}max(e,t){return new Qi({...this._def,maxLength:{value:e,message:Fe.toString(t)}})}length(e,t){return new Qi({...this._def,exactLength:{value:e,message:Fe.toString(t)}})}nonempty(e){return this.min(1,e)}}Qi.create=(n,e)=>new Qi({type:n,minLength:null,maxLength:null,exactLength:null,typeName:we.ZodArray,...et(e)});function ou(n){if(n instanceof Qt){const e={};for(const t in n.shape){const r=n.shape[t];e[t]=es.create(ou(r))}return new Qt({...n._def,shape:()=>e})}else return n instanceof Qi?new Qi({...n._def,type:ou(n.element)}):n instanceof es?es.create(ou(n.unwrap())):n instanceof Wo?Wo.create(ou(n.unwrap())):n instanceof js?js.create(n.items.map(e=>ou(e))):n}class Qt extends ut{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=Tt.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==Oe.object){const c=this._getOrReturnCtx(e);return Ae(c,{code:ve.invalid_type,expected:Oe.object,received:c.parsedType}),Xe}const{status:r,ctx:i}=this._processInputParams(e),{shape:s,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof La&&this._def.unknownKeys==="strip"))for(const c in i.data)a.includes(c)||o.push(c);const l=[];for(const c of a){const u=s[c],d=i.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Is(i,d,i.path,c)),alwaysSet:c in i.data})}if(this._def.catchall instanceof La){const c=this._def.unknownKeys;if(c==="passthrough")for(const u of o)l.push({key:{status:"valid",value:u},value:{status:"valid",value:i.data[u]}});else if(c==="strict")o.length>0&&(Ae(i,{code:ve.unrecognized_keys,keys:o}),r.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const u of o){const d=i.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Is(i,d,i.path,u)),alwaysSet:u in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const c=[];for(const u of l){const d=await u.key,h=await u.value;c.push({key:d,value:h,alwaysSet:u.alwaysSet})}return c}).then(c=>ar.mergeObjectSync(r,c)):ar.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(e){return Fe.errToObj,new Qt({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,r)=>{var i,s,a,o;const l=(a=(s=(i=this._def).errorMap)===null||s===void 0?void 0:s.call(i,t,r).message)!==null&&a!==void 0?a:r.defaultError;return t.code==="unrecognized_keys"?{message:(o=Fe.errToObj(e).message)!==null&&o!==void 0?o:l}:{message:l}}}:{}})}strip(){return new Qt({...this._def,unknownKeys:"strip"})}passthrough(){return new Qt({...this._def,unknownKeys:"passthrough"})}extend(e){return new Qt({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Qt({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:we.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new Qt({...this._def,catchall:e})}pick(e){const t={};return Tt.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(t[r]=this.shape[r])}),new Qt({...this._def,shape:()=>t})}omit(e){const t={};return Tt.objectKeys(this.shape).forEach(r=>{e[r]||(t[r]=this.shape[r])}),new Qt({...this._def,shape:()=>t})}deepPartial(){return ou(this)}partial(e){const t={};return Tt.objectKeys(this.shape).forEach(r=>{const i=this.shape[r];e&&!e[r]?t[r]=i:t[r]=i.optional()}),new Qt({...this._def,shape:()=>t})}required(e){const t={};return Tt.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])t[r]=this.shape[r];else{let s=this.shape[r];for(;s instanceof es;)s=s._def.innerType;t[r]=s}}),new Qt({...this._def,shape:()=>t})}keyof(){return uF(Tt.objectKeys(this.shape))}}Qt.create=(n,e)=>new Qt({shape:()=>n,unknownKeys:"strip",catchall:La.create(),typeName:we.ZodObject,...et(e)});Qt.strictCreate=(n,e)=>new Qt({shape:()=>n,unknownKeys:"strict",catchall:La.create(),typeName:we.ZodObject,...et(e)});Qt.lazycreate=(n,e)=>new Qt({shape:n,unknownKeys:"strip",catchall:La.create(),typeName:we.ZodObject,...et(e)});class rp extends ut{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;function i(s){for(const o of s)if(o.result.status==="valid")return o.result;for(const o of s)if(o.result.status==="dirty")return t.common.issues.push(...o.ctx.common.issues),o.result;const a=s.map(o=>new ii(o.ctx.common.issues));return Ae(t,{code:ve.invalid_union,unionErrors:a}),Xe}if(t.common.async)return Promise.all(r.map(async s=>{const a={...t,common:{...t.common,issues:[]},parent:null};return{result:await s._parseAsync({data:t.data,path:t.path,parent:a}),ctx:a}})).then(i);{let s;const a=[];for(const l of r){const c={...t,common:{...t.common,issues:[]},parent:null},u=l._parseSync({data:t.data,path:t.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!s&&(s={result:u,ctx:c}),c.common.issues.length&&a.push(c.common.issues)}if(s)return t.common.issues.push(...s.ctx.common.issues),s.result;const o=a.map(l=>new ii(l));return Ae(t,{code:ve.invalid_union,unionErrors:o}),Xe}}get options(){return this._def.options}}rp.create=(n,e)=>new rp({options:n,typeName:we.ZodUnion,...et(e)});const na=n=>n instanceof ap?na(n.schema):n instanceof is?na(n.innerType()):n instanceof op?[n.value]:n instanceof Ho?n.options:n instanceof lp?Tt.objectValues(n.enum):n instanceof cp?na(n._def.innerType):n instanceof tp?[void 0]:n instanceof np?[null]:n instanceof es?[void 0,...na(n.unwrap())]:n instanceof Wo?[null,...na(n.unwrap())]:n instanceof RT||n instanceof dp?na(n.unwrap()):n instanceof up?na(n._def.innerType):[];class Gv extends ut{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Oe.object)return Ae(t,{code:ve.invalid_type,expected:Oe.object,received:t.parsedType}),Xe;const r=this.discriminator,i=t.data[r],s=this.optionsMap.get(i);return s?t.common.async?s._parseAsync({data:t.data,path:t.path,parent:t}):s._parseSync({data:t.data,path:t.path,parent:t}):(Ae(t,{code:ve.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),Xe)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){const i=new Map;for(const s of t){const a=na(s.shape[e]);if(!a.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of a){if(i.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);i.set(o,s)}}return new Gv({typeName:we.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:i,...et(r)})}}function YS(n,e){const t=ca(n),r=ca(e);if(n===e)return{valid:!0,data:n};if(t===Oe.object&&r===Oe.object){const i=Tt.objectKeys(e),s=Tt.objectKeys(n).filter(o=>i.indexOf(o)!==-1),a={...n,...e};for(const o of s){const l=YS(n[o],e[o]);if(!l.valid)return{valid:!1};a[o]=l.data}return{valid:!0,data:a}}else if(t===Oe.array&&r===Oe.array){if(n.length!==e.length)return{valid:!1};const i=[];for(let s=0;s<n.length;s++){const a=n[s],o=e[s],l=YS(a,o);if(!l.valid)return{valid:!1};i.push(l.data)}return{valid:!0,data:i}}else return t===Oe.date&&r===Oe.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}class ip extends ut{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),i=(s,a)=>{if(qS(s)||qS(a))return Xe;const o=YS(s.value,a.value);return o.valid?((XS(s)||XS(a))&&t.dirty(),{status:t.value,value:o.data}):(Ae(r,{code:ve.invalid_intersection_types}),Xe)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([s,a])=>i(s,a)):i(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}ip.create=(n,e,t)=>new ip({left:n,right:e,typeName:we.ZodIntersection,...et(t)});class js extends ut{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Oe.array)return Ae(r,{code:ve.invalid_type,expected:Oe.array,received:r.parsedType}),Xe;if(r.data.length<this._def.items.length)return Ae(r,{code:ve.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Xe;!this._def.rest&&r.data.length>this._def.items.length&&(Ae(r,{code:ve.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const s=[...r.data].map((a,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new Is(r,a,r.path,o)):null}).filter(a=>!!a);return r.common.async?Promise.all(s).then(a=>ar.mergeArray(t,a)):ar.mergeArray(t,s)}get items(){return this._def.items}rest(e){return new js({...this._def,rest:e})}}js.create=(n,e)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new js({items:n,typeName:we.ZodTuple,rest:null,...et(e)})};class sp extends ut{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Oe.object)return Ae(r,{code:ve.invalid_type,expected:Oe.object,received:r.parsedType}),Xe;const i=[],s=this._def.keyType,a=this._def.valueType;for(const o in r.data)i.push({key:s._parse(new Is(r,o,r.path,o)),value:a._parse(new Is(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?ar.mergeObjectAsync(t,i):ar.mergeObjectSync(t,i)}get element(){return this._def.valueType}static create(e,t,r){return t instanceof ut?new sp({keyType:e,valueType:t,typeName:we.ZodRecord,...et(r)}):new sp({keyType:qi.create(),valueType:e,typeName:we.ZodRecord,...et(t)})}}class b0 extends ut{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Oe.map)return Ae(r,{code:ve.invalid_type,expected:Oe.map,received:r.parsedType}),Xe;const i=this._def.keyType,s=this._def.valueType,a=[...r.data.entries()].map(([o,l],c)=>({key:i._parse(new Is(r,o,r.path,[c,"key"])),value:s._parse(new Is(r,l,r.path,[c,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of a){const c=await l.key,u=await l.value;if(c.status==="aborted"||u.status==="aborted")return Xe;(c.status==="dirty"||u.status==="dirty")&&t.dirty(),o.set(c.value,u.value)}return{status:t.value,value:o}})}else{const o=new Map;for(const l of a){const c=l.key,u=l.value;if(c.status==="aborted"||u.status==="aborted")return Xe;(c.status==="dirty"||u.status==="dirty")&&t.dirty(),o.set(c.value,u.value)}return{status:t.value,value:o}}}}b0.create=(n,e,t)=>new b0({valueType:e,keyType:n,typeName:we.ZodMap,...et(t)});class dc extends ut{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Oe.set)return Ae(r,{code:ve.invalid_type,expected:Oe.set,received:r.parsedType}),Xe;const i=this._def;i.minSize!==null&&r.data.size<i.minSize.value&&(Ae(r,{code:ve.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),t.dirty()),i.maxSize!==null&&r.data.size>i.maxSize.value&&(Ae(r,{code:ve.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),t.dirty());const s=this._def.valueType;function a(l){const c=new Set;for(const u of l){if(u.status==="aborted")return Xe;u.status==="dirty"&&t.dirty(),c.add(u.value)}return{status:t.value,value:c}}const o=[...r.data.values()].map((l,c)=>s._parse(new Is(r,l,r.path,c)));return r.common.async?Promise.all(o).then(l=>a(l)):a(o)}min(e,t){return new dc({...this._def,minSize:{value:e,message:Fe.toString(t)}})}max(e,t){return new dc({...this._def,maxSize:{value:e,message:Fe.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}dc.create=(n,e)=>new dc({valueType:n,minSize:null,maxSize:null,typeName:we.ZodSet,...et(e)});class Wu extends ut{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Oe.function)return Ae(t,{code:ve.invalid_type,expected:Oe.function,received:t.parsedType}),Xe;function r(o,l){return y0({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,g0(),hd].filter(c=>!!c),issueData:{code:ve.invalid_arguments,argumentsError:l}})}function i(o,l){return y0({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,g0(),hd].filter(c=>!!c),issueData:{code:ve.invalid_return_type,returnTypeError:l}})}const s={errorMap:t.common.contextualErrorMap},a=t.data;if(this._def.returns instanceof pd){const o=this;return _r(async function(...l){const c=new ii([]),u=await o._def.args.parseAsync(l,s).catch(p=>{throw c.addIssue(r(l,p)),c}),d=await Reflect.apply(a,this,u);return await o._def.returns._def.type.parseAsync(d,s).catch(p=>{throw c.addIssue(i(d,p)),c})})}else{const o=this;return _r(function(...l){const c=o._def.args.safeParse(l,s);if(!c.success)throw new ii([r(l,c.error)]);const u=Reflect.apply(a,this,c.data),d=o._def.returns.safeParse(u,s);if(!d.success)throw new ii([i(u,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Wu({...this._def,args:js.create(e).rest(Zl.create())})}returns(e){return new Wu({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new Wu({args:e||js.create([]).rest(Zl.create()),returns:t||Zl.create(),typeName:we.ZodFunction,...et(r)})}}class ap extends ut{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}ap.create=(n,e)=>new ap({getter:n,typeName:we.ZodLazy,...et(e)});class op extends ut{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return Ae(t,{received:t.data,code:ve.invalid_literal,expected:this._def.value}),Xe}return{status:"valid",value:e.data}}get value(){return this._def.value}}op.create=(n,e)=>new op({value:n,typeName:we.ZodLiteral,...et(e)});function uF(n,e){return new Ho({values:n,typeName:we.ZodEnum,...et(e)})}class Ho extends ut{constructor(){super(...arguments),zh.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),r=this._def.values;return Ae(t,{expected:Tt.joinValues(r),received:t.parsedType,code:ve.invalid_type}),Xe}if(v0(this,zh)||aF(this,zh,new Set(this._def.values)),!v0(this,zh).has(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return Ae(t,{received:t.data,code:ve.invalid_enum_value,options:r}),Xe}return _r(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Ho.create(e,{...this._def,...t})}exclude(e,t=this._def){return Ho.create(this.options.filter(r=>!e.includes(r)),{...this._def,...t})}}zh=new WeakMap;Ho.create=uF;class lp extends ut{constructor(){super(...arguments),$h.set(this,void 0)}_parse(e){const t=Tt.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==Oe.string&&r.parsedType!==Oe.number){const i=Tt.objectValues(t);return Ae(r,{expected:Tt.joinValues(i),received:r.parsedType,code:ve.invalid_type}),Xe}if(v0(this,$h)||aF(this,$h,new Set(Tt.getValidEnumValues(this._def.values))),!v0(this,$h).has(e.data)){const i=Tt.objectValues(t);return Ae(r,{received:r.data,code:ve.invalid_enum_value,options:i}),Xe}return _r(e.data)}get enum(){return this._def.values}}$h=new WeakMap;lp.create=(n,e)=>new lp({values:n,typeName:we.ZodNativeEnum,...et(e)});class pd extends ut{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Oe.promise&&t.common.async===!1)return Ae(t,{code:ve.invalid_type,expected:Oe.promise,received:t.parsedType}),Xe;const r=t.parsedType===Oe.promise?t.data:Promise.resolve(t.data);return _r(r.then(i=>this._def.type.parseAsync(i,{path:t.path,errorMap:t.common.contextualErrorMap})))}}pd.create=(n,e)=>new pd({type:n,typeName:we.ZodPromise,...et(e)});class is extends ut{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===we.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),i=this._def.effect||null,s={addIssue:a=>{Ae(r,a),a.fatal?t.abort():t.dirty()},get path(){return r.path}};if(s.addIssue=s.addIssue.bind(s),i.type==="preprocess"){const a=i.transform(r.data,s);if(r.common.async)return Promise.resolve(a).then(async o=>{if(t.value==="aborted")return Xe;const l=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return l.status==="aborted"?Xe:l.status==="dirty"||t.value==="dirty"?ku(l.value):l});{if(t.value==="aborted")return Xe;const o=this._def.schema._parseSync({data:a,path:r.path,parent:r});return o.status==="aborted"?Xe:o.status==="dirty"||t.value==="dirty"?ku(o.value):o}}if(i.type==="refinement"){const a=o=>{const l=i.refinement(o,s);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?Xe:(o.status==="dirty"&&t.dirty(),a(o.value),{status:t.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?Xe:(o.status==="dirty"&&t.dirty(),a(o.value).then(()=>({status:t.value,value:o.value}))))}if(i.type==="transform")if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!cc(a))return a;const o=i.transform(a.value,s);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>cc(a)?Promise.resolve(i.transform(a.value,s)).then(o=>({status:t.value,value:o})):a);Tt.assertNever(i)}}is.create=(n,e,t)=>new is({schema:n,typeName:we.ZodEffects,effect:e,...et(t)});is.createWithPreprocess=(n,e,t)=>new is({schema:e,effect:{type:"preprocess",transform:n},typeName:we.ZodEffects,...et(t)});class es extends ut{_parse(e){return this._getType(e)===Oe.undefined?_r(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}es.create=(n,e)=>new es({innerType:n,typeName:we.ZodOptional,...et(e)});class Wo extends ut{_parse(e){return this._getType(e)===Oe.null?_r(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Wo.create=(n,e)=>new Wo({innerType:n,typeName:we.ZodNullable,...et(e)});class cp extends ut{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===Oe.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}cp.create=(n,e)=>new cp({innerType:n,typeName:we.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...et(e)});class up extends ut{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Qf(i)?i.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new ii(r.common.issues)},input:r.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new ii(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}up.create=(n,e)=>new up({innerType:n,typeName:we.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...et(e)});class w0 extends ut{_parse(e){if(this._getType(e)!==Oe.nan){const r=this._getOrReturnCtx(e);return Ae(r,{code:ve.invalid_type,expected:Oe.nan,received:r.parsedType}),Xe}return{status:"valid",value:e.data}}}w0.create=n=>new w0({typeName:we.ZodNaN,...et(n)});const oJ=Symbol("zod_brand");class RT extends ut{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class Xp extends ut{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?Xe:s.status==="dirty"?(t.dirty(),ku(s.value)):this._def.out._parseAsync({data:s.value,path:r.path,parent:r})})();{const i=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?Xe:i.status==="dirty"?(t.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:r.path,parent:r})}}static create(e,t){return new Xp({in:e,out:t,typeName:we.ZodPipeline})}}class dp extends ut{_parse(e){const t=this._def.innerType._parse(e),r=i=>(cc(i)&&(i.value=Object.freeze(i.value)),i);return Qf(t)?t.then(i=>r(i)):r(t)}unwrap(){return this._def.innerType}}dp.create=(n,e)=>new dp({innerType:n,typeName:we.ZodReadonly,...et(e)});function HC(n,e){const t=typeof n=="function"?n(e):typeof n=="string"?{message:n}:n;return typeof t=="string"?{message:t}:t}function dF(n,e={},t){return n?fd.create().superRefine((r,i)=>{var s,a;const o=n(r);if(o instanceof Promise)return o.then(l=>{var c,u;if(!l){const d=HC(e,r),h=(u=(c=d.fatal)!==null&&c!==void 0?c:t)!==null&&u!==void 0?u:!0;i.addIssue({code:"custom",...d,fatal:h})}});if(!o){const l=HC(e,r),c=(a=(s=l.fatal)!==null&&s!==void 0?s:t)!==null&&a!==void 0?a:!0;i.addIssue({code:"custom",...l,fatal:c})}}):fd.create()}const lJ={object:Qt.lazycreate};var we;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(we||(we={}));const cJ=(n,e={message:`Input not instance of ${n.name}`})=>dF(t=>t instanceof n,e),hF=qi.create,fF=$o.create,uJ=w0.create,dJ=Vo.create,pF=ep.create,hJ=uc.create,fJ=x0.create,pJ=tp.create,mJ=np.create,gJ=fd.create,yJ=Zl.create,vJ=La.create,xJ=_0.create,_J=Qi.create,bJ=Qt.create,wJ=Qt.strictCreate,SJ=rp.create,EJ=Gv.create,TJ=ip.create,MJ=js.create,kJ=sp.create,AJ=b0.create,PJ=dc.create,CJ=Wu.create,RJ=ap.create,NJ=op.create,OJ=Ho.create,LJ=lp.create,DJ=pd.create,WC=is.create,IJ=es.create,jJ=Wo.create,FJ=is.createWithPreprocess,UJ=Xp.create,BJ=()=>hF().optional(),zJ=()=>fF().optional(),$J=()=>pF().optional(),VJ={string:n=>qi.create({...n,coerce:!0}),number:n=>$o.create({...n,coerce:!0}),boolean:n=>ep.create({...n,coerce:!0}),bigint:n=>Vo.create({...n,coerce:!0}),date:n=>uc.create({...n,coerce:!0})},HJ=Xe;var df=Object.freeze({__proto__:null,defaultErrorMap:hd,setErrorMap:FZ,getErrorMap:g0,makeIssue:y0,EMPTY_PATH:UZ,addIssueToContext:Ae,ParseStatus:ar,INVALID:Xe,DIRTY:ku,OK:_r,isAborted:qS,isDirty:XS,isValid:cc,isAsync:Qf,get util(){return Tt},get objectUtil(){return GS},ZodParsedType:Oe,getParsedType:ca,ZodType:ut,datetimeRegex:cF,ZodString:qi,ZodNumber:$o,ZodBigInt:Vo,ZodBoolean:ep,ZodDate:uc,ZodSymbol:x0,ZodUndefined:tp,ZodNull:np,ZodAny:fd,ZodUnknown:Zl,ZodNever:La,ZodVoid:_0,ZodArray:Qi,ZodObject:Qt,ZodUnion:rp,ZodDiscriminatedUnion:Gv,ZodIntersection:ip,ZodTuple:js,ZodRecord:sp,ZodMap:b0,ZodSet:dc,ZodFunction:Wu,ZodLazy:ap,ZodLiteral:op,ZodEnum:Ho,ZodNativeEnum:lp,ZodPromise:pd,ZodEffects:is,ZodTransformer:is,ZodOptional:es,ZodNullable:Wo,ZodDefault:cp,ZodCatch:up,ZodNaN:w0,BRAND:oJ,ZodBranded:RT,ZodPipeline:Xp,ZodReadonly:dp,custom:dF,Schema:ut,ZodSchema:ut,late:lJ,get ZodFirstPartyTypeKind(){return we},coerce:VJ,any:gJ,array:_J,bigint:dJ,boolean:pF,date:hJ,discriminatedUnion:EJ,effect:WC,enum:OJ,function:CJ,instanceof:cJ,intersection:TJ,lazy:RJ,literal:NJ,map:AJ,nan:uJ,nativeEnum:LJ,never:vJ,null:mJ,nullable:jJ,number:fF,object:bJ,oboolean:$J,onumber:zJ,optional:IJ,ostring:BJ,pipeline:UJ,preprocess:FJ,promise:DJ,record:kJ,set:PJ,strictObject:wJ,string:hF,symbol:fJ,transformer:WC,tuple:MJ,undefined:pJ,union:SJ,unknown:yJ,void:xJ,NEVER:HJ,ZodIssueCode:ve,quotelessJson:jZ,ZodError:ii}),qv={exports:{}},mF={};function Ci(n,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(n)),this._timeouts=n,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}var WJ=Ci;Ci.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};Ci.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};Ci.prototype.retry=function(n){if(this._timeout&&clearTimeout(this._timeout),!n)return!1;var e=new Date().getTime();if(n&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(n),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(n);var t=this._timeouts.shift();if(t===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),t=this._cachedTimeouts.slice(-1);else return!1;var r=this;return this._timer=setTimeout(function(){r._attempts++,r._operationTimeoutCb&&(r._timeout=setTimeout(function(){r._operationTimeoutCb(r._attempts)},r._operationTimeout),r._options.unref&&r._timeout.unref()),r._fn(r._attempts)},t),this._options.unref&&this._timer.unref(),!0};Ci.prototype.attempt=function(n,e){this._fn=n,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var t=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){t._operationTimeoutCb()},t._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};Ci.prototype.try=function(n){console.log("Using RetryOperation.try() is deprecated"),this.attempt(n)};Ci.prototype.start=function(n){console.log("Using RetryOperation.start() is deprecated"),this.attempt(n)};Ci.prototype.start=Ci.prototype.try;Ci.prototype.errors=function(){return this._errors};Ci.prototype.attempts=function(){return this._attempts};Ci.prototype.mainError=function(){if(this._errors.length===0)return null;for(var n={},e=null,t=0,r=0;r<this._errors.length;r++){var i=this._errors[r],s=i.message,a=(n[s]||0)+1;n[s]=a,a>=t&&(e=i,t=a)}return e};(function(n){var e=WJ;n.operation=function(t){var r=n.timeouts(t);return new e(r,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})},n.timeouts=function(t){if(t instanceof Array)return[].concat(t);var r={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var i in t)r[i]=t[i];if(r.minTimeout>r.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var s=[],a=0;a<r.retries;a++)s.push(this.createTimeout(a,r));return t&&t.forever&&!s.length&&s.push(this.createTimeout(a,r)),s.sort(function(o,l){return o-l}),s},n.createTimeout=function(t,r){var i=r.randomize?Math.random()+1:1,s=Math.round(i*Math.max(r.minTimeout,1)*Math.pow(r.factor,t));return s=Math.min(s,r.maxTimeout),s},n.wrap=function(t,r,i){if(r instanceof Array&&(i=r,r=null),!i){i=[];for(var s in t)typeof t[s]=="function"&&i.push(s)}for(var a=0;a<i.length;a++){var o=i[a],l=t[o];t[o]=(function(u){var d=n.operation(r),h=Array.prototype.slice.call(arguments,1),p=h.pop();h.push(function(y){d.retry(y)||(y&&(arguments[0]=d.mainError()),p.apply(this,arguments))}),d.attempt(function(){u.apply(t,h)})}).bind(t,l),t[o].options=r}}})(mF);var GJ=mF;const qJ=GJ,XJ=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class gF extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}const YJ=(n,e,t)=>{const r=t.retries-(e-1);return n.attemptNumber=e,n.retriesLeft=r,n},KJ=n=>XJ.includes(n),yF=(n,e)=>new Promise((t,r)=>{e={onFailedAttempt:()=>{},retries:10,...e};const i=qJ.operation(e);i.attempt(async s=>{try{t(await n(s))}catch(a){if(!(a instanceof Error)){r(new TypeError(`Non-error was thrown: "${a}". You should only throw errors.`));return}if(a instanceof gF)i.stop(),r(a.originalError);else if(a instanceof TypeError&&!KJ(a.message))i.stop(),r(a);else{YJ(a,s,e);try{await e.onFailedAttempt(a)}catch(o){r(o);return}i.retry(a)||r(i.mainError())}}})});qv.exports=yF;qv.exports.default=yF;qv.exports.AbortError=gF;var ZJ=qv.exports;const S0=Cp(ZJ),JJ=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function E0(n){return typeof n=="string"&&JJ.test(n)}var jn=[];for(var eb=0;eb<256;++eb)jn.push((eb+256).toString(16).slice(1));function QJ(n,e=0){return(jn[n[e+0]]+jn[n[e+1]]+jn[n[e+2]]+jn[n[e+3]]+"-"+jn[n[e+4]]+jn[n[e+5]]+"-"+jn[n[e+6]]+jn[n[e+7]]+"-"+jn[n[e+8]]+jn[n[e+9]]+"-"+jn[n[e+10]]+jn[n[e+11]]+jn[n[e+12]]+jn[n[e+13]]+jn[n[e+14]]+jn[n[e+15]]).toLowerCase()}var ig,eQ=new Uint8Array(16);function tQ(){if(!ig&&(ig=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ig))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ig(eQ)}var nQ=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const GC={randomUUID:nQ};function Qr(n,e,t){if(GC.randomUUID&&!e&&!n)return GC.randomUUID();n=n||{};var r=n.random||(n.rng||tQ)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,QJ(r)}var vF={},xF={exports:{}};(function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function i(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function s(l,c,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var p=new i(u,d||l,h),y=t?t+c:c;return l._events[y]?l._events[y].fn?l._events[y]=[l._events[y],p]:l._events[y].push(p):(l._events[y]=p,l._eventsCount++),l}function a(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)e.call(u,d)&&c.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},o.prototype.listeners=function(c){var u=t?t+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,p=d.length,y=new Array(p);h<p;h++)y[h]=d[h].fn;return y},o.prototype.listenerCount=function(c){var u=t?t+c:c,d=this._events[u];return d?d.fn?1:d.length:0},o.prototype.emit=function(c,u,d,h,p,y){var v=t?t+c:c;if(!this._events[v])return!1;var g=this._events[v],m=arguments.length,x,_;if(g.fn){switch(g.once&&this.removeListener(c,g.fn,void 0,!0),m){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,d),!0;case 4:return g.fn.call(g.context,u,d,h),!0;case 5:return g.fn.call(g.context,u,d,h,p),!0;case 6:return g.fn.call(g.context,u,d,h,p,y),!0}for(_=1,x=new Array(m-1);_<m;_++)x[_-1]=arguments[_];g.fn.apply(g.context,x)}else{var b=g.length,w;for(_=0;_<b;_++)switch(g[_].once&&this.removeListener(c,g[_].fn,void 0,!0),m){case 1:g[_].fn.call(g[_].context);break;case 2:g[_].fn.call(g[_].context,u);break;case 3:g[_].fn.call(g[_].context,u,d);break;case 4:g[_].fn.call(g[_].context,u,d,h);break;default:if(!x)for(w=1,x=new Array(m-1);w<m;w++)x[w-1]=arguments[w];g[_].fn.apply(g[_].context,x)}}return!0},o.prototype.on=function(c,u,d){return s(this,c,u,d,!1)},o.prototype.once=function(c,u,d){return s(this,c,u,d,!0)},o.prototype.removeListener=function(c,u,d,h){var p=t?t+c:c;if(!this._events[p])return this;if(!u)return a(this,p),this;var y=this._events[p];if(y.fn)y.fn===u&&(!h||y.once)&&(!d||y.context===d)&&a(this,p);else{for(var v=0,g=[],m=y.length;v<m;v++)(y[v].fn!==u||h&&!y[v].once||d&&y[v].context!==d)&&g.push(y[v]);g.length?this._events[p]=g.length===1?g[0]:g:a(this,p)}return this},o.prototype.removeAllListeners=function(c){var u;return c?(u=t?t+c:c,this._events[u]&&a(this,u)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=t,o.EventEmitter=o,n.exports=o})(xF);var rQ=xF.exports,Xv={exports:{}},iQ=(n,e)=>(e=e||(()=>{}),n.then(t=>new Promise(r=>{r(e())}).then(()=>t),t=>new Promise(r=>{r(e())}).then(()=>{throw t})));const sQ=iQ;class _F extends Error{constructor(e){super(e),this.name="TimeoutError"}}const bF=(n,e,t)=>new Promise((r,i)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){r(n);return}const s=setTimeout(()=>{if(typeof t=="function"){try{r(t())}catch(l){i(l)}return}const a=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,o=t instanceof Error?t:new _F(a);typeof n.cancel=="function"&&n.cancel(),i(o)},e);sQ(n.then(r,i),()=>{clearTimeout(s)})});Xv.exports=bF;Xv.exports.default=bF;Xv.exports.TimeoutError=_F;var aQ=Xv.exports,NT={},OT={};Object.defineProperty(OT,"__esModule",{value:!0});function oQ(n,e,t){let r=0,i=n.length;for(;i>0;){const s=i/2|0;let a=r+s;t(n[a],e)<=0?(r=++a,i-=s+1):i=s}return r}OT.default=oQ;Object.defineProperty(NT,"__esModule",{value:!0});const lQ=OT;class cQ{constructor(){this._queue=[]}enqueue(e,t){t=Object.assign({priority:0},t);const r={priority:t.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority){this._queue.push(r);return}const i=lQ.default(this._queue,r,(s,a)=>a.priority-s.priority);this._queue.splice(i,0,r)}dequeue(){const e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return this._queue.length}}NT.default=cQ;Object.defineProperty(vF,"__esModule",{value:!0});const uQ=rQ,wF=aQ,dQ=NT,sg=()=>{},hQ=new wF.TimeoutError;class fQ extends uQ{constructor(e){var t,r,i,s;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=sg,this._resolveIdle=sg,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:dQ.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(r=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(i=e.interval)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=sg,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=sg,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(this._intervalId===void 0){const t=this._intervalEnd-e;if(t<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const t=this._queue.dequeue();return t?(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((r,i)=>{const s=async()=>{this._pendingCount++,this._intervalCount++;try{const a=this._timeout===void 0&&t.timeout===void 0?e():wF.default(Promise.resolve(e()),t.timeout===void 0?this._timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?this._throwOnTimeout:t.throwOnTimeout)&&i(hQ)});r(await a)}catch(a){i(a)}this._next()};this._queue.enqueue(s,t),this._tryToStartAnother(),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async r=>this.add(r,t)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{const t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{const t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}var Ea=vF.default=fQ;const pQ=(...n)=>fetch(...n),mQ=Symbol.for("ls:fetch_implementation"),Ve=()=>globalThis[mQ]??pQ,gQ=[400,401,403,404,405,406,407,408],yQ=[409];let qC=class{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedResponseHook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,"default"in Ea?this.queue=new Ea.default({concurrency:this.maxConcurrency}):this.queue=new Ea({concurrency:this.maxConcurrency}),this.onFailedResponseHook=e==null?void 0:e.onFailedResponseHook}call(e,...t){const r=this.onFailedResponseHook;return this.queue.add(()=>S0(()=>e(...t).catch(i=>{throw i instanceof Error?i:new Error(i)}),{async onFailedAttempt(i){if(i.message.startsWith("Cancel")||i.message.startsWith("TimeoutError")||i.message.startsWith("AbortError")||(i==null?void 0:i.code)==="ECONNABORTED")throw i;const s=i==null?void 0:i.response,a=s==null?void 0:s.status;if(a){if(gQ.includes(+a))throw i;if(yQ.includes(+a))return;r&&await r(s)}},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...r){return e.signal?Promise.race([this.call(t,...r),new Promise((i,s)=>{var a;(a=e.signal)==null||a.addEventListener("abort",()=>{s(new Error("AbortError"))})})]):this.call(t,...r)}fetch(...e){return this.call(()=>Ve()(...e).then(t=>t.ok?t:Promise.reject(t)))}};function XC(n){return typeof(n==null?void 0:n._getType)=="function"}function YC(n){const e={type:n._getType(),data:{content:n.content}};return n!=null&&n.additional_kwargs&&Object.keys(n.additional_kwargs).length>0&&(e.data.additional_kwargs={...n.additional_kwargs}),e}function xt(n,e){if(!E0(n)){const t=e!==void 0?`Invalid UUID for ${e}: ${n}`:`Invalid UUID: ${n}`;throw new Error(t)}return n}const KC={};function SF(n){KC[n]||(console.warn(n),KC[n]=!0)}var KS={exports:{}};const vQ="2.0.0",EF=256,xQ=Number.MAX_SAFE_INTEGER||9007199254740991,_Q=16,bQ=EF-6,wQ=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var Yv={MAX_LENGTH:EF,MAX_SAFE_COMPONENT_LENGTH:_Q,MAX_SAFE_BUILD_LENGTH:bQ,MAX_SAFE_INTEGER:xQ,RELEASE_TYPES:wQ,SEMVER_SPEC_VERSION:vQ,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},tb={};const SQ=typeof process=="object"&&tb&&tb.NODE_DEBUG&&/\bsemver\b/i.test(tb.NODE_DEBUG)?(...n)=>console.error("SEMVER",...n):()=>{};var Kv=SQ;(function(n,e){const{MAX_SAFE_COMPONENT_LENGTH:t,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:i}=Yv,s=Kv;e=n.exports={};const a=e.re=[],o=e.safeRe=[],l=e.src=[],c=e.safeSrc=[],u=e.t={};let d=0;const h="[a-zA-Z0-9-]",p=[["\\s",1],["\\d",i],[h,r]],y=g=>{for(const[m,x]of p)g=g.split(`${m}*`).join(`${m}{0,${x}}`).split(`${m}+`).join(`${m}{1,${x}}`);return g},v=(g,m,x)=>{const _=y(m),b=d++;s(g,b,m),u[g]=b,l[b]=m,c[b]=_,a[b]=new RegExp(m,x?"g":void 0),o[b]=new RegExp(_,x?"g":void 0)};v("NUMERICIDENTIFIER","0|[1-9]\\d*"),v("NUMERICIDENTIFIERLOOSE","\\d+"),v("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${h}*`),v("MAINVERSION",`(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})`),v("MAINVERSIONLOOSE",`(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})`),v("PRERELEASEIDENTIFIER",`(?:${l[u.NUMERICIDENTIFIER]}|${l[u.NONNUMERICIDENTIFIER]})`),v("PRERELEASEIDENTIFIERLOOSE",`(?:${l[u.NUMERICIDENTIFIERLOOSE]}|${l[u.NONNUMERICIDENTIFIER]})`),v("PRERELEASE",`(?:-(${l[u.PRERELEASEIDENTIFIER]}(?:\\.${l[u.PRERELEASEIDENTIFIER]})*))`),v("PRERELEASELOOSE",`(?:-?(${l[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[u.PRERELEASEIDENTIFIERLOOSE]})*))`),v("BUILDIDENTIFIER",`${h}+`),v("BUILD",`(?:\\+(${l[u.BUILDIDENTIFIER]}(?:\\.${l[u.BUILDIDENTIFIER]})*))`),v("FULLPLAIN",`v?${l[u.MAINVERSION]}${l[u.PRERELEASE]}?${l[u.BUILD]}?`),v("FULL",`^${l[u.FULLPLAIN]}$`),v("LOOSEPLAIN",`[v=\\s]*${l[u.MAINVERSIONLOOSE]}${l[u.PRERELEASELOOSE]}?${l[u.BUILD]}?`),v("LOOSE",`^${l[u.LOOSEPLAIN]}$`),v("GTLT","((?:<|>)?=?)"),v("XRANGEIDENTIFIERLOOSE",`${l[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),v("XRANGEIDENTIFIER",`${l[u.NUMERICIDENTIFIER]}|x|X|\\*`),v("XRANGEPLAIN",`[v=\\s]*(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:${l[u.PRERELEASE]})?${l[u.BUILD]}?)?)?`),v("XRANGEPLAINLOOSE",`[v=\\s]*(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:${l[u.PRERELEASELOOSE]})?${l[u.BUILD]}?)?)?`),v("XRANGE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAIN]}$`),v("XRANGELOOSE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAINLOOSE]}$`),v("COERCEPLAIN",`(^|[^\\d])(\\d{1,${t}})(?:\\.(\\d{1,${t}}))?(?:\\.(\\d{1,${t}}))?`),v("COERCE",`${l[u.COERCEPLAIN]}(?:$|[^\\d])`),v("COERCEFULL",l[u.COERCEPLAIN]+`(?:${l[u.PRERELEASE]})?(?:${l[u.BUILD]})?(?:$|[^\\d])`),v("COERCERTL",l[u.COERCE],!0),v("COERCERTLFULL",l[u.COERCEFULL],!0),v("LONETILDE","(?:~>?)"),v("TILDETRIM",`(\\s*)${l[u.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",v("TILDE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAIN]}$`),v("TILDELOOSE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAINLOOSE]}$`),v("LONECARET","(?:\\^)"),v("CARETTRIM",`(\\s*)${l[u.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",v("CARET",`^${l[u.LONECARET]}${l[u.XRANGEPLAIN]}$`),v("CARETLOOSE",`^${l[u.LONECARET]}${l[u.XRANGEPLAINLOOSE]}$`),v("COMPARATORLOOSE",`^${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]})$|^$`),v("COMPARATOR",`^${l[u.GTLT]}\\s*(${l[u.FULLPLAIN]})$|^$`),v("COMPARATORTRIM",`(\\s*)${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]}|${l[u.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",v("HYPHENRANGE",`^\\s*(${l[u.XRANGEPLAIN]})\\s+-\\s+(${l[u.XRANGEPLAIN]})\\s*$`),v("HYPHENRANGELOOSE",`^\\s*(${l[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[u.XRANGEPLAINLOOSE]})\\s*$`),v("STAR","(<|>)?=?\\s*\\*"),v("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),v("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(KS,KS.exports);var Yp=KS.exports;const EQ=Object.freeze({loose:!0}),TQ=Object.freeze({}),MQ=n=>n?typeof n!="object"?EQ:n:TQ;var LT=MQ;const ZC=/^[0-9]+$/,TF=(n,e)=>{const t=ZC.test(n),r=ZC.test(e);return t&&r&&(n=+n,e=+e),n===e?0:t&&!r?-1:r&&!t?1:n<e?-1:1},kQ=(n,e)=>TF(e,n);var MF={compareIdentifiers:TF,rcompareIdentifiers:kQ};const ag=Kv,{MAX_LENGTH:JC,MAX_SAFE_INTEGER:og}=Yv,{safeRe:QC,safeSrc:eR,t:lg}=Yp,AQ=LT,{compareIdentifiers:Yc}=MF;let PQ=class ms{constructor(e,t){if(t=AQ(t),e instanceof ms){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>JC)throw new TypeError(`version is longer than ${JC} characters`);ag("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const r=e.trim().match(t.loose?QC[lg.LOOSE]:QC[lg.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>og||this.major<0)throw new TypeError("Invalid major version");if(this.minor>og||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>og||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const s=+i;if(s>=0&&s<og)return s}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(ag("SemVer.compare",this.version,this.options,e),!(e instanceof ms)){if(typeof e=="string"&&e===this.version)return 0;e=new ms(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof ms||(e=new ms(e,this.options)),Yc(this.major,e.major)||Yc(this.minor,e.minor)||Yc(this.patch,e.patch)}comparePre(e){if(e instanceof ms||(e=new ms(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const r=this.prerelease[t],i=e.prerelease[t];if(ag("prerelease compare",t,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return Yc(r,i)}while(++t)}compareBuild(e){e instanceof ms||(e=new ms(e,this.options));let t=0;do{const r=this.build[t],i=e.build[t];if(ag("build compare",t,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return Yc(r,i)}while(++t)}inc(e,t,r){if(e.startsWith("pre")){if(!t&&r===!1)throw new Error("invalid increment argument: identifier is empty");if(t){const i=new RegExp(`^${this.options.loose?eR[lg.PRERELEASELOOSE]:eR[lg.PRERELEASE]}$`),s=`-${t}`.match(i);if(!s||s[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const i=Number(r)?1:0;if(this.prerelease.length===0)this.prerelease=[i];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(t===this.prerelease.join(".")&&r===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(t){let s=[t,i];r===!1&&(s=[t]),Yc(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var Sr=PQ;const tR=Sr,CQ=(n,e,t=!1)=>{if(n instanceof tR)return n;try{return new tR(n,e)}catch(r){if(!t)return null;throw r}};var Nd=CQ;const RQ=Nd,NQ=(n,e)=>{const t=RQ(n,e);return t?t.version:null};var OQ=NQ;const LQ=Nd,DQ=(n,e)=>{const t=LQ(n.trim().replace(/^[=v]+/,""),e);return t?t.version:null};var IQ=DQ;const nR=Sr,jQ=(n,e,t,r,i)=>{typeof t=="string"&&(i=r,r=t,t=void 0);try{return new nR(n instanceof nR?n.version:n,t).inc(e,r,i).version}catch{return null}};var FQ=jQ;const rR=Nd,UQ=(n,e)=>{const t=rR(n,null,!0),r=rR(e,null,!0),i=t.compare(r);if(i===0)return null;const s=i>0,a=s?t:r,o=s?r:t,l=!!a.prerelease.length;if(!!o.prerelease.length&&!l){if(!o.patch&&!o.minor)return"major";if(o.compareMain(a)===0)return o.minor&&!o.patch?"minor":"patch"}const u=l?"pre":"";return t.major!==r.major?u+"major":t.minor!==r.minor?u+"minor":t.patch!==r.patch?u+"patch":"prerelease"};var BQ=UQ;const zQ=Sr,$Q=(n,e)=>new zQ(n,e).major;var VQ=$Q;const HQ=Sr,WQ=(n,e)=>new HQ(n,e).minor;var GQ=WQ;const qQ=Sr,XQ=(n,e)=>new qQ(n,e).patch;var YQ=XQ;const KQ=Nd,ZQ=(n,e)=>{const t=KQ(n,e);return t&&t.prerelease.length?t.prerelease:null};var JQ=ZQ;const iR=Sr,QQ=(n,e,t)=>new iR(n,t).compare(new iR(e,t));var ls=QQ;const eee=ls,tee=(n,e,t)=>eee(e,n,t);var nee=tee;const ree=ls,iee=(n,e)=>ree(n,e,!0);var see=iee;const sR=Sr,aee=(n,e,t)=>{const r=new sR(n,t),i=new sR(e,t);return r.compare(i)||r.compareBuild(i)};var DT=aee;const oee=DT,lee=(n,e)=>n.sort((t,r)=>oee(t,r,e));var cee=lee;const uee=DT,dee=(n,e)=>n.sort((t,r)=>uee(r,t,e));var hee=dee;const fee=ls,pee=(n,e,t)=>fee(n,e,t)>0;var Zv=pee;const mee=ls,gee=(n,e,t)=>mee(n,e,t)<0;var IT=gee;const yee=ls,vee=(n,e,t)=>yee(n,e,t)===0;var kF=vee;const xee=ls,_ee=(n,e,t)=>xee(n,e,t)!==0;var AF=_ee;const bee=ls,wee=(n,e,t)=>bee(n,e,t)>=0;var jT=wee;const See=ls,Eee=(n,e,t)=>See(n,e,t)<=0;var FT=Eee;const Tee=kF,Mee=AF,kee=Zv,Aee=jT,Pee=IT,Cee=FT,Ree=(n,e,t,r)=>{switch(e){case"===":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n===t;case"!==":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n!==t;case"":case"=":case"==":return Tee(n,t,r);case"!=":return Mee(n,t,r);case">":return kee(n,t,r);case">=":return Aee(n,t,r);case"<":return Pee(n,t,r);case"<=":return Cee(n,t,r);default:throw new TypeError(`Invalid operator: ${e}`)}};var PF=Ree;const Nee=Sr,Oee=Nd,{safeRe:cg,t:ug}=Yp,Lee=(n,e)=>{if(n instanceof Nee)return n;if(typeof n=="number"&&(n=String(n)),typeof n!="string")return null;e=e||{};let t=null;if(!e.rtl)t=n.match(e.includePrerelease?cg[ug.COERCEFULL]:cg[ug.COERCE]);else{const l=e.includePrerelease?cg[ug.COERCERTLFULL]:cg[ug.COERCERTL];let c;for(;(c=l.exec(n))&&(!t||t.index+t[0].length!==n.length);)(!t||c.index+c[0].length!==t.index+t[0].length)&&(t=c),l.lastIndex=c.index+c[1].length+c[2].length;l.lastIndex=-1}if(t===null)return null;const r=t[2],i=t[3]||"0",s=t[4]||"0",a=e.includePrerelease&&t[5]?`-${t[5]}`:"",o=e.includePrerelease&&t[6]?`+${t[6]}`:"";return Oee(`${r}.${i}.${s}${a}${o}`,e)};var Dee=Lee;class Iee{constructor(){this.max=1e3,this.map=new Map}get(e){const t=this.map.get(e);if(t!==void 0)return this.map.delete(e),this.map.set(e,t),t}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&t!==void 0){if(this.map.size>=this.max){const i=this.map.keys().next().value;this.delete(i)}this.map.set(e,t)}return this}}var jee=Iee,nb,aR;function cs(){if(aR)return nb;aR=1;const n=/\s+/g;class e{constructor(I,F){if(F=i(F),I instanceof e)return I.loose===!!F.loose&&I.includePrerelease===!!F.includePrerelease?I:new e(I.raw,F);if(I instanceof s)return this.raw=I.value,this.set=[[I]],this.formatted=void 0,this;if(this.options=F,this.loose=!!F.loose,this.includePrerelease=!!F.includePrerelease,this.raw=I.trim().replace(n," "),this.set=this.raw.split("||").map(j=>this.parseRange(j.trim())).filter(j=>j.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const j=this.set[0];if(this.set=this.set.filter(L=>!v(L[0])),this.set.length===0)this.set=[j];else if(this.set.length>1){for(const L of this.set)if(L.length===1&&g(L[0])){this.set=[L];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let I=0;I<this.set.length;I++){I>0&&(this.formatted+="||");const F=this.set[I];for(let j=0;j<F.length;j++)j>0&&(this.formatted+=" "),this.formatted+=F[j].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(I){const j=((this.options.includePrerelease&&p)|(this.options.loose&&y))+":"+I,L=r.get(j);if(L)return L;const D=this.options.loose,z=D?l[c.HYPHENRANGELOOSE]:l[c.HYPHENRANGE];I=I.replace(z,H(this.options.includePrerelease)),a("hyphen replace",I),I=I.replace(l[c.COMPARATORTRIM],u),a("comparator trim",I),I=I.replace(l[c.TILDETRIM],d),a("tilde trim",I),I=I.replace(l[c.CARETTRIM],h),a("caret trim",I);let K=I.split(" ").map(ne=>x(ne,this.options)).join(" ").split(/\s+/).map(ne=>P(ne,this.options));D&&(K=K.filter(ne=>(a("loose invalid filter",ne,this.options),!!ne.match(l[c.COMPARATORLOOSE])))),a("range list",K);const re=new Map,Se=K.map(ne=>new s(ne,this.options));for(const ne of Se){if(v(ne))return[ne];re.set(ne.value,ne)}re.size>1&&re.has("")&&re.delete("");const G=[...re.values()];return r.set(j,G),G}intersects(I,F){if(!(I instanceof e))throw new TypeError("a Range is required");return this.set.some(j=>m(j,F)&&I.set.some(L=>m(L,F)&&j.every(D=>L.every(z=>D.intersects(z,F)))))}test(I){if(!I)return!1;if(typeof I=="string")try{I=new o(I,this.options)}catch{return!1}for(let F=0;F<this.set.length;F++)if(W(this.set[F],I,this.options))return!0;return!1}}nb=e;const t=jee,r=new t,i=LT,s=Jv(),a=Kv,o=Sr,{safeRe:l,t:c,comparatorTrimReplace:u,tildeTrimReplace:d,caretTrimReplace:h}=Yp,{FLAG_INCLUDE_PRERELEASE:p,FLAG_LOOSE:y}=Yv,v=O=>O.value==="<0.0.0-0",g=O=>O.value==="",m=(O,I)=>{let F=!0;const j=O.slice();let L=j.pop();for(;F&&j.length;)F=j.every(D=>L.intersects(D,I)),L=j.pop();return F},x=(O,I)=>(a("comp",O,I),O=E(O,I),a("caret",O),O=b(O,I),a("tildes",O),O=M(O,I),a("xrange",O),O=T(O,I),a("stars",O),O),_=O=>!O||O.toLowerCase()==="x"||O==="*",b=(O,I)=>O.trim().split(/\s+/).map(F=>w(F,I)).join(" "),w=(O,I)=>{const F=I.loose?l[c.TILDELOOSE]:l[c.TILDE];return O.replace(F,(j,L,D,z,K)=>{a("tilde",O,j,L,D,z,K);let re;return _(L)?re="":_(D)?re=`>=${L}.0.0 <${+L+1}.0.0-0`:_(z)?re=`>=${L}.${D}.0 <${L}.${+D+1}.0-0`:K?(a("replaceTilde pr",K),re=`>=${L}.${D}.${z}-${K} <${L}.${+D+1}.0-0`):re=`>=${L}.${D}.${z} <${L}.${+D+1}.0-0`,a("tilde return",re),re})},E=(O,I)=>O.trim().split(/\s+/).map(F=>S(F,I)).join(" "),S=(O,I)=>{a("caret",O,I);const F=I.loose?l[c.CARETLOOSE]:l[c.CARET],j=I.includePrerelease?"-0":"";return O.replace(F,(L,D,z,K,re)=>{a("caret",O,L,D,z,K,re);let Se;return _(D)?Se="":_(z)?Se=`>=${D}.0.0${j} <${+D+1}.0.0-0`:_(K)?D==="0"?Se=`>=${D}.${z}.0${j} <${D}.${+z+1}.0-0`:Se=`>=${D}.${z}.0${j} <${+D+1}.0.0-0`:re?(a("replaceCaret pr",re),D==="0"?z==="0"?Se=`>=${D}.${z}.${K}-${re} <${D}.${z}.${+K+1}-0`:Se=`>=${D}.${z}.${K}-${re} <${D}.${+z+1}.0-0`:Se=`>=${D}.${z}.${K}-${re} <${+D+1}.0.0-0`):(a("no pr"),D==="0"?z==="0"?Se=`>=${D}.${z}.${K}${j} <${D}.${z}.${+K+1}-0`:Se=`>=${D}.${z}.${K}${j} <${D}.${+z+1}.0-0`:Se=`>=${D}.${z}.${K} <${+D+1}.0.0-0`),a("caret return",Se),Se})},M=(O,I)=>(a("replaceXRanges",O,I),O.split(/\s+/).map(F=>N(F,I)).join(" ")),N=(O,I)=>{O=O.trim();const F=I.loose?l[c.XRANGELOOSE]:l[c.XRANGE];return O.replace(F,(j,L,D,z,K,re)=>{a("xRange",O,j,L,D,z,K,re);const Se=_(D),G=Se||_(z),ne=G||_(K),ye=ne;return L==="="&&ye&&(L=""),re=I.includePrerelease?"-0":"",Se?L===">"||L==="<"?j="<0.0.0-0":j="*":L&&ye?(G&&(z=0),K=0,L===">"?(L=">=",G?(D=+D+1,z=0,K=0):(z=+z+1,K=0)):L==="<="&&(L="<",G?D=+D+1:z=+z+1),L==="<"&&(re="-0"),j=`${L+D}.${z}.${K}${re}`):G?j=`>=${D}.0.0${re} <${+D+1}.0.0-0`:ne&&(j=`>=${D}.${z}.0${re} <${D}.${+z+1}.0-0`),a("xRange return",j),j})},T=(O,I)=>(a("replaceStars",O,I),O.trim().replace(l[c.STAR],"")),P=(O,I)=>(a("replaceGTE0",O,I),O.trim().replace(l[I.includePrerelease?c.GTE0PRE:c.GTE0],"")),H=O=>(I,F,j,L,D,z,K,re,Se,G,ne,ye)=>(_(j)?F="":_(L)?F=`>=${j}.0.0${O?"-0":""}`:_(D)?F=`>=${j}.${L}.0${O?"-0":""}`:z?F=`>=${F}`:F=`>=${F}${O?"-0":""}`,_(Se)?re="":_(G)?re=`<${+Se+1}.0.0-0`:_(ne)?re=`<${Se}.${+G+1}.0-0`:ye?re=`<=${Se}.${G}.${ne}-${ye}`:O?re=`<${Se}.${G}.${+ne+1}-0`:re=`<=${re}`,`${F} ${re}`.trim()),W=(O,I,F)=>{for(let j=0;j<O.length;j++)if(!O[j].test(I))return!1;if(I.prerelease.length&&!F.includePrerelease){for(let j=0;j<O.length;j++)if(a(O[j].semver),O[j].semver!==s.ANY&&O[j].semver.prerelease.length>0){const L=O[j].semver;if(L.major===I.major&&L.minor===I.minor&&L.patch===I.patch)return!0}return!1}return!0};return nb}var rb,oR;function Jv(){if(oR)return rb;oR=1;const n=Symbol("SemVer ANY");class e{static get ANY(){return n}constructor(u,d){if(d=t(d),u instanceof e){if(u.loose===!!d.loose)return u;u=u.value}u=u.trim().split(/\s+/).join(" "),a("comparator",u,d),this.options=d,this.loose=!!d.loose,this.parse(u),this.semver===n?this.value="":this.value=this.operator+this.semver.version,a("comp",this)}parse(u){const d=this.options.loose?r[i.COMPARATORLOOSE]:r[i.COMPARATOR],h=u.match(d);if(!h)throw new TypeError(`Invalid comparator: ${u}`);this.operator=h[1]!==void 0?h[1]:"",this.operator==="="&&(this.operator=""),h[2]?this.semver=new o(h[2],this.options.loose):this.semver=n}toString(){return this.value}test(u){if(a("Comparator.test",u,this.options.loose),this.semver===n||u===n)return!0;if(typeof u=="string")try{u=new o(u,this.options)}catch{return!1}return s(u,this.operator,this.semver,this.options)}intersects(u,d){if(!(u instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new l(u.value,d).test(this.value):u.operator===""?u.value===""?!0:new l(this.value,d).test(u.semver):(d=t(d),d.includePrerelease&&(this.value==="<0.0.0-0"||u.value==="<0.0.0-0")||!d.includePrerelease&&(this.value.startsWith("<0.0.0")||u.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&u.operator.startsWith(">")||this.operator.startsWith("<")&&u.operator.startsWith("<")||this.semver.version===u.semver.version&&this.operator.includes("=")&&u.operator.includes("=")||s(this.semver,"<",u.semver,d)&&this.operator.startsWith(">")&&u.operator.startsWith("<")||s(this.semver,">",u.semver,d)&&this.operator.startsWith("<")&&u.operator.startsWith(">")))}}rb=e;const t=LT,{safeRe:r,t:i}=Yp,s=PF,a=Kv,o=Sr,l=cs();return rb}const Fee=cs(),Uee=(n,e,t)=>{try{e=new Fee(e,t)}catch{return!1}return e.test(n)};var Qv=Uee;const Bee=cs(),zee=(n,e)=>new Bee(n,e).set.map(t=>t.map(r=>r.value).join(" ").trim().split(" "));var $ee=zee;const Vee=Sr,Hee=cs(),Wee=(n,e,t)=>{let r=null,i=null,s=null;try{s=new Hee(e,t)}catch{return null}return n.forEach(a=>{s.test(a)&&(!r||i.compare(a)===-1)&&(r=a,i=new Vee(r,t))}),r};var Gee=Wee;const qee=Sr,Xee=cs(),Yee=(n,e,t)=>{let r=null,i=null,s=null;try{s=new Xee(e,t)}catch{return null}return n.forEach(a=>{s.test(a)&&(!r||i.compare(a)===1)&&(r=a,i=new qee(r,t))}),r};var Kee=Yee;const ib=Sr,Zee=cs(),lR=Zv,Jee=(n,e)=>{n=new Zee(n,e);let t=new ib("0.0.0");if(n.test(t)||(t=new ib("0.0.0-0"),n.test(t)))return t;t=null;for(let r=0;r<n.set.length;++r){const i=n.set[r];let s=null;i.forEach(a=>{const o=new ib(a.semver.version);switch(a.operator){case">":o.prerelease.length===0?o.patch++:o.prerelease.push(0),o.raw=o.format();case"":case">=":(!s||lR(o,s))&&(s=o);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${a.operator}`)}}),s&&(!t||lR(t,s))&&(t=s)}return t&&n.test(t)?t:null};var Qee=Jee;const ete=cs(),tte=(n,e)=>{try{return new ete(n,e).range||"*"}catch{return null}};var nte=tte;const rte=Sr,CF=Jv(),{ANY:ite}=CF,ste=cs(),ate=Qv,cR=Zv,uR=IT,ote=FT,lte=jT,cte=(n,e,t,r)=>{n=new rte(n,r),e=new ste(e,r);let i,s,a,o,l;switch(t){case">":i=cR,s=ote,a=uR,o=">",l=">=";break;case"<":i=uR,s=lte,a=cR,o="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(ate(n,e,r))return!1;for(let c=0;c<e.set.length;++c){const u=e.set[c];let d=null,h=null;if(u.forEach(p=>{p.semver===ite&&(p=new CF(">=0.0.0")),d=d||p,h=h||p,i(p.semver,d.semver,r)?d=p:a(p.semver,h.semver,r)&&(h=p)}),d.operator===o||d.operator===l||(!h.operator||h.operator===o)&&s(n,h.semver))return!1;if(h.operator===l&&a(n,h.semver))return!1}return!0};var UT=cte;const ute=UT,dte=(n,e,t)=>ute(n,e,">",t);var hte=dte;const fte=UT,pte=(n,e,t)=>fte(n,e,"<",t);var mte=pte;const dR=cs(),gte=(n,e,t)=>(n=new dR(n,t),e=new dR(e,t),n.intersects(e,t));var yte=gte;const vte=Qv,xte=ls;var _te=(n,e,t)=>{const r=[];let i=null,s=null;const a=n.sort((u,d)=>xte(u,d,t));for(const u of a)vte(u,e,t)?(s=u,i||(i=u)):(s&&r.push([i,s]),s=null,i=null);i&&r.push([i,null]);const o=[];for(const[u,d]of r)u===d?o.push(u):!d&&u===a[0]?o.push("*"):d?u===a[0]?o.push(`<=${d}`):o.push(`${u} - ${d}`):o.push(`>=${u}`);const l=o.join(" || "),c=typeof e.raw=="string"?e.raw:String(e);return l.length<c.length?l:e};const hR=cs(),BT=Jv(),{ANY:sb}=BT,ch=Qv,zT=ls,bte=(n,e,t={})=>{if(n===e)return!0;n=new hR(n,t),e=new hR(e,t);let r=!1;e:for(const i of n.set){for(const s of e.set){const a=Ste(i,s,t);if(r=r||a!==null,a)continue e}if(r)return!1}return!0},wte=[new BT(">=0.0.0-0")],fR=[new BT(">=0.0.0")],Ste=(n,e,t)=>{if(n===e)return!0;if(n.length===1&&n[0].semver===sb){if(e.length===1&&e[0].semver===sb)return!0;t.includePrerelease?n=wte:n=fR}if(e.length===1&&e[0].semver===sb){if(t.includePrerelease)return!0;e=fR}const r=new Set;let i,s;for(const p of n)p.operator===">"||p.operator===">="?i=pR(i,p,t):p.operator==="<"||p.operator==="<="?s=mR(s,p,t):r.add(p.semver);if(r.size>1)return null;let a;if(i&&s){if(a=zT(i.semver,s.semver,t),a>0)return null;if(a===0&&(i.operator!==">="||s.operator!=="<="))return null}for(const p of r){if(i&&!ch(p,String(i),t)||s&&!ch(p,String(s),t))return null;for(const y of e)if(!ch(p,String(y),t))return!1;return!0}let o,l,c,u,d=s&&!t.includePrerelease&&s.semver.prerelease.length?s.semver:!1,h=i&&!t.includePrerelease&&i.semver.prerelease.length?i.semver:!1;d&&d.prerelease.length===1&&s.operator==="<"&&d.prerelease[0]===0&&(d=!1);for(const p of e){if(u=u||p.operator===">"||p.operator===">=",c=c||p.operator==="<"||p.operator==="<=",i){if(h&&p.semver.prerelease&&p.semver.prerelease.length&&p.semver.major===h.major&&p.semver.minor===h.minor&&p.semver.patch===h.patch&&(h=!1),p.operator===">"||p.operator===">="){if(o=pR(i,p,t),o===p&&o!==i)return!1}else if(i.operator===">="&&!ch(i.semver,String(p),t))return!1}if(s){if(d&&p.semver.prerelease&&p.semver.prerelease.length&&p.semver.major===d.major&&p.semver.minor===d.minor&&p.semver.patch===d.patch&&(d=!1),p.operator==="<"||p.operator==="<="){if(l=mR(s,p,t),l===p&&l!==s)return!1}else if(s.operator==="<="&&!ch(s.semver,String(p),t))return!1}if(!p.operator&&(s||i)&&a!==0)return!1}return!(i&&c&&!s&&a!==0||s&&u&&!i&&a!==0||h||d)},pR=(n,e,t)=>{if(!n)return e;const r=zT(n.semver,e.semver,t);return r>0?n:r<0||e.operator===">"&&n.operator===">="?e:n},mR=(n,e,t)=>{if(!n)return e;const r=zT(n.semver,e.semver,t);return r<0?n:r>0||e.operator==="<"&&n.operator==="<="?e:n};var Ete=bte;const ab=Yp,gR=Yv,Tte=Sr,yR=MF,Mte=Nd,kte=OQ,Ate=IQ,Pte=FQ,Cte=BQ,Rte=VQ,Nte=GQ,Ote=YQ,Lte=JQ,Dte=ls,Ite=nee,jte=see,Fte=DT,Ute=cee,Bte=hee,zte=Zv,$te=IT,Vte=kF,Hte=AF,Wte=jT,Gte=FT,qte=PF,Xte=Dee,Yte=Jv(),Kte=cs(),Zte=Qv,Jte=$ee,Qte=Gee,ene=Kee,tne=Qee,nne=nte,rne=UT,ine=hte,sne=mte,ane=yte,one=_te,lne=Ete;var vR={parse:Mte,valid:kte,clean:Ate,inc:Pte,diff:Cte,major:Rte,minor:Nte,patch:Ote,prerelease:Lte,compare:Dte,rcompare:Ite,compareLoose:jte,compareBuild:Fte,sort:Ute,rsort:Bte,gt:zte,lt:$te,eq:Vte,neq:Hte,gte:Wte,lte:Gte,cmp:qte,coerce:Xte,Comparator:Yte,Range:Kte,satisfies:Zte,toComparators:Jte,maxSatisfying:Qte,minSatisfying:ene,minVersion:tne,validRange:nne,outside:rne,gtr:ine,ltr:sne,intersects:ane,simplifyRange:one,subset:lne,SemVer:Tte,re:ab.re,src:ab.src,tokens:ab.t,SEMVER_SPEC_VERSION:gR.SEMVER_SPEC_VERSION,RELEASE_TYPES:gR.RELEASE_TYPES,compareIdentifiers:yR.compareIdentifiers,rcompareIdentifiers:yR.rcompareIdentifiers};function cne(n,e){const t=vR.parse(n),r=vR.parse(e);if(!t||!r)throw new Error("Invalid version format.");return t.compare(r)>=0}function Xa(n){if(!n||n.split("/").length>2||n.startsWith("/")||n.endsWith("/")||n.split(":").length>2)throw new Error(`Invalid identifier format: ${n}`);const[e,t]=n.split(":"),r=t||"latest";if(e.includes("/")){const[i,s]=e.split("/",2);if(!i||!s)throw new Error(`Invalid identifier format: ${n}`);return[i,s,r]}else{if(!e)throw new Error(`Invalid identifier format: ${n}`);return["-",e,r]}}class une extends Error{constructor(e){super(e),this.name="LangSmithConflictError"}}async function gt(n,e,t){let r;if(n.ok){t&&(r=await n.text());return}r=await n.text();const i=`Failed to ${e}. Received status [${n.status}]: ${n.statusText}. Server response: ${r}`;throw n.status===409?new une(i):new Error(i)}var xR="[...]",dne={result:"[Circular]"},T0=[],Au=[];function hne(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function lu(n,e,t,r){var a;try{return JSON.stringify(n,e,t)}catch(o){if(!((a=o.message)!=null&&a.includes("Converting circular structure to JSON")))return console.warn("[WARNING]: LangSmith received unserializable value."),"[Unserializable]";console.warn("[WARNING]: LangSmith received circular JSON. This will decrease tracer performance."),typeof r>"u"&&(r=hne()),ZS(n,"",0,[],void 0,0,r);var i;try{Au.length===0?i=JSON.stringify(n,e,t):i=JSON.stringify(n,fne(e),t)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;T0.length!==0;){var s=T0.pop();s.length===4?Object.defineProperty(s[0],s[1],s[3]):s[0][s[1]]=s[2]}}return i}}function ob(n,e,t,r){var i=Object.getOwnPropertyDescriptor(r,t);i.get!==void 0?i.configurable?(Object.defineProperty(r,t,{value:n}),T0.push([r,t,e,i])):Au.push([e,t,n]):(r[t]=n,T0.push([r,t,e]))}function ZS(n,e,t,r,i,s,a){s+=1;var o;if(typeof n=="object"&&n!==null){for(o=0;o<r.length;o++)if(r[o]===n){ob(dne,n,e,i);return}if(typeof a.depthLimit<"u"&&s>a.depthLimit){ob(xR,n,e,i);return}if(typeof a.edgesLimit<"u"&&t+1>a.edgesLimit){ob(xR,n,e,i);return}if(r.push(n),Array.isArray(n))for(o=0;o<n.length;o++)ZS(n[o],o,o,r,n,s,a);else{var l=Object.keys(n);for(o=0;o<l.length;o++){var c=l[o];ZS(n[c],c,o,r,n,s,a)}}r.pop()}}function fne(n){return n=typeof n<"u"?n:function(e,t){return t},function(e,t){if(Au.length>0)for(var r=0;r<Au.length;r++){var i=Au[r];if(i[1]===e&&i[0]===t){t=i[2],Au.splice(r,1);break}}return n.call(this,e,t)}}function _R(n){const e=OF(),t=Mne(),r=n.extra??{},i=r.metadata;return n.extra={...r,runtime:{...e,...r==null?void 0:r.runtime},metadata:{...t,...t.revision_id||n.revision_id?{revision_id:n.revision_id??t.revision_id}:{},...i}},n}const pne=()=>{const n=Cl("TRACING_SAMPLING_RATE");if(n===void 0)return;const e=parseFloat(n);if(e<0||e>1)throw new Error(`LANGSMITH_TRACING_SAMPLING_RATE must be between 0 and 1 if set. Got: ${e}`);return e},mne=n=>{const t=n.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return t==="localhost"||t==="127.0.0.1"||t==="::1"};async function gne(n){const e=[];for await(const t of n)e.push(t);return e}function lb(n){if(n!==void 0)return n.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}const yne=async n=>{if((n==null?void 0:n.status)===429){const e=parseInt(n.headers.get("retry-after")??"30",10)*1e3;if(e>0)return await new Promise(t=>setTimeout(t,e)),!0}return!1};class vne{constructor(){Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"sizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:0})}peek(){return this.items[0]}push(e){let t;const r=new Promise(s=>{t=s}),i=lu(e.item).length;return this.items.push({action:e.action,payload:e.item,itemPromiseResolve:t,itemPromise:r,size:i}),this.sizeBytes+=i,r}pop(e){var i;if(e<1)throw new Error("Number of bytes to pop off may not be less than 1.");const t=[];let r=0;for(;r+(((i=this.peek())==null?void 0:i.size)??0)<e&&this.items.length>0;){const s=this.items.shift();s&&(t.push(s),r+=s.size,this.sizeBytes-=s.size)}if(t.length===0&&this.items.length>0){const s=this.items.shift();t.push(s),r+=s.size,this.sizeBytes-=s.size}return[t.map(s=>({action:s.action,item:s.payload})),()=>t.forEach(s=>s.itemPromiseResolve())]}}const xne=20971520,_ne=1e3;class hp{constructor(e={}){var r;Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchIngestCaller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tenantId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hideInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hideOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingSampleRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filteredPostUuids",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"autoBatchTracing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"autoBatchQueue",{enumerable:!0,configurable:!0,writable:!0,value:new vne}),Object.defineProperty(this,"autoBatchTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchInitialDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:250}),Object.defineProperty(this,"autoBatchAggregationDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:50}),Object.defineProperty(this,"batchSizeBytesLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockOnRootRunFinalization",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_serverInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_getServerInfoPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const t=hp.getDefaultClientConfig();this.tracingSampleRate=pne(),this.apiUrl=lb(e.apiUrl??t.apiUrl)??"",this.apiUrl.endsWith("/")&&(this.apiUrl=this.apiUrl.slice(0,-1)),this.apiKey=lb(e.apiKey??t.apiKey),this.webUrl=lb(e.webUrl??t.webUrl),(r=this.webUrl)!=null&&r.endsWith("/")&&(this.webUrl=this.webUrl.slice(0,-1)),this.timeout_ms=e.timeout_ms??12e3,this.caller=new qC(e.callerOptions??{}),this.batchIngestCaller=new qC({...e.callerOptions??{},onFailedResponseHook:yne}),this.hideInputs=e.hideInputs??e.anonymizer??t.hideInputs,this.hideOutputs=e.hideOutputs??e.anonymizer??t.hideOutputs,this.autoBatchTracing=e.autoBatchTracing??this.autoBatchTracing,this.blockOnRootRunFinalization=e.blockOnRootRunFinalization??this.blockOnRootRunFinalization,this.batchSizeBytesLimit=e.batchSizeBytesLimit,this.fetchOptions=e.fetchOptions||{}}static getDefaultClientConfig(){const e=Cl("API_KEY"),t=Cl("ENDPOINT")??"https://api.smith.langchain.com",r=Cl("HIDE_INPUTS")==="true",i=Cl("HIDE_OUTPUTS")==="true";return{apiUrl:t,apiKey:e,webUrl:void 0,hideInputs:r,hideOutputs:i}}getHostUrl(){return this.webUrl?this.webUrl:mne(this.apiUrl)?(this.webUrl="http://localhost:3000",this.webUrl):this.apiUrl.includes("/api")&&!this.apiUrl.split(".",1)[0].endsWith("api")?(this.webUrl=this.apiUrl.replace("/api",""),this.webUrl):this.apiUrl.split(".",1)[0].includes("dev")?(this.webUrl="https://dev.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("eu")?(this.webUrl="https://eu.smith.langchain.com",this.webUrl):(this.webUrl="https://smith.langchain.com",this.webUrl)}get headers(){const e={"User-Agent":`langsmith-js/${RF}`};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),e}processInputs(e){return this.hideInputs===!1?e:this.hideInputs===!0?{}:typeof this.hideInputs=="function"?this.hideInputs(e):e}processOutputs(e){return this.hideOutputs===!1?e:this.hideOutputs===!0?{}:typeof this.hideOutputs=="function"?this.hideOutputs(e):e}prepareRunCreateOrUpdateInputs(e){const t={...e};return t.inputs!==void 0&&(t.inputs=this.processInputs(t.inputs)),t.outputs!==void 0&&(t.outputs=this.processOutputs(t.outputs)),t}async _getResponse(e,t){const r=(t==null?void 0:t.toString())??"",i=`${this.apiUrl}${e}?${r}`,s=await this.caller.call(Ve(),i,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await gt(s,`Failed to fetch ${e}`),s}async _get(e,t){return(await this._getResponse(e,t)).json()}async*_getPaginated(e,t=new URLSearchParams,r){let i=Number(t.get("offset"))||0;const s=Number(t.get("limit"))||100;for(;;){t.set("offset",String(i)),t.set("limit",String(s));const a=`${this.apiUrl}${e}?${t}`,o=await this.caller.call(Ve(),a,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await gt(o,`Failed to fetch ${e}`);const l=r?r(await o.json()):await o.json();if(l.length===0||(yield l,l.length<s))break;i+=l.length}}async*_getCursorPaginatedList(e,t=null,r="POST",i="runs"){const s=t?{...t}:{};for(;;){const o=await(await this.caller.call(Ve(),`${this.apiUrl}${e}`,{method:r,headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:JSON.stringify(s)})).json();if(!o||!o[i])break;yield o[i];const l=o.cursors;if(!l||!l.next)break;s.cursor=l.next}}_filterForSampling(e,t=!1){if(this.tracingSampleRate===void 0)return e;if(t){const r=[];for(const i of e)this.filteredPostUuids.has(i.id)?this.filteredPostUuids.delete(i.id):r.push(i);return r}else{const r=[];for(const i of e)i.id!==i.trace_id&&!this.filteredPostUuids.has(i.trace_id)||Math.random()<this.tracingSampleRate?r.push(i):this.filteredPostUuids.add(i.id);return r}}async _getBatchSizeLimitBytes(){var t;const e=await this._ensureServerInfo();return this.batchSizeBytesLimit??((t=e.batch_ingest_config)==null?void 0:t.size_limit_bytes)??xne}async drainAutoBatchQueue(){var e;for(;this.autoBatchQueue.items.length>=0;){const[t,r]=this.autoBatchQueue.pop(await this._getBatchSizeLimitBytes());if(!t.length){r();return}try{const i={runCreates:t.filter(a=>a.action==="create").map(a=>a.item),runUpdates:t.filter(a=>a.action==="update").map(a=>a.item)},s=await this._ensureServerInfo();(e=s==null?void 0:s.batch_ingest_config)!=null&&e.use_multipart_endpoint?await this.multipartIngestRuns(i):await this.batchIngestRuns(i)}finally{r()}}}async processRunOperation(e,t){const r=this.autoBatchTimeout;clearTimeout(this.autoBatchTimeout),this.autoBatchTimeout=void 0,e.action==="create"&&(e.item=_R(e.item));const i=this.autoBatchQueue.push(e),s=await this._getBatchSizeLimitBytes();return(t||this.autoBatchQueue.sizeBytes>s)&&await this.drainAutoBatchQueue().catch(console.error),this.autoBatchQueue.items.length>0&&(this.autoBatchTimeout=setTimeout(()=>{this.autoBatchTimeout=void 0,this.drainAutoBatchQueue().catch(console.error)},r?this.autoBatchAggregationDelayMs:this.autoBatchInitialDelayMs)),i}async _getServerInfo(){const e=await Ve()(`${this.apiUrl}/info`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(_ne),...this.fetchOptions});return await gt(e,"get server info"),e.json()}async _ensureServerInfo(){return this._getServerInfoPromise===void 0&&(this._getServerInfoPromise=(async()=>{if(this._serverInfo===void 0)try{this._serverInfo=await this._getServerInfo()}catch{console.warn("[WARNING]: LangSmith failed to fetch info on supported operations. Falling back to single calls and default limits.")}return this._serverInfo??{}})()),this._getServerInfoPromise.then(e=>(this._serverInfo===void 0&&(this._getServerInfoPromise=void 0),e))}async _getSettings(){return this.settings||(this.settings=this._get("/settings")),await this.settings}async createRun(e){if(!this._filterForSampling([e]).length)return;const t={...this.headers,"Content-Type":"application/json"},r=e.project_name;delete e.project_name;const i=this.prepareRunCreateOrUpdateInputs({session_name:r,...e,start_time:e.start_time??Date.now()});if(this.autoBatchTracing&&i.trace_id!==void 0&&i.dotted_order!==void 0){this.processRunOperation({action:"create",item:i}).catch(console.error);return}const s=_R(i),a=await this.caller.call(Ve(),`${this.apiUrl}/runs`,{method:"POST",headers:t,body:lu(s),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await gt(a,"create run",!0)}async batchIngestRuns({runCreates:e,runUpdates:t}){if(e===void 0&&t===void 0)return;let r=(e==null?void 0:e.map(l=>this.prepareRunCreateOrUpdateInputs(l)))??[],i=(t==null?void 0:t.map(l=>this.prepareRunCreateOrUpdateInputs(l)))??[];if(r.length>0&&i.length>0){const l=r.reduce((u,d)=>(d.id&&(u[d.id]=d),u),{}),c=[];for(const u of i)u.id!==void 0&&l[u.id]?l[u.id]={...l[u.id],...u}:c.push(u);r=Object.values(l),i=c}const s={post:this._filterForSampling(r),patch:this._filterForSampling(i,!0)};if(!s.post.length&&!s.patch.length)return;if((await this._ensureServerInfo()).version===void 0){this.autoBatchTracing=!1;for(const l of s.post)await this.createRun(l);for(const l of s.patch)l.id!==void 0&&await this.updateRun(l.id,l);return}const o={post:[],patch:[]};for(const l of["post","patch"]){const c=l,u=s[c].reverse();let d=u.pop();for(;d!==void 0;)o[c].push(d),d=u.pop()}(o.post.length>0||o.patch.length>0)&&await this._postBatchIngestRuns(lu(o))}async _postBatchIngestRuns(e){const t={...this.headers,"Content-Type":"application/json",Accept:"application/json"},r=await this.batchIngestCaller.call(Ve(),`${this.apiUrl}/runs/batch`,{method:"POST",headers:t,body:e,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await gt(r,"batch create run",!0)}async multipartIngestRuns({runCreates:e,runUpdates:t}){if(e===void 0&&t===void 0)return;const r={};let i=[];for(const u of e??[]){const d=this.prepareRunCreateOrUpdateInputs(u);d.id!==void 0&&d.attachments!==void 0&&(r[d.id]=d.attachments),delete d.attachments,i.push(d)}let s=[];for(const u of t??[])s.push(this.prepareRunCreateOrUpdateInputs(u));if(i.find(u=>u.trace_id===void 0||u.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when creating a run');if(s.find(u=>u.trace_id===void 0||u.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when updating a run');if(i.length>0&&s.length>0){const u=i.reduce((h,p)=>(p.id&&(h[p.id]=p),h),{}),d=[];for(const h of s)h.id!==void 0&&u[h.id]?u[h.id]={...u[h.id],...h}:d.push(h);i=Object.values(u),s=d}if(i.length===0&&s.length===0)return;const l=[],c=[];for(const[u,d]of[["post",i],["patch",s]])for(const h of d){const{inputs:p,outputs:y,events:v,...g}=h,m={inputs:p,outputs:y,events:v},x=lu(g);c.push({name:`${u}.${g.id}`,payload:new Blob([x],{type:`application/json; length=${x.length}`})});for(const[_,b]of Object.entries(m)){if(b===void 0)continue;const w=lu(b);c.push({name:`${u}.${g.id}.${_}`,payload:new Blob([w],{type:`application/json; length=${w.length}`})})}if(g.id!==void 0){const _=r[g.id];if(_){delete r[g.id];for(const[b,[w,E]]of Object.entries(_))c.push({name:`attachment.${g.id}.${b}`,payload:new Blob([E],{type:`${w}; length=${E.length}`})})}}l.push(`trace=${g.trace_id},id=${g.id}`)}await this._sendMultipartRequest(c,l.join("; "))}async _sendMultipartRequest(e,t){try{const r=new FormData;for(const i of e)r.append(i.name,i.payload);await this.batchIngestCaller.call(Ve(),`${this.apiUrl}/runs/multipart`,{method:"POST",headers:{...this.headers},body:r,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})}catch(r){let i="Failed to multipart ingest runs";r instanceof Error?i+=`: ${r.stack||r.message}`:i+=`: ${String(r)}`,console.warn(`${i.trim()}

Context: ${t}`)}}async updateRun(e,t){xt(e),t.inputs&&(t.inputs=this.processInputs(t.inputs)),t.outputs&&(t.outputs=this.processOutputs(t.outputs));const r={...t,id:e};if(!this._filterForSampling([r],!0).length)return;if(this.autoBatchTracing&&r.trace_id!==void 0&&r.dotted_order!==void 0){if(t.end_time!==void 0&&r.parent_run_id===void 0&&this.blockOnRootRunFinalization){await this.processRunOperation({action:"update",item:r},!0);return}else this.processRunOperation({action:"update",item:r}).catch(console.error);return}const i={...this.headers,"Content-Type":"application/json"},s=await this.caller.call(Ve(),`${this.apiUrl}/runs/${e}`,{method:"PATCH",headers:i,body:lu(t),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await gt(s,"update run",!0)}async readRun(e,{loadChildRuns:t}={loadChildRuns:!1}){xt(e);let r=await this._get(`/runs/${e}`);return t&&r.child_run_ids&&(r=await this._loadChildRuns(r)),r}async getRunUrl({runId:e,run:t,projectOpts:r}){if(t!==void 0){let i;t.session_id?i=t.session_id:r!=null&&r.projectName?i=(await this.readProject({projectName:r==null?void 0:r.projectName})).id:r!=null&&r.projectId?i=r==null?void 0:r.projectId:i=(await this.readProject({projectName:Cl("PROJECT")||"default"})).id;const s=await this._getTenantId();return`${this.getHostUrl()}/o/${s}/projects/p/${i}/r/${t.id}?poll=true`}else if(e!==void 0){const i=await this.readRun(e);if(!i.app_path)throw new Error(`Run ${e} has no app_path`);return`${this.getHostUrl()}${i.app_path}`}else throw new Error("Must provide either runId or run")}async _loadChildRuns(e){const t=await gne(this.listRuns({id:e.child_run_ids})),r={},i={};t.sort((s,a)=>((s==null?void 0:s.dotted_order)??"").localeCompare((a==null?void 0:a.dotted_order)??""));for(const s of t){if(s.parent_run_id===null||s.parent_run_id===void 0)throw new Error(`Child run ${s.id} has no parent`);s.parent_run_id in r||(r[s.parent_run_id]=[]),r[s.parent_run_id].push(s),i[s.id]=s}e.child_runs=r[e.id]||[];for(const s in r)s!==e.id&&(i[s].child_runs=r[s]);return e}async*listRuns(e){const{projectId:t,projectName:r,parentRunId:i,traceId:s,referenceExampleId:a,startTime:o,executionOrder:l,isRoot:c,runType:u,error:d,id:h,query:p,filter:y,traceFilter:v,treeFilter:g,limit:m,select:x}=e;let _=[];if(t&&(_=Array.isArray(t)?t:[t]),r){const S=Array.isArray(r)?r:[r],M=await Promise.all(S.map(N=>this.readProject({projectName:N}).then(T=>T.id)));_.push(...M)}const b=["app_path","child_run_ids","completion_cost","completion_tokens","dotted_order","end_time","error","events","extra","feedback_stats","first_token_time","id","inputs","name","outputs","parent_run_id","parent_run_ids","prompt_cost","prompt_tokens","reference_example_id","run_type","session_id","start_time","status","tags","total_cost","total_tokens","trace_id"],w={session:_.length?_:null,run_type:u,reference_example:a,query:p,filter:y,trace_filter:v,tree_filter:g,execution_order:l,parent_run:i,start_time:o?o.toISOString():null,error:d,id:h,limit:m,trace:s,select:x||b,is_root:c};let E=0;for await(const S of this._getCursorPaginatedList("/runs/query",w))if(m){if(E>=m)break;if(S.length+E>m){yield*S.slice(0,m-E);break}E+=S.length,yield*S}else yield*S}async getRunStats({id:e,trace:t,parentRun:r,runType:i,projectNames:s,projectIds:a,referenceExampleIds:o,startTime:l,endTime:c,error:u,query:d,filter:h,traceFilter:p,treeFilter:y,isRoot:v,dataSourceType:g}){let m=a||[];s&&(m=[...a||[],...await Promise.all(s.map(E=>this.readProject({projectName:E}).then(S=>S.id)))]);const _=Object.fromEntries(Object.entries({id:e,trace:t,parent_run:r,run_type:i,session:m,reference_example:o,start_time:l,end_time:c,error:u,query:d,filter:h,trace_filter:p,tree_filter:y,is_root:v,data_source_type:g}).filter(([E,S])=>S!==void 0));return await(await this.caller.call(Ve(),`${this.apiUrl}/runs/stats`,{method:"POST",headers:this.headers,body:JSON.stringify(_),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async shareRun(e,{shareId:t}={}){const r={run_id:e,share_token:t||Qr()};xt(e);const s=await(await this.caller.call(Ve(),`${this.apiUrl}/runs/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(s===null||!("share_token"in s))throw new Error("Invalid response from server");return`${this.getHostUrl()}/public/${s.share_token}/r`}async unshareRun(e){xt(e);const t=await this.caller.call(Ve(),`${this.apiUrl}/runs/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await gt(t,"unshare run",!0)}async readRunSharedLink(e){xt(e);const r=await(await this.caller.call(Ve(),`${this.apiUrl}/runs/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(!(r===null||!("share_token"in r)))return`${this.getHostUrl()}/public/${r.share_token}/r`}async listSharedRuns(e,{runIds:t}={}){const r=new URLSearchParams({share_token:e});if(t!==void 0)for(const a of t)r.append("id",a);return xt(e),await(await this.caller.call(Ve(),`${this.apiUrl}/public/${e}/runs${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async readDatasetSharedSchema(e,t){if(!e&&!t)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:t})).id),xt(e);const i=await(await this.caller.call(Ve(),`${this.apiUrl}/datasets/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return i.url=`${this.getHostUrl()}/public/${i.share_token}/d`,i}async shareDataset(e,t){if(!e&&!t)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:t})).id);const r={dataset_id:e};xt(e);const s=await(await this.caller.call(Ve(),`${this.apiUrl}/datasets/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return s.url=`${this.getHostUrl()}/public/${s.share_token}/d`,s}async unshareDataset(e){xt(e);const t=await this.caller.call(Ve(),`${this.apiUrl}/datasets/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await gt(t,"unshare dataset",!0)}async readSharedDataset(e){return xt(e),await(await this.caller.call(Ve(),`${this.apiUrl}/public/${e}/datasets`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async listSharedExamples(e,t){const r={};t!=null&&t.exampleIds&&(r.id=t.exampleIds);const i=new URLSearchParams;Object.entries(r).forEach(([o,l])=>{Array.isArray(l)?l.forEach(c=>i.append(o,c)):i.append(o,l)});const s=await this.caller.call(Ve(),`${this.apiUrl}/public/${e}/examples?${i.toString()}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),a=await s.json();if(!s.ok)throw"detail"in a?new Error(`Failed to list shared examples.
Status: ${s.status}
Message: ${a.detail.join(`
`)}`):new Error(`Failed to list shared examples: ${s.status} ${s.statusText}`);return a.map(o=>({...o,_hostUrl:this.getHostUrl()}))}async createProject({projectName:e,description:t=null,metadata:r=null,upsert:i=!1,projectExtra:s=null,referenceDatasetId:a=null}){const o=i?"?upsert=true":"",l=`${this.apiUrl}/sessions${o}`,c=s||{};r&&(c.metadata=r);const u={name:e,extra:c,description:t};a!==null&&(u.reference_dataset_id=a);const d=await this.caller.call(Ve(),l,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await gt(d,"create project"),await d.json()}async updateProject(e,{name:t=null,description:r=null,metadata:i=null,projectExtra:s=null,endTime:a=null}){const o=`${this.apiUrl}/sessions/${e}`;let l=s;i&&(l={...l||{},metadata:i});const c={name:t,extra:l,description:r,end_time:a?new Date(a).toISOString():null},u=await this.caller.call(Ve(),o,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await gt(u,"update project"),await u.json()}async hasProject({projectId:e,projectName:t}){let r="/sessions";const i=new URLSearchParams;if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)xt(e),r+=`/${e}`;else if(t!==void 0)i.append("name",t);else throw new Error("Must provide projectName or projectId");const s=await this.caller.call(Ve(),`${this.apiUrl}${r}?${i}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});try{const a=await s.json();return s.ok?Array.isArray(a)?a.length>0:!0:!1}catch{return!1}}async readProject({projectId:e,projectName:t,includeStats:r}){let i="/sessions";const s=new URLSearchParams;if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)xt(e),i+=`/${e}`;else if(t!==void 0)s.append("name",t);else throw new Error("Must provide projectName or projectId");r!==void 0&&s.append("include_stats",r.toString());const a=await this._get(i,s);let o;if(Array.isArray(a)){if(a.length===0)throw new Error(`Project[id=${e}, name=${t}] not found`);o=a[0]}else o=a;return o}async getProjectUrl({projectId:e,projectName:t}){if(e===void 0&&t===void 0)throw new Error("Must provide either projectName or projectId");const r=await this.readProject({projectId:e,projectName:t}),i=await this._getTenantId();return`${this.getHostUrl()}/o/${i}/projects/p/${r.id}`}async getDatasetUrl({datasetId:e,datasetName:t}){if(e===void 0&&t===void 0)throw new Error("Must provide either datasetName or datasetId");const r=await this.readDataset({datasetId:e,datasetName:t}),i=await this._getTenantId();return`${this.getHostUrl()}/o/${i}/datasets/${r.id}`}async _getTenantId(){if(this._tenantId!==null)return this._tenantId;const e=new URLSearchParams({limit:"1"});for await(const t of this._getPaginated("/sessions",e))return this._tenantId=t[0].tenant_id,t[0].tenant_id;throw new Error("No projects found to resolve tenant.")}async*listProjects({projectIds:e,name:t,nameContains:r,referenceDatasetId:i,referenceDatasetName:s,referenceFree:a,metadata:o}={}){const l=new URLSearchParams;if(e!==void 0)for(const c of e)l.append("id",c);if(t!==void 0&&l.append("name",t),r!==void 0&&l.append("name_contains",r),i!==void 0)l.append("reference_dataset",i);else if(s!==void 0){const c=await this.readDataset({datasetName:s});l.append("reference_dataset",c.id)}a!==void 0&&l.append("reference_free",a.toString()),o!==void 0&&l.append("metadata",JSON.stringify(o));for await(const c of this._getPaginated("/sessions",l))yield*c}async deleteProject({projectId:e,projectName:t}){let r;if(e===void 0&&t===void 0)throw new Error("Must provide projectName or projectId");if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");e===void 0?r=(await this.readProject({projectName:t})).id:r=e,xt(r);const i=await this.caller.call(Ve(),`${this.apiUrl}/sessions/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await gt(i,`delete session ${r} (${t})`,!0)}async uploadCsv({csvFile:e,fileName:t,inputKeys:r,outputKeys:i,description:s,dataType:a,name:o}){const l=`${this.apiUrl}/datasets/upload`,c=new FormData;c.append("file",e,t),r.forEach(h=>{c.append("input_keys",h)}),i.forEach(h=>{c.append("output_keys",h)}),s&&c.append("description",s),a&&c.append("data_type",a),o&&c.append("name",o);const u=await this.caller.call(Ve(),l,{method:"POST",headers:this.headers,body:c,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await gt(u,"upload CSV"),await u.json()}async createDataset(e,{description:t,dataType:r,inputsSchema:i,outputsSchema:s,metadata:a}={}){const o={name:e,description:t,extra:a?{metadata:a}:void 0};r&&(o.data_type=r),i&&(o.inputs_schema_definition=i),s&&(o.outputs_schema_definition=s);const l=await this.caller.call(Ve(),`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await gt(l,"create dataset"),await l.json()}async readDataset({datasetId:e,datasetName:t}){let r="/datasets";const i=new URLSearchParams({limit:"1"});if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)xt(e),r+=`/${e}`;else if(t!==void 0)i.append("name",t);else throw new Error("Must provide datasetName or datasetId");const s=await this._get(r,i);let a;if(Array.isArray(s)){if(s.length===0)throw new Error(`Dataset[id=${e}, name=${t}] not found`);a=s[0]}else a=s;return a}async hasDataset({datasetId:e,datasetName:t}){try{return await this.readDataset({datasetId:e,datasetName:t}),!0}catch(r){if(r instanceof Error&&r.message.toLocaleLowerCase().includes("not found"))return!1;throw r}}async diffDatasetVersions({datasetId:e,datasetName:t,fromVersion:r,toVersion:i}){let s=e;if(s===void 0&&t===void 0)throw new Error("Must provide either datasetName or datasetId");if(s!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");s===void 0&&(s=(await this.readDataset({datasetName:t})).id);const a=new URLSearchParams({from_version:typeof r=="string"?r:r.toISOString(),to_version:typeof i=="string"?i:i.toISOString()});return await this._get(`/datasets/${s}/versions/diff`,a)}async readDatasetOpenaiFinetuning({datasetId:e,datasetName:t}){const r="/datasets";if(e===void 0)if(t!==void 0)e=(await this.readDataset({datasetName:t})).id;else throw new Error("Must provide datasetName or datasetId");return(await(await this._getResponse(`${r}/${e}/openai_ft`)).text()).trim().split(`
`).map(o=>JSON.parse(o))}async*listDatasets({limit:e=100,offset:t=0,datasetIds:r,datasetName:i,datasetNameContains:s,metadata:a}={}){const o="/datasets",l=new URLSearchParams({limit:e.toString(),offset:t.toString()});if(r!==void 0)for(const c of r)l.append("id",c);i!==void 0&&l.append("name",i),s!==void 0&&l.append("name_contains",s),a!==void 0&&l.append("metadata",JSON.stringify(a));for await(const c of this._getPaginated(o,l))yield*c}async updateDataset(e){const{datasetId:t,datasetName:r,...i}=e;if(!t&&!r)throw new Error("Must provide either datasetName or datasetId");const s=t??(await this.readDataset({datasetName:r})).id;xt(s);const a=await this.caller.call(Ve(),`${this.apiUrl}/datasets/${s}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(i),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await gt(a,"update dataset"),await a.json()}async deleteDataset({datasetId:e,datasetName:t}){let r="/datasets",i=e;if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(t!==void 0&&(i=(await this.readDataset({datasetName:t})).id),i!==void 0)xt(i),r+=`/${i}`;else throw new Error("Must provide datasetName or datasetId");const s=await this.caller.call(Ve(),this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await gt(s,`delete ${r}`),await s.json()}async indexDataset({datasetId:e,datasetName:t,tag:r}){let i=e;if(!i&&!t)throw new Error("Must provide either datasetName or datasetId");if(i&&t)throw new Error("Must provide either datasetName or datasetId, not both");i||(i=(await this.readDataset({datasetName:t})).id),xt(i);const s={tag:r},a=await this.caller.call(Ve(),`${this.apiUrl}/datasets/${i}/index`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await gt(a,"index dataset"),await a.json()}async similarExamples(e,t,r,{filter:i}={}){const s={limit:r,inputs:e};i!==void 0&&(s.filter=i),xt(t);const a=await this.caller.call(Ve(),`${this.apiUrl}/datasets/${t}/search`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await gt(a,"fetch similar examples"),(await a.json()).examples}async createExample(e,t,{datasetId:r,datasetName:i,createdAt:s,exampleId:a,metadata:o,split:l,sourceRunId:c}){let u=r;if(u===void 0&&i===void 0)throw new Error("Must provide either datasetName or datasetId");if(u!==void 0&&i!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");u===void 0&&(u=(await this.readDataset({datasetName:i})).id);const d=s||new Date,h={dataset_id:u,inputs:e,outputs:t,created_at:d==null?void 0:d.toISOString(),id:a,metadata:o,split:l,source_run_id:c},p=await this.caller.call(Ve(),`${this.apiUrl}/examples`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(h),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await gt(p,"create example"),await p.json()}async createExamples(e){const{inputs:t,outputs:r,metadata:i,sourceRunIds:s,exampleIds:a,datasetId:o,datasetName:l}=e;let c=o;if(c===void 0&&l===void 0)throw new Error("Must provide either datasetName or datasetId");if(c!==void 0&&l!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");c===void 0&&(c=(await this.readDataset({datasetName:l})).id);const u=t.map((p,y)=>({dataset_id:c,inputs:p,outputs:r?r[y]:void 0,metadata:i?i[y]:void 0,split:e.splits?e.splits[y]:void 0,id:a?a[y]:void 0,source_run_id:s?s[y]:void 0})),d=await this.caller.call(Ve(),`${this.apiUrl}/examples/bulk`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await gt(d,"create examples"),await d.json()}async createLLMExample(e,t,r){return this.createExample({input:e},{output:t},r)}async createChatExample(e,t,r){const i=e.map(a=>XC(a)?YC(a):a),s=XC(t)?YC(t):t;return this.createExample({input:i},{output:s},r)}async readExample(e){xt(e);const t=`/examples/${e}`;return await this._get(t)}async*listExamples({datasetId:e,datasetName:t,exampleIds:r,asOf:i,splits:s,inlineS3Urls:a,metadata:o,limit:l,offset:c,filter:u}={}){let d;if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)d=e;else if(t!==void 0)d=(await this.readDataset({datasetName:t})).id;else throw new Error("Must provide a datasetName or datasetId");const h=new URLSearchParams({dataset:d}),p=i?typeof i=="string"?i:i==null?void 0:i.toISOString():void 0;p&&h.append("as_of",p);const y=a??!0;if(h.append("inline_s3_urls",y.toString()),r!==void 0)for(const g of r)h.append("id",g);if(s!==void 0)for(const g of s)h.append("splits",g);if(o!==void 0){const g=JSON.stringify(o);h.append("metadata",g)}l!==void 0&&h.append("limit",l.toString()),c!==void 0&&h.append("offset",c.toString()),u!==void 0&&h.append("filter",u);let v=0;for await(const g of this._getPaginated("/examples",h)){for(const m of g)yield m,v++;if(l!==void 0&&v>=l)break}}async deleteExample(e){xt(e);const t=`/examples/${e}`,r=await this.caller.call(Ve(),this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await gt(r,`delete ${t}`),await r.json()}async updateExample(e,t){xt(e);const r=await this.caller.call(Ve(),`${this.apiUrl}/examples/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(t),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await gt(r,"update example"),await r.json()}async updateExamples(e){const t=await this.caller.call(Ve(),`${this.apiUrl}/examples/bulk`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(e),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await gt(t,"update examples"),await t.json()}async listDatasetSplits({datasetId:e,datasetName:t,asOf:r}){let i;if(e===void 0&&t===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?i=(await this.readDataset({datasetName:t})).id:i=e,xt(i);const s=new URLSearchParams,a=r?typeof r=="string"?r:r==null?void 0:r.toISOString():void 0;return a&&s.append("as_of",a),await this._get(`/datasets/${i}/splits`,s)}async updateDatasetSplits({datasetId:e,datasetName:t,splitName:r,exampleIds:i,remove:s=!1}){let a;if(e===void 0&&t===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?a=(await this.readDataset({datasetName:t})).id:a=e,xt(a);const o={split_name:r,examples:i.map(c=>(xt(c),c)),remove:s},l=await this.caller.call(Ve(),`${this.apiUrl}/datasets/${a}/splits`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await gt(l,"update dataset splits",!0)}async evaluateRun(e,t,{sourceInfo:r,loadChildRuns:i,referenceExample:s}={loadChildRuns:!1}){SF("This method is deprecated and will be removed in future LangSmith versions, use `evaluate` from `langsmith/evaluation` instead.");let a;if(typeof e=="string")a=await this.readRun(e,{loadChildRuns:i});else if(typeof e=="object"&&"id"in e)a=e;else throw new Error(`Invalid run type: ${typeof e}`);a.reference_example_id!==null&&a.reference_example_id!==void 0&&(s=await this.readExample(a.reference_example_id));const o=await t.evaluateRun(a,s),[l,c]=await this._logEvaluationFeedback(o,a,r);return c[0]}async createFeedback(e,t,{score:r,value:i,correction:s,comment:a,sourceInfo:o,feedbackSourceType:l="api",sourceRunId:c,feedbackId:u,feedbackConfig:d,projectId:h,comparativeExperimentId:p}){var x;if(!e&&!h)throw new Error("One of runId or projectId must be provided");if(e&&h)throw new Error("Only one of runId or projectId can be provided");const y={type:l??"api",metadata:o??{}};c!==void 0&&(y==null?void 0:y.metadata)!==void 0&&!y.metadata.__run&&(y.metadata.__run={run_id:c}),(y==null?void 0:y.metadata)!==void 0&&((x=y.metadata.__run)==null?void 0:x.run_id)!==void 0&&xt(y.metadata.__run.run_id);const v={id:u??Qr(),run_id:e,key:t,score:r,value:i,correction:s,comment:a,feedback_source:y,comparative_experiment_id:p,feedbackConfig:d,session_id:h},g=`${this.apiUrl}/feedback`,m=await this.caller.call(Ve(),g,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(v),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await gt(m,"create feedback",!0),v}async updateFeedback(e,{score:t,value:r,correction:i,comment:s}){const a={};t!=null&&(a.score=t),r!=null&&(a.value=r),i!=null&&(a.correction=i),s!=null&&(a.comment=s),xt(e);const o=await this.caller.call(Ve(),`${this.apiUrl}/feedback/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await gt(o,"update feedback",!0)}async readFeedback(e){xt(e);const t=`/feedback/${e}`;return await this._get(t)}async deleteFeedback(e){xt(e);const t=`/feedback/${e}`,r=await this.caller.call(Ve(),this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await gt(r,`delete ${t}`),await r.json()}async*listFeedback({runIds:e,feedbackKeys:t,feedbackSourceTypes:r}={}){const i=new URLSearchParams;if(e&&i.append("run",e.join(",")),t)for(const s of t)i.append("key",s);if(r)for(const s of r)i.append("source",s);for await(const s of this._getPaginated("/feedback",i))yield*s}async createPresignedFeedbackToken(e,t,{expiration:r,feedbackConfig:i}={}){const s={run_id:e,feedback_key:t,feedback_config:i};return r?typeof r=="string"?s.expires_at=r:(r!=null&&r.hours||r!=null&&r.minutes||r!=null&&r.days)&&(s.expires_in=r):s.expires_in={hours:3},await(await this.caller.call(Ve(),`${this.apiUrl}/feedback/tokens`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async createComparativeExperiment({name:e,experimentIds:t,referenceDatasetId:r,createdAt:i,description:s,metadata:a,id:o}){var u;if(t.length===0)throw new Error("At least one experiment is required");if(r||(r=(await this.readProject({projectId:t[0]})).reference_dataset_id),!r==null)throw new Error("A reference dataset is required");const l={id:o,name:e,experiment_ids:t,reference_dataset_id:r,description:s,created_at:(u=i??new Date)==null?void 0:u.toISOString(),extra:{}};return a&&(l.extra.metadata=a),await(await this.caller.call(Ve(),`${this.apiUrl}/datasets/comparative`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async*listPresignedFeedbackTokens(e){xt(e);const t=new URLSearchParams({run_id:e});for await(const r of this._getPaginated("/feedback/tokens",t))yield*r}_selectEvalResults(e){let t;return"results"in e?t=e.results:t=[e],t}async _logEvaluationFeedback(e,t,r){const i=this._selectEvalResults(e),s=[];for(const a of i){let o=r||{};a.evaluatorInfo&&(o={...a.evaluatorInfo,...o});let l=null;a.targetRunId?l=a.targetRunId:t&&(l=t.id),s.push(await this.createFeedback(l,a.key,{score:a.score,value:a.value,comment:a.comment,correction:a.correction,sourceInfo:o,sourceRunId:a.sourceRunId,feedbackConfig:a.feedbackConfig,feedbackSourceType:"model"}))}return[i,s]}async logEvaluationFeedback(e,t,r){const[i]=await this._logEvaluationFeedback(e,t,r);return i}async*listAnnotationQueues(e={}){const{queueIds:t,name:r,nameContains:i,limit:s}=e,a=new URLSearchParams;t&&t.forEach((l,c)=>{xt(l,`queueIds[${c}]`),a.append("ids",l)}),r&&a.append("name",r),i&&a.append("name_contains",i),a.append("limit",(s!==void 0?Math.min(s,100):100).toString());let o=0;for await(const l of this._getPaginated("/annotation-queues",a))if(yield*l,o++,s!==void 0&&o>=s)break}async createAnnotationQueue(e){const{name:t,description:r,queueId:i}=e,s={name:t,description:r,id:i||Qr()},a=await this.caller.call(Ve(),`${this.apiUrl}/annotation-queues`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(Object.fromEntries(Object.entries(s).filter(([l,c])=>c!==void 0))),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await gt(a,"create annotation queue"),await a.json()}async readAnnotationQueue(e){const t=await this.listAnnotationQueues({queueIds:[e]}).next();if(t.done)throw new Error(`Annotation queue with ID ${e} not found`);return t.value}async updateAnnotationQueue(e,t){const{name:r,description:i}=t,s=await this.caller.call(Ve(),`${this.apiUrl}/annotation-queues/${xt(e,"queueId")}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({name:r,description:i}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await gt(s,"update annotation queue")}async deleteAnnotationQueue(e){const t=await this.caller.call(Ve(),`${this.apiUrl}/annotation-queues/${xt(e,"queueId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await gt(t,"delete annotation queue")}async addRunsToAnnotationQueue(e,t){const r=await this.caller.call(Ve(),`${this.apiUrl}/annotation-queues/${xt(e,"queueId")}/runs`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(t.map((i,s)=>xt(i,`runIds[${s}]`).toString())),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await gt(r,"add runs to annotation queue")}async getRunFromAnnotationQueue(e,t){const r=`/annotation-queues/${xt(e,"queueId")}/run`,i=await this.caller.call(Ve(),`${this.apiUrl}${r}/${t}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await gt(i,"get run from annotation queue"),await i.json()}async _currentTenantIsOwner(e){const t=await this._getSettings();return e=="-"||t.tenant_handle===e}async _ownerConflictError(e,t){const r=await this._getSettings();return new Error(`Cannot ${e} for another tenant.

      Current tenant: ${r.tenant_handle}

      Requested tenant: ${t}`)}async _getLatestCommitHash(e){const t=await this.caller.call(Ve(),`${this.apiUrl}/commits/${e}/?limit=1&offset=0`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),r=await t.json();if(!t.ok){const i=typeof r.detail=="string"?r.detail:JSON.stringify(r.detail),s=new Error(`Error ${t.status}: ${t.statusText}
${i}`);throw s.statusCode=t.status,s}if(r.commits.length!==0)return r.commits[0].commit_hash}async _likeOrUnlikePrompt(e,t){const[r,i,s]=Xa(e),a=await this.caller.call(Ve(),`${this.apiUrl}/likes/${r}/${i}`,{method:"POST",body:JSON.stringify({like:t}),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await gt(a,`${t?"like":"unlike"} prompt`),await a.json()}async _getPromptUrl(e){const[t,r,i]=Xa(e);if(await this._currentTenantIsOwner(t)){const s=await this._getSettings();return i!=="latest"?`${this.getHostUrl()}/prompts/${r}/${i.substring(0,8)}?organizationId=${s.id}`:`${this.getHostUrl()}/prompts/${r}?organizationId=${s.id}`}else return i!=="latest"?`${this.getHostUrl()}/hub/${t}/${r}/${i.substring(0,8)}`:`${this.getHostUrl()}/hub/${t}/${r}`}async promptExists(e){return!!await this.getPrompt(e)}async likePrompt(e){return this._likeOrUnlikePrompt(e,!0)}async unlikePrompt(e){return this._likeOrUnlikePrompt(e,!1)}async*listCommits(e){for await(const t of this._getPaginated(`/commits/${e}/`,new URLSearchParams,r=>r.commits))yield*t}async*listPrompts(e){const t=new URLSearchParams;t.append("sort_field",(e==null?void 0:e.sortField)??"updated_at"),t.append("sort_direction","desc"),t.append("is_archived",(!!(e!=null&&e.isArchived)).toString()),(e==null?void 0:e.isPublic)!==void 0&&t.append("is_public",e.isPublic.toString()),e!=null&&e.query&&t.append("query",e.query);for await(const r of this._getPaginated("/repos",t,i=>i.repos))yield*r}async getPrompt(e){const[t,r,i]=Xa(e),s=await this.caller.call(Ve(),`${this.apiUrl}/repos/${t}/${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(s.status===404)return null;await gt(s,"get prompt");const a=await s.json();return a.repo?a.repo:null}async createPrompt(e,t){const r=await this._getSettings();if(t!=null&&t.isPublic&&!r.tenant_handle)throw new Error(`Cannot create a public prompt without first

        creating a LangChain Hub handle. 
        You can add a handle by creating a public prompt at:

        https://smith.langchain.com/prompts`);const[i,s,a]=Xa(e);if(!await this._currentTenantIsOwner(i))throw await this._ownerConflictError("create a prompt",i);const o={repo_handle:s,...(t==null?void 0:t.description)&&{description:t.description},...(t==null?void 0:t.readme)&&{readme:t.readme},...(t==null?void 0:t.tags)&&{tags:t.tags},is_public:!!(t!=null&&t.isPublic)},l=await this.caller.call(Ve(),`${this.apiUrl}/repos/`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await gt(l,"create prompt");const{repo:c}=await l.json();return c}async createCommit(e,t,r){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[i,s,a]=Xa(e),o=(r==null?void 0:r.parentCommitHash)==="latest"||!(r!=null&&r.parentCommitHash)?await this._getLatestCommitHash(`${i}/${s}`):r==null?void 0:r.parentCommitHash,l={manifest:JSON.parse(JSON.stringify(t)),parent_commit:o},c=await this.caller.call(Ve(),`${this.apiUrl}/commits/${i}/${s}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await gt(c,"create commit");const u=await c.json();return this._getPromptUrl(`${i}/${s}${u.commit_hash?`:${u.commit_hash}`:""}`)}async updatePrompt(e,t){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[r,i]=Xa(e);if(!await this._currentTenantIsOwner(r))throw await this._ownerConflictError("update a prompt",r);const s={};if((t==null?void 0:t.description)!==void 0&&(s.description=t.description),(t==null?void 0:t.readme)!==void 0&&(s.readme=t.readme),(t==null?void 0:t.tags)!==void 0&&(s.tags=t.tags),(t==null?void 0:t.isPublic)!==void 0&&(s.is_public=t.isPublic),(t==null?void 0:t.isArchived)!==void 0&&(s.is_archived=t.isArchived),Object.keys(s).length===0)throw new Error("No valid update options provided");const a=await this.caller.call(Ve(),`${this.apiUrl}/repos/${r}/${i}`,{method:"PATCH",body:JSON.stringify(s),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await gt(a,"update prompt"),a.json()}async deletePrompt(e){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[t,r,i]=Xa(e);if(!await this._currentTenantIsOwner(t))throw await this._ownerConflictError("delete a prompt",t);return await(await this.caller.call(Ve(),`${this.apiUrl}/repos/${t}/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async pullPromptCommit(e,t){const[r,i,s]=Xa(e),a=await this._getServerInfo(),o=cne(a.version,"0.5.23");let l=s;if(!o&&s==="latest"){const d=await this._getLatestCommitHash(`${r}/${i}`);if(d)l=d;else throw new Error("No commits found")}const c=await this.caller.call(Ve(),`${this.apiUrl}/commits/${r}/${i}/${l}${t!=null&&t.includeModel?"?include_model=true":""}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await gt(c,"pull prompt commit");const u=await c.json();return{owner:r,repo:i,commit_hash:u.commit_hash,manifest:u.manifest,examples:u.examples}}async _pullPrompt(e,t){const r=await this.pullPromptCommit(e,{includeModel:t==null?void 0:t.includeModel});return JSON.stringify(r.manifest)}async pushPrompt(e,t){return await this.promptExists(e)?t&&Object.keys(t).some(i=>i!=="object")&&await this.updatePrompt(e,{description:t==null?void 0:t.description,readme:t==null?void 0:t.readme,tags:t==null?void 0:t.tags,isPublic:t==null?void 0:t.isPublic}):await this.createPrompt(e,{description:t==null?void 0:t.description,readme:t==null?void 0:t.readme,tags:t==null?void 0:t.tags,isPublic:t==null?void 0:t.isPublic}),t!=null&&t.object?await this.createCommit(e,t==null?void 0:t.object,{parentCommitHash:t==null?void 0:t.parentCommitHash}):await this._getPromptUrl(e)}async clonePublicDataset(e,t={}){const{sourceApiUrl:r=this.apiUrl,datasetName:i}=t,[s,a]=this.parseTokenOrUrl(e,r),o=new hp({apiUrl:s,apiKey:"placeholder"}),l=await o.readSharedDataset(a),c=i||l.name;try{if(await this.hasDataset({datasetId:c})){console.log(`Dataset ${c} already exists in your tenant. Skipping.`);return}}catch{}const u=await o.listSharedExamples(a),d=await this.createDataset(c,{description:l.description,dataType:l.data_type||"kv",inputsSchema:l.inputs_schema_definition??void 0,outputsSchema:l.outputs_schema_definition??void 0});try{await this.createExamples({inputs:u.map(h=>h.inputs),outputs:u.flatMap(h=>h.outputs?[h.outputs]:[]),datasetId:d.id})}catch(h){throw console.error(`An error occurred while creating dataset ${c}. You should delete it manually.`),h}}parseTokenOrUrl(e,t,r=2,i="dataset"){try{return xt(e),[t,e]}catch{}try{const a=new URL(e).pathname.split("/").filter(o=>o!=="");if(a.length>=r){const o=a[a.length-r];return[t,o]}else throw new Error(`Invalid public ${i} URL: ${e}`)}catch{throw new Error(`Invalid public ${i} URL or token: ${e}`)}}awaitPendingTraceBatches(){return Promise.all(this.autoBatchQueue.items.map(({itemPromise:e})=>e))}}const RF="0.1.68";var hf={};let Ys;const bne=()=>typeof window<"u"&&typeof window.document<"u",wne=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",Sne=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),NF=()=>typeof Deno<"u",Ene=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!NF(),Tne=()=>Ys||(bne()?Ys="browser":Ene()?Ys="node":wne()?Ys="webworker":Sne()?Ys="jsdom":NF()?Ys="deno":Ys="other",Ys);let cb;function OF(){if(cb===void 0){const n=Tne(),e=Ane();cb={library:"langsmith",runtime:n,sdk:"langsmith-js",sdk_version:RF,...e}}return cb}function Mne(){const n=kne()||{},e={},t=["LANGCHAIN_API_KEY","LANGCHAIN_ENDPOINT","LANGCHAIN_TRACING_V2","LANGCHAIN_PROJECT","LANGCHAIN_SESSION"];for(const[r,i]of Object.entries(n))r.startsWith("LANGCHAIN_")&&typeof i=="string"&&!t.includes(r)&&!r.toLowerCase().includes("key")&&!r.toLowerCase().includes("secret")&&!r.toLowerCase().includes("token")&&(r==="LANGCHAIN_REVISION_ID"?e.revision_id=i:e[r]=i);return e}function kne(){try{return typeof process<"u"&&hf?Object.entries(hf).reduce((n,[e,t])=>(n[e]=String(t),n),{}):void 0}catch{return}}function Ul(n){try{return typeof process<"u"?hf==null?void 0:hf[n]:void 0}catch{return}}function Cl(n){return Ul(`LANGSMITH_${n}`)||Ul(`LANGCHAIN_${n}`)}let ub;function Ane(){if(ub!==void 0)return ub;const n=["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"],e={};for(const t of n){const r=Ul(t);r!==void 0&&(e[t]=r)}return ub=e,e}const Pne=n=>!!["TRACING_V2","TRACING"].find(t=>Cl(t)==="true"),db=Symbol.for("lc:context_variables");function Cne(n){return n.replace(/[-:.]/g,"")}function Rne(n,e,t=1){const r=t.toFixed(0).slice(0,3).padStart(3,"0");return Cne(`${new Date(n).toISOString().slice(0,-1)}${r}Z`)+e}class M0{constructor(e,t){Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.metadata=e,this.tags=t}static fromHeader(e){const t=e.split(",");let r={},i=[];for(const s of t){const[a,o]=s.split("="),l=decodeURIComponent(o);a==="langsmith-metadata"?r=JSON.parse(l):a==="langsmith-tags"&&(i=l.split(","))}return new M0(r,i)}toHeader(){const e=[];return this.metadata&&Object.keys(this.metadata).length>0&&e.push(`langsmith-metadata=${encodeURIComponent(JSON.stringify(this.metadata))}`),this.tags&&this.tags.length>0&&e.push(`langsmith-tags=${encodeURIComponent(this.tags.join(","))}`),e.join(",")}}class Zr{constructor(e){var o;if(Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"run_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_runs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"end_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extra",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serialized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reference_example_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"trace_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dotted_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),LF(e)){Object.assign(this,{...e});return}const t=Zr.getDefaultConfig(),{metadata:r,...i}=e,s=i.client??Zr.getSharedClient(),a={...r,...(o=i==null?void 0:i.extra)==null?void 0:o.metadata};if(i.extra={...i.extra,metadata:a},Object.assign(this,{...t,...i,client:s}),this.trace_id||(this.parent_run?this.trace_id=this.parent_run.trace_id??this.id:this.trace_id=this.id),this.execution_order??(this.execution_order=1),this.child_execution_order??(this.child_execution_order=1),!this.dotted_order){const l=Rne(this.start_time,this.id,this.execution_order);this.parent_run?this.dotted_order=this.parent_run.dotted_order+"."+l:this.dotted_order=l}}static getDefaultConfig(){return{id:Qr(),run_type:"chain",project_name:Ul("LANGCHAIN_PROJECT")??Ul("LANGCHAIN_SESSION")??"default",child_runs:[],api_url:Ul("LANGCHAIN_ENDPOINT")??"http://localhost:1984",api_key:Ul("LANGCHAIN_API_KEY"),caller_options:{},start_time:Date.now(),serialized:{},inputs:{},extra:{}}}static getSharedClient(){return Zr.sharedClient||(Zr.sharedClient=new hp),Zr.sharedClient}createChild(e){var l,c,u,d,h,p;const t=this.child_execution_order+1,r=new Zr({...e,parent_run:this,project_name:this.project_name,client:this.client,tracingEnabled:this.tracingEnabled,execution_order:t,child_execution_order:t});db in this&&(r[db]=this[db]);const i=Symbol.for("lc:child_config"),s=((l=e.extra)==null?void 0:l[i])??this.extra[i];if(One(s)){const y={...s},v=Nne(y.callbacks)?(u=(c=y.callbacks).copy)==null?void 0:u.call(c):void 0;v&&(Object.assign(v,{_parentRunId:r.id}),(p=(h=(d=v.handlers)==null?void 0:d.find(DF))==null?void 0:h.updateFromRunTree)==null||p.call(h,r),y.callbacks=v),r.extra[i]=y}const a=new Set;let o=this;for(;o!=null&&!a.has(o.id);)a.add(o.id),o.child_execution_order=Math.max(o.child_execution_order,t),o=o.parent_run;return this.child_runs.push(r),r}async end(e,t,r=Date.now(),i){this.outputs=this.outputs??e,this.error=this.error??t,this.end_time=this.end_time??r,i&&Object.keys(i).length>0&&(this.extra=this.extra?{...this.extra,metadata:{...this.extra.metadata,...i}}:{metadata:i})}_convertToCreate(e,t,r=!0){var l;const i=e.extra??{};if(i.runtime||(i.runtime={}),t)for(const[c,u]of Object.entries(t))i.runtime[c]||(i.runtime[c]=u);let s,a;return r?(a=(l=e.parent_run)==null?void 0:l.id,s=[]):(s=e.child_runs.map(c=>this._convertToCreate(c,t,r)),a=void 0),{id:e.id,name:e.name,start_time:e.start_time,end_time:e.end_time,run_type:e.run_type,reference_example_id:e.reference_example_id,extra:i,serialized:e.serialized,error:e.error,inputs:e.inputs,outputs:e.outputs,session_name:e.project_name,child_runs:s,parent_run_id:a,trace_id:e.trace_id,dotted_order:e.dotted_order,tags:e.tags}}async postRun(e=!0){try{const t=OF(),r=await this._convertToCreate(this,t,!0);if(await this.client.createRun(r),!e){SF("Posting with excludeChildRuns=false is deprecated and will be removed in a future version.");for(const i of this.child_runs)await i.postRun(!1)}}catch(t){console.error(`Error in postRun for run ${this.id}:`,t)}}async patchRun(){var e;try{const t={end_time:this.end_time,error:this.error,inputs:this.inputs,outputs:this.outputs,parent_run_id:(e=this.parent_run)==null?void 0:e.id,reference_example_id:this.reference_example_id,extra:this.extra,events:this.events,dotted_order:this.dotted_order,trace_id:this.trace_id,tags:this.tags};await this.client.updateRun(this.id,t)}catch(t){console.error(`Error in patchRun for run ${this.id}`,t)}}toJSON(){return this._convertToCreate(this,void 0,!1)}static fromRunnableConfig(e,t){var c,u,d,h;const r=e==null?void 0:e.callbacks;let i,s,a,o=Pne();if(r){const p=((c=r==null?void 0:r.getParentRunId)==null?void 0:c.call(r))??"",y=(u=r==null?void 0:r.handlers)==null?void 0:u.find(v=>(v==null?void 0:v.name)=="langchain_tracer");i=(d=y==null?void 0:y.getRun)==null?void 0:d.call(y,p),s=y==null?void 0:y.projectName,a=y==null?void 0:y.client,o=o||!!y}return i?new Zr({name:i.name,id:i.id,trace_id:i.trace_id,dotted_order:i.dotted_order,client:a,tracingEnabled:o,project_name:s,tags:[...new Set(((i==null?void 0:i.tags)??[]).concat((e==null?void 0:e.tags)??[]))],extra:{metadata:{...(h=i==null?void 0:i.extra)==null?void 0:h.metadata,...e==null?void 0:e.metadata}}}).createChild(t):new Zr({...t,client:a,tracingEnabled:o,project_name:s})}static fromDottedOrder(e){return this.fromHeaders({"langsmith-trace":e})}static fromHeaders(e,t){var c;const r="get"in e&&typeof e.get=="function"?{"langsmith-trace":e.get("langsmith-trace"),baggage:e.get("baggage")}:e,i=r["langsmith-trace"];if(!i||typeof i!="string")return;const s=i.trim(),a=s.split(".").map(u=>{const[d,h]=u.split("Z");return{strTime:d,time:Date.parse(d+"Z"),uuid:h}}),o=a[0].uuid,l={...t,name:(t==null?void 0:t.name)??"parent",run_type:(t==null?void 0:t.run_type)??"chain",start_time:(t==null?void 0:t.start_time)??Date.now(),id:(c=a.at(-1))==null?void 0:c.uuid,trace_id:o,dotted_order:s};if(r.baggage&&typeof r.baggage=="string"){const u=M0.fromHeader(r.baggage);l.metadata=u.metadata,l.tags=u.tags}return new Zr(l)}toHeaders(e){var r;const t={"langsmith-trace":this.dotted_order,baggage:new M0((r=this.extra)==null?void 0:r.metadata,this.tags).toHeader()};if(e)for(const[i,s]of Object.entries(t))e.set(i,s);return t}}Object.defineProperty(Zr,"sharedClient",{enumerable:!0,configurable:!0,writable:!0,value:null});function LF(n){return n!==void 0&&typeof n.createChild=="function"&&typeof n.postRun=="function"}function DF(n){return typeof n=="object"&&n!=null&&typeof n.name=="string"&&n.name==="langchain_tracer"}function bR(n){return Array.isArray(n)&&n.some(e=>DF(e))}function Nne(n){return typeof n=="object"&&n!=null&&Array.isArray(n.handlers)}function One(n){var e;return n!==void 0&&typeof n.callbacks=="object"&&(bR((e=n.callbacks)==null?void 0:e.handlers)||bR(n.callbacks))}let Lne=class{getStore(){}run(e,t){return t()}};const hb=Symbol.for("ls:tracing_async_local_storage"),Dne=new Lne;let Ine=class{getInstance(){return globalThis[hb]??Dne}initializeGlobalInstance(e){globalThis[hb]===void 0&&(globalThis[hb]=e)}};const jne=new Ine,Fne=()=>{const n=jne.getInstance().getStore();if(!LF(n))throw new Error(["Could not get the current run tree.","","Please make sure you are calling this method within a traceable function or the tracing is enabled."].join(`
`));return n};function $T(n){return typeof n=="function"&&"langsmith:traceable"in n}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */const Une=Object.prototype.hasOwnProperty;function Bne(n,e){return Une.call(n,e)}function zne(n){if(Array.isArray(n)){const t=new Array(n.length);for(let r=0;r<t.length;r++)t[r]=""+r;return t}if(Object.keys)return Object.keys(n);let e=[];for(let t in n)Bne(n,t)&&e.push(t);return e}function md(n){switch(typeof n){case"object":return JSON.parse(JSON.stringify(n));case"undefined":return null;default:return n}}function JS(n){let e=0;const t=n.length;let r;for(;e<t;){if(r=n.charCodeAt(e),r>=48&&r<=57){e++;continue}return!1}return!0}function $ne(n){return n.replace(/~1/g,"/").replace(/~0/g,"~")}function QS(n){if(n===void 0)return!0;if(n){if(Array.isArray(n)){for(let t=0,r=n.length;t<r;t++)if(QS(n[t]))return!0}else if(typeof n=="object"){const t=zne(n),r=t.length;for(var e=0;e<r;e++)if(QS(n[t[e]]))return!0}}return!1}function wR(n,e){const t=[n];for(const r in e){const i=typeof e[r]=="object"?JSON.stringify(e[r],null,2):e[r];typeof i<"u"&&t.push(`${r}: ${i}`)}return t.join(`
`)}class Vne extends Error{constructor(e,t,r,i,s){super(wR(e,{name:t,index:r,operation:i,tree:s})),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"index",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"operation",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"tree",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.setPrototypeOf(this,new.target.prototype),this.message=wR(e,{name:t,index:r,operation:i,tree:s})}}const mn=Vne,Pu={add:function(n,e,t){return n[e]=this.value,{newDocument:t}},remove:function(n,e,t){var r=n[e];return delete n[e],{newDocument:t,removed:r}},replace:function(n,e,t){var r=n[e];return n[e]=this.value,{newDocument:t,removed:r}},move:function(n,e,t){let r=e1(t,this.path);r&&(r=md(r));const i=ff(t,{op:"remove",path:this.from}).removed;return ff(t,{op:"add",path:this.path,value:i}),{newDocument:t,removed:r}},copy:function(n,e,t){const r=e1(t,this.from);return ff(t,{op:"add",path:this.path,value:md(r)}),{newDocument:t}},test:function(n,e,t){return{newDocument:t,test:A0(n[e],this.value)}},_get:function(n,e,t){return this.value=n[e],{newDocument:t}}};var Hne={add:function(n,e,t){return JS(e)?n.splice(e,0,this.value):n[e]=this.value,{newDocument:t,index:e}},remove:function(n,e,t){var r=n.splice(e,1);return{newDocument:t,removed:r[0]}},replace:function(n,e,t){var r=n[e];return n[e]=this.value,{newDocument:t,removed:r}},move:Pu.move,copy:Pu.copy,test:Pu.test,_get:Pu._get};function e1(n,e){if(e=="")return n;var t={op:"_get",path:e};return ff(n,t),t.value}function ff(n,e,t=!1,r=!0,i=!0,s=0){if(t&&(typeof t=="function"?t(e,0,n,e.path):t1(e,0)),e.path===""){let a={newDocument:n};if(e.op==="add")return a.newDocument=e.value,a;if(e.op==="replace")return a.newDocument=e.value,a.removed=n,a;if(e.op==="move"||e.op==="copy")return a.newDocument=e1(n,e.from),e.op==="move"&&(a.removed=n),a;if(e.op==="test"){if(a.test=A0(n,e.value),a.test===!1)throw new mn("Test operation failed","TEST_OPERATION_FAILED",s,e,n);return a.newDocument=n,a}else{if(e.op==="remove")return a.removed=n,a.newDocument=null,a;if(e.op==="_get")return e.value=n,a;if(t)throw new mn("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,e,n);return a}}else{r||(n=md(n));const o=(e.path||"").split("/");let l=n,c=1,u=o.length,d,h,p;for(typeof t=="function"?p=t:p=t1;;){if(h=o[c],h&&h.indexOf("~")!=-1&&(h=$ne(h)),i&&(h=="__proto__"||h=="prototype"&&c>0&&o[c-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(t&&d===void 0&&(l[h]===void 0?d=o.slice(0,c).join("/"):c==u-1&&(d=e.path),d!==void 0&&p(e,0,n,d)),c++,Array.isArray(l)){if(h==="-")h=l.length;else{if(t&&!JS(h))throw new mn("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,e,n);JS(h)&&(h=~~h)}if(c>=u){if(t&&e.op==="add"&&h>l.length)throw new mn("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,e,n);const y=Hne[e.op].call(e,l,h,n);if(y.test===!1)throw new mn("Test operation failed","TEST_OPERATION_FAILED",s,e,n);return y}}else if(c>=u){const y=Pu[e.op].call(e,l,h,n);if(y.test===!1)throw new mn("Test operation failed","TEST_OPERATION_FAILED",s,e,n);return y}if(l=l[h],t&&c<u&&(!l||typeof l!="object"))throw new mn("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,e,n)}}}function k0(n,e,t,r=!0,i=!0){if(t&&!Array.isArray(e))throw new mn("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(n=md(n));const s=new Array(e.length);for(let a=0,o=e.length;a<o;a++)s[a]=ff(n,e[a],t,!0,i,a),n=s[a].newDocument;return s.newDocument=n,s}function t1(n,e,t,r){if(typeof n!="object"||n===null||Array.isArray(n))throw new mn("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,n,t);if(Pu[n.op]){if(typeof n.path!="string")throw new mn("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,n,t);if(n.path.indexOf("/")!==0&&n.path.length>0)throw new mn('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,n,t);if((n.op==="move"||n.op==="copy")&&typeof n.from!="string")throw new mn("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,n,t);if((n.op==="add"||n.op==="replace"||n.op==="test")&&n.value===void 0)throw new mn("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,n,t);if((n.op==="add"||n.op==="replace"||n.op==="test")&&QS(n.value))throw new mn("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,n,t);if(t){if(n.op=="add"){var i=n.path.split("/").length,s=r.split("/").length;if(i!==s+1&&i!==s)throw new mn("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,n,t)}else if(n.op==="replace"||n.op==="remove"||n.op==="_get"){if(n.path!==r)throw new mn("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,n,t)}else if(n.op==="move"||n.op==="copy"){var a={op:"_get",path:n.from,value:void 0},o=Wne([a],t);if(o&&o.name==="OPERATION_PATH_UNRESOLVABLE")throw new mn("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,n,t)}}}else throw new mn("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,n,t)}function Wne(n,e,t){try{if(!Array.isArray(n))throw new mn("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)k0(md(e),md(n),t||!0);else{t=t||t1;for(var r=0;r<n.length;r++)t(n[r],r,e,void 0)}}catch(i){if(i instanceof mn)return i;throw i}}function A0(n,e){if(n===e)return!0;if(n&&e&&typeof n=="object"&&typeof e=="object"){var t=Array.isArray(n),r=Array.isArray(e),i,s,a;if(t&&r){if(s=n.length,s!=e.length)return!1;for(i=s;i--!==0;)if(!A0(n[i],e[i]))return!1;return!0}if(t!=r)return!1;var o=Object.keys(n);if(s=o.length,s!==Object.keys(e).length)return!1;for(i=s;i--!==0;)if(!e.hasOwnProperty(o[i]))return!1;for(i=s;i--!==0;)if(a=o[i],!A0(n[a],e[a]))return!1;return!0}return n!==n&&e!==e}var fb={};const Gne=()=>typeof window<"u"&&typeof window.document<"u",qne=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",Xne=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),IF=()=>typeof Deno<"u",Yne=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!IF(),Kne=()=>{let n;return Gne()?n="browser":Yne()?n="node":qne()?n="webworker":Xne()?n="jsdom":IF()?n="deno":n="other",n};let pb;async function Zne(){return pb===void 0&&(pb={library:"langchain-js",runtime:Kne()}),pb}function hc(n){try{return typeof process<"u"?fb==null?void 0:fb[n]:void 0}catch{return}}class Jne{}class Kp extends Jne{get lc_namespace(){return["langchain_core","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,eF(this.constructor)]}constructor(e){super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreCustomEvent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"raiseError",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:hc("LANGCHAIN_CALLBACKS_BACKGROUND")!=="true"}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent,this.ignoreRetriever=e.ignoreRetriever??this.ignoreRetriever,this.ignoreCustomEvent=e.ignoreCustomEvent??this.ignoreCustomEvent,this.raiseError=e.raiseError??this.raiseError,this.awaitHandlers=this.raiseError||(e._awaitHandler??this.awaitHandlers))}copy(){return new this.constructor(this)}toJSON(){return lc.prototype.toJSON.call(this)}toJSONNotImplemented(){return lc.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class t extends Kp{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:Qr()}),Object.assign(this,e)}}return new t}}function mb(n,e){return n&&!Array.isArray(n)&&typeof n=="object"?n:{[e]:n}}function Qne(n){return n.replace(/[-:.]/g,"")}function ere(n,e,t){const r=t.toFixed(0).slice(0,3).padStart(3,"0");return Qne(`${new Date(n).toISOString().slice(0,-1)}${r}Z`)+e}function uh(n){return typeof n._addRunToRunMap=="function"}class Zp extends Kp{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}copy(){return this}stringifyError(e){return e instanceof Error?e.message+(e!=null&&e.stack?`

${e.stack}`:""):typeof e=="string"?e:`${e}`}_addChildRun(e,t){e.child_runs.push(t)}_addRunToRunMap(e){const t=ere(e.start_time,e.id,e.execution_order),r={...e};if(r.parent_run_id!==void 0){const i=this.runMap.get(r.parent_run_id);i&&(this._addChildRun(i,r),i.child_execution_order=Math.max(i.child_execution_order,r.child_execution_order),r.trace_id=i.trace_id,i.dotted_order!==void 0&&(r.dotted_order=[i.dotted_order,t].join(".")))}else r.trace_id=r.id,r.dotted_order=t;return this.runMap.set(r.id,r),r}async _endTrace(e){var r;const t=e.parent_run_id!==void 0&&this.runMap.get(e.parent_run_id);t?t.child_execution_order=Math.max(t.child_execution_order,e.child_execution_order):await this.persistRun(e),this.runMap.delete(e.id),await((r=this.onRunUpdate)==null?void 0:r.call(this,e))}_getExecutionOrder(e){const t=e!==void 0&&this.runMap.get(e);return t?t.child_execution_order+1:1}_createRunForLLMStart(e,t,r,i,s,a,o,l){const c=this._getExecutionOrder(i),u=Date.now(),d=o?{...s,metadata:o}:s,h={id:r,name:l??e.id[e.id.length-1],parent_run_id:i,start_time:u,serialized:e,events:[{name:"start",time:new Date(u).toISOString()}],inputs:{prompts:t},execution_order:c,child_runs:[],child_execution_order:c,run_type:"llm",extra:d??{},tags:a||[]};return this._addRunToRunMap(h)}async handleLLMStart(e,t,r,i,s,a,o,l){var u,d;const c=this.runMap.get(r)??this._createRunForLLMStart(e,t,r,i,s,a,o,l);return await((u=this.onRunCreate)==null?void 0:u.call(this,c)),await((d=this.onLLMStart)==null?void 0:d.call(this,c)),c}_createRunForChatModelStart(e,t,r,i,s,a,o,l){const c=this._getExecutionOrder(i),u=Date.now(),d=o?{...s,metadata:o}:s,h={id:r,name:l??e.id[e.id.length-1],parent_run_id:i,start_time:u,serialized:e,events:[{name:"start",time:new Date(u).toISOString()}],inputs:{messages:t},execution_order:c,child_runs:[],child_execution_order:c,run_type:"llm",extra:d??{},tags:a||[]};return this._addRunToRunMap(h)}async handleChatModelStart(e,t,r,i,s,a,o,l){var u,d;const c=this.runMap.get(r)??this._createRunForChatModelStart(e,t,r,i,s,a,o,l);return await((u=this.onRunCreate)==null?void 0:u.call(this,c)),await((d=this.onLLMStart)==null?void 0:d.call(this,c)),c}async handleLLMEnd(e,t){var i;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="llm")throw new Error("No LLM run to end.");return r.end_time=Date.now(),r.outputs=e,r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await((i=this.onLLMEnd)==null?void 0:i.call(this,r)),await this._endTrace(r),r}async handleLLMError(e,t){var i;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="llm")throw new Error("No LLM run to end.");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await((i=this.onLLMError)==null?void 0:i.call(this,r)),await this._endTrace(r),r}_createRunForChainStart(e,t,r,i,s,a,o,l){const c=this._getExecutionOrder(i),u=Date.now(),d={id:r,name:l??e.id[e.id.length-1],parent_run_id:i,start_time:u,serialized:e,events:[{name:"start",time:new Date(u).toISOString()}],inputs:t,execution_order:c,child_execution_order:c,run_type:o??"chain",child_runs:[],extra:a?{metadata:a}:{},tags:s||[]};return this._addRunToRunMap(d)}async handleChainStart(e,t,r,i,s,a,o,l){var u,d;const c=this.runMap.get(r)??this._createRunForChainStart(e,t,r,i,s,a,o,l);return await((u=this.onRunCreate)==null?void 0:u.call(this,c)),await((d=this.onChainStart)==null?void 0:d.call(this,c)),c}async handleChainEnd(e,t,r,i,s){var o;const a=this.runMap.get(t);if(!a)throw new Error("No chain run to end.");return a.end_time=Date.now(),a.outputs=mb(e,"output"),a.events.push({name:"end",time:new Date(a.end_time).toISOString()}),(s==null?void 0:s.inputs)!==void 0&&(a.inputs=mb(s.inputs,"input")),await((o=this.onChainEnd)==null?void 0:o.call(this,a)),await this._endTrace(a),a}async handleChainError(e,t,r,i,s){var o;const a=this.runMap.get(t);if(!a)throw new Error("No chain run to end.");return a.end_time=Date.now(),a.error=this.stringifyError(e),a.events.push({name:"error",time:new Date(a.end_time).toISOString()}),(s==null?void 0:s.inputs)!==void 0&&(a.inputs=mb(s.inputs,"input")),await((o=this.onChainError)==null?void 0:o.call(this,a)),await this._endTrace(a),a}_createRunForToolStart(e,t,r,i,s,a,o){const l=this._getExecutionOrder(i),c=Date.now(),u={id:r,name:o??e.id[e.id.length-1],parent_run_id:i,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:{input:t},execution_order:l,child_execution_order:l,run_type:"tool",child_runs:[],extra:a?{metadata:a}:{},tags:s||[]};return this._addRunToRunMap(u)}async handleToolStart(e,t,r,i,s,a,o){var c,u;const l=this.runMap.get(r)??this._createRunForToolStart(e,t,r,i,s,a,o);return await((c=this.onRunCreate)==null?void 0:c.call(this,l)),await((u=this.onToolStart)==null?void 0:u.call(this,l)),l}async handleToolEnd(e,t){var i;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");return r.end_time=Date.now(),r.outputs={output:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await((i=this.onToolEnd)==null?void 0:i.call(this,r)),await this._endTrace(r),r}async handleToolError(e,t){var i;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await((i=this.onToolError)==null?void 0:i.call(this,r)),await this._endTrace(r),r}async handleAgentAction(e,t){var s;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="chain")return;const i=r;i.actions=i.actions||[],i.actions.push(e),i.events.push({name:"agent_action",time:new Date().toISOString(),kwargs:{action:e}}),await((s=this.onAgentAction)==null?void 0:s.call(this,r))}async handleAgentEnd(e,t){var i;const r=this.runMap.get(t);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"agent_end",time:new Date().toISOString(),kwargs:{action:e}}),await((i=this.onAgentEnd)==null?void 0:i.call(this,r)))}_createRunForRetrieverStart(e,t,r,i,s,a,o){const l=this._getExecutionOrder(i),c=Date.now(),u={id:r,name:o??e.id[e.id.length-1],parent_run_id:i,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:{query:t},execution_order:l,child_execution_order:l,run_type:"retriever",child_runs:[],extra:a?{metadata:a}:{},tags:s||[]};return this._addRunToRunMap(u)}async handleRetrieverStart(e,t,r,i,s,a,o){var c,u;const l=this.runMap.get(r)??this._createRunForRetrieverStart(e,t,r,i,s,a,o);return await((c=this.onRunCreate)==null?void 0:c.call(this,l)),await((u=this.onRetrieverStart)==null?void 0:u.call(this,l)),l}async handleRetrieverEnd(e,t){var i;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="retriever")throw new Error("No retriever run to end");return r.end_time=Date.now(),r.outputs={documents:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await((i=this.onRetrieverEnd)==null?void 0:i.call(this,r)),await this._endTrace(r),r}async handleRetrieverError(e,t){var i;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="retriever")throw new Error("No retriever run to end");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await((i=this.onRetrieverError)==null?void 0:i.call(this,r)),await this._endTrace(r),r}async handleText(e,t){var i;const r=this.runMap.get(t);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"text",time:new Date().toISOString(),kwargs:{text:e}}),await((i=this.onText)==null?void 0:i.call(this,r)))}async handleLLMNewToken(e,t,r,i,s,a){var l;const o=this.runMap.get(r);if(!o||(o==null?void 0:o.run_type)!=="llm")throw new Error('Invalid "runId" provided to "handleLLMNewToken" callback.');return o.events.push({name:"new_token",time:new Date().toISOString(),kwargs:{token:e,idx:t,chunk:a==null?void 0:a.chunk}}),await((l=this.onLLMNewToken)==null?void 0:l.call(this,o,e,{chunk:a==null?void 0:a.chunk})),o}}var VT={exports:{}};VT.exports;(function(n){const t=(s=0)=>a=>`\x1B[${38+s};5;${a}m`,r=(s=0)=>(a,o,l)=>`\x1B[${38+s};2;${a};${o};${l}m`;function i(){const s=new Map,a={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};a.color.gray=a.color.blackBright,a.bgColor.bgGray=a.bgColor.bgBlackBright,a.color.grey=a.color.blackBright,a.bgColor.bgGrey=a.bgColor.bgBlackBright;for(const[o,l]of Object.entries(a)){for(const[c,u]of Object.entries(l))a[c]={open:`\x1B[${u[0]}m`,close:`\x1B[${u[1]}m`},l[c]=a[c],s.set(u[0],u[1]);Object.defineProperty(a,o,{value:l,enumerable:!1})}return Object.defineProperty(a,"codes",{value:s,enumerable:!1}),a.color.close="\x1B[39m",a.bgColor.close="\x1B[49m",a.color.ansi256=t(),a.color.ansi16m=r(),a.bgColor.ansi256=t(10),a.bgColor.ansi16m=r(10),Object.defineProperties(a,{rgbToAnsi256:{value:(o,l,c)=>o===l&&l===c?o<8?16:o>248?231:Math.round((o-8)/247*24)+232:16+36*Math.round(o/255*5)+6*Math.round(l/255*5)+Math.round(c/255*5),enumerable:!1},hexToRgb:{value:o=>{const l=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(o.toString(16));if(!l)return[0,0,0];let{colorString:c}=l.groups;c.length===3&&(c=c.split("").map(d=>d+d).join(""));const u=Number.parseInt(c,16);return[u>>16&255,u>>8&255,u&255]},enumerable:!1},hexToAnsi256:{value:o=>a.rgbToAnsi256(...a.hexToRgb(o)),enumerable:!1}}),a}Object.defineProperty(n,"exports",{enumerable:!0,get:i})})(VT);var tre=VT.exports;const jF=Cp(tre);function ur(n,e){return`${n.open}${e}${n.close}`}function xi(n,e){try{return JSON.stringify(n,null,2)}catch{return e}}function SR(n){return typeof n=="string"?n.trim():n==null?n:xi(n,n.toString())}function Ya(n){if(!n.end_time)return"";const e=n.end_time-n.start_time;return e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`}const{color:Ar}=jF;class ER extends Zp{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){const t=[];let r=e;for(;r.parent_run_id;){const i=this.runMap.get(r.parent_run_id);if(i)t.push(i),r=i;else break}return t}getBreadcrumbs(e){const r=[...this.getParents(e).reverse(),e].map((i,s,a)=>{const o=`${i.execution_order}:${i.run_type}:${i.name}`;return s===a.length-1?ur(jF.bold,o):o}).join(" > ");return ur(Ar.grey,r)}onChainStart(e){const t=this.getBreadcrumbs(e);console.log(`${ur(Ar.green,"[chain/start]")} [${t}] Entering Chain run with input: ${xi(e.inputs,"[inputs]")}`)}onChainEnd(e){const t=this.getBreadcrumbs(e);console.log(`${ur(Ar.cyan,"[chain/end]")} [${t}] [${Ya(e)}] Exiting Chain run with output: ${xi(e.outputs,"[outputs]")}`)}onChainError(e){const t=this.getBreadcrumbs(e);console.log(`${ur(Ar.red,"[chain/error]")} [${t}] [${Ya(e)}] Chain run errored with error: ${xi(e.error,"[error]")}`)}onLLMStart(e){const t=this.getBreadcrumbs(e),r="prompts"in e.inputs?{prompts:e.inputs.prompts.map(i=>i.trim())}:e.inputs;console.log(`${ur(Ar.green,"[llm/start]")} [${t}] Entering LLM run with input: ${xi(r,"[inputs]")}`)}onLLMEnd(e){const t=this.getBreadcrumbs(e);console.log(`${ur(Ar.cyan,"[llm/end]")} [${t}] [${Ya(e)}] Exiting LLM run with output: ${xi(e.outputs,"[response]")}`)}onLLMError(e){const t=this.getBreadcrumbs(e);console.log(`${ur(Ar.red,"[llm/error]")} [${t}] [${Ya(e)}] LLM run errored with error: ${xi(e.error,"[error]")}`)}onToolStart(e){const t=this.getBreadcrumbs(e);console.log(`${ur(Ar.green,"[tool/start]")} [${t}] Entering Tool run with input: "${SR(e.inputs.input)}"`)}onToolEnd(e){var r;const t=this.getBreadcrumbs(e);console.log(`${ur(Ar.cyan,"[tool/end]")} [${t}] [${Ya(e)}] Exiting Tool run with output: "${SR((r=e.outputs)==null?void 0:r.output)}"`)}onToolError(e){const t=this.getBreadcrumbs(e);console.log(`${ur(Ar.red,"[tool/error]")} [${t}] [${Ya(e)}] Tool run errored with error: ${xi(e.error,"[error]")}`)}onRetrieverStart(e){const t=this.getBreadcrumbs(e);console.log(`${ur(Ar.green,"[retriever/start]")} [${t}] Entering Retriever run with input: ${xi(e.inputs,"[inputs]")}`)}onRetrieverEnd(e){const t=this.getBreadcrumbs(e);console.log(`${ur(Ar.cyan,"[retriever/end]")} [${t}] [${Ya(e)}] Exiting Retriever run with output: ${xi(e.outputs,"[outputs]")}`)}onRetrieverError(e){const t=this.getBreadcrumbs(e);console.log(`${ur(Ar.red,"[retriever/error]")} [${t}] [${Ya(e)}] Retriever run errored with error: ${xi(e.error,"[error]")}`)}onAgentAction(e){const t=e,r=this.getBreadcrumbs(e);console.log(`${ur(Ar.blue,"[agent/action]")} [${r}] Agent selected action: ${xi(t.actions[t.actions.length-1],"[action]")}`)}}class pf extends Zp{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{exampleId:t,projectName:r,client:i}=e;this.projectName=r??hc("LANGCHAIN_PROJECT")??hc("LANGCHAIN_SESSION"),this.exampleId=t,this.client=i??new hp({});const s=pf.getTraceableRunTree();s&&this.updateFromRunTree(s)}async _convertToCreate(e,t=void 0){return{...e,extra:{...e.extra,runtime:await Zne()},child_runs:void 0,session_name:this.projectName,reference_example_id:e.parent_run_id?void 0:t}}async persistRun(e){}async onRunCreate(e){const t=await this._convertToCreate(e,this.exampleId);await this.client.createRun(t)}async onRunUpdate(e){const t={end_time:e.end_time,error:e.error,outputs:e.outputs,events:e.events,inputs:e.inputs,trace_id:e.trace_id,dotted_order:e.dotted_order,parent_run_id:e.parent_run_id};await this.client.updateRun(e.id,t)}getRun(e){return this.runMap.get(e)}updateFromRunTree(e){let t=e;const r=new Set;for(;t.parent_run&&!(r.has(t.id)||(r.add(t.id),!t.parent_run));)t=t.parent_run;r.clear();const i=[t];for(;i.length>0;){const s=i.shift();!s||r.has(s.id)||(r.add(s.id),this.runMap.set(s.id,s),s.child_runs&&i.push(...s.child_runs))}this.client=e.client??this.client,this.projectName=e.project_name??this.projectName,this.exampleId=e.reference_example_id??this.exampleId}convertToRunTree(e){const t={},r=[];for(const[i,s]of this.runMap){const a=new Zr({...s,child_runs:[],parent_run:void 0,client:this.client,project_name:this.projectName,reference_example_id:this.exampleId,tracingEnabled:!0});t[i]=a,r.push([i,s.dotted_order])}r.sort((i,s)=>!i[1]||!s[1]?0:i[1].localeCompare(s[1]));for(const[i]of r){const s=this.runMap.get(i),a=t[i];if(!(!s||!a)&&s.parent_run_id){const o=t[s.parent_run_id];o&&(o.child_runs.push(a),a.parent_run=o)}}return t[e]}static getTraceableRunTree(){try{return Fne()}catch{return}}}let gb;function nre(){const n="default"in Ea?Ea.default:Ea;return new n({autoStart:!0,concurrency:1})}async function wn(n,e){e===!0?await n():(typeof gb>"u"&&(gb=nre()),gb.add(n))}const rre=n=>!!["LANGSMITH_TRACING_V2","LANGCHAIN_TRACING_V2","LANGSMITH_TRACING","LANGCHAIN_TRACING"].find(t=>hc(t)==="true");class ire{setHandler(e){return this.setHandlers([e])}}class ex{constructor(e,t,r,i,s,a,o,l){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:l})}get parentRunId(){return this._parentRunId}async handleText(e){await Promise.all(this.handlers.map(t=>wn(async()=>{var r;try{await((r=t.handleText)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(i){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleText: ${i}`),t.raiseError)throw i}},t.awaitHandlers)))}async handleCustomEvent(e,t,r,i,s){await Promise.all(this.handlers.map(a=>wn(async()=>{var o;try{await((o=a.handleCustomEvent)==null?void 0:o.call(a,e,t,this.runId,this.tags,this.metadata))}catch(l){if((a.raiseError?console.error:console.warn)(`Error in handler ${a.constructor.name}, handleCustomEvent: ${l}`),a.raiseError)throw l}},a.awaitHandlers)))}}class sre extends ex{getChild(e){const t=new si(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleRetrieverEnd(e){await Promise.all(this.handlers.map(t=>wn(async()=>{var r;if(!t.ignoreRetriever)try{await((r=t.handleRetrieverEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(i){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleRetriever`),t.raiseError)throw i}},t.awaitHandlers)))}async handleRetrieverError(e){await Promise.all(this.handlers.map(t=>wn(async()=>{var r;if(!t.ignoreRetriever)try{await((r=t.handleRetrieverError)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(i){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleRetrieverError: ${i}`),t.raiseError)throw e}},t.awaitHandlers)))}}class TR extends ex{async handleLLMNewToken(e,t,r,i,s,a){await Promise.all(this.handlers.map(o=>wn(async()=>{var l;if(!o.ignoreLLM)try{await((l=o.handleLLMNewToken)==null?void 0:l.call(o,e,t??{prompt:0,completion:0},this.runId,this._parentRunId,this.tags,a))}catch(c){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleLLMNewToken: ${c}`),o.raiseError)throw c}},o.awaitHandlers)))}async handleLLMError(e){await Promise.all(this.handlers.map(t=>wn(async()=>{var r;if(!t.ignoreLLM)try{await((r=t.handleLLMError)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(i){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleLLMError: ${i}`),t.raiseError)throw i}},t.awaitHandlers)))}async handleLLMEnd(e){await Promise.all(this.handlers.map(t=>wn(async()=>{var r;if(!t.ignoreLLM)try{await((r=t.handleLLMEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(i){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleLLMEnd: ${i}`),t.raiseError)throw i}},t.awaitHandlers)))}}class are extends ex{getChild(e){const t=new si(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleChainError(e,t,r,i,s){await Promise.all(this.handlers.map(a=>wn(async()=>{var o;if(!a.ignoreChain)try{await((o=a.handleChainError)==null?void 0:o.call(a,e,this.runId,this._parentRunId,this.tags,s))}catch(l){if((a.raiseError?console.error:console.warn)(`Error in handler ${a.constructor.name}, handleChainError: ${l}`),a.raiseError)throw l}},a.awaitHandlers)))}async handleChainEnd(e,t,r,i,s){await Promise.all(this.handlers.map(a=>wn(async()=>{var o;if(!a.ignoreChain)try{await((o=a.handleChainEnd)==null?void 0:o.call(a,e,this.runId,this._parentRunId,this.tags,s))}catch(l){if((a.raiseError?console.error:console.warn)(`Error in handler ${a.constructor.name}, handleChainEnd: ${l}`),a.raiseError)throw l}},a.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(t=>wn(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleAgentAction)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(i){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleAgentAction: ${i}`),t.raiseError)throw i}},t.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(t=>wn(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleAgentEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(i){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleAgentEnd: ${i}`),t.raiseError)throw i}},t.awaitHandlers)))}}class ore extends ex{getChild(e){const t=new si(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleToolError(e){await Promise.all(this.handlers.map(t=>wn(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleToolError)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(i){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleToolError: ${i}`),t.raiseError)throw i}},t.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(t=>wn(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleToolEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(i){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleToolEnd: ${i}`),t.raiseError)throw i}},t.awaitHandlers)))}}class si extends ire{constructor(e,t){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=(t==null?void 0:t.handlers)??this.handlers,this.inheritableHandlers=(t==null?void 0:t.inheritableHandlers)??this.inheritableHandlers,this.tags=(t==null?void 0:t.tags)??this.tags,this.inheritableTags=(t==null?void 0:t.inheritableTags)??this.inheritableTags,this.metadata=(t==null?void 0:t.metadata)??this.metadata,this.inheritableMetadata=(t==null?void 0:t.inheritableMetadata)??this.inheritableMetadata,this._parentRunId=e}getParentRunId(){return this._parentRunId}async handleLLMStart(e,t,r=void 0,i=void 0,s=void 0,a=void 0,o=void 0,l=void 0){return Promise.all(t.map(async(c,u)=>{const d=u===0&&r?r:Qr();return await Promise.all(this.handlers.map(h=>{if(!h.ignoreLLM)return uh(h)&&h._createRunForLLMStart(e,[c],d,this._parentRunId,s,this.tags,this.metadata,l),wn(async()=>{var p;try{await((p=h.handleLLMStart)==null?void 0:p.call(h,e,[c],d,this._parentRunId,s,this.tags,this.metadata,l))}catch(y){if((h.raiseError?console.error:console.warn)(`Error in handler ${h.constructor.name}, handleLLMStart: ${y}`),h.raiseError)throw y}},h.awaitHandlers)})),new TR(d,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(e,t,r=void 0,i=void 0,s=void 0,a=void 0,o=void 0,l=void 0){return Promise.all(t.map(async(c,u)=>{const d=u===0&&r?r:Qr();return await Promise.all(this.handlers.map(h=>{if(!h.ignoreLLM)return uh(h)&&h._createRunForChatModelStart(e,[c],d,this._parentRunId,s,this.tags,this.metadata,l),wn(async()=>{var p,y;try{if(h.handleChatModelStart)await((p=h.handleChatModelStart)==null?void 0:p.call(h,e,[c],d,this._parentRunId,s,this.tags,this.metadata,l));else if(h.handleLLMStart){const v=iF(c);await((y=h.handleLLMStart)==null?void 0:y.call(h,e,[v],d,this._parentRunId,s,this.tags,this.metadata,l))}}catch(v){if((h.raiseError?console.error:console.warn)(`Error in handler ${h.constructor.name}, handleLLMStart: ${v}`),h.raiseError)throw v}},h.awaitHandlers)})),new TR(d,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(e,t,r=Qr(),i=void 0,s=void 0,a=void 0,o=void 0){return await Promise.all(this.handlers.map(l=>{if(!l.ignoreChain)return uh(l)&&l._createRunForChainStart(e,t,r,this._parentRunId,this.tags,this.metadata,i,o),wn(async()=>{var c;try{await((c=l.handleChainStart)==null?void 0:c.call(l,e,t,r,this._parentRunId,this.tags,this.metadata,i,o))}catch(u){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleChainStart: ${u}`),l.raiseError)throw u}},l.awaitHandlers)})),new are(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,t,r=Qr(),i=void 0,s=void 0,a=void 0,o=void 0){return await Promise.all(this.handlers.map(l=>{if(!l.ignoreAgent)return uh(l)&&l._createRunForToolStart(e,t,r,this._parentRunId,this.tags,this.metadata,o),wn(async()=>{var c;try{await((c=l.handleToolStart)==null?void 0:c.call(l,e,t,r,this._parentRunId,this.tags,this.metadata,o))}catch(u){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleToolStart: ${u}`),l.raiseError)throw u}},l.awaitHandlers)})),new ore(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleRetrieverStart(e,t,r=Qr(),i=void 0,s=void 0,a=void 0,o=void 0){return await Promise.all(this.handlers.map(l=>{if(!l.ignoreRetriever)return uh(l)&&l._createRunForRetrieverStart(e,t,r,this._parentRunId,this.tags,this.metadata,o),wn(async()=>{var c;try{await((c=l.handleRetrieverStart)==null?void 0:c.call(l,e,t,r,this._parentRunId,this.tags,this.metadata,o))}catch(u){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleRetrieverStart: ${u}`),l.raiseError)throw u}},l.awaitHandlers)})),new sre(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleCustomEvent(e,t,r,i,s){await Promise.all(this.handlers.map(a=>wn(async()=>{var o;if(!a.ignoreCustomEvent)try{await((o=a.handleCustomEvent)==null?void 0:o.call(a,e,t,r,this.tags,this.metadata))}catch(l){if((a.raiseError?console.error:console.warn)(`Error in handler ${a.constructor.name}, handleCustomEvent: ${l}`),a.raiseError)throw l}},a.awaitHandlers)))}addHandler(e,t=!0){this.handlers.push(e),t&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(t=>t!==e),this.inheritableHandlers=this.inheritableHandlers.filter(t=>t!==e)}setHandlers(e,t=!0){this.handlers=[],this.inheritableHandlers=[];for(const r of e)this.addHandler(r,t)}addTags(e,t=!0){this.removeTags(e),this.tags.push(...e),t&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter(t=>!e.includes(t)),this.inheritableTags=this.inheritableTags.filter(t=>!e.includes(t))}addMetadata(e,t=!0){this.metadata={...this.metadata,...e},t&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(const t of Object.keys(e))delete this.metadata[t],delete this.inheritableMetadata[t]}copy(e=[],t=!0){const r=new si(this._parentRunId);for(const i of this.handlers){const s=this.inheritableHandlers.includes(i);r.addHandler(i,s)}for(const i of this.tags){const s=this.inheritableTags.includes(i);r.addTags([i],s)}for(const i of Object.keys(this.metadata)){const s=Object.keys(this.inheritableMetadata).includes(i);r.addMetadata({[i]:this.metadata[i]},s)}for(const i of e)r.handlers.filter(s=>s.name==="console_callback_handler").some(s=>s.name===i.name)||r.addHandler(i,t);return r}static fromHandlers(e){class t extends Kp{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:Qr()}),Object.assign(this,e)}}const r=new this;return r.addHandler(new t),r}static async configure(e,t,r,i,s,a,o){return this._configureSync(e,t,r,i,s,a,o)}static _configureSync(e,t,r,i,s,a,o){var h,p;let l;(e||t)&&(Array.isArray(e)||!e?(l=new si,l.setHandlers((e==null?void 0:e.map(P0))??[],!0)):l=e,l=l.copy(Array.isArray(t)?t.map(P0):t==null?void 0:t.handlers,!1));const c=hc("LANGCHAIN_VERBOSE")==="true"||(o==null?void 0:o.verbose),u=((h=pf.getTraceableRunTree())==null?void 0:h.tracingEnabled)||rre(),d=u||(hc("LANGCHAIN_TRACING")??!1);if(c||d){if(l||(l=new si),c&&!l.handlers.some(y=>y.name===ER.prototype.name)){const y=new ER;l.addHandler(y,!0)}if(d&&!l.handlers.some(y=>y.name==="langchain_tracer")&&u){const y=new pf;l.addHandler(y,!0),l._parentRunId=((p=pf.getTraceableRunTree())==null?void 0:p.id)??l._parentRunId}}return(r||i)&&l&&(l.addTags(r??[]),l.addTags(i??[],!1)),(s||a)&&l&&(l.addMetadata(s??{}),l.addMetadata(a??{},!1)),l}}function P0(n){return"name"in n?n:Kp.fromMethods(n)}class lre{getStore(){}run(e,t){return t()}}const cre=new lre,yb=Symbol.for("ls:tracing_async_local_storage"),MR=Symbol.for("lc:child_config");class ure{getInstance(){return globalThis[yb]??cre}getRunnableConfig(){var t,r;return(r=(t=this.getInstance().getStore())==null?void 0:t.extra)==null?void 0:r[MR]}runWithConfig(e,t,r){var c;const i=si._configureSync(e==null?void 0:e.callbacks,void 0,e==null?void 0:e.tags,void 0,e==null?void 0:e.metadata),s=this.getInstance(),a=i==null?void 0:i.getParentRunId(),o=(c=i==null?void 0:i.handlers)==null?void 0:c.find(u=>(u==null?void 0:u.name)==="langchain_tracer");let l;return o&&a?l=o.convertToRunTree(a):r||(l=new Zr({name:"<runnable_lambda>",tracingEnabled:!1})),l&&(l.extra={...l.extra,[MR]:e}),s.run(l,t)}initializeGlobalInstance(e){globalThis[yb]===void 0&&(globalThis[yb]=e)}}const fc=new ure;async function Go(n,e){if(e===void 0)return n;let t;return Promise.race([n.catch(r=>{if(!(e!=null&&e.aborted))throw r}),new Promise((r,i)=>{t=()=>{i(new Error("Aborted"))},e.addEventListener("abort",t),e.aborted&&i(new Error("Aborted"))})]).finally(()=>e.removeEventListener("abort",t))}class li extends ReadableStream{constructor(){super(...arguments),Object.defineProperty(this,"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{const e=await this.reader.read();return e.done?(this.reader.releaseLock(),{done:!0,value:void 0}):{done:!1,value:e.value}}catch(e){throw this.reader.releaseLock(),e}}async return(){if(this.ensureReader(),this.locked){const e=this.reader.cancel();this.reader.releaseLock(),await e}return{done:!0,value:void 0}}async throw(e){if(this.ensureReader(),this.locked){const t=this.reader.cancel();this.reader.releaseLock(),await t}throw e}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}static fromReadableStream(e){const t=e.getReader();return new li({start(r){return i();function i(){return t.read().then(({done:s,value:a})=>{if(s){r.close();return}return r.enqueue(a),i()})}},cancel(){t.releaseLock()}})}static fromAsyncGenerator(e){return new li({async pull(t){const{value:r,done:i}=await e.next();i&&t.close(),t.enqueue(r)},async cancel(t){await e.return(t)}})}}function FF(n,e=2){const t=Array.from({length:e},()=>[]);return t.map(async function*(i){for(;;)if(i.length===0){const s=await n.next();for(const a of t)a.push(s)}else{if(i[0].done)return;yield i.shift().value}})}function ts(n,e){if(Array.isArray(n)&&Array.isArray(e))return n.concat(e);if(typeof n=="string"&&typeof e=="string")return n+e;if(typeof n=="number"&&typeof e=="number")return n+e;if("concat"in n&&typeof n.concat=="function")return n.concat(e);if(typeof n=="object"&&typeof e=="object"){const t={...n};for(const[r,i]of Object.entries(e))r in t&&!Array.isArray(t[r])?t[r]=ts(t[r],i):t[r]=i;return t}else throw new Error(`Cannot concat ${typeof n} and ${typeof e}`)}class Od{constructor(e){var t;Object.defineProperty(this,"generator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResult",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResultUsed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.generator=e.generator,this.config=e.config,this.signal=e.signal??((t=this.config)==null?void 0:t.signal),this.setup=new Promise((r,i)=>{fc.runWithConfig(e.config,async()=>{this.firstResult=e.generator.next(),e.startSetup?this.firstResult.then(e.startSetup).then(r,i):this.firstResult.then(s=>r(void 0),i)},!0)})}async next(...e){var t;return(t=this.signal)==null||t.throwIfAborted(),this.firstResultUsed?fc.runWithConfig(this.config,this.signal?async()=>Go(this.generator.next(...e),this.signal):async()=>this.generator.next(...e),!0):(this.firstResultUsed=!0,this.firstResult)}async return(e){return this.generator.return(e)}async throw(e){return this.generator.throw(e)}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}}async function dre(n,e,t,r,...i){const s=new Od({generator:e,startSetup:t,signal:r}),a=await s.setup;return{output:n(s,a,...i),setup:a}}class oo{constructor(e){Object.defineProperty(this,"ops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ops=e.ops??[]}concat(e){const t=this.ops.concat(e.ops),r=k0({},t);return new fp({ops:t,state:r[r.length-1].newDocument})}}class fp extends oo{constructor(e){super(e),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.state=e.state}concat(e){const t=this.ops.concat(e.ops),r=k0(this.state,e.ops);return new fp({ops:t,state:r[r.length-1].newDocument})}static fromRunLogPatch(e){const t=k0({},e.ops);return new fp({ops:e.ops,state:t[t.length-1].newDocument})}}const UF=n=>n.name==="log_stream_tracer";async function kR(n,e){if(e==="original")throw new Error("Do not assign inputs with original schema drop the key for now. When inputs are added to streamLog they should be added with standardized schema for streaming events.");const{inputs:t}=n;if(["retriever","llm","prompt"].includes(n.run_type))return t;if(!(Object.keys(t).length===1&&(t==null?void 0:t.input)===""))return t.input}async function AR(n,e){const{outputs:t}=n;return e==="original"||["retriever","llm","prompt"].includes(n.run_type)?t:t!==void 0&&Object.keys(t).length===1&&(t==null?void 0:t.output)!==void 0?t.output:t}function hre(n){return n!==void 0&&n.message!==void 0}class PR extends Zp{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_schemaFormat",{enumerable:!0,configurable:!0,writable:!0,value:"original"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"keyMapByRunId",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"counterMapByRunName",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"log_stream_tracer"}),this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this._schemaFormat=(e==null?void 0:e._schemaFormat)??this._schemaFormat,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=li.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){if(e.id===this.rootId)return!1;const t=e.tags??[];let r=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(e.run_type)),this.includeTags!==void 0&&(r=r||t.find(i=>{var s;return(s=this.includeTags)==null?void 0:s.includes(i)})!==void 0),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(e.run_type)),this.excludeTags!==void 0&&(r=r&&t.every(i=>{var s;return!((s=this.excludeTags)!=null&&s.includes(i))})),r}async*tapOutputIterable(e,t){for await(const r of t){if(e!==this.rootId){const i=this.keyMapByRunId[e];i&&await this.writer.write(new oo({ops:[{op:"add",path:`/logs/${i}/streamed_output/-`,value:r}]}))}yield r}}async onRunCreate(e){var i;if(this.rootId===void 0&&(this.rootId=e.id,await this.writer.write(new oo({ops:[{op:"replace",path:"",value:{id:e.id,name:e.name,type:e.run_type,streamed_output:[],final_output:void 0,logs:{}}}]}))),!this._includeRun(e))return;this.counterMapByRunName[e.name]===void 0&&(this.counterMapByRunName[e.name]=0),this.counterMapByRunName[e.name]+=1;const t=this.counterMapByRunName[e.name];this.keyMapByRunId[e.id]=t===1?e.name:`${e.name}:${t}`;const r={id:e.id,name:e.name,type:e.run_type,tags:e.tags??[],metadata:((i=e.extra)==null?void 0:i.metadata)??{},start_time:new Date(e.start_time).toISOString(),streamed_output:[],streamed_output_str:[],final_output:void 0,end_time:void 0};this._schemaFormat==="streaming_events"&&(r.inputs=await kR(e,this._schemaFormat)),await this.writer.write(new oo({ops:[{op:"add",path:`/logs/${this.keyMapByRunId[e.id]}`,value:r}]}))}async onRunUpdate(e){try{const t=this.keyMapByRunId[e.id];if(t===void 0)return;const r=[];this._schemaFormat==="streaming_events"&&r.push({op:"replace",path:`/logs/${t}/inputs`,value:await kR(e,this._schemaFormat)}),r.push({op:"add",path:`/logs/${t}/final_output`,value:await AR(e,this._schemaFormat)}),e.end_time!==void 0&&r.push({op:"add",path:`/logs/${t}/end_time`,value:new Date(e.end_time).toISOString()});const i=new oo({ops:r});await this.writer.write(i)}finally{if(e.id===this.rootId){const t=new oo({ops:[{op:"replace",path:"/final_output",value:await AR(e,this._schemaFormat)}]});await this.writer.write(t),this.autoClose&&await this.writer.close()}}}async onLLMNewToken(e,t,r){const i=this.keyMapByRunId[e.id];if(i===void 0)return;const s=e.inputs.messages!==void 0;let a;s?hre(r==null?void 0:r.chunk)?a=r==null?void 0:r.chunk:a=new pr({id:`run-${e.id}`,content:t}):a=t;const o=new oo({ops:[{op:"add",path:`/logs/${i}/streamed_output_str/-`,value:t},{op:"add",path:`/logs/${i}/streamed_output/-`,value:a}]});await this.writer.write(o)}}const CR="__run";class pp{constructor(e){Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generationInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=e.text,this.generationInfo=e.generationInfo}concat(e){return new pp({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo}})}}class HT extends pp{constructor(e){super(e),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.message=e.message}concat(e){return new HT({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo},message:this.message.concat(e.message)})}}function dg({name:n,serialized:e}){return n!==void 0?n:(e==null?void 0:e.name)!==void 0?e.name:(e==null?void 0:e.id)!==void 0&&Array.isArray(e==null?void 0:e.id)?e.id[e.id.length-1]:"Unnamed"}const BF=n=>n.name==="event_stream_tracer";class fre extends Zp{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runInfoMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"tappedPromises",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"event_stream_tracer"}),this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=li.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){const t=e.tags??[];let r=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(e.runType)),this.includeTags!==void 0&&(r=r||t.find(i=>{var s;return(s=this.includeTags)==null?void 0:s.includes(i)})!==void 0),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(e.runType)),this.excludeTags!==void 0&&(r=r&&t.every(i=>{var s;return!((s=this.excludeTags)!=null&&s.includes(i))})),r}async*tapOutputIterable(e,t){const r=await t.next();if(r.done)return;const i=this.runInfoMap.get(e);if(i===void 0){yield r.value;return}function s(o,l){return o==="llm"&&typeof l=="string"?new pp({text:l}):l}let a=this.tappedPromises.get(e);if(a===void 0){let o;a=new Promise(l=>{o=l}),this.tappedPromises.set(e,a);try{const l={event:`on_${i.runType}_stream`,run_id:e,name:i.name,tags:i.tags,metadata:i.metadata,data:{}};await this.send({...l,data:{chunk:s(i.runType,r.value)}},i),yield r.value;for await(const c of t)i.runType!=="tool"&&i.runType!=="retriever"&&await this.send({...l,data:{chunk:s(i.runType,c)}},i),yield c}finally{o()}}else{yield r.value;for await(const o of t)yield o}}async send(e,t){this._includeRun(t)&&await this.writer.write(e)}async sendEndEvent(e,t){const r=this.tappedPromises.get(e.run_id);r!==void 0?r.then(()=>{this.send(e,t)}):await this.send(e,t)}async onLLMStart(e){var a,o;const t=dg(e),r=e.inputs.messages!==void 0?"chat_model":"llm",i={tags:e.tags??[],metadata:((a=e.extra)==null?void 0:a.metadata)??{},name:t,runType:r,inputs:e.inputs};this.runInfoMap.set(e.id,i);const s=`on_${r}_start`;await this.send({event:s,data:{input:e.inputs},name:t,tags:e.tags??[],run_id:e.id,metadata:((o=e.extra)==null?void 0:o.metadata)??{}},i)}async onLLMNewToken(e,t,r){const i=this.runInfoMap.get(e.id);let s,a;if(i===void 0)throw new Error(`onLLMNewToken: Run ID ${e.id} not found in run map.`);if(this.runInfoMap.size!==1){if(i.runType==="chat_model")a="on_chat_model_stream",(r==null?void 0:r.chunk)===void 0?s=new pr({content:t,id:`run-${e.id}`}):s=r.chunk.message;else if(i.runType==="llm")a="on_llm_stream",(r==null?void 0:r.chunk)===void 0?s=new pp({text:t}):s=r.chunk;else throw new Error(`Unexpected run type ${i.runType}`);await this.send({event:a,data:{chunk:s},run_id:e.id,name:i.name,tags:i.tags,metadata:i.metadata},i)}}async onLLMEnd(e){var a,o,l;const t=this.runInfoMap.get(e.id);this.runInfoMap.delete(e.id);let r;if(t===void 0)throw new Error(`onLLMEnd: Run ID ${e.id} not found in run map.`);const i=(a=e.outputs)==null?void 0:a.generations;let s;if(t.runType==="chat_model"){for(const c of i??[]){if(s!==void 0)break;s=(o=c[0])==null?void 0:o.message}r="on_chat_model_end"}else if(t.runType==="llm")s={generations:i==null?void 0:i.map(c=>c.map(u=>({text:u.text,generationInfo:u.generationInfo}))),llmOutput:((l=e.outputs)==null?void 0:l.llmOutput)??{}},r="on_llm_end";else throw new Error(`onLLMEnd: Unexpected run type: ${t.runType}`);await this.sendEndEvent({event:r,data:{output:s,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async onChainStart(e){var a,o;const t=dg(e),r=e.run_type??"chain",i={tags:e.tags??[],metadata:((a=e.extra)==null?void 0:a.metadata)??{},name:t,runType:e.run_type};let s={};e.inputs.input===""&&Object.keys(e.inputs).length===1?(s={},i.inputs={}):e.inputs.input!==void 0?(s.input=e.inputs.input,i.inputs=e.inputs.input):(s.input=e.inputs,i.inputs=e.inputs),this.runInfoMap.set(e.id,i),await this.send({event:`on_${r}_start`,data:s,name:t,tags:e.tags??[],run_id:e.id,metadata:((o=e.extra)==null?void 0:o.metadata)??{}},i)}async onChainEnd(e){var o;const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onChainEnd: Run ID ${e.id} not found in run map.`);const r=`on_${e.run_type}_end`,i=e.inputs??t.inputs??{},a={output:((o=e.outputs)==null?void 0:o.output)??e.outputs,input:i};i.input&&Object.keys(i).length===1&&(a.input=i.input,t.inputs=i.input),await this.sendEndEvent({event:r,data:a,run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata??{}},t)}async onToolStart(e){var i,s;const t=dg(e),r={tags:e.tags??[],metadata:((i=e.extra)==null?void 0:i.metadata)??{},name:t,runType:"tool",inputs:e.inputs??{}};this.runInfoMap.set(e.id,r),await this.send({event:"on_tool_start",data:{input:e.inputs??{}},name:t,run_id:e.id,tags:e.tags??[],metadata:((s=e.extra)==null?void 0:s.metadata)??{}},r)}async onToolEnd(e){var i;const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onToolEnd: Run ID ${e.id} not found in run map.`);if(t.inputs===void 0)throw new Error(`onToolEnd: Run ID ${e.id} is a tool call, and is expected to have traced inputs.`);const r=((i=e.outputs)==null?void 0:i.output)===void 0?e.outputs:e.outputs.output;await this.sendEndEvent({event:"on_tool_end",data:{output:r,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async onRetrieverStart(e){var s,a;const t=dg(e),i={tags:e.tags??[],metadata:((s=e.extra)==null?void 0:s.metadata)??{},name:t,runType:"retriever",inputs:{query:e.inputs.query}};this.runInfoMap.set(e.id,i),await this.send({event:"on_retriever_start",data:{input:{query:e.inputs.query}},name:t,tags:e.tags??[],run_id:e.id,metadata:((a=e.extra)==null?void 0:a.metadata)??{}},i)}async onRetrieverEnd(e){var r;const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onRetrieverEnd: Run ID ${e.id} not found in run map.`);await this.sendEndEvent({event:"on_retriever_end",data:{output:((r=e.outputs)==null?void 0:r.documents)??e.outputs,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async handleCustomEvent(e,t,r){const i=this.runInfoMap.get(r);if(i===void 0)throw new Error(`handleCustomEvent: Run ID ${r} not found in run map.`);await this.send({event:"on_custom_event",run_id:r,name:e,tags:i.tags,metadata:i.metadata,data:t},i)}async finish(){const e=[...this.tappedPromises.values()];Promise.all(e).finally(()=>{this.writer.close()})}}const vb=25;async function ns(n){return si._configureSync(n==null?void 0:n.callbacks,void 0,n==null?void 0:n.tags,void 0,n==null?void 0:n.metadata)}function RR(...n){const e={};for(const t of n.filter(r=>!!r))for(const r of Object.keys(t))if(r==="metadata")e[r]={...e[r],...t[r]};else if(r==="tags"){const i=e[r]??[];e[r]=[...new Set(i.concat(t[r]??[]))]}else if(r==="configurable")e[r]={...e[r],...t[r]};else if(r==="timeout")e.timeout===void 0?e.timeout=t.timeout:t.timeout!==void 0&&(e.timeout=Math.min(e.timeout,t.timeout));else if(r==="signal")e.signal===void 0?e.signal=t.signal:t.signal!==void 0&&("any"in AbortSignal?e.signal=AbortSignal.any([e.signal,t.signal]):e.signal=t.signal);else if(r==="callbacks"){const i=e.callbacks,s=t.callbacks;if(Array.isArray(s))if(!i)e.callbacks=s;else if(Array.isArray(i))e.callbacks=i.concat(s);else{const a=i.copy();for(const o of s)a.addHandler(P0(o),!0);e.callbacks=a}else if(s)if(!i)e.callbacks=s;else if(Array.isArray(i)){const a=s.copy();for(const o of i)a.addHandler(P0(o),!0);e.callbacks=a}else e.callbacks=new si(s._parentRunId,{handlers:i.handlers.concat(s.handlers),inheritableHandlers:i.inheritableHandlers.concat(s.inheritableHandlers),tags:Array.from(new Set(i.tags.concat(s.tags))),inheritableTags:Array.from(new Set(i.inheritableTags.concat(s.inheritableTags))),metadata:{...i.metadata,...s.metadata}})}else{const i=r;e[i]=t[i]??e[i]}return e}const pre=new Set(["string","number","boolean"]);function Nt(n){var r;const e=fc.getRunnableConfig();let t={tags:[],metadata:{},recursionLimit:25,runId:void 0};if(e){const{runId:i,runName:s,...a}=e;t=Object.entries(a).reduce((o,[l,c])=>(c!==void 0&&(o[l]=c),o),t)}if(n&&(t=Object.entries(n).reduce((i,[s,a])=>(a!==void 0&&(i[s]=a),i),t)),t!=null&&t.configurable)for(const i of Object.keys(t.configurable))pre.has(typeof t.configurable[i])&&!((r=t.metadata)!=null&&r[i])&&(t.metadata||(t.metadata={}),t.metadata[i]=t.configurable[i]);if(t.timeout!==void 0){if(t.timeout<=0)throw new Error("Timeout must be a positive number");const i=AbortSignal.timeout(t.timeout);t.signal!==void 0?"any"in AbortSignal&&(t.signal=AbortSignal.any([t.signal,i])):t.signal=i,delete t.timeout}return t}function tr(n={},{callbacks:e,maxConcurrency:t,recursionLimit:r,runName:i,configurable:s,runId:a}={}){const o=Nt(n);return e!==void 0&&(delete o.runName,o.callbacks=e),r!==void 0&&(o.recursionLimit=r),t!==void 0&&(o.maxConcurrency=t),i!==void 0&&(o.runName=i),s!==void 0&&(o.configurable={...o.configurable,...s}),a!==void 0&&delete o.runId,o}const mre=[400,401,402,403,404,405,406,407,409],gre=n=>{var t,r;if(n.message.startsWith("Cancel")||n.message.startsWith("AbortError")||n.name==="AbortError"||(n==null?void 0:n.code)==="ECONNABORTED")throw n;const e=((t=n==null?void 0:n.response)==null?void 0:t.status)??(n==null?void 0:n.status);if(e&&mre.includes(+e))throw n;if(((r=n==null?void 0:n.error)==null?void 0:r.code)==="insufficient_quota"){const i=new Error(n==null?void 0:n.message);throw i.name="InsufficientQuotaError",i}};class WT{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.onFailedAttempt=e.onFailedAttempt??gre;const t="default"in Ea?Ea.default:Ea;this.queue=new t({concurrency:this.maxConcurrency})}call(e,...t){return this.queue.add(()=>S0(()=>e(...t).catch(r=>{throw r instanceof Error?r:new Error(r)}),{onFailedAttempt:this.onFailedAttempt,retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...r){return e.signal?Promise.race([this.call(t,...r),new Promise((i,s)=>{var a;(a=e.signal)==null||a.addEventListener("abort",()=>{s(new Error("AbortError"))})})]):this.call(t,...r)}fetch(...e){return this.call(()=>fetch(...e).then(t=>t.ok?t:Promise.reject(t)))}}class zF extends Zp{constructor({config:e,onStart:t,onEnd:r,onError:i}){super({_awaitHandler:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RootListenersTracer"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnStart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnEnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.config=e,this.argOnStart=t,this.argOnEnd=r,this.argOnError=i}persistRun(e){return Promise.resolve()}async onRunCreate(e){this.rootId||(this.rootId=e.id,this.argOnStart&&(this.argOnStart.length===1?await this.argOnStart(e):this.argOnStart.length===2&&await this.argOnStart(e,this.config)))}async onRunUpdate(e){e.id===this.rootId&&(e.error?this.argOnError&&(this.argOnError.length===1?await this.argOnError(e):this.argOnError.length===2&&await this.argOnError(e,this.config)):this.argOnEnd&&(this.argOnEnd.length===1?await this.argOnEnd(e):this.argOnEnd.length===2&&await this.argOnEnd(e,this.config)))}}function GT(n){return n?n.lc_runnable:!1}class yre{constructor(e){Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.includeNames=e.includeNames,this.includeTypes=e.includeTypes,this.includeTags=e.includeTags,this.excludeNames=e.excludeNames,this.excludeTypes=e.excludeTypes,this.excludeTags=e.excludeTags}includeEvent(e,t){let r=this.includeNames===void 0&&this.includeTypes===void 0&&this.includeTags===void 0;const i=e.tags??[];return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(t)),this.includeTags!==void 0&&(r=r||i.some(s=>{var a;return(a=this.includeTags)==null?void 0:a.includes(s)})),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(t)),this.excludeTags!==void 0&&(r=r&&i.every(s=>{var a;return!((a=this.excludeTags)!=null&&a.includes(s))})),r}}const vre=Symbol("Let zodToJsonSchema decide on which parser to use"),xre={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},_re=n=>({...xre,...n}),bre=n=>{const e=_re(n),t=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:t,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([r,i])=>[i._def,{def:i._def,path:[...e.basePath,e.definitionPath,r],jsonSchema:void 0}]))}};function $F(n,e,t,r){r!=null&&r.errorMessages&&t&&(n.errorMessage={...n.errorMessage,[e]:t})}function Dt(n,e,t,r,i){n[e]=t,$F(n,e,r,i)}function wre(){return{}}function Sre(n,e){var r,i,s;const t={type:"array"};return(r=n.type)!=null&&r._def&&((s=(i=n.type)==null?void 0:i._def)==null?void 0:s.typeName)!==we.ZodAny&&(t.items=Pt(n.type._def,{...e,currentPath:[...e.currentPath,"items"]})),n.minLength&&Dt(t,"minItems",n.minLength.value,n.minLength.message,e),n.maxLength&&Dt(t,"maxItems",n.maxLength.value,n.maxLength.message,e),n.exactLength&&(Dt(t,"minItems",n.exactLength.value,n.exactLength.message,e),Dt(t,"maxItems",n.exactLength.value,n.exactLength.message,e)),t}function Ere(n,e){const t={type:"integer",format:"int64"};if(!n.checks)return t;for(const r of n.checks)switch(r.kind){case"min":e.target==="jsonSchema7"?r.inclusive?Dt(t,"minimum",r.value,r.message,e):Dt(t,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(t.exclusiveMinimum=!0),Dt(t,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Dt(t,"maximum",r.value,r.message,e):Dt(t,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(t.exclusiveMaximum=!0),Dt(t,"maximum",r.value,r.message,e));break;case"multipleOf":Dt(t,"multipleOf",r.value,r.message,e);break}return t}function Tre(){return{type:"boolean"}}function VF(n,e){return Pt(n.type._def,e)}const Mre=(n,e)=>Pt(n.innerType._def,e);function HF(n,e,t){const r=t??e.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((i,s)=>HF(n,e,i))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return kre(n,e)}}const kre=(n,e)=>{const t={type:"integer",format:"unix-time"};if(e.target==="openApi3")return t;for(const r of n.checks)switch(r.kind){case"min":Dt(t,"minimum",r.value,r.message,e);break;case"max":Dt(t,"maximum",r.value,r.message,e);break}return t};function Are(n,e){return{...Pt(n.innerType._def,e),default:n.defaultValue()}}function Pre(n,e){return e.effectStrategy==="input"?Pt(n.schema._def,e):{}}function Cre(n){return{type:"string",enum:Array.from(n.values)}}const Rre=n=>"type"in n&&n.type==="string"?!1:"allOf"in n;function Nre(n,e){const t=[Pt(n.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),Pt(n.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(s=>!!s);let r=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const i=[];return t.forEach(s=>{if(Rre(s))i.push(...s.allOf),s.unevaluatedProperties===void 0&&(r=void 0);else{let a=s;if("additionalProperties"in s&&s.additionalProperties===!1){const{additionalProperties:o,...l}=s;a=l}else r=void 0;i.push(a)}}),i.length?{allOf:i,...r}:void 0}function Ore(n,e){const t=typeof n.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(n.value)?"array":"object"}:e.target==="openApi3"?{type:t==="bigint"?"integer":t,enum:[n.value]}:{type:t==="bigint"?"integer":t,const:n.value}}let xb;const Ii={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(xb===void 0&&(xb=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),xb),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function WF(n,e){const t={type:"string"};if(n.checks)for(const r of n.checks)switch(r.kind){case"min":Dt(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,r.value):r.value,r.message,e);break;case"max":Dt(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,r.value):r.value,r.message,e);break;case"email":switch(e.emailStrategy){case"format:email":ji(t,"email",r.message,e);break;case"format:idn-email":ji(t,"idn-email",r.message,e);break;case"pattern:zod":dr(t,Ii.email,r.message,e);break}break;case"url":ji(t,"uri",r.message,e);break;case"uuid":ji(t,"uuid",r.message,e);break;case"regex":dr(t,r.regex,r.message,e);break;case"cuid":dr(t,Ii.cuid,r.message,e);break;case"cuid2":dr(t,Ii.cuid2,r.message,e);break;case"startsWith":dr(t,RegExp(`^${_b(r.value,e)}`),r.message,e);break;case"endsWith":dr(t,RegExp(`${_b(r.value,e)}$`),r.message,e);break;case"datetime":ji(t,"date-time",r.message,e);break;case"date":ji(t,"date",r.message,e);break;case"time":ji(t,"time",r.message,e);break;case"duration":ji(t,"duration",r.message,e);break;case"length":Dt(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,r.value):r.value,r.message,e),Dt(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,r.value):r.value,r.message,e);break;case"includes":{dr(t,RegExp(_b(r.value,e)),r.message,e);break}case"ip":{r.version!=="v6"&&ji(t,"ipv4",r.message,e),r.version!=="v4"&&ji(t,"ipv6",r.message,e);break}case"base64url":dr(t,Ii.base64url,r.message,e);break;case"jwt":dr(t,Ii.jwt,r.message,e);break;case"cidr":{r.version!=="v6"&&dr(t,Ii.ipv4Cidr,r.message,e),r.version!=="v4"&&dr(t,Ii.ipv6Cidr,r.message,e);break}case"emoji":dr(t,Ii.emoji(),r.message,e);break;case"ulid":{dr(t,Ii.ulid,r.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{ji(t,"binary",r.message,e);break}case"contentEncoding:base64":{Dt(t,"contentEncoding","base64",r.message,e);break}case"pattern:zod":{dr(t,Ii.base64,r.message,e);break}}break}case"nanoid":dr(t,Ii.nanoid,r.message,e)}return t}function _b(n,e){return e.patternStrategy==="escape"?Dre(n):n}const Lre=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function Dre(n){let e="";for(let t=0;t<n.length;t++)Lre.has(n[t])||(e+="\\"),e+=n[t];return e}function ji(n,e,t,r){var i;n.format||(i=n.anyOf)!=null&&i.some(s=>s.format)?(n.anyOf||(n.anyOf=[]),n.format&&(n.anyOf.push({format:n.format,...n.errorMessage&&r.errorMessages&&{errorMessage:{format:n.errorMessage.format}}}),delete n.format,n.errorMessage&&(delete n.errorMessage.format,Object.keys(n.errorMessage).length===0&&delete n.errorMessage)),n.anyOf.push({format:e,...t&&r.errorMessages&&{errorMessage:{format:t}}})):Dt(n,"format",e,t,r)}function dr(n,e,t,r){var i;n.pattern||(i=n.allOf)!=null&&i.some(s=>s.pattern)?(n.allOf||(n.allOf=[]),n.pattern&&(n.allOf.push({pattern:n.pattern,...n.errorMessage&&r.errorMessages&&{errorMessage:{pattern:n.errorMessage.pattern}}}),delete n.pattern,n.errorMessage&&(delete n.errorMessage.pattern,Object.keys(n.errorMessage).length===0&&delete n.errorMessage)),n.allOf.push({pattern:NR(e,r),...t&&r.errorMessages&&{errorMessage:{pattern:t}}})):Dt(n,"pattern",NR(e,r),t,r)}function NR(n,e){var l;if(!e.applyRegexFlags||!n.flags)return n.source;const t={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},r=t.i?n.source.toLowerCase():n.source;let i="",s=!1,a=!1,o=!1;for(let c=0;c<r.length;c++){if(s){i+=r[c],s=!1;continue}if(t.i){if(a){if(r[c].match(/[a-z]/)){o?(i+=r[c],i+=`${r[c-2]}-${r[c]}`.toUpperCase(),o=!1):r[c+1]==="-"&&((l=r[c+2])!=null&&l.match(/[a-z]/))?(i+=r[c],o=!0):i+=`${r[c]}${r[c].toUpperCase()}`;continue}}else if(r[c].match(/[a-z]/)){i+=`[${r[c]}${r[c].toUpperCase()}]`;continue}}if(t.m){if(r[c]==="^"){i+=`(^|(?<=[\r
]))`;continue}else if(r[c]==="$"){i+=`($|(?=[\r
]))`;continue}}if(t.s&&r[c]==="."){i+=a?`${r[c]}\r
`:`[${r[c]}\r
]`;continue}i+=r[c],r[c]==="\\"?s=!0:a&&r[c]==="]"?a=!1:!a&&r[c]==="["&&(a=!0)}try{new RegExp(i)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return i}function GF(n,e){var r,i,s,a,o,l;if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&((r=n.keyType)==null?void 0:r._def.typeName)===we.ZodEnum)return{type:"object",required:n.keyType._def.values,properties:n.keyType._def.values.reduce((c,u)=>({...c,[u]:Pt(n.valueType._def,{...e,currentPath:[...e.currentPath,"properties",u]})??{}}),{}),additionalProperties:!1};const t={type:"object",additionalProperties:Pt(n.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return t;if(((i=n.keyType)==null?void 0:i._def.typeName)===we.ZodString&&((s=n.keyType._def.checks)!=null&&s.length)){const{type:c,...u}=WF(n.keyType._def,e);return{...t,propertyNames:u}}else{if(((a=n.keyType)==null?void 0:a._def.typeName)===we.ZodEnum)return{...t,propertyNames:{enum:n.keyType._def.values}};if(((o=n.keyType)==null?void 0:o._def.typeName)===we.ZodBranded&&n.keyType._def.type._def.typeName===we.ZodString&&((l=n.keyType._def.type._def.checks)!=null&&l.length)){const{type:c,...u}=VF(n.keyType._def,e);return{...t,propertyNames:u}}}return t}function Ire(n,e){if(e.mapStrategy==="record")return GF(n,e);const t=Pt(n.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},r=Pt(n.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[t,r],minItems:2,maxItems:2}}}function jre(n){const e=n.values,r=Object.keys(n.values).filter(s=>typeof e[e[s]]!="number").map(s=>e[s]),i=Array.from(new Set(r.map(s=>typeof s)));return{type:i.length===1?i[0]==="string"?"string":"number":["string","number"],enum:r}}function Fre(){return{not:{}}}function Ure(n){return n.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const C0={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Bre(n,e){if(e.target==="openApi3")return OR(n,e);const t=n.options instanceof Map?Array.from(n.options.values()):n.options;if(t.every(r=>r._def.typeName in C0&&(!r._def.checks||!r._def.checks.length))){const r=t.reduce((i,s)=>{const a=C0[s._def.typeName];return a&&!i.includes(a)?[...i,a]:i},[]);return{type:r.length>1?r:r[0]}}else if(t.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=t.reduce((i,s)=>{const a=typeof s._def.value;switch(a){case"string":case"number":case"boolean":return[...i,a];case"bigint":return[...i,"integer"];case"object":if(s._def.value===null)return[...i,"null"];case"symbol":case"undefined":case"function":default:return i}},[]);if(r.length===t.length){const i=r.filter((s,a,o)=>o.indexOf(s)===a);return{type:i.length>1?i:i[0],enum:t.reduce((s,a)=>s.includes(a._def.value)?s:[...s,a._def.value],[])}}}else if(t.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:t.reduce((r,i)=>[...r,...i._def.values.filter(s=>!r.includes(s))],[])};return OR(n,e)}const OR=(n,e)=>{const t=(n.options instanceof Map?Array.from(n.options.values()):n.options).map((r,i)=>Pt(r._def,{...e,currentPath:[...e.currentPath,"anyOf",`${i}`]})).filter(r=>!!r&&(!e.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return t.length?{anyOf:t}:void 0};function zre(n,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(n.innerType._def.typeName)&&(!n.innerType._def.checks||!n.innerType._def.checks.length))return e.target==="openApi3"?{type:C0[n.innerType._def.typeName],nullable:!0}:{type:[C0[n.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const r=Pt(n.innerType._def,{...e,currentPath:[...e.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const t=Pt(n.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return t&&{anyOf:[t,{type:"null"}]}}function $re(n,e){const t={type:"number"};if(!n.checks)return t;for(const r of n.checks)switch(r.kind){case"int":t.type="integer",$F(t,"type",r.message,e);break;case"min":e.target==="jsonSchema7"?r.inclusive?Dt(t,"minimum",r.value,r.message,e):Dt(t,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(t.exclusiveMinimum=!0),Dt(t,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Dt(t,"maximum",r.value,r.message,e):Dt(t,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(t.exclusiveMaximum=!0),Dt(t,"maximum",r.value,r.message,e));break;case"multipleOf":Dt(t,"multipleOf",r.value,r.message,e);break}return t}function Vre(n,e){return e.removeAdditionalStrategy==="strict"?n.catchall._def.typeName==="ZodNever"?n.unknownKeys!=="strict":Pt(n.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:n.catchall._def.typeName==="ZodNever"?n.unknownKeys==="passthrough":Pt(n.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function Hre(n,e){const t=e.target==="openAi",r={type:"object",...Object.entries(n.shape()).reduce((i,[s,a])=>{if(a===void 0||a._def===void 0)return i;let o=a.isOptional();o&&t&&(a instanceof es&&(a=a._def.innerType),a.isNullable()||(a=a.nullable()),o=!1);const l=Pt(a._def,{...e,currentPath:[...e.currentPath,"properties",s],propertyPath:[...e.currentPath,"properties",s]});return l===void 0?i:{properties:{...i.properties,[s]:l},required:o?i.required:[...i.required,s]}},{properties:{},required:[]}),additionalProperties:Vre(n,e)};return r.required.length||delete r.required,r}const Wre=(n,e)=>{var r;if(e.currentPath.toString()===((r=e.propertyPath)==null?void 0:r.toString()))return Pt(n.innerType._def,e);const t=Pt(n.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return t?{anyOf:[{not:{}},t]}:{}},Gre=(n,e)=>{if(e.pipeStrategy==="input")return Pt(n.in._def,e);if(e.pipeStrategy==="output")return Pt(n.out._def,e);const t=Pt(n.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),r=Pt(n.out._def,{...e,currentPath:[...e.currentPath,"allOf",t?"1":"0"]});return{allOf:[t,r].filter(i=>i!==void 0)}};function qre(n,e){return Pt(n.type._def,e)}function Xre(n,e){const r={type:"array",uniqueItems:!0,items:Pt(n.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return n.minSize&&Dt(r,"minItems",n.minSize.value,n.minSize.message,e),n.maxSize&&Dt(r,"maxItems",n.maxSize.value,n.maxSize.message,e),r}function Yre(n,e){return n.rest?{type:"array",minItems:n.items.length,items:n.items.map((t,r)=>Pt(t._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((t,r)=>r===void 0?t:[...t,r],[]),additionalItems:Pt(n.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:n.items.length,maxItems:n.items.length,items:n.items.map((t,r)=>Pt(t._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((t,r)=>r===void 0?t:[...t,r],[])}}function Kre(){return{not:{}}}function Zre(){return{}}const Jre=(n,e)=>Pt(n.innerType._def,e),Qre=(n,e,t)=>{switch(e){case we.ZodString:return WF(n,t);case we.ZodNumber:return $re(n,t);case we.ZodObject:return Hre(n,t);case we.ZodBigInt:return Ere(n,t);case we.ZodBoolean:return Tre();case we.ZodDate:return HF(n,t);case we.ZodUndefined:return Kre();case we.ZodNull:return Ure(t);case we.ZodArray:return Sre(n,t);case we.ZodUnion:case we.ZodDiscriminatedUnion:return Bre(n,t);case we.ZodIntersection:return Nre(n,t);case we.ZodTuple:return Yre(n,t);case we.ZodRecord:return GF(n,t);case we.ZodLiteral:return Ore(n,t);case we.ZodEnum:return Cre(n);case we.ZodNativeEnum:return jre(n);case we.ZodNullable:return zre(n,t);case we.ZodOptional:return Wre(n,t);case we.ZodMap:return Ire(n,t);case we.ZodSet:return Xre(n,t);case we.ZodLazy:return()=>n.getter()._def;case we.ZodPromise:return qre(n,t);case we.ZodNaN:case we.ZodNever:return Fre();case we.ZodEffects:return Pre(n,t);case we.ZodAny:return wre();case we.ZodUnknown:return Zre();case we.ZodDefault:return Are(n,t);case we.ZodBranded:return VF(n,t);case we.ZodReadonly:return Jre(n,t);case we.ZodCatch:return Mre(n,t);case we.ZodPipeline:return Gre(n,t);case we.ZodFunction:case we.ZodVoid:case we.ZodSymbol:return;default:return(r=>{})()}};function Pt(n,e,t=!1){var o;const r=e.seen.get(n);if(e.override){const l=(o=e.override)==null?void 0:o.call(e,n,e,r,t);if(l!==vre)return l}if(r&&!t){const l=eie(r,e);if(l!==void 0)return l}const i={def:n,path:e.currentPath,jsonSchema:void 0};e.seen.set(n,i);const s=Qre(n,n.typeName,e),a=typeof s=="function"?Pt(s(),e):s;if(a&&nie(n,e,a),e.postProcess){const l=e.postProcess(a,n,e);return i.jsonSchema=a,l}return i.jsonSchema=a,a}const eie=(n,e)=>{switch(e.$refStrategy){case"root":return{$ref:n.path.join("/")};case"relative":return{$ref:tie(e.currentPath,n.path)};case"none":case"seen":return n.path.length<e.currentPath.length&&n.path.every((t,r)=>e.currentPath[r]===t)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},tie=(n,e)=>{let t=0;for(;t<n.length&&t<e.length&&n[t]===e[t];t++);return[(n.length-t).toString(),...e.slice(t)].join("/")},nie=(n,e,t)=>(n.description&&(t.description=n.description,e.markdownDescription&&(t.markdownDescription=n.description)),t),R0=(n,e)=>{const t=bre(e),r=void 0,i=e==null?void 0:e.name,s=Pt(n._def,t,!1)??{},a=i===void 0?r?{...s,[t.definitionPath]:r}:s:{$ref:[...t.$refStrategy==="relative"?[]:t.basePath,t.definitionPath,i].join("/"),[t.definitionPath]:{...r,[i]:s}};return t.target==="jsonSchema7"?a.$schema="http://json-schema.org/draft-07/schema#":(t.target==="jsonSchema2019-09"||t.target==="openAi")&&(a.$schema="https://json-schema.org/draft/2019-09/schema#"),t.target==="openAi"&&("anyOf"in a||"oneOf"in a||"allOf"in a||"type"in a&&Array.isArray(a.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),a};function bb(n){return n.replace(/[^a-zA-Z-_0-9]/g,"_")}function rie(n,e){const t=e[n.source]??n.source,r=e[n.target]??n.target;return[t,r]}function iie(n){let e="";for(const[t,r]of Object.entries(n))e+=`	classDef ${t}class fill:${r};
`;return e}function sie(n,e,t){const{firstNodeLabel:r,lastNodeLabel:i,nodeColors:s,withStyles:a=!0,curveStyle:o="linear",wrapLabelNWords:l=9}=t??{};let c=a?`%%{init: {'flowchart': {'curve': '${o}'}}}%%
graph TD;
`:`graph TD;
`;if(a){const d="default",h={[d]:"{0}([{1}]):::otherclass"};r!==void 0&&(h[r]="{0}[{0}]:::startclass"),i!==void 0&&(h[i]="{0}[{0}]:::endclass");for(const p of Object.values(n)){const y=h[p]??h[d],v=bb(p),g=p.split(":"),m=g[g.length-1];c+=`	${y.replace(/\{0\}/g,v).replace(/\{1\}/g,m)};
`}}let u="";for(const d of e){const h=d.source.includes(":")?d.source.split(":")[0]:void 0,p=d.target.includes(":")?d.target.split(":")[0]:void 0;u!==""&&(u!==h||u!==p)&&(c+=`	end
`,u=""),u===""&&h!==void 0&&h===p&&(c=`	subgraph ${h}
`,u=h);const[y,v]=rie(d,n);let g="";if(d.data!==void 0){let m=d.data;const x=m.split(" ");x.length>l&&(m=x.reduce((_,b,w)=>(w%l===0&&_.push(""),_[_.length-1]+=` ${b}`,_),[]).join("<br>")),d.conditional?g=` -. ${m} .-> `:g=` -- ${m} --> `}else d.conditional?g=" -.-> ":g=" --> ";c+=`	${bb(y)}${g}${bb(v)};
`}return u!==""&&(c+=`end
`),a&&s!==void 0&&(c+=iie(s)),c}async function aie(n,e){let{backgroundColor:t="white"}=e??{};const r=btoa(n);t!==void 0&&(/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(t)||(t=`!${t}`));const i=`https://mermaid.ink/img/${r}?bgColor=${t}`,s=await fetch(i);if(!s.ok)throw new Error(["Failed to render the graph using the Mermaid.INK API.",`Status code: ${s.status}`,`Status text: ${s.statusText}`].join(`
`));return await s.blob()}const LR=42;function wb(n){if(E0(n.id))if(GT(n.data))try{let e=n.data.getName();return e=e.startsWith("Runnable")?e.slice(8):e,e.length>LR&&(e=`${e.substring(0,LR)}...`),e}catch{return n.data.getName()}else return n.data.name??"UnknownSchema";else return n.id}function oie(n){return GT(n.data)?{type:"runnable",data:{id:n.data.lc_id,name:n.data.getName()}}:{type:"schema",data:{...R0(n.data.schema),title:n.data.name}}}class qF{constructor(){Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"edges",{enumerable:!0,configurable:!0,writable:!0,value:[]})}toJSON(){const e={};return Object.values(this.nodes).forEach((t,r)=>{e[t.id]=E0(t.id)?r:t.id}),{nodes:Object.values(this.nodes).map(t=>({id:e[t.id],...oie(t)})),edges:this.edges.map(t=>{const r={source:e[t.source],target:e[t.target]};return typeof t.data<"u"&&(r.data=t.data),typeof t.conditional<"u"&&(r.conditional=t.conditional),r})}}addNode(e,t){if(t!==void 0&&this.nodes[t]!==void 0)throw new Error(`Node with id ${t} already exists`);const r=t||Qr(),i={id:r,data:e};return this.nodes[r]=i,i}removeNode(e){delete this.nodes[e.id],this.edges=this.edges.filter(t=>t.source!==e.id&&t.target!==e.id)}addEdge(e,t,r,i){if(this.nodes[e.id]===void 0)throw new Error(`Source node ${e.id} not in graph`);if(this.nodes[t.id]===void 0)throw new Error(`Target node ${t.id} not in graph`);const s={source:e.id,target:t.id,data:r,conditional:i};return this.edges.push(s),s}firstNode(){const e=new Set(this.edges.map(r=>r.target)),t=[];return Object.values(this.nodes).forEach(r=>{e.has(r.id)||t.push(r)}),t[0]}lastNode(){const e=new Set(this.edges.map(r=>r.source)),t=[];return Object.values(this.nodes).forEach(r=>{e.has(r.id)||t.push(r)}),t[0]}extend(e,t=""){let r=t;Object.values(e.nodes).map(c=>c.id).every(E0)&&(r="");const s=c=>r?`${r}:${c}`:c;Object.entries(e.nodes).forEach(([c,u])=>{this.nodes[s(c)]={...u,id:s(c)}});const a=e.edges.map(c=>({...c,source:s(c.source),target:s(c.target)}));this.edges=[...this.edges,...a];const o=e.firstNode(),l=e.lastNode();return[o?{id:s(o.id),data:o.data}:void 0,l?{id:s(l.id),data:l.data}:void 0]}trimFirstNode(){const e=this.firstNode();if(e){const t=this.edges.filter(r=>r.source===e.id);(Object.keys(this.nodes).length===1||t.length===1)&&this.removeNode(e)}}trimLastNode(){const e=this.lastNode();if(e){const t=this.edges.filter(r=>r.target===e.id);(Object.keys(this.nodes).length===1||t.length===1)&&this.removeNode(e)}}drawMermaid(e){const{withStyles:t,curveStyle:r,nodeColors:i={start:"#ffdfba",end:"#baffc9",other:"#fad7de"},wrapLabelNWords:s}=e??{},a={};for(const d of Object.values(this.nodes))a[d.id]=wb(d);const o=this.firstNode(),l=o?wb(o):void 0,c=this.lastNode(),u=c?wb(c):void 0;return sie(a,this.edges,{firstNodeLabel:l,lastNodeLabel:u,withStyles:t,curveStyle:r,nodeColors:i,wrapLabelNWords:s})}async drawMermaidPng(e){const t=this.drawMermaid(e);return aie(t,{backgroundColor:e==null?void 0:e.backgroundColor})}}function lie(n){const e=new TextEncoder,t=new ReadableStream({async start(r){for await(const i of n)r.enqueue(e.encode(`event: data
data: ${JSON.stringify(i)}

`));r.enqueue(e.encode(`event: end

`)),r.close()}});return li.fromReadableStream(t)}function DR(n){return typeof n=="object"&&n!==null&&typeof n[Symbol.iterator]=="function"&&typeof n.next=="function"}const cie=n=>n!=null&&typeof n=="object"&&"next"in n&&typeof n.next=="function";function n1(n){return typeof n=="object"&&n!==null&&typeof n[Symbol.asyncIterator]=="function"}function*IR(n,e){for(;;){const{value:t,done:r}=fc.runWithConfig(n,e.next.bind(e),!0);if(r)break;yield t}}async function*jR(n,e){const t=e[Symbol.asyncIterator]();for(;;){const{value:r,done:i}=await fc.runWithConfig(n,t.next.bind(e),!0);if(i)break;yield r}}function On(n,e){return n&&!Array.isArray(n)&&!(n instanceof Date)&&typeof n=="object"?n:{[e]:n}}class _n extends lc{constructor(){super(...arguments),Object.defineProperty(this,"lc_runnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getName(e){const t=this.name??this.constructor.lc_name()??this.constructor.name;return e?`${t}${e}`:t}bind(e){return new Jl({bound:this,kwargs:e,config:{}})}map(){return new N0({bound:this})}withRetry(e){return new uie({bound:this,kwargs:{},config:{},maxAttemptNumber:e==null?void 0:e.stopAfterAttempt,...e})}withConfig(e){return new Jl({bound:this,config:e,kwargs:{}})}withFallbacks(e){const t=Array.isArray(e)?e:e.fallbacks;return new hie({runnable:this,fallbacks:t})}_getOptionsList(e,t=0){if(Array.isArray(e)&&e.length!==t)throw new Error(`Passed "options" must be an array with the same length as the inputs, but got ${e.length} options for ${t} inputs`);if(Array.isArray(e))return e.map(Nt);if(t>1&&!Array.isArray(e)&&e.runId){console.warn("Provided runId will be used only for the first element of the batch.");const r=Object.fromEntries(Object.entries(e).filter(([i])=>i!=="runId"));return Array.from({length:t},(i,s)=>Nt(s===0?e:r))}return Array.from({length:t},()=>Nt(e))}async batch(e,t,r){var l;const i=this._getOptionsList(t??{},e.length),s=((l=i[0])==null?void 0:l.maxConcurrency)??(r==null?void 0:r.maxConcurrency),a=new WT({maxConcurrency:s,onFailedAttempt:c=>{throw c}}),o=e.map((c,u)=>a.call(async()=>{try{return await this.invoke(c,i[u])}catch(d){if(r!=null&&r.returnExceptions)return d;throw d}}));return Promise.all(o)}async*_streamIterator(e,t){yield this.invoke(e,t)}async stream(e,t){const r=Nt(t),i=new Od({generator:this._streamIterator(e,r),config:r});return await i.setup,li.fromAsyncGenerator(i)}_separateRunnableConfigFromCallOptions(e){let t;e===void 0?t=Nt(e):t=Nt({callbacks:e.callbacks,tags:e.tags,metadata:e.metadata,runName:e.runName,configurable:e.configurable,recursionLimit:e.recursionLimit,maxConcurrency:e.maxConcurrency,runId:e.runId,timeout:e.timeout,signal:e.signal});const r={...e};return delete r.callbacks,delete r.tags,delete r.metadata,delete r.runName,delete r.configurable,delete r.recursionLimit,delete r.maxConcurrency,delete r.runId,delete r.timeout,delete r.signal,[t,r]}async _callWithConfig(e,t,r){const i=Nt(r),s=await ns(i),a=await(s==null?void 0:s.handleChainStart(this.toJSON(),On(t,"input"),i.runId,i==null?void 0:i.runType,void 0,void 0,(i==null?void 0:i.runName)??this.getName()));delete i.runId;let o;try{const l=e.call(this,t,i,a);o=await Go(l,r==null?void 0:r.signal)}catch(l){throw await(a==null?void 0:a.handleChainError(l)),l}return await(a==null?void 0:a.handleChainEnd(On(o,"output"))),o}async _batchWithConfig(e,t,r,i){var c;const s=this._getOptionsList(r??{},t.length),a=await Promise.all(s.map(ns)),o=await Promise.all(a.map(async(u,d)=>{const h=await(u==null?void 0:u.handleChainStart(this.toJSON(),On(t[d],"input"),s[d].runId,s[d].runType,void 0,void 0,s[d].runName??this.getName()));return delete s[d].runId,h}));let l;try{const u=e.call(this,t,s,o,i);l=await Go(u,(c=s==null?void 0:s[0])==null?void 0:c.signal)}catch(u){throw await Promise.all(o.map(d=>d==null?void 0:d.handleChainError(u))),u}return await Promise.all(o.map(u=>u==null?void 0:u.handleChainEnd(On(l,"output")))),l}async*_transformStreamWithConfig(e,t,r){let i,s=!0,a,o=!0;const l=Nt(r),c=await ns(l);async function*u(){for await(const h of e){if(s)if(i===void 0)i=h;else try{i=ts(i,h)}catch{i=void 0,s=!1}yield h}}let d;try{const h=await dre(t.bind(this),u(),async()=>c==null?void 0:c.handleChainStart(this.toJSON(),{input:""},l.runId,l.runType,void 0,void 0,l.runName??this.getName()),r==null?void 0:r.signal,l);delete l.runId,d=h.setup;const p=d==null?void 0:d.handlers.find(BF);let y=h.output;p!==void 0&&d!==void 0&&(y=p.tapOutputIterable(d.runId,y));const v=d==null?void 0:d.handlers.find(UF);v!==void 0&&d!==void 0&&(y=v.tapOutputIterable(d.runId,y));for await(const g of y)if(yield g,o)if(a===void 0)a=g;else try{a=ts(a,g)}catch{a=void 0,o=!1}}catch(h){throw await(d==null?void 0:d.handleChainError(h,void 0,void 0,void 0,{inputs:On(i,"input")})),h}await(d==null?void 0:d.handleChainEnd(a??{},void 0,void 0,void 0,{inputs:On(i,"input")}))}getGraph(e){const t=new qF,r=t.addNode({name:`${this.getName()}Input`,schema:df.any()}),i=t.addNode(this),s=t.addNode({name:`${this.getName()}Output`,schema:df.any()});return t.addEdge(r,i),t.addEdge(i,s),t}pipe(e){return new va({first:this,last:Bl(e)})}pick(e){return this.pipe(new fie(e))}assign(e){return this.pipe(new XF(new Ld({steps:e})))}async*transform(e,t){let r;for await(const i of e)r===void 0?r=i:r=ts(r,i);yield*this._streamIterator(r,Nt(t))}async*streamLog(e,t,r){const i=new PR({...r,autoClose:!1,_schemaFormat:"original"}),s=Nt(t);yield*this._streamLog(e,i,s)}async*_streamLog(e,t,r){const{callbacks:i}=r;if(i===void 0)r.callbacks=[t];else if(Array.isArray(i))r.callbacks=i.concat([t]);else{const l=i.copy();l.addHandler(t,!0),r.callbacks=l}const s=this.stream(e,r);async function a(){try{const l=await s;for await(const c of l){const u=new oo({ops:[{op:"add",path:"/streamed_output/-",value:c}]});await t.writer.write(u)}}finally{await t.writer.close()}}const o=a();try{for await(const l of t)yield l}finally{await o}}streamEvents(e,t,r){let i;if(t.version==="v1")i=this._streamEventsV1(e,t,r);else if(t.version==="v2")i=this._streamEventsV2(e,t,r);else throw new Error('Only versions "v1" and "v2" of the schema are currently supported.');return t.encoding==="text/event-stream"?lie(i):li.fromAsyncGenerator(i)}async*_streamEventsV2(e,t,r){var p;const i=new fre({...r,autoClose:!1}),s=Nt(t),a=s.runId??Qr();s.runId=a;const o=s.callbacks;if(o===void 0)s.callbacks=[i];else if(Array.isArray(o))s.callbacks=o.concat(i);else{const y=o.copy();y.addHandler(i,!0),s.callbacks=y}const l=this;async function c(){try{const y=await l.stream(e,s),v=i.tapOutputIterable(a,y);for await(const g of v);}finally{await i.finish()}}const u=c();let d=!1,h;try{for await(const y of i){if(!d){y.data.input=e,d=!0,h=y.run_id,yield y;continue}y.run_id===h&&y.event.endsWith("_end")&&(p=y.data)!=null&&p.input&&delete y.data.input,yield y}}finally{await u}}async*_streamEventsV1(e,t,r){let i,s=!1;const a=Nt(t),o=a.tags??[],l=a.metadata??{},c=a.runName??this.getName(),u=new PR({...r,autoClose:!1,_schemaFormat:"streaming_events"}),d=new yre({...r}),h=this._streamLog(e,u,a);for await(const y of h){if(i?i=i.concat(y):i=fp.fromRunLogPatch(y),i.state===void 0)throw new Error('Internal error: "streamEvents" state is missing. Please open a bug report.');if(!s){s=!0;const x={...i.state},_={run_id:x.id,event:`on_${x.type}_start`,name:c,tags:o,metadata:l,data:{input:e}};d.includeEvent(_,x.type)&&(yield _)}const v=y.ops.filter(x=>x.path.startsWith("/logs/")).map(x=>x.path.split("/")[2]),g=[...new Set(v)];for(const x of g){let _,b={};const w=i.state.logs[x];if(w.end_time===void 0?w.streamed_output.length>0?_="stream":_="start":_="end",_==="start")w.inputs!==void 0&&(b.input=w.inputs);else if(_==="end")w.inputs!==void 0&&(b.input=w.inputs),b.output=w.final_output;else if(_==="stream"){const E=w.streamed_output.length;if(E!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${E} instead. Encountered in: "${w.name}"`);b={chunk:w.streamed_output[0]},w.streamed_output=[]}yield{event:`on_${w.type}_${_}`,name:w.name,run_id:w.id,tags:w.tags,metadata:w.metadata,data:b}}const{state:m}=i;if(m.streamed_output.length>0){const x=m.streamed_output.length;if(x!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${x} instead. Encountered in: "${m.name}"`);const _={chunk:m.streamed_output[0]};m.streamed_output=[];const b={event:`on_${m.type}_stream`,run_id:m.id,tags:o,metadata:l,name:c,data:_};d.includeEvent(b,m.type)&&(yield b)}}const p=i==null?void 0:i.state;if(p!==void 0){const y={event:`on_${p.type}_end`,name:c,run_id:p.id,tags:o,metadata:l,data:{output:p.final_output}};d.includeEvent(y,p.type)&&(yield y)}}static isRunnable(e){return GT(e)}withListeners({onStart:e,onEnd:t,onError:r}){return new Jl({bound:this,config:{},configFactories:[i=>({callbacks:[new zF({config:i,onStart:e,onEnd:t,onError:r})]})]})}asTool(e){return pie(this,e)}}class Jl extends _n{static lc_name(){return"RunnableBinding"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"configFactories",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound,this.kwargs=e.kwargs,this.config=e.config,this.configFactories=e.configFactories}getName(e){return this.bound.getName(e)}async _mergeConfig(...e){const t=RR(this.config,...e);return RR(t,...this.configFactories?await Promise.all(this.configFactories.map(async r=>await r(t))):[])}bind(e){return new this.constructor({bound:this.bound,kwargs:{...this.kwargs,...e},config:this.config})}withConfig(e){return new this.constructor({bound:this.bound,kwargs:this.kwargs,config:{...this.config,...e}})}withRetry(e){return new this.constructor({bound:this.bound.withRetry(e),kwargs:this.kwargs,config:this.config})}async invoke(e,t){return this.bound.invoke(e,await this._mergeConfig(Nt(t),this.kwargs))}async batch(e,t,r){const i=Array.isArray(t)?await Promise.all(t.map(async s=>this._mergeConfig(Nt(s),this.kwargs))):await this._mergeConfig(Nt(t),this.kwargs);return this.bound.batch(e,i,r)}async*_streamIterator(e,t){yield*this.bound._streamIterator(e,await this._mergeConfig(Nt(t),this.kwargs))}async stream(e,t){return this.bound.stream(e,await this._mergeConfig(Nt(t),this.kwargs))}async*transform(e,t){yield*this.bound.transform(e,await this._mergeConfig(Nt(t),this.kwargs))}streamEvents(e,t,r){const i=this,s=async function*(){yield*i.bound.streamEvents(e,{...await i._mergeConfig(Nt(t),i.kwargs),version:t.version},r)};return li.fromAsyncGenerator(s())}static isRunnableBinding(e){return e.bound&&_n.isRunnable(e.bound)}withListeners({onStart:e,onEnd:t,onError:r}){return new Jl({bound:this.bound,kwargs:this.kwargs,config:this.config,configFactories:[i=>({callbacks:[new zF({config:i,onStart:e,onEnd:t,onError:r})]})]})}}class N0 extends _n{static lc_name(){return"RunnableEach"}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound}bind(e){return new N0({bound:this.bound.bind(e)})}async invoke(e,t){return this._callWithConfig(this._invoke,e,t)}async _invoke(e,t,r){return this.bound.batch(e,tr(t,{callbacks:r==null?void 0:r.getChild()}))}withListeners({onStart:e,onEnd:t,onError:r}){return new N0({bound:this.bound.withListeners({onStart:e,onEnd:t,onError:r})})}}class uie extends Jl{static lc_name(){return"RunnableRetry"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"maxAttemptNumber",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:()=>{}}),this.maxAttemptNumber=e.maxAttemptNumber??this.maxAttemptNumber,this.onFailedAttempt=e.onFailedAttempt??this.onFailedAttempt}_patchConfigForRetry(e,t,r){const i=e>1?`retry:attempt:${e}`:void 0;return tr(t,{callbacks:r==null?void 0:r.getChild(i)})}async _invoke(e,t,r){return S0(i=>super.invoke(e,this._patchConfigForRetry(i,t,r)),{onFailedAttempt:i=>this.onFailedAttempt(i,e),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}async invoke(e,t){return this._callWithConfig(this._invoke,e,t)}async _batch(e,t,r,i){const s={};try{await S0(async a=>{const o=e.map((h,p)=>p).filter(h=>s[h.toString()]===void 0||s[h.toString()]instanceof Error),l=o.map(h=>e[h]),c=o.map(h=>this._patchConfigForRetry(a,t==null?void 0:t[h],r==null?void 0:r[h])),u=await super.batch(l,c,{...i,returnExceptions:!0});let d;for(let h=0;h<u.length;h+=1){const p=u[h],y=o[h];p instanceof Error&&d===void 0&&(d=p,d.input=l[h]),s[y.toString()]=p}if(d)throw d;return u},{onFailedAttempt:a=>this.onFailedAttempt(a,a.input),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}catch(a){if((i==null?void 0:i.returnExceptions)!==!0)throw a}return Object.keys(s).sort((a,o)=>parseInt(a,10)-parseInt(o,10)).map(a=>s[parseInt(a,10)])}async batch(e,t,r){return this._batchWithConfig(this._batch.bind(this),e,t,r)}}class va extends _n{static lc_name(){return"RunnableSequence"}constructor(e){super(e),Object.defineProperty(this,"first",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"middle",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),this.first=e.first,this.middle=e.middle??this.middle,this.last=e.last,this.name=e.name}get steps(){return[this.first,...this.middle,this.last]}async invoke(e,t){var l;const r=Nt(t),i=await ns(r),s=await(i==null?void 0:i.handleChainStart(this.toJSON(),On(e,"input"),r.runId,void 0,void 0,void 0,r==null?void 0:r.runName));delete r.runId;let a=e,o;try{const c=[this.first,...this.middle];for(let u=0;u<c.length;u+=1){const h=c[u].invoke(a,tr(r,{callbacks:s==null?void 0:s.getChild(`seq:step:${u+1}`)}));a=await Go(h,t==null?void 0:t.signal)}if((l=t==null?void 0:t.signal)!=null&&l.aborted)throw new Error("Aborted");o=await this.last.invoke(a,tr(r,{callbacks:s==null?void 0:s.getChild(`seq:step:${this.steps.length}`)}))}catch(c){throw await(s==null?void 0:s.handleChainError(c)),c}return await(s==null?void 0:s.handleChainEnd(On(o,"output"))),o}async batch(e,t,r){var l;const i=this._getOptionsList(t??{},e.length),s=await Promise.all(i.map(ns)),a=await Promise.all(s.map(async(c,u)=>{const d=await(c==null?void 0:c.handleChainStart(this.toJSON(),On(e[u],"input"),i[u].runId,void 0,void 0,void 0,i[u].runName));return delete i[u].runId,d}));let o=e;try{for(let c=0;c<this.steps.length;c+=1){const d=this.steps[c].batch(o,a.map((h,p)=>{const y=h==null?void 0:h.getChild(`seq:step:${c+1}`);return tr(i[p],{callbacks:y})}),r);o=await Go(d,(l=i[0])==null?void 0:l.signal)}}catch(c){throw await Promise.all(a.map(u=>u==null?void 0:u.handleChainError(c))),c}return await Promise.all(a.map(c=>c==null?void 0:c.handleChainEnd(On(o,"output")))),o}async*_streamIterator(e,t){var d;const r=await ns(t),{runId:i,...s}=t??{},a=await(r==null?void 0:r.handleChainStart(this.toJSON(),On(e,"input"),i,void 0,void 0,void 0,s==null?void 0:s.runName)),o=[this.first,...this.middle,this.last];let l=!0,c;async function*u(){yield e}try{let h=o[0].transform(u(),tr(s,{callbacks:a==null?void 0:a.getChild("seq:step:1")}));for(let p=1;p<o.length;p+=1)h=await o[p].transform(h,tr(s,{callbacks:a==null?void 0:a.getChild(`seq:step:${p+1}`)}));for await(const p of h)if((d=t==null?void 0:t.signal)==null||d.throwIfAborted(),yield p,l)if(c===void 0)c=p;else try{c=ts(c,p)}catch{c=void 0,l=!1}}catch(h){throw await(a==null?void 0:a.handleChainError(h)),h}await(a==null?void 0:a.handleChainEnd(On(c,"output")))}getGraph(e){const t=new qF;let r=null;return this.steps.forEach((i,s)=>{const a=i.getGraph(e);s!==0&&a.trimFirstNode(),s!==this.steps.length-1&&a.trimLastNode(),t.extend(a);const o=a.firstNode();if(!o)throw new Error(`Runnable ${i} has no first node`);r&&t.addEdge(r,o),r=a.lastNode()}),t}pipe(e){return va.isRunnableSequence(e)?new va({first:this.first,middle:this.middle.concat([this.last,e.first,...e.middle]),last:e.last,name:this.name??e.name}):new va({first:this.first,middle:[...this.middle,this.last],last:Bl(e),name:this.name})}static isRunnableSequence(e){return Array.isArray(e.middle)&&_n.isRunnable(e)}static from([e,...t],r){return new va({first:Bl(e),middle:t.slice(0,-1).map(Bl),last:Bl(t[t.length-1]),name:r})}}class Ld extends _n{static lc_name(){return"RunnableMap"}getStepsKeys(){return Object.keys(this.steps)}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"steps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.steps={};for(const[t,r]of Object.entries(e.steps))this.steps[t]=Bl(r)}static from(e){return new Ld({steps:e})}async invoke(e,t){const r=Nt(t),i=await ns(r),s=await(i==null?void 0:i.handleChainStart(this.toJSON(),{input:e},r.runId,void 0,void 0,void 0,r==null?void 0:r.runName));delete r.runId;const a={};try{const o=Object.entries(this.steps).map(async([l,c])=>{a[l]=await c.invoke(e,tr(r,{callbacks:s==null?void 0:s.getChild(`map:key:${l}`)}))});await Go(Promise.all(o),t==null?void 0:t.signal)}catch(o){throw await(s==null?void 0:s.handleChainError(o)),o}return await(s==null?void 0:s.handleChainEnd(a)),a}async*_transform(e,t,r){const i={...this.steps},s=FF(e,Object.keys(i).length),a=new Map(Object.entries(i).map(([o,l],c)=>{const u=l.transform(s[c],tr(r,{callbacks:t==null?void 0:t.getChild(`map:key:${o}`)}));return[o,u.next().then(d=>({key:o,gen:u,result:d}))]}));for(;a.size;){const o=Promise.race(a.values()),{key:l,result:c,gen:u}=await Go(o,r==null?void 0:r.signal);a.delete(l),c.done||(yield{[l]:c.value},a.set(l,u.next().then(d=>({key:l,gen:u,result:d}))))}}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}const i=Nt(t),s=new Od({generator:this.transform(r(),i),config:i});return await s.setup,li.fromAsyncGenerator(s)}}class qT extends _n{constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!$T(e.func))throw new Error("RunnableTraceable requires a function that is wrapped in traceable higher-order function");this.func=e.func}async invoke(e,t){const[r]=this._getOptionsList(t??{},1),i=await ns(r),s=this.func(tr(r,{callbacks:i}),e);return Go(s,r==null?void 0:r.signal)}async*_streamIterator(e,t){var s,a;const[r]=this._getOptionsList(t??{},1),i=await this.invoke(e,t);if(n1(i)){for await(const o of i)(s=r==null?void 0:r.signal)==null||s.throwIfAborted(),yield o;return}if(cie(i)){for(;;){(a=r==null?void 0:r.signal)==null||a.throwIfAborted();const o=i.next();if(o.done)break;yield o.value}return}yield i}static from(e){return new qT({func:e})}}function die(n){if($T(n))throw new Error("RunnableLambda requires a function that is not wrapped in traceable higher-order function. This shouldn't happen.")}class Jp extends _n{static lc_name(){return"RunnableLambda"}constructor(e){if($T(e.func))return qT.from(e.func);super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),die(e.func),this.func=e.func}static from(e){return new Jp({func:e})}async _invoke(e,t,r){return new Promise((i,s)=>{const a=tr(t,{callbacks:r==null?void 0:r.getChild(),recursionLimit:((t==null?void 0:t.recursionLimit)??vb)-1});fc.runWithConfig(a,async()=>{var o,l;try{let c=await this.func(e,{...a,config:a});if(c&&_n.isRunnable(c)){if((t==null?void 0:t.recursionLimit)===0)throw new Error("Recursion limit reached.");c=await c.invoke(e,{...a,recursionLimit:(a.recursionLimit??vb)-1})}else if(n1(c)){let u;for await(const d of jR(a,c))if((o=t==null?void 0:t.signal)==null||o.throwIfAborted(),u===void 0)u=d;else try{u=ts(u,d)}catch{u=d}c=u}else if(DR(c)){let u;for(const d of IR(a,c))if((l=t==null?void 0:t.signal)==null||l.throwIfAborted(),u===void 0)u=d;else try{u=ts(u,d)}catch{u=d}c=u}i(c)}catch(c){s(c)}})})}async invoke(e,t){return this._callWithConfig(this._invoke,e,t)}async*_transform(e,t,r){var o,l;let i;for await(const c of e)if(i===void 0)i=c;else try{i=ts(i,c)}catch{i=c}const s=tr(r,{callbacks:t==null?void 0:t.getChild(),recursionLimit:((r==null?void 0:r.recursionLimit)??vb)-1}),a=await new Promise((c,u)=>{fc.runWithConfig(s,async()=>{try{const d=await this.func(i,{...s,config:s});c(d)}catch(d){u(d)}})});if(a&&_n.isRunnable(a)){if((r==null?void 0:r.recursionLimit)===0)throw new Error("Recursion limit reached.");const c=await a.stream(i,s);for await(const u of c)yield u}else if(n1(a))for await(const c of jR(s,a))(o=r==null?void 0:r.signal)==null||o.throwIfAborted(),yield c;else if(DR(a))for(const c of IR(s,a))(l=r==null?void 0:r.signal)==null||l.throwIfAborted(),yield c;else yield a}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}const i=Nt(t),s=new Od({generator:this.transform(r(),i),config:i});return await s.setup,li.fromAsyncGenerator(s)}}class hie extends _n{static lc_name(){return"RunnableWithFallbacks"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fallbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnable=e.runnable,this.fallbacks=e.fallbacks}*runnables(){yield this.runnable;for(const e of this.fallbacks)yield e}async invoke(e,t){var c;const r=Nt(t),i=await ns(t),{runId:s,...a}=r,o=await(i==null?void 0:i.handleChainStart(this.toJSON(),On(e,"input"),s,void 0,void 0,void 0,a==null?void 0:a.runName));let l;for(const u of this.runnables()){(c=r==null?void 0:r.signal)==null||c.throwIfAborted();try{const d=await u.invoke(e,tr(a,{callbacks:o==null?void 0:o.getChild()}));return await(o==null?void 0:o.handleChainEnd(On(d,"output"))),d}catch(d){l===void 0&&(l=d)}}throw l===void 0?new Error("No error stored at end of fallback."):(await(o==null?void 0:o.handleChainError(l)),l)}async*_streamIterator(e,t){var d;const r=Nt(t),i=await ns(t),{runId:s,...a}=r,o=await(i==null?void 0:i.handleChainStart(this.toJSON(),On(e,"input"),s,void 0,void 0,void 0,a==null?void 0:a.runName));let l,c;for(const h of this.runnables()){(d=r==null?void 0:r.signal)==null||d.throwIfAborted();const p=tr(a,{callbacks:o==null?void 0:o.getChild()});try{c=await h.stream(e,p);break}catch(y){l===void 0&&(l=y)}}if(c===void 0){const h=l??new Error("No error stored at end of fallback.");throw await(o==null?void 0:o.handleChainError(h)),h}let u;try{for await(const h of c){yield h;try{u=u===void 0?u:ts(u,h)}catch{u=void 0}}}catch(h){throw await(o==null?void 0:o.handleChainError(h)),h}await(o==null?void 0:o.handleChainEnd(On(u,"output")))}async batch(e,t,r){var l;if(r!=null&&r.returnExceptions)throw new Error("Not implemented.");const i=this._getOptionsList(t??{},e.length),s=await Promise.all(i.map(c=>ns(c))),a=await Promise.all(s.map(async(c,u)=>{const d=await(c==null?void 0:c.handleChainStart(this.toJSON(),On(e[u],"input"),i[u].runId,void 0,void 0,void 0,i[u].runName));return delete i[u].runId,d}));let o;for(const c of this.runnables()){(l=i[0].signal)==null||l.throwIfAborted();try{const u=await c.batch(e,a.map((d,h)=>tr(i[h],{callbacks:d==null?void 0:d.getChild()})),r);return await Promise.all(a.map((d,h)=>d==null?void 0:d.handleChainEnd(On(u[h],"output")))),u}catch(u){o===void 0&&(o=u)}}throw o?(await Promise.all(a.map(c=>c==null?void 0:c.handleChainError(o))),o):new Error("No error stored at end of fallbacks.")}}function Bl(n){if(typeof n=="function")return new Jp({func:n});if(_n.isRunnable(n))return n;if(!Array.isArray(n)&&typeof n=="object"){const e={};for(const[t,r]of Object.entries(n))e[t]=Bl(r);return new Ld({steps:e})}else throw new Error(`Expected a Runnable, function or object.
Instead got an unsupported type.`)}class XF extends _n{static lc_name(){return"RunnableAssign"}constructor(e){e instanceof Ld&&(e={mapper:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"mapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.mapper=e.mapper}async invoke(e,t){const r=await this.mapper.invoke(e,t);return{...e,...r}}async*_transform(e,t,r){const i=this.mapper.getStepsKeys(),[s,a]=FF(e),o=this.mapper.transform(a,tr(r,{callbacks:t==null?void 0:t.getChild()})),l=o.next();for await(const c of s){if(typeof c!="object"||Array.isArray(c))throw new Error(`RunnableAssign can only be used with objects as input, got ${typeof c}`);const u=Object.fromEntries(Object.entries(c).filter(([d])=>!i.includes(d)));Object.keys(u).length>0&&(yield u)}yield(await l).value;for await(const c of o)yield c}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}const i=Nt(t),s=new Od({generator:this.transform(r(),i),config:i});return await s.setup,li.fromAsyncGenerator(s)}}class fie extends _n{static lc_name(){return"RunnablePick"}constructor(e){(typeof e=="string"||Array.isArray(e))&&(e={keys:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"keys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keys=e.keys}async _pick(e){if(typeof this.keys=="string")return e[this.keys];{const t=this.keys.map(r=>[r,e[r]]).filter(r=>r[1]!==void 0);return t.length===0?void 0:Object.fromEntries(t)}}async invoke(e,t){return this._callWithConfig(this._pick.bind(this),e,t)}async*_transform(e){for await(const t of e){const r=await this._pick(t);r!==void 0&&(yield r)}}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}const i=Nt(t),s=new Od({generator:this.transform(r(),i),config:i});return await s.setup,li.fromAsyncGenerator(s)}}class FR extends Jl{constructor(e){const t=va.from([Jp.from(async r=>{let i;if(rF(r))try{i=await this.schema.parseAsync(r.args)}catch{throw new DZ("Received tool input did not match expected schema",JSON.stringify(r.args))}else i=r;return i}).withConfig({runName:`${e.name}:parse_input`}),e.bound]).withConfig({runName:e.name});super({bound:t,config:e.config??{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.description=e.description,this.schema=e.schema}static lc_name(){return"RunnableToolLike"}}function pie(n,e){var i;const t=e.name??n.getName(),r=e.description??((i=e.schema)==null?void 0:i.description);return e.schema.constructor===df.ZodString?new FR({name:t,description:r,schema:df.object({input:df.string()}).transform(s=>s.input),bound:n}):new FR({name:t,description:r,schema:e.schema,bound:n})}/*
 * [js-sha1]{@link https://github.com/emn178/js-sha1}
 *
 * @version 0.6.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */var mie=typeof window=="object"?window:{},st="0123456789abcdef".split(""),gie=[-2147483648,8388608,32768,128],Fi=[24,16,8,0],Pn=[];function ss(n){n?(Pn[0]=Pn[16]=Pn[1]=Pn[2]=Pn[3]=Pn[4]=Pn[5]=Pn[6]=Pn[7]=Pn[8]=Pn[9]=Pn[10]=Pn[11]=Pn[12]=Pn[13]=Pn[14]=Pn[15]=0,this.blocks=Pn):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}ss.prototype.update=function(n){if(!this.finalized){var e=typeof n!="string";e&&n.constructor===mie.ArrayBuffer&&(n=new Uint8Array(n));for(var t,r=0,i,s=n.length||0,a=this.blocks;r<s;){if(this.hashed&&(this.hashed=!1,a[0]=this.block,a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),e)for(i=this.start;r<s&&i<64;++r)a[i>>2]|=n[r]<<Fi[i++&3];else for(i=this.start;r<s&&i<64;++r)t=n.charCodeAt(r),t<128?a[i>>2]|=t<<Fi[i++&3]:t<2048?(a[i>>2]|=(192|t>>6)<<Fi[i++&3],a[i>>2]|=(128|t&63)<<Fi[i++&3]):t<55296||t>=57344?(a[i>>2]|=(224|t>>12)<<Fi[i++&3],a[i>>2]|=(128|t>>6&63)<<Fi[i++&3],a[i>>2]|=(128|t&63)<<Fi[i++&3]):(t=65536+((t&1023)<<10|n.charCodeAt(++r)&1023),a[i>>2]|=(240|t>>18)<<Fi[i++&3],a[i>>2]|=(128|t>>12&63)<<Fi[i++&3],a[i>>2]|=(128|t>>6&63)<<Fi[i++&3],a[i>>2]|=(128|t&63)<<Fi[i++&3]);this.lastByteIndex=i,this.bytes+=i-this.start,i>=64?(this.block=a[16],this.start=i-64,this.hash(),this.hashed=!0):this.start=i}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}};ss.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var n=this.blocks,e=this.lastByteIndex;n[16]=this.block,n[e>>2]|=gie[e&3],this.block=n[16],e>=56&&(this.hashed||this.hash(),n[0]=this.block,n[16]=n[1]=n[2]=n[3]=n[4]=n[5]=n[6]=n[7]=n[8]=n[9]=n[10]=n[11]=n[12]=n[13]=n[14]=n[15]=0),n[14]=this.hBytes<<3|this.bytes>>>29,n[15]=this.bytes<<3,this.hash()}};ss.prototype.hash=function(){var n=this.h0,e=this.h1,t=this.h2,r=this.h3,i=this.h4,s,a,o,l=this.blocks;for(a=16;a<80;++a)o=l[a-3]^l[a-8]^l[a-14]^l[a-16],l[a]=o<<1|o>>>31;for(a=0;a<20;a+=5)s=e&t|~e&r,o=n<<5|n>>>27,i=o+s+i+1518500249+l[a]<<0,e=e<<30|e>>>2,s=n&e|~n&t,o=i<<5|i>>>27,r=o+s+r+1518500249+l[a+1]<<0,n=n<<30|n>>>2,s=i&n|~i&e,o=r<<5|r>>>27,t=o+s+t+1518500249+l[a+2]<<0,i=i<<30|i>>>2,s=r&i|~r&n,o=t<<5|t>>>27,e=o+s+e+1518500249+l[a+3]<<0,r=r<<30|r>>>2,s=t&r|~t&i,o=e<<5|e>>>27,n=o+s+n+1518500249+l[a+4]<<0,t=t<<30|t>>>2;for(;a<40;a+=5)s=e^t^r,o=n<<5|n>>>27,i=o+s+i+1859775393+l[a]<<0,e=e<<30|e>>>2,s=n^e^t,o=i<<5|i>>>27,r=o+s+r+1859775393+l[a+1]<<0,n=n<<30|n>>>2,s=i^n^e,o=r<<5|r>>>27,t=o+s+t+1859775393+l[a+2]<<0,i=i<<30|i>>>2,s=r^i^n,o=t<<5|t>>>27,e=o+s+e+1859775393+l[a+3]<<0,r=r<<30|r>>>2,s=t^r^i,o=e<<5|e>>>27,n=o+s+n+1859775393+l[a+4]<<0,t=t<<30|t>>>2;for(;a<60;a+=5)s=e&t|e&r|t&r,o=n<<5|n>>>27,i=o+s+i-1894007588+l[a]<<0,e=e<<30|e>>>2,s=n&e|n&t|e&t,o=i<<5|i>>>27,r=o+s+r-1894007588+l[a+1]<<0,n=n<<30|n>>>2,s=i&n|i&e|n&e,o=r<<5|r>>>27,t=o+s+t-1894007588+l[a+2]<<0,i=i<<30|i>>>2,s=r&i|r&n|i&n,o=t<<5|t>>>27,e=o+s+e-1894007588+l[a+3]<<0,r=r<<30|r>>>2,s=t&r|t&i|r&i,o=e<<5|e>>>27,n=o+s+n-1894007588+l[a+4]<<0,t=t<<30|t>>>2;for(;a<80;a+=5)s=e^t^r,o=n<<5|n>>>27,i=o+s+i-899497514+l[a]<<0,e=e<<30|e>>>2,s=n^e^t,o=i<<5|i>>>27,r=o+s+r-899497514+l[a+1]<<0,n=n<<30|n>>>2,s=i^n^e,o=r<<5|r>>>27,t=o+s+t-899497514+l[a+2]<<0,i=i<<30|i>>>2,s=r^i^n,o=t<<5|t>>>27,e=o+s+e-899497514+l[a+3]<<0,r=r<<30|r>>>2,s=t^r^i,o=e<<5|e>>>27,n=o+s+n-899497514+l[a+4]<<0,t=t<<30|t>>>2;this.h0=this.h0+n<<0,this.h1=this.h1+e<<0,this.h2=this.h2+t<<0,this.h3=this.h3+r<<0,this.h4=this.h4+i<<0};ss.prototype.hex=function(){this.finalize();var n=this.h0,e=this.h1,t=this.h2,r=this.h3,i=this.h4;return st[n>>28&15]+st[n>>24&15]+st[n>>20&15]+st[n>>16&15]+st[n>>12&15]+st[n>>8&15]+st[n>>4&15]+st[n&15]+st[e>>28&15]+st[e>>24&15]+st[e>>20&15]+st[e>>16&15]+st[e>>12&15]+st[e>>8&15]+st[e>>4&15]+st[e&15]+st[t>>28&15]+st[t>>24&15]+st[t>>20&15]+st[t>>16&15]+st[t>>12&15]+st[t>>8&15]+st[t>>4&15]+st[t&15]+st[r>>28&15]+st[r>>24&15]+st[r>>20&15]+st[r>>16&15]+st[r>>12&15]+st[r>>8&15]+st[r>>4&15]+st[r&15]+st[i>>28&15]+st[i>>24&15]+st[i>>20&15]+st[i>>16&15]+st[i>>12&15]+st[i>>8&15]+st[i>>4&15]+st[i&15]};ss.prototype.toString=ss.prototype.hex;ss.prototype.digest=function(){this.finalize();var n=this.h0,e=this.h1,t=this.h2,r=this.h3,i=this.h4;return[n>>24&255,n>>16&255,n>>8&255,n&255,e>>24&255,e>>16&255,e>>8&255,e&255,t>>24&255,t>>16&255,t>>8&255,t&255,r>>24&255,r>>16&255,r>>8&255,r&255,i>>24&255,i>>16&255,i>>8&255,i&255]};ss.prototype.array=ss.prototype.digest;ss.prototype.arrayBuffer=function(){this.finalize();var n=new ArrayBuffer(20),e=new DataView(n);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),n};const yie=n=>new ss(!0).update(n).hex(),UR=(...n)=>yie(n.join("_"));class vie{}const xie=new Map;class XT extends vie{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,t){return Promise.resolve(this.cache.get(UR(e,t))??null)}async update(e,t,r){this.cache.set(UR(e,t),r)}static global(){return new XT(xie)}}class YT extends lc{}class YF extends YT{static lc_name(){return"StringPromptValue"}constructor(e){super({value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e}toString(){return this.value}toChatMessages(){return[new Ds(this.value)]}}class KF extends YT{static lc_name(){return"ChatPromptValue"}constructor(e){Array.isArray(e)&&(e={messages:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=e.messages}toString(){return iF(this.messages)}toChatMessages(){return this.messages}}class _ie extends YT{static lc_name(){return"ImagePromptValue"}constructor(e){"imageUrl"in e||(e={imageUrl:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"imageUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.imageUrl=e.imageUrl}toString(){return this.imageUrl.url}toChatMessages(){return[new Ds({content:[{type:"image_url",image_url:{detail:this.imageUrl.detail,url:this.imageUrl.url}}]})]}}var tx={};tx.byteLength=Sie;tx.toByteArray=Tie;tx.fromByteArray=Aie;var ks=[],bi=[],bie=typeof Uint8Array<"u"?Uint8Array:Array,Sb="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Kc=0,wie=Sb.length;Kc<wie;++Kc)ks[Kc]=Sb[Kc],bi[Sb.charCodeAt(Kc)]=Kc;bi[45]=62;bi[95]=63;function ZF(n){var e=n.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=n.indexOf("=");t===-1&&(t=e);var r=t===e?0:4-t%4;return[t,r]}function Sie(n){var e=ZF(n),t=e[0],r=e[1];return(t+r)*3/4-r}function Eie(n,e,t){return(e+t)*3/4-t}function Tie(n){var e,t=ZF(n),r=t[0],i=t[1],s=new bie(Eie(n,r,i)),a=0,o=i>0?r-4:r,l;for(l=0;l<o;l+=4)e=bi[n.charCodeAt(l)]<<18|bi[n.charCodeAt(l+1)]<<12|bi[n.charCodeAt(l+2)]<<6|bi[n.charCodeAt(l+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=e&255;return i===2&&(e=bi[n.charCodeAt(l)]<<2|bi[n.charCodeAt(l+1)]>>4,s[a++]=e&255),i===1&&(e=bi[n.charCodeAt(l)]<<10|bi[n.charCodeAt(l+1)]<<4|bi[n.charCodeAt(l+2)]>>2,s[a++]=e>>8&255,s[a++]=e&255),s}function Mie(n){return ks[n>>18&63]+ks[n>>12&63]+ks[n>>6&63]+ks[n&63]}function kie(n,e,t){for(var r,i=[],s=e;s<t;s+=3)r=(n[s]<<16&16711680)+(n[s+1]<<8&65280)+(n[s+2]&255),i.push(Mie(r));return i.join("")}function Aie(n){for(var e,t=n.length,r=t%3,i=[],s=16383,a=0,o=t-r;a<o;a+=s)i.push(kie(n,a,a+s>o?o:a+s));return r===1?(e=n[t-1],i.push(ks[e>>2]+ks[e<<4&63]+"==")):r===2&&(e=(n[t-2]<<8)+n[t-1],i.push(ks[e>>10]+ks[e>>4&63]+ks[e<<2&63]+"=")),i.join("")}var Pie=Object.defineProperty,Cie=(n,e,t)=>e in n?Pie(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Rie=(n,e,t)=>(Cie(n,e+"",t),t);function Nie(n,e){let t=Array.from({length:n.length},(r,i)=>({start:i,end:i+1}));for(;t.length>1;){let r=null;for(let i=0;i<t.length-1;i++){const s=n.slice(t[i].start,t[i+1].end),a=e.get(s.join(","));a!=null&&(r==null||a<r[0])&&(r=[a,i])}if(r!=null){const i=r[1];t[i]={start:t[i].start,end:t[i+1].end},t.splice(i+1,1)}else break}return t}function Oie(n,e){return n.length===1?[e.get(n.join(","))]:Nie(n,e).map(t=>e.get(n.slice(t.start,t.end).join(","))).filter(t=>t!=null)}function Lie(n){return n.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}var r1=class{constructor(n,e){Re(this,"specialTokens");Re(this,"inverseSpecialTokens");Re(this,"patStr");Re(this,"textEncoder",new TextEncoder);Re(this,"textDecoder",new TextDecoder("utf-8"));Re(this,"rankMap",new Map);Re(this,"textMap",new Map);this.patStr=n.pat_str;const t=n.bpe_ranks.split(`
`).filter(Boolean).reduce((r,i)=>{const[s,a,...o]=i.split(" "),l=Number.parseInt(a,10);return o.forEach((c,u)=>r[c]=l+u),r},{});for(const[r,i]of Object.entries(t)){const s=tx.toByteArray(r);this.rankMap.set(s.join(","),i),this.textMap.set(i,s)}this.specialTokens={...n.special_tokens,...e},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((r,[i,s])=>(r[s]=this.textEncoder.encode(i),r),{})}encode(n,e=[],t="all"){const r=new RegExp(this.patStr,"ug"),i=r1.specialTokenRegex(Object.keys(this.specialTokens)),s=[],a=new Set(e==="all"?Object.keys(this.specialTokens):e),o=new Set(t==="all"?Object.keys(this.specialTokens).filter(c=>!a.has(c)):t);if(o.size>0){const c=r1.specialTokenRegex([...o]),u=n.match(c);if(u!=null)throw new Error(`The text contains a special token that is not allowed: ${u[0]}`)}let l=0;for(;;){let c=null,u=l;for(;i.lastIndex=u,c=i.exec(n),!(c==null||a.has(c[0]));)u=c.index+1;const d=(c==null?void 0:c.index)??n.length;for(const p of n.substring(l,d).matchAll(r)){const y=this.textEncoder.encode(p[0]),v=this.rankMap.get(y.join(","));if(v!=null){s.push(v);continue}s.push(...Oie(y,this.rankMap))}if(c==null)break;let h=this.specialTokens[c[0]];s.push(h),l=c.index+c[0].length}return s}decode(n){const e=[];let t=0;for(let s=0;s<n.length;++s){const a=n[s],o=this.textMap.get(a)??this.inverseSpecialTokens[a];o!=null&&(e.push(o),t+=o.length)}const r=new Uint8Array(t);let i=0;for(const s of e)r.set(s,i),i+=s.length;return this.textDecoder.decode(r)}},JF=r1;Rie(JF,"specialTokenRegex",n=>new RegExp(n.map(e=>Lie(e)).join("|"),"g"));function Die(n){switch(n){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":case"text-embedding-3-small":case"text-embedding-3-large":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":case"gpt-4o-2024-11-20":case"gpt-4o-mini-2024-07-18":case"gpt-4o-mini":case"o1":case"o1-2024-12-17":case"o1-mini":case"o1-preview":case"o1-preview-2024-09-12":case"o1-mini-2024-09-12":case"o3-mini":case"o3-mini-2025-01-31":case"chatgpt-4o-latest":case"gpt-4o-realtime":case"gpt-4o-realtime-preview-2024-10-01":return"o200k_base";default:throw new Error("Unknown model")}}const hg={},Iie=new WT({});async function jie(n){return n in hg||(hg[n]=Iie.fetch(`https://tiktoken.pages.dev/js/${n}.json`).then(e=>e.json()).then(e=>new JF(e)).catch(e=>{throw delete hg[n],e})),await hg[n]}async function Fie(n){return jie(Die(n))}const Uie=n=>n.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":n.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":n.startsWith("gpt-4-32k")?"gpt-4-32k":n.startsWith("gpt-4-")?"gpt-4":n.startsWith("gpt-4o")?"gpt-4o":n;function Bie(n){return typeof n!="object"||!n?!1:!!("type"in n&&n.type==="function"&&"function"in n&&typeof n.function=="object"&&n.function&&"name"in n.function&&"parameters"in n.function)}const zie=()=>!1;class $ie extends _n{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??zie(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}}class Vie extends $ie{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:e,callbackManager:t,...r}){super({callbacks:e??t,...r}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof r.cache=="object"?this.cache=r.cache:r.cache?this.cache=XT.global():this.cache=void 0,this.caller=new WT(r??{})}async getNumTokens(e){if(typeof e!="string")return 0;let t=Math.ceil(e.length/4);if(!this._encoding)try{this._encoding=await Fie("modelName"in this?Uie(this.modelName):"gpt2")}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}if(this._encoding)try{t=this._encoding.encode(e).length}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}return t}static _convertInputToPromptValue(e){return typeof e=="string"?new YF(e):Array.isArray(e)?new KF(e.map(_o)):e}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall({config:e,...t}){const r={...this._identifyingParams(),...t,_type:this._llmType(),_model:this._modelType()};return Object.entries(r).filter(([a,o])=>o!==void 0).map(([a,o])=>`${a}:${JSON.stringify(o)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){throw new Error("Use .toJSON() instead")}}class O0 extends _n{static lc_name(){return"RunnablePassthrough"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e&&(this.func=e.func)}async invoke(e,t){const r=Nt(t);return this.func&&await this.func(e,r),this._callWithConfig(i=>Promise.resolve(i),e,r)}async*transform(e,t){const r=Nt(t);let i,s=!0;for await(const a of this._transformStreamWithConfig(e,o=>o,r))if(yield a,s)if(i===void 0)i=a;else try{i=ts(i,a)}catch{i=void 0,s=!1}this.func&&i!==void 0&&await this.func(i,r)}static assign(e){return new XF(new Ld({steps:e}))}}function KT(n){return typeof(n==null?void 0:n.parse)=="function"}class lo extends Vie{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]})}_separateRunnableConfigFromCallOptionsCompat(e){const[t,r]=super._separateRunnableConfigFromCallOptions(e);return r.signal=t.signal,[t,r]}async invoke(e,t){const r=lo._convertInputToPromptValue(e);return(await this.generatePrompt([r],t,t==null?void 0:t.callbacks)).generations[0][0].message}async*_streamResponseChunks(e,t,r){throw new Error("Not implemented.")}async*_streamIterator(e,t){var r;if(this._streamResponseChunks===lo.prototype._streamResponseChunks)yield this.invoke(e,t);else{const s=lo._convertInputToPromptValue(e).toChatMessages(),[a,o]=this._separateRunnableConfigFromCallOptionsCompat(t),l={...a.metadata,...this.getLsParams(o)},c=await si.configure(a.callbacks,this.callbacks,a.tags,this.tags,l,this.metadata,{verbose:this.verbose}),u={options:o,invocation_params:this==null?void 0:this.invocationParams(o),batch_size:1},d=await(c==null?void 0:c.handleChatModelStart(this.toJSON(),[s],a.runId,void 0,u,void 0,void 0,a.runName));let h;try{for await(const p of this._streamResponseChunks(s,o,d==null?void 0:d[0])){if(p.message.id==null){const y=(r=d==null?void 0:d.at(0))==null?void 0:r.runId;y!=null&&p.message._updateId(`run-${y}`)}p.message.response_metadata={...p.generationInfo,...p.message.response_metadata},yield p.message,h?h=h.concat(p):h=p}}catch(p){throw await Promise.all((d??[]).map(y=>y==null?void 0:y.handleLLMError(p))),p}await Promise.all((d??[]).map(p=>p==null?void 0:p.handleLLMEnd({generations:[[h]]})))}}getLsParams(e){return{ls_model_type:"chat",ls_stop:e.stop}}async _generateUncached(e,t,r){var p,y;const i=e.map(v=>v.map(_o)),s={...r.metadata,...this.getLsParams(t)},a=await si.configure(r.callbacks,this.callbacks,r.tags,this.tags,s,this.metadata,{verbose:this.verbose}),o={options:t,invocation_params:this==null?void 0:this.invocationParams(t),batch_size:1},l=await(a==null?void 0:a.handleChatModelStart(this.toJSON(),i,r.runId,void 0,o,void 0,void 0,r.runName)),c=[],u=[];if(!!(l!=null&&l[0].handlers.find(v=>BF(v)||UF(v)))&&i.length===1&&this._streamResponseChunks!==lo.prototype._streamResponseChunks)try{const v=await this._streamResponseChunks(i[0],t,l==null?void 0:l[0]);let g;for await(const m of v){if(m.message.id==null){const x=(p=l==null?void 0:l.at(0))==null?void 0:p.runId;x!=null&&m.message._updateId(`run-${x}`)}g===void 0?g=m:g=ts(g,m)}if(g===void 0)throw new Error("Received empty response from chat model call.");c.push([g]),await(l==null?void 0:l[0].handleLLMEnd({generations:c,llmOutput:{}}))}catch(v){throw await(l==null?void 0:l[0].handleLLMError(v)),v}else{const v=await Promise.allSettled(i.map((g,m)=>this._generate(g,{...t,promptIndex:m},l==null?void 0:l[m])));await Promise.all(v.map(async(g,m)=>{var x,_,b;if(g.status==="fulfilled"){const w=g.value;for(const E of w.generations){if(E.message.id==null){const S=(x=l==null?void 0:l.at(0))==null?void 0:x.runId;S!=null&&E.message._updateId(`run-${S}`)}E.message.response_metadata={...E.generationInfo,...E.message.response_metadata}}return w.generations.length===1&&(w.generations[0].message.response_metadata={...w.llmOutput,...w.generations[0].message.response_metadata}),c[m]=w.generations,u[m]=w.llmOutput,(_=l==null?void 0:l[m])==null?void 0:_.handleLLMEnd({generations:[w.generations],llmOutput:w.llmOutput})}else return await((b=l==null?void 0:l[m])==null?void 0:b.handleLLMError(g.reason)),Promise.reject(g.reason)}))}const h={generations:c,llmOutput:u.length?(y=this._combineLLMOutput)==null?void 0:y.call(this,...u):void 0};return Object.defineProperty(h,CR,{value:l?{runIds:l==null?void 0:l.map(v=>v.runId)}:void 0,configurable:!0}),h}async _generateCached({messages:e,cache:t,llmStringKey:r,parsedOptions:i,handledOptions:s}){const a=e.map(g=>g.map(_o)),o={...s.metadata,...this.getLsParams(i)},l=await si.configure(s.callbacks,this.callbacks,s.tags,this.tags,o,this.metadata,{verbose:this.verbose}),c={options:i,invocation_params:this==null?void 0:this.invocationParams(i),batch_size:1,cached:!0},u=await(l==null?void 0:l.handleChatModelStart(this.toJSON(),a,s.runId,void 0,c,void 0,void 0,s.runName)),d=[],p=(await Promise.allSettled(a.map(async(g,m)=>{const x=lo._convertInputToPromptValue(g).toString(),_=await t.lookup(x,r);return _==null&&d.push(m),_}))).map((g,m)=>({result:g,runManager:u==null?void 0:u[m]})).filter(({result:g})=>g.status==="fulfilled"&&g.value!=null||g.status==="rejected"),y=[];await Promise.all(p.map(async({result:g,runManager:m},x)=>{if(g.status==="fulfilled"){const _=g.value;return y[x]=_,_.length&&await(m==null?void 0:m.handleLLMNewToken(_[0].text)),m==null?void 0:m.handleLLMEnd({generations:[_]})}else return await(m==null?void 0:m.handleLLMError(g.reason)),Promise.reject(g.reason)}));const v={generations:y,missingPromptIndices:d};return Object.defineProperty(v,CR,{value:u?{runIds:u==null?void 0:u.map(g=>g.runId)}:void 0,configurable:!0}),v}async generate(e,t,r){let i;Array.isArray(t)?i={stop:t}:i=t;const s=e.map(p=>p.map(_o)),[a,o]=this._separateRunnableConfigFromCallOptionsCompat(i);if(a.callbacks=a.callbacks??r,!this.cache)return this._generateUncached(s,o,a);const{cache:l}=this,c=this._getSerializedCacheKeyParametersForCall(o),{generations:u,missingPromptIndices:d}=await this._generateCached({messages:s,cache:l,llmStringKey:c,parsedOptions:o,handledOptions:a});let h={};if(d.length>0){const p=await this._generateUncached(d.map(y=>s[y]),o,a);await Promise.all(p.generations.map(async(y,v)=>{const g=d[v];u[g]=y;const m=lo._convertInputToPromptValue(s[g]).toString();return l.update(m,c,y)})),h=p.llmOutput??{}}return{generations:u,llmOutput:h}}invocationParams(e){return{}}_modelType(){return"base_chat_model"}serialize(){return{...this.invocationParams(),_type:this._llmType(),_model:this._modelType()}}async generatePrompt(e,t,r){const i=e.map(s=>s.toChatMessages());return this.generate(i,t,r)}async call(e,t,r){return(await this.generate([e.map(_o)],t,r)).generations[0][0].message}async callPrompt(e,t,r){const i=e.toChatMessages();return this.call(i,t,r)}async predictMessages(e,t,r){return this.call(e,t,r)}async predict(e,t,r){const i=new Ds(e),s=await this.call([i],t,r);if(typeof s.content!="string")throw new Error("Cannot use predict when output is not a string.");return s.content}withStructuredOutput(e,t){if(typeof this.bindTools!="function")throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');const r=e,i=t==null?void 0:t.name,s=r.description??"A function available to call.",a=t==null?void 0:t.method,o=t==null?void 0:t.includeRaw;if(a==="jsonMode")throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let l=i??"extract",c;KT(r)?c=[{type:"function",function:{name:l,description:s,parameters:R0(r)}}]:("name"in r&&(l=r.name),c=[{type:"function",function:{name:l,description:s,parameters:r}}]);const u=this.bindTools(c),d=Jp.from(v=>{if(!v.tool_calls||v.tool_calls.length===0)throw new Error("No tool calls found in the response.");const g=v.tool_calls.find(m=>m.name===l);if(!g)throw new Error(`No tool call found with name ${l}.`);return g.args});if(!o)return u.pipe(d).withConfig({runName:"StructuredOutput"});const h=O0.assign({parsed:(v,g)=>d.invoke(v.raw,g)}),p=O0.assign({parsed:()=>null}),y=h.withFallbacks({fallbacks:[p]});return va.from([{raw:u},y]).withConfig({runName:"StructuredOutputRunnable"})}}class QF extends _n{parseResultWithPrompt(e,t,r){return this.parseResult(e,r)}_baseMessageToString(e){return typeof e.content=="string"?e.content:this._baseMessageContentToString(e.content)}_baseMessageContentToString(e){return JSON.stringify(e)}async invoke(e,t){return typeof e=="string"?this._callWithConfig(async(r,i)=>this.parseResult([{text:r}],i==null?void 0:i.callbacks),e,{...t,runType:"parser"}):this._callWithConfig(async(r,i)=>this.parseResult([{message:r,text:this._baseMessageToString(r)}],i==null?void 0:i.callbacks),e,{...t,runType:"parser"})}}class Hie extends QF{parseResult(e,t){return this.parse(e[0].text,t)}async parseWithPrompt(e,t,r){return this.parse(e,r)}_type(){throw new Error("_type not implemented")}}class BR extends Error{constructor(e,t,r,i=!1){if(super(e),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=t,this.observation=r,this.sendToLLM=i,i&&(r===void 0||t===void 0))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true")}}class Wie extends Hie{async*_transform(e){for await(const t of e)typeof t=="string"?yield this.parseResult([{text:t}]):yield this.parseResult([{message:t,text:this._baseMessageToString(t)}])}async*transform(e,t){yield*this._transformStreamWithConfig(e,this._transform.bind(this),{...t,runType:"parser"})}}class Gie extends Wie{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers","string"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"StrOutputParser"}parse(e){return Promise.resolve(e)}getFormatInstructions(){return""}_textContentToString(e){return e.text}_imageUrlContentToString(e){throw new Error('Cannot coerce a multimodal "image_url" message part into a string.')}_messageContentComplexToString(e){switch(e.type){case"text":case"text_delta":if("text"in e)return this._textContentToString(e);break;case"image_url":if("image_url"in e)return this._imageUrlContentToString(e);break;default:throw new Error(`Cannot coerce "${e.type}" message part into a string.`)}throw new Error(`Invalid content type: ${e.type}`)}_baseMessageContentToString(e){return e.reduce((t,r)=>t+this._messageContentComplexToString(r),"")}}function qie(n){return n!==void 0&&Array.isArray(n.lc_namespace)}function Xie(n){return n!==void 0&&_n.isRunnable(n)&&"lc_name"in n.constructor&&typeof n.constructor.lc_name=="function"&&n.constructor.lc_name()==="RunnableToolLike"}function Yie(n){return!!n&&typeof n=="object"&&"name"in n&&"schema"in n&&KT(n.schema)}function Kie(n){return Yie(n)||Xie(n)||qie(n)}const cu="0.37.0";let zR=!1,mf,eU,i1,tU,nU,rU;function Zie(n,e={auto:!1}){if(zR)throw new Error(`you must \`import '@anthropic-ai/sdk/shims/${n.kind}'\` before importing anything else from @anthropic-ai/sdk`);if(mf)throw new Error(`can't \`import '@anthropic-ai/sdk/shims/${n.kind}'\` after \`import '@anthropic-ai/sdk/shims/${mf}'\``);zR=e.auto,mf=n.kind,eU=n.fetch,i1=n.File,tU=n.ReadableStream,nU=n.getDefaultAgent,rU=n.fileFromPath}class Jie{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function Qie({manuallyImported:n}={}){const e=n?"You may need to use polyfills":"Add one of these imports before your first `import  from '@anthropic-ai/sdk'`:\n- `import '@anthropic-ai/sdk/shims/node'` (if you're running on Node)\n- `import '@anthropic-ai/sdk/shims/web'` (otherwise)\n";let t,r,i,s;try{t=fetch,r=Request,i=Response,s=Headers}catch(a){throw new Error(`this environment is missing the following Web Fetch API type: ${a.message}. ${e}`)}return{kind:"web",fetch:t,Request:r,Response:i,Headers:s,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(a,o)=>({...o,body:new Jie(a)}),getDefaultAgent:a=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/anthropics/anthropic-sdk-typescript#file-uploads")},isFsReadStream:a=>!1}}mf||Zie(Qie(),{auto:!0});class wt extends Error{}class or extends wt{constructor(e,t,r,i){super(`${or.makeMessage(e,t,r)}`),this.status=e,this.headers=i,this.request_id=i==null?void 0:i["request-id"],this.error=t}static makeMessage(e,t,r){const i=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,t,r,i){if(!e||!i)return new nx({message:r,cause:s1(t)});const s=t;return e===400?new sU(e,s,r,i):e===401?new aU(e,s,r,i):e===403?new oU(e,s,r,i):e===404?new lU(e,s,r,i):e===409?new cU(e,s,r,i):e===422?new uU(e,s,r,i):e===429?new dU(e,s,r,i):e>=500?new hU(e,s,r,i):new or(e,s,r,i)}}class Xi extends or{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class nx extends or{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class iU extends nx{constructor({message:e}={}){super({message:e??"Request timed out."})}}class sU extends or{}class aU extends or{}class oU extends or{}class lU extends or{}class cU extends or{}class uU extends or{}class dU extends or{}class hU extends or{}var fg=function(n,e,t,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(n,t):i?i.value=t:e.set(n,t),t},hl=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},Yr;class Qp{constructor(){Yr.set(this,void 0),this.buffer=new Uint8Array,fg(this,Yr,null,"f")}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?new TextEncoder().encode(e):e;let r=new Uint8Array(this.buffer.length+t.length);r.set(this.buffer),r.set(t,this.buffer.length),this.buffer=r;const i=[];let s;for(;(s=ese(this.buffer,hl(this,Yr,"f")))!=null;){if(s.carriage&&hl(this,Yr,"f")==null){fg(this,Yr,s.index,"f");continue}if(hl(this,Yr,"f")!=null&&(s.index!==hl(this,Yr,"f")+1||s.carriage)){i.push(this.decodeText(this.buffer.slice(0,hl(this,Yr,"f")-1))),this.buffer=this.buffer.slice(hl(this,Yr,"f")),fg(this,Yr,null,"f");continue}const a=hl(this,Yr,"f")!==null?s.preceding-1:s.preceding,o=this.decodeText(this.buffer.slice(0,a));i.push(o),this.buffer=this.buffer.slice(s.index),fg(this,Yr,null,"f")}return i}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new wt(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new wt(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new wt("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}}Yr=new WeakMap;Qp.NEWLINE_CHARS=new Set([`
`,"\r"]);Qp.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function ese(n,e){for(let i=e??0;i<n.length;i++){if(n[i]===10)return{preceding:i,index:i+1,carriage:!1};if(n[i]===13)return{preceding:i,index:i+1,carriage:!0}}return null}function tse(n){for(let r=0;r<n.length-1;r++){if(n[r]===10&&n[r+1]===10||n[r]===13&&n[r+1]===13)return r+2;if(n[r]===13&&n[r+1]===10&&r+3<n.length&&n[r+2]===13&&n[r+3]===10)return r+4}return-1}function ZT(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class As{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let r=!1;async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let s=!1;try{for await(const a of nse(e,t)){if(a.event==="completion")try{yield JSON.parse(a.data)}catch(o){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),o}if(a.event==="message_start"||a.event==="message_delta"||a.event==="message_stop"||a.event==="content_block_start"||a.event==="content_block_delta"||a.event==="content_block_stop")try{yield JSON.parse(a.data)}catch(o){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),o}if(a.event!=="ping"&&a.event==="error")throw or.generate(void 0,`SSE Error: ${a.data}`,a.data,mU(e.headers))}s=!0}catch(a){if(a instanceof Error&&a.name==="AbortError")return;throw a}finally{s||t.abort()}}return new As(i,t)}static fromReadableStream(e,t){let r=!1;async function*i(){const a=new Qp,o=ZT(e);for await(const l of o)for(const c of a.decode(l))yield c;for(const l of a.flush())yield l}async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let a=!1;try{for await(const o of i())a||o&&(yield JSON.parse(o));a=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{a||t.abort()}}return new As(s,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],r=this.iterator(),i=s=>({next:()=>{if(s.length===0){const a=r.next();e.push(a),t.push(a)}return s.shift()}});return[new As(()=>i(e),this.controller),new As(()=>i(t),this.controller)]}toReadableStream(){const e=this;let t;const r=new TextEncoder;return new tU({async start(){t=e[Symbol.asyncIterator]()},async pull(i){try{const{value:s,done:a}=await t.next();if(a)return i.close();const o=r.encode(JSON.stringify(s)+`
`);i.enqueue(o)}catch(s){i.error(s)}},async cancel(){var i;await((i=t.return)==null?void 0:i.call(t))}})}}async function*nse(n,e){if(!n.body)throw e.abort(),new wt("Attempted to iterate over a response with no body");const t=new ise,r=new Qp,i=ZT(n.body);for await(const s of rse(i))for(const a of r.decode(s)){const o=t.decode(a);o&&(yield o)}for(const s of r.flush()){const a=t.decode(s);a&&(yield a)}}async function*rse(n){let e=new Uint8Array;for await(const t of n){if(t==null)continue;const r=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let i=new Uint8Array(e.length+r.length);i.set(e),i.set(r,e.length),e=i;let s;for(;(s=tse(e))!==-1;)yield e.slice(0,s),e=e.slice(s)}e.length>0&&(yield e)}class ise{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const s={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],s}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,i]=sse(e,":");return i.startsWith(" ")&&(i=i.substring(1)),t==="event"?this.event=i:t==="data"&&this.data.push(i),null}}function sse(n,e){const t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}const ase=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function",ose=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&rx(n),rx=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function";async function lse(n,e,t){var i;if(n=await n,ose(n))return n;if(ase(n)){const s=await n.blob();e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()??"unknown_file");const a=rx(s)?[await s.arrayBuffer()]:[s];return new i1(a,e,t)}const r=await cse(n);if(e||(e=dse(n)??"unknown_file"),!(t!=null&&t.type)){const s=(i=r[0])==null?void 0:i.type;typeof s=="string"&&(t={...t,type:s})}return new i1(r,e,t)}async function cse(n){var t;let e=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)e.push(n);else if(rx(n))e.push(await n.arrayBuffer());else if(hse(n))for await(const r of n)e.push(r);else throw new Error(`Unexpected data type: ${typeof n}; constructor: ${(t=n==null?void 0:n.constructor)==null?void 0:t.name}; props: ${use(n)}`);return e}function use(n){return`[${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}function dse(n){var e;return Eb(n.name)||Eb(n.filename)||((e=Eb(n.path))==null?void 0:e.split(/[\\/]/).pop())}const Eb=n=>{if(typeof n=="string")return n;if(typeof Buffer<"u"&&n instanceof Buffer)return String(n)},hse=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function",$R=n=>n&&typeof n=="object"&&n.body&&n[Symbol.toStringTag]==="MultipartBody";var Gu={},fse=function(n,e,t,r,i){if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(n,t),t},pse=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},pg;async function fU(n){const{response:e}=n;if(n.options.stream)return qu("response",e.status,e.url,e.headers,e.body),n.options.__streamClass?n.options.__streamClass.fromSSEResponse(e,n.controller):As.fromSSEResponse(e,n.controller);if(e.status===204)return null;if(n.options.__binaryResponse)return e;const t=e.headers.get("content-type");if((t==null?void 0:t.includes("application/json"))||(t==null?void 0:t.includes("application/vnd.api+json"))){const s=await e.json();return qu("response",e.status,e.url,e.headers,s),pU(s,e)}const i=await e.text();return qu("response",e.status,e.url,e.headers,i),i}function pU(n,e){return!n||typeof n!="object"||Array.isArray(n)?n:Object.defineProperty(n,"_request_id",{value:e.headers.get("request-id"),enumerable:!1})}class ix extends Promise{constructor(e,t=fU){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new ix(this.responsePromise,async t=>pU(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class mse{constructor({baseURL:e,maxRetries:t=2,timeout:r=6e5,httpAgent:i,fetch:s}){this.baseURL=e,this.maxRetries=Tb("maxRetries",t),this.timeout=Tb("timeout",r),this.httpAgent=i,this.fetch=s??eU}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...bse(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${Mse()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(async i=>{const s=i&&rx(i==null?void 0:i.body)?new DataView(await i.body.arrayBuffer()):(i==null?void 0:i.body)instanceof DataView?i.body:(i==null?void 0:i.body)instanceof ArrayBuffer?new DataView(i.body):i&&ArrayBuffer.isView(i==null?void 0:i.body)?new DataView(i.body.buffer):i==null?void 0:i.body;return{method:e,path:t,...i,body:s}}))}getAPIList(e,t,r){return this.requestAPIList(t,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var y;e={...e};const{method:r,path:i,query:s,headers:a={}}=e,o=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:$R(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,l=this.calculateContentLength(o),c=this.buildURL(i,s);"timeout"in e&&Tb("timeout",e.timeout),e.timeout=e.timeout??this.timeout;const u=e.httpAgent??this.httpAgent??nU(c),d=e.timeout+1e3;typeof((y=u==null?void 0:u.options)==null?void 0:y.timeout)=="number"&&d>(u.options.timeout??0)&&(u.options.timeout=d),this.idempotencyHeader&&r!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const h=this.buildHeaders({options:e,headers:a,contentLength:l,retryCount:t});return{req:{method:r,...o&&{body:o},headers:h,...u&&{agent:u},signal:e.signal??null},url:c,timeout:e.timeout}}buildHeaders({options:e,headers:t,contentLength:r,retryCount:i}){const s={};r&&(s["content-length"]=r);const a=this.defaultHeaders(e);return GR(s,a),GR(s,t),$R(e.body)&&mf!=="node"&&delete s["content-type"],mg(a,"x-stainless-retry-count")===void 0&&mg(t,"x-stainless-retry-count")===void 0&&(s["x-stainless-retry-count"]=String(i)),mg(a,"x-stainless-timeout")===void 0&&mg(t,"x-stainless-timeout")===void 0&&e.timeout&&(s["x-stainless-timeout"]=String(e.timeout)),this.validateHeaders(s,t),s}_calculateNonstreamingTimeout(e){if(3600*e/128e3>600)throw new wt("Streaming is strongly recommended for operations that may take longer than 10 minutes. See https://github.com/anthropics/anthropic-sdk-python#streaming-responses for more details");return 600*1e3}async prepareOptions(e){}async prepareRequest(e,{url:t,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,r,i){return or.generate(e,t,r,i)}request(e,t=null){return new ix(this.makeRequest(e,t))}async makeRequest(e,t){var d,h;const r=await e,i=r.maxRetries??this.maxRetries;t==null&&(t=i),await this.prepareOptions(r);const{req:s,url:a,timeout:o}=this.buildRequest(r,{retryCount:i-t});if(await this.prepareRequest(s,{url:a,options:r}),qu("request",a,r,s.headers),(d=r.signal)!=null&&d.aborted)throw new Xi;const l=new AbortController,c=await this.fetchWithTimeout(a,s,o,l).catch(s1);if(c instanceof Error){if((h=r.signal)!=null&&h.aborted)throw new Xi;if(t)return this.retryRequest(r,t);throw c.name==="AbortError"?new iU:new nx({cause:c})}const u=mU(c.headers);if(!c.ok){if(t&&this.shouldRetry(c)){const x=`retrying, ${t} attempts remaining`;return qu(`response (error; ${x})`,c.status,a,u),this.retryRequest(r,t,u)}const p=await c.text().catch(x=>s1(x).message),y=wse(p),v=y?void 0:p;throw qu(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,c.status,a,u,v),this.makeStatusError(c.status,y,v,u)}return{response:c,options:r,controller:l}}requestAPIList(e,t){const r=this.makeRequest(t,null);return new yse(this,r,e)}buildURL(e,t){const r=Ese(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),i=this.defaultQuery();return L0(i)||(t={...i,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(r.search=this.stringifyQuery(t)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,r])=>typeof r<"u").map(([t,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(t)}=`;throw new wt(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,r,i){const{signal:s,...a}=t||{};s&&s.addEventListener("abort",()=>i.abort());const o=setTimeout(()=>i.abort(),r),l={signal:i.signal,...a};l.method&&(l.method=l.method.toUpperCase());const c=60*1e3,u=setTimeout(()=>{var d,h;if(l&&((d=l==null?void 0:l.agent)!=null&&d.sockets))for(const p of Object.values((h=l==null?void 0:l.agent)==null?void 0:h.sockets).flat())p!=null&&p.setKeepAlive&&p.setKeepAlive(!0,c)},c);return this.fetch.call(void 0,e,l).finally(()=>{clearTimeout(o),clearTimeout(u)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,r){let i;const s=r==null?void 0:r["retry-after-ms"];if(s){const o=parseFloat(s);Number.isNaN(o)||(i=o)}const a=r==null?void 0:r["retry-after"];if(a&&!i){const o=parseFloat(a);Number.isNaN(o)?i=Date.parse(a)-Date.now():i=o*1e3}if(!(i&&0<=i&&i<60*1e3)){const o=e.maxRetries??this.maxRetries;i=this.calculateDefaultRetryTimeoutMillis(t,o)}return await Tse(i),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const s=t-e,a=Math.min(.5*Math.pow(2,s),8),o=1-Math.random()*.25;return a*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${cu}`}}class gse{constructor(e,t,r,i){pg.set(this,void 0),fse(this,pg,e),this.options=i,this.response=t,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new wt("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const r=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[i,s]of r)e.url.searchParams.set(i,s);t.query=void 0,t.path=e.url.toString()}return await pse(this,pg,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(pg=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class yse extends ix{constructor(e,t,r){super(t,async i=>new r(e,i.response,await fU(i),i.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}const mU=n=>new Proxy(Object.fromEntries(n.entries()),{get(e,t){const r=t.toString();return e[r.toLowerCase()]||e[r]}}),vse={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},po=n=>typeof n=="object"&&n!==null&&!L0(n)&&Object.keys(n).every(e=>gU(vse,e)),xse=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":cu,"X-Stainless-OS":HR(Deno.build.os),"X-Stainless-Arch":VR(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":cu,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":cu,"X-Stainless-OS":HR(process.platform),"X-Stainless-Arch":VR(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const n=_se();return n?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":cu,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${n.browser}`,"X-Stainless-Runtime-Version":n.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":cu,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function _se(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of n){const r=t.exec(navigator.userAgent);if(r){const i=r[1]||0,s=r[2]||0,a=r[3]||0;return{browser:e,version:`${i}.${s}.${a}`}}}return null}const VR=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",HR=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let WR;const bse=()=>WR??(WR=xse()),wse=n=>{try{return JSON.parse(n)}catch{return}},Sse=/^[a-z][a-z0-9+.-]*:/i,Ese=n=>Sse.test(n),Tse=n=>new Promise(e=>setTimeout(e,n)),Tb=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new wt(`${n} must be an integer`);if(e<0)throw new wt(`${n} must be a positive integer`);return e},s1=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null)try{return new Error(JSON.stringify(n))}catch{}return new Error(String(n))},Mb=n=>{var e,t,r,i;if(typeof process<"u")return((e=Gu==null?void 0:Gu[n])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(i=(r=(t=Deno.env)==null?void 0:t.get)==null?void 0:r.call(t,n))==null?void 0:i.trim()};function L0(n){if(!n)return!0;for(const e in n)return!1;return!0}function gU(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function GR(n,e){for(const t in e){if(!gU(e,t))continue;const r=t.toLowerCase();if(!r)continue;const i=e[t];i===null?delete n[r]:i!==void 0&&(n[r]=i)}}function qu(n,...e){typeof process<"u"&&(Gu==null?void 0:Gu.DEBUG)==="true"&&console.log(`Anthropic:DEBUG:${n}`,...e)}const Mse=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,n=>{const e=Math.random()*16|0;return(n==="x"?e:e&3|8).toString(16)}),kse=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",Ase=n=>typeof(n==null?void 0:n.get)=="function",mg=(n,e)=>{var r;const t=e.toLowerCase();if(Ase(n)){const i=((r=e[0])==null?void 0:r.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(s,a,o)=>a+o.toUpperCase());for(const s of[e,t,e.toUpperCase(),i]){const a=n.get(s);if(a)return a}}for(const[i,s]of Object.entries(n))if(i.toLowerCase()===t)return Array.isArray(s)?(s.length<=1||console.warn(`Received ${s.length} entries for the ${e} header, using the first entry.`),s[0]):s};class sx extends gse{constructor(e,t,r,i){super(e,t,r,i),this.data=r.data||[],this.has_more=r.has_more||!1,this.first_id=r.first_id||null,this.last_id=r.last_id||null}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var t;if((t=this.options.query)!=null&&t.before_id){const r=this.first_id;return r?{params:{before_id:r}}:null}const e=this.last_id;return e?{params:{after_id:e}}:null}}class el{constructor(e){this._client=e}}let JT=class extends el{retrieve(e,t){return this._client.get(`/v1/models/${e}?beta=true`,t)}list(e={},t){return po(e)?this.list({},e):this._client.getAPIList("/v1/models?beta=true",QT,{query:e,...t})}};class QT extends sx{}JT.BetaModelInfosPage=QT;class ax{constructor(e,t){this.iterator=e,this.controller=t}async*decoder(){const e=new Qp;for await(const t of this.iterator)for(const r of e.decode(t))yield JSON.parse(r);for(const t of e.flush())yield JSON.parse(t)}[Symbol.asyncIterator](){return this.decoder()}static fromResponse(e,t){if(!e.body)throw t.abort(),new wt("Attempted to iterate over a response with no body");return new ax(ZT(e.body),t)}}let eM=class extends el{create(e,t){const{betas:r,...i}=e;return this._client.post("/v1/messages/batches?beta=true",{body:i,...t,headers:{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString(),...t==null?void 0:t.headers}})}retrieve(e,t={},r){if(po(t))return this.retrieve(e,{},t);const{betas:i}=t;return this._client.get(`/v1/messages/batches/${e}?beta=true`,{...r,headers:{"anthropic-beta":[...i??[],"message-batches-2024-09-24"].toString(),...r==null?void 0:r.headers}})}list(e={},t){if(po(e))return this.list({},e);const{betas:r,...i}=e;return this._client.getAPIList("/v1/messages/batches?beta=true",tM,{query:i,...t,headers:{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString(),...t==null?void 0:t.headers}})}delete(e,t={},r){if(po(t))return this.delete(e,{},t);const{betas:i}=t;return this._client.delete(`/v1/messages/batches/${e}?beta=true`,{...r,headers:{"anthropic-beta":[...i??[],"message-batches-2024-09-24"].toString(),...r==null?void 0:r.headers}})}cancel(e,t={},r){if(po(t))return this.cancel(e,{},t);const{betas:i}=t;return this._client.post(`/v1/messages/batches/${e}/cancel?beta=true`,{...r,headers:{"anthropic-beta":[...i??[],"message-batches-2024-09-24"].toString(),...r==null?void 0:r.headers}})}async results(e,t={},r){if(po(t))return this.results(e,{},t);const i=await this.retrieve(e);if(!i.results_url)throw new wt(`No batch \`results_url\`; Has it finished processing? ${i.processing_status} - ${i.id}`);const{betas:s}=t;return this._client.get(i.results_url,{...r,headers:{"anthropic-beta":[...s??[],"message-batches-2024-09-24"].toString(),Accept:"application/binary",...r==null?void 0:r.headers},__binaryResponse:!0})._thenUnwrap((a,o)=>ax.fromResponse(o.response,o.controller))}};class tM extends sx{}eM.BetaMessageBatchesPage=tM;const Pse=n=>{let e=0,t=[];for(;e<n.length;){let r=n[e];if(r==="\\"){e++;continue}if(r==="{"){t.push({type:"brace",value:"{"}),e++;continue}if(r==="}"){t.push({type:"brace",value:"}"}),e++;continue}if(r==="["){t.push({type:"paren",value:"["}),e++;continue}if(r==="]"){t.push({type:"paren",value:"]"}),e++;continue}if(r===":"){t.push({type:"separator",value:":"}),e++;continue}if(r===","){t.push({type:"delimiter",value:","}),e++;continue}if(r==='"'){let o="",l=!1;for(r=n[++e];r!=='"';){if(e===n.length){l=!0;break}if(r==="\\"){if(e++,e===n.length){l=!0;break}o+=r+n[e],r=n[++e]}else o+=r,r=n[++e]}r=n[++e],l||t.push({type:"string",value:o});continue}if(r&&/\s/.test(r)){e++;continue}let s=/[0-9]/;if(r&&s.test(r)||r==="-"||r==="."){let o="";for(r==="-"&&(o+=r,r=n[++e]);r&&s.test(r)||r===".";)o+=r,r=n[++e];t.push({type:"number",value:o});continue}let a=/[a-z]/i;if(r&&a.test(r)){let o="";for(;r&&a.test(r)&&e!==n.length;)o+=r,r=n[++e];if(o=="true"||o=="false"||o==="null")t.push({type:"name",value:o});else{e++;continue}continue}e++}return t},uu=n=>{if(n.length===0)return n;let e=n[n.length-1];switch(e.type){case"separator":return n=n.slice(0,n.length-1),uu(n);case"number":let t=e.value[e.value.length-1];if(t==="."||t==="-")return n=n.slice(0,n.length-1),uu(n);case"string":let r=n[n.length-2];if((r==null?void 0:r.type)==="delimiter")return n=n.slice(0,n.length-1),uu(n);if((r==null?void 0:r.type)==="brace"&&r.value==="{")return n=n.slice(0,n.length-1),uu(n);break;case"delimiter":return n=n.slice(0,n.length-1),uu(n)}return n},Cse=n=>{let e=[];return n.map(t=>{t.type==="brace"&&(t.value==="{"?e.push("}"):e.splice(e.lastIndexOf("}"),1)),t.type==="paren"&&(t.value==="["?e.push("]"):e.splice(e.lastIndexOf("]"),1))}),e.length>0&&e.reverse().map(t=>{t==="}"?n.push({type:"brace",value:"}"}):t==="]"&&n.push({type:"paren",value:"]"})}),n},Rse=n=>{let e="";return n.map(t=>{switch(t.type){case"string":e+='"'+t.value+'"';break;default:e+=t.value;break}}),e},yU=n=>JSON.parse(Rse(Cse(uu(Pse(n)))));var Xn=function(n,e,t,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(n,t):i?i.value=t:e.set(n,t),t},ht=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},mi,Ka,dh,gg,hh,fh,yg,ph,Ks,mh,vg,xg,Zc,_g,bg,kb,qR,Ab,Pb,Cb,Rb,XR;const YR="__json_buf";class D0{constructor(){mi.add(this),this.messages=[],this.receivedMessages=[],Ka.set(this,void 0),this.controller=new AbortController,dh.set(this,void 0),gg.set(this,()=>{}),hh.set(this,()=>{}),fh.set(this,void 0),yg.set(this,()=>{}),ph.set(this,()=>{}),Ks.set(this,{}),mh.set(this,!1),vg.set(this,!1),xg.set(this,!1),Zc.set(this,!1),_g.set(this,void 0),bg.set(this,void 0),Ab.set(this,e=>{if(Xn(this,vg,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new Xi),e instanceof Xi)return Xn(this,xg,!0,"f"),this._emit("abort",e);if(e instanceof wt)return this._emit("error",e);if(e instanceof Error){const t=new wt(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new wt(String(e)))}),Xn(this,dh,new Promise((e,t)=>{Xn(this,gg,e,"f"),Xn(this,hh,t,"f")}),"f"),Xn(this,fh,new Promise((e,t)=>{Xn(this,yg,e,"f"),Xn(this,ph,t,"f")}),"f"),ht(this,dh,"f").catch(()=>{}),ht(this,fh,"f").catch(()=>{})}get response(){return ht(this,_g,"f")}get request_id(){return ht(this,bg,"f")}async withResponse(){const e=await ht(this,dh,"f");if(!e)throw new Error("Could not resolve a `Response` object");return{data:this,response:e,request_id:e.headers.get("request-id")}}static fromReadableStream(e){const t=new D0;return t._run(()=>t._fromReadableStream(e)),t}static createMessage(e,t,r){const i=new D0;for(const s of t.messages)i._addMessageParam(s);return i._run(()=>i._createMessage(e,{...t,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),i}_run(e){e().then(()=>{this._emitFinal(),this._emit("end")},ht(this,Ab,"f"))}_addMessageParam(e){this.messages.push(e)}_addMessage(e,t=!0){this.receivedMessages.push(e),t&&this._emit("message",e)}async _createMessage(e,t,r){var o;const i=r==null?void 0:r.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),ht(this,mi,"m",Pb).call(this);const{response:s,data:a}=await e.create({...t,stream:!0},{...r,signal:this.controller.signal}).withResponse();this._connected(s);for await(const l of a)ht(this,mi,"m",Cb).call(this,l);if((o=a.controller.signal)!=null&&o.aborted)throw new Xi;ht(this,mi,"m",Rb).call(this)}_connected(e){this.ended||(Xn(this,_g,e,"f"),Xn(this,bg,e==null?void 0:e.headers.get("request-id"),"f"),ht(this,gg,"f").call(this,e),this._emit("connect"))}get ended(){return ht(this,mh,"f")}get errored(){return ht(this,vg,"f")}get aborted(){return ht(this,xg,"f")}abort(){this.controller.abort()}on(e,t){return(ht(this,Ks,"f")[e]||(ht(this,Ks,"f")[e]=[])).push({listener:t}),this}off(e,t){const r=ht(this,Ks,"f")[e];if(!r)return this;const i=r.findIndex(s=>s.listener===t);return i>=0&&r.splice(i,1),this}once(e,t){return(ht(this,Ks,"f")[e]||(ht(this,Ks,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,r)=>{Xn(this,Zc,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,t)})}async done(){Xn(this,Zc,!0,"f"),await ht(this,fh,"f")}get currentMessage(){return ht(this,Ka,"f")}async finalMessage(){return await this.done(),ht(this,mi,"m",kb).call(this)}async finalText(){return await this.done(),ht(this,mi,"m",qR).call(this)}_emit(e,...t){if(ht(this,mh,"f"))return;e==="end"&&(Xn(this,mh,!0,"f"),ht(this,yg,"f").call(this));const r=ht(this,Ks,"f")[e];if(r&&(ht(this,Ks,"f")[e]=r.filter(i=>!i.once),r.forEach(({listener:i})=>i(...t))),e==="abort"){const i=t[0];!ht(this,Zc,"f")&&!(r!=null&&r.length)&&Promise.reject(i),ht(this,hh,"f").call(this,i),ht(this,ph,"f").call(this,i),this._emit("end");return}if(e==="error"){const i=t[0];!ht(this,Zc,"f")&&!(r!=null&&r.length)&&Promise.reject(i),ht(this,hh,"f").call(this,i),ht(this,ph,"f").call(this,i),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",ht(this,mi,"m",kb).call(this))}async _fromReadableStream(e,t){var s;const r=t==null?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),ht(this,mi,"m",Pb).call(this),this._connected(null);const i=As.fromReadableStream(e,this.controller);for await(const a of i)ht(this,mi,"m",Cb).call(this,a);if((s=i.controller.signal)!=null&&s.aborted)throw new Xi;ht(this,mi,"m",Rb).call(this)}[(Ka=new WeakMap,dh=new WeakMap,gg=new WeakMap,hh=new WeakMap,fh=new WeakMap,yg=new WeakMap,ph=new WeakMap,Ks=new WeakMap,mh=new WeakMap,vg=new WeakMap,xg=new WeakMap,Zc=new WeakMap,_g=new WeakMap,bg=new WeakMap,Ab=new WeakMap,mi=new WeakSet,kb=function(){if(this.receivedMessages.length===0)throw new wt("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},qR=function(){if(this.receivedMessages.length===0)throw new wt("stream ended without producing a Message with role=assistant");const t=this.receivedMessages.at(-1).content.filter(r=>r.type==="text").map(r=>r.text);if(t.length===0)throw new wt("stream ended without producing a content block with type=text");return t.join(" ")},Pb=function(){this.ended||Xn(this,Ka,void 0,"f")},Cb=function(t){if(this.ended)return;const r=ht(this,mi,"m",XR).call(this,t);switch(this._emit("streamEvent",t,r),t.type){case"content_block_delta":{const i=r.content.at(-1);switch(t.delta.type){case"text_delta":{i.type==="text"&&this._emit("text",t.delta.text,i.text||"");break}case"citations_delta":{i.type==="text"&&this._emit("citation",t.delta.citation,i.citations??[]);break}case"input_json_delta":{i.type==="tool_use"&&i.input&&this._emit("inputJson",t.delta.partial_json,i.input);break}case"thinking_delta":{i.type==="thinking"&&this._emit("thinking",t.delta.thinking,i.thinking);break}case"signature_delta":{i.type==="thinking"&&this._emit("signature",i.signature);break}default:t.delta}break}case"message_stop":{this._addMessageParam(r),this._addMessage(r,!0);break}case"content_block_stop":{this._emit("contentBlock",r.content.at(-1));break}case"message_start":{Xn(this,Ka,r,"f");break}}},Rb=function(){if(this.ended)throw new wt("stream has ended, this shouldn't happen");const t=ht(this,Ka,"f");if(!t)throw new wt("request ended without sending any chunks");return Xn(this,Ka,void 0,"f"),t},XR=function(t){let r=ht(this,Ka,"f");if(t.type==="message_start"){if(r)throw new wt(`Unexpected event order, got ${t.type} before receiving "message_stop"`);return t.message}if(!r)throw new wt(`Unexpected event order, got ${t.type} before "message_start"`);switch(t.type){case"message_stop":return r;case"message_delta":return r.stop_reason=t.delta.stop_reason,r.stop_sequence=t.delta.stop_sequence,r.usage.output_tokens=t.usage.output_tokens,r;case"content_block_start":return r.content.push(t.content_block),r;case"content_block_delta":{const i=r.content.at(t.index);switch(t.delta.type){case"text_delta":{(i==null?void 0:i.type)==="text"&&(i.text+=t.delta.text);break}case"citations_delta":{(i==null?void 0:i.type)==="text"&&(i.citations??(i.citations=[]),i.citations.push(t.delta.citation));break}case"input_json_delta":{if((i==null?void 0:i.type)==="tool_use"){let s=i[YR]||"";s+=t.delta.partial_json,Object.defineProperty(i,YR,{value:s,enumerable:!1,writable:!0}),s&&(i.input=yU(s))}break}case"thinking_delta":{(i==null?void 0:i.type)==="thinking"&&(i.thinking+=t.delta.thinking);break}case"signature_delta":{(i==null?void 0:i.type)==="thinking"&&(i.signature=t.delta.signature);break}default:t.delta}return r}case"content_block_stop":return r}},Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("streamEvent",i=>{const s=t.shift();s?s.resolve(i):e.push(i)}),this.on("end",()=>{r=!0;for(const i of t)i.resolve(void 0);t.length=0}),this.on("abort",i=>{r=!0;for(const s of t)s.reject(i);t.length=0}),this.on("error",i=>{r=!0;for(const s of t)s.reject(i);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((s,a)=>t.push({resolve:s,reject:a})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new As(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}const KR={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025"};let ox=class extends el{constructor(){super(...arguments),this.batches=new eM(this._client)}create(e,t){const{betas:r,...i}=e;return i.model in KR&&console.warn(`The model '${i.model}' is deprecated and will reach end-of-life on ${KR[i.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`),this._client.post("/v1/messages?beta=true",{body:i,timeout:this._client._options.timeout??(i.stream?6e5:this._client._calculateNonstreamingTimeout(i.max_tokens)),...t,headers:{...(r==null?void 0:r.toString())!=null?{"anthropic-beta":r==null?void 0:r.toString()}:void 0,...t==null?void 0:t.headers},stream:e.stream??!1})}stream(e,t){return D0.createMessage(this,e,t)}countTokens(e,t){const{betas:r,...i}=e;return this._client.post("/v1/messages/count_tokens?beta=true",{body:i,...t,headers:{"anthropic-beta":[...r??[],"token-counting-2024-11-01"].toString(),...t==null?void 0:t.headers}})}};ox.Batches=eM;ox.BetaMessageBatchesPage=tM;class em extends el{constructor(){super(...arguments),this.models=new JT(this._client),this.messages=new ox(this._client)}}em.Models=JT;em.BetaModelInfosPage=QT;em.Messages=ox;class vU extends el{create(e,t){return this._client.post("/v1/complete",{body:e,timeout:this._client._options.timeout??6e5,...t,stream:e.stream??!1})}}class nM extends el{create(e,t){return this._client.post("/v1/messages/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/v1/messages/batches/${e}`,t)}list(e={},t){return po(e)?this.list({},e):this._client.getAPIList("/v1/messages/batches",rM,{query:e,...t})}delete(e,t){return this._client.delete(`/v1/messages/batches/${e}`,t)}cancel(e,t){return this._client.post(`/v1/messages/batches/${e}/cancel`,t)}async results(e,t){const r=await this.retrieve(e);if(!r.results_url)throw new wt(`No batch \`results_url\`; Has it finished processing? ${r.processing_status} - ${r.id}`);return this._client.get(r.results_url,{...t,headers:{Accept:"application/binary",...t==null?void 0:t.headers},__binaryResponse:!0})._thenUnwrap((i,s)=>ax.fromResponse(s.response,s.controller))}}class rM extends sx{}nM.MessageBatchesPage=rM;var Yn=function(n,e,t,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(n,t):i?i.value=t:e.set(n,t),t},ft=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},gi,Za,gh,wg,yh,vh,Sg,xh,Zs,_h,Eg,Tg,Jc,Mg,kg,Nb,ZR,Ob,Lb,Db,Ib,JR;const QR="__json_buf";class I0{constructor(){gi.add(this),this.messages=[],this.receivedMessages=[],Za.set(this,void 0),this.controller=new AbortController,gh.set(this,void 0),wg.set(this,()=>{}),yh.set(this,()=>{}),vh.set(this,void 0),Sg.set(this,()=>{}),xh.set(this,()=>{}),Zs.set(this,{}),_h.set(this,!1),Eg.set(this,!1),Tg.set(this,!1),Jc.set(this,!1),Mg.set(this,void 0),kg.set(this,void 0),Ob.set(this,e=>{if(Yn(this,Eg,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new Xi),e instanceof Xi)return Yn(this,Tg,!0,"f"),this._emit("abort",e);if(e instanceof wt)return this._emit("error",e);if(e instanceof Error){const t=new wt(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new wt(String(e)))}),Yn(this,gh,new Promise((e,t)=>{Yn(this,wg,e,"f"),Yn(this,yh,t,"f")}),"f"),Yn(this,vh,new Promise((e,t)=>{Yn(this,Sg,e,"f"),Yn(this,xh,t,"f")}),"f"),ft(this,gh,"f").catch(()=>{}),ft(this,vh,"f").catch(()=>{})}get response(){return ft(this,Mg,"f")}get request_id(){return ft(this,kg,"f")}async withResponse(){const e=await ft(this,gh,"f");if(!e)throw new Error("Could not resolve a `Response` object");return{data:this,response:e,request_id:e.headers.get("request-id")}}static fromReadableStream(e){const t=new I0;return t._run(()=>t._fromReadableStream(e)),t}static createMessage(e,t,r){const i=new I0;for(const s of t.messages)i._addMessageParam(s);return i._run(()=>i._createMessage(e,{...t,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),i}_run(e){e().then(()=>{this._emitFinal(),this._emit("end")},ft(this,Ob,"f"))}_addMessageParam(e){this.messages.push(e)}_addMessage(e,t=!0){this.receivedMessages.push(e),t&&this._emit("message",e)}async _createMessage(e,t,r){var o;const i=r==null?void 0:r.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),ft(this,gi,"m",Lb).call(this);const{response:s,data:a}=await e.create({...t,stream:!0},{...r,signal:this.controller.signal}).withResponse();this._connected(s);for await(const l of a)ft(this,gi,"m",Db).call(this,l);if((o=a.controller.signal)!=null&&o.aborted)throw new Xi;ft(this,gi,"m",Ib).call(this)}_connected(e){this.ended||(Yn(this,Mg,e,"f"),Yn(this,kg,e==null?void 0:e.headers.get("request-id"),"f"),ft(this,wg,"f").call(this,e),this._emit("connect"))}get ended(){return ft(this,_h,"f")}get errored(){return ft(this,Eg,"f")}get aborted(){return ft(this,Tg,"f")}abort(){this.controller.abort()}on(e,t){return(ft(this,Zs,"f")[e]||(ft(this,Zs,"f")[e]=[])).push({listener:t}),this}off(e,t){const r=ft(this,Zs,"f")[e];if(!r)return this;const i=r.findIndex(s=>s.listener===t);return i>=0&&r.splice(i,1),this}once(e,t){return(ft(this,Zs,"f")[e]||(ft(this,Zs,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,r)=>{Yn(this,Jc,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,t)})}async done(){Yn(this,Jc,!0,"f"),await ft(this,vh,"f")}get currentMessage(){return ft(this,Za,"f")}async finalMessage(){return await this.done(),ft(this,gi,"m",Nb).call(this)}async finalText(){return await this.done(),ft(this,gi,"m",ZR).call(this)}_emit(e,...t){if(ft(this,_h,"f"))return;e==="end"&&(Yn(this,_h,!0,"f"),ft(this,Sg,"f").call(this));const r=ft(this,Zs,"f")[e];if(r&&(ft(this,Zs,"f")[e]=r.filter(i=>!i.once),r.forEach(({listener:i})=>i(...t))),e==="abort"){const i=t[0];!ft(this,Jc,"f")&&!(r!=null&&r.length)&&Promise.reject(i),ft(this,yh,"f").call(this,i),ft(this,xh,"f").call(this,i),this._emit("end");return}if(e==="error"){const i=t[0];!ft(this,Jc,"f")&&!(r!=null&&r.length)&&Promise.reject(i),ft(this,yh,"f").call(this,i),ft(this,xh,"f").call(this,i),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",ft(this,gi,"m",Nb).call(this))}async _fromReadableStream(e,t){var s;const r=t==null?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),ft(this,gi,"m",Lb).call(this),this._connected(null);const i=As.fromReadableStream(e,this.controller);for await(const a of i)ft(this,gi,"m",Db).call(this,a);if((s=i.controller.signal)!=null&&s.aborted)throw new Xi;ft(this,gi,"m",Ib).call(this)}[(Za=new WeakMap,gh=new WeakMap,wg=new WeakMap,yh=new WeakMap,vh=new WeakMap,Sg=new WeakMap,xh=new WeakMap,Zs=new WeakMap,_h=new WeakMap,Eg=new WeakMap,Tg=new WeakMap,Jc=new WeakMap,Mg=new WeakMap,kg=new WeakMap,Ob=new WeakMap,gi=new WeakSet,Nb=function(){if(this.receivedMessages.length===0)throw new wt("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},ZR=function(){if(this.receivedMessages.length===0)throw new wt("stream ended without producing a Message with role=assistant");const t=this.receivedMessages.at(-1).content.filter(r=>r.type==="text").map(r=>r.text);if(t.length===0)throw new wt("stream ended without producing a content block with type=text");return t.join(" ")},Lb=function(){this.ended||Yn(this,Za,void 0,"f")},Db=function(t){if(this.ended)return;const r=ft(this,gi,"m",JR).call(this,t);switch(this._emit("streamEvent",t,r),t.type){case"content_block_delta":{const i=r.content.at(-1);switch(t.delta.type){case"text_delta":{i.type==="text"&&this._emit("text",t.delta.text,i.text||"");break}case"citations_delta":{i.type==="text"&&this._emit("citation",t.delta.citation,i.citations??[]);break}case"input_json_delta":{i.type==="tool_use"&&i.input&&this._emit("inputJson",t.delta.partial_json,i.input);break}case"thinking_delta":{i.type==="thinking"&&this._emit("thinking",t.delta.thinking,i.thinking);break}case"signature_delta":{i.type==="thinking"&&this._emit("signature",i.signature);break}default:t.delta}break}case"message_stop":{this._addMessageParam(r),this._addMessage(r,!0);break}case"content_block_stop":{this._emit("contentBlock",r.content.at(-1));break}case"message_start":{Yn(this,Za,r,"f");break}}},Ib=function(){if(this.ended)throw new wt("stream has ended, this shouldn't happen");const t=ft(this,Za,"f");if(!t)throw new wt("request ended without sending any chunks");return Yn(this,Za,void 0,"f"),t},JR=function(t){let r=ft(this,Za,"f");if(t.type==="message_start"){if(r)throw new wt(`Unexpected event order, got ${t.type} before receiving "message_stop"`);return t.message}if(!r)throw new wt(`Unexpected event order, got ${t.type} before "message_start"`);switch(t.type){case"message_stop":return r;case"message_delta":return r.stop_reason=t.delta.stop_reason,r.stop_sequence=t.delta.stop_sequence,r.usage.output_tokens=t.usage.output_tokens,r;case"content_block_start":return r.content.push(t.content_block),r;case"content_block_delta":{const i=r.content.at(t.index);switch(t.delta.type){case"text_delta":{(i==null?void 0:i.type)==="text"&&(i.text+=t.delta.text);break}case"citations_delta":{(i==null?void 0:i.type)==="text"&&(i.citations??(i.citations=[]),i.citations.push(t.delta.citation));break}case"input_json_delta":{if((i==null?void 0:i.type)==="tool_use"){let s=i[QR]||"";s+=t.delta.partial_json,Object.defineProperty(i,QR,{value:s,enumerable:!1,writable:!0}),s&&(i.input=yU(s))}break}case"thinking_delta":{(i==null?void 0:i.type)==="thinking"&&(i.thinking+=t.delta.thinking);break}case"signature_delta":{(i==null?void 0:i.type)==="thinking"&&(i.signature=t.delta.signature);break}default:t.delta}return r}case"content_block_stop":return r}},Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("streamEvent",i=>{const s=t.shift();s?s.resolve(i):e.push(i)}),this.on("end",()=>{r=!0;for(const i of t)i.resolve(void 0);t.length=0}),this.on("abort",i=>{r=!0;for(const s of t)s.reject(i);t.length=0}),this.on("error",i=>{r=!0;for(const s of t)s.reject(i);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((s,a)=>t.push({resolve:s,reject:a})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new As(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}class lx extends el{constructor(){super(...arguments),this.batches=new nM(this._client)}create(e,t){return e.model in e2&&console.warn(`The model '${e.model}' is deprecated and will reach end-of-life on ${e2[e.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`),this._client.post("/v1/messages",{body:e,timeout:this._client._options.timeout??(e.stream?6e5:this._client._calculateNonstreamingTimeout(e.max_tokens)),...t,stream:e.stream??!1})}stream(e,t){return I0.createMessage(this,e,t)}countTokens(e,t){return this._client.post("/v1/messages/count_tokens",{body:e,...t})}}const e2={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025"};lx.Batches=nM;lx.MessageBatchesPage=rM;class iM extends el{retrieve(e,t){return this._client.get(`/v1/models/${e}`,t)}list(e={},t){return po(e)?this.list({},e):this._client.getAPIList("/v1/models",sM,{query:e,...t})}}class sM extends sx{}iM.ModelInfosPage=sM;var xU;class Ht extends mse{constructor({baseURL:e=Mb("ANTHROPIC_BASE_URL"),apiKey:t=Mb("ANTHROPIC_API_KEY")??null,authToken:r=Mb("ANTHROPIC_AUTH_TOKEN")??null,...i}={}){const s={apiKey:t,authToken:r,...i,baseURL:e||"https://api.anthropic.com"};if(!s.dangerouslyAllowBrowser&&kse())throw new wt(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new Anthropic({ apiKey, dangerouslyAllowBrowser: true });
`);super({baseURL:s.baseURL,timeout:s.timeout??6e5,httpAgent:s.httpAgent,maxRetries:s.maxRetries,fetch:s.fetch}),this.completions=new vU(this),this.messages=new lx(this),this.models=new iM(this),this.beta=new em(this),this._options=s,this.apiKey=t,this.authToken=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),...this._options.dangerouslyAllowBrowser?{"anthropic-dangerous-direct-browser-access":"true"}:void 0,"anthropic-version":"2023-06-01",...this._options.defaultHeaders}}validateHeaders(e,t){if(!(this.apiKey&&e["x-api-key"])&&t["x-api-key"]!==null&&!(this.authToken&&e.authorization)&&t.authorization!==null)throw new Error('Could not resolve authentication method. Expected either apiKey or authToken to be set. Or for one of the "X-Api-Key" or "Authorization" headers to be explicitly omitted')}authHeaders(e){const t=this.apiKeyAuth(e),r=this.bearerAuth(e);return t!=null&&!L0(t)?t:r!=null&&!L0(r)?r:{}}apiKeyAuth(e){return this.apiKey==null?{}:{"X-Api-Key":this.apiKey}}bearerAuth(e){return this.authToken==null?{}:{Authorization:`Bearer ${this.authToken}`}}}xU=Ht;Ht.Anthropic=xU;Ht.HUMAN_PROMPT=`

Human:`;Ht.AI_PROMPT=`

Assistant:`;Ht.DEFAULT_TIMEOUT=6e5;Ht.AnthropicError=wt;Ht.APIError=or;Ht.APIConnectionError=nx;Ht.APIConnectionTimeoutError=iU;Ht.APIUserAbortError=Xi;Ht.NotFoundError=lU;Ht.ConflictError=cU;Ht.RateLimitError=dU;Ht.BadRequestError=sU;Ht.AuthenticationError=aU;Ht.InternalServerError=hU;Ht.PermissionDeniedError=oU;Ht.UnprocessableEntityError=uU;Ht.toFile=lse;Ht.fileFromPath=rU;Ht.Completions=vU;Ht.Messages=lx;Ht.Models=iM;Ht.ModelInfosPage=sM;Ht.Beta=em;class t2 extends QF{static lc_name(){return"AnthropicToolsOutputParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","anthropic","output_parsers"]}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.zodSchema=e.zodSchema}async _validateResult(e){let t=e;if(typeof e=="string")try{t=JSON.parse(e)}catch(i){throw new BR(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(i.message)}`,e)}else t=e;if(this.zodSchema===void 0)return t;const r=await this.zodSchema.safeParseAsync(t);if(r.success)return r.data;throw new BR(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(r.error.errors)}`,JSON.stringify(t,null,2))}async parseResult(e){const t=e.flatMap(s=>{const{message:a}=s;return Array.isArray(a.content)?_U(a.content)[0]:[]});if(t[0]===void 0)throw new Error("No parseable tool calls provided to AnthropicToolsOutputParser.");const[r]=t;return await this._validateResult(r.args)}}function _U(n){const e=[];for(const t of n)t.type==="tool_use"&&e.push({name:t.name,args:t.input,id:t.id,type:"tool_call"});return e}function Nse(n){if(n)return n==="any"?{type:"any"}:n==="auto"?{type:"auto"}:typeof n=="string"?{type:"tool",name:n}:n}function n2(n){const e=/^data:(image\/.+);base64,(.+)$/,t=n.match(e);if(t===null)throw new Error(["Anthropic only supports base64-encoded images currently.","Example: data:image/png;base64,/9j/4AAQSk..."].join(`

`));return{type:"base64",media_type:t[1]??"",data:t[2]??""}}function Ose(n){const e=[];for(const t of n)if(t._getType()==="tool")if(typeof t.content=="string"){const r=e[e.length-1];(r==null?void 0:r._getType())==="human"&&Array.isArray(r.content)&&"type"in r.content[0]&&r.content[0].type==="tool_result"?r.content.push({type:"tool_result",content:t.content,tool_use_id:t.tool_call_id}):e.push(new Ds({content:[{type:"tool_result",content:t.content,tool_use_id:t.tool_call_id}]}))}else e.push(new Ds({content:[{type:"tool_result",content:a1(t.content),tool_use_id:t.tool_call_id}]}));else e.push(t);return e}function r2(n){if(n.id===void 0)throw new Error('Anthropic requires all tool calls to have an "id".');return{type:"tool_use",id:n.id,name:n.name,input:n.args}}function a1(n){const e=["tool_use","tool_result","input_json_delta"],t=["text","text_delta"];return typeof n=="string"?n:n.map(i=>{const s="cache_control"in i?i.cache_control:void 0;if(i.type==="image_url"){let a;return typeof i.image_url=="string"?a=n2(i.image_url):a=n2(i.image_url.url),{type:"image",source:a,...s?{cache_control:s}:{}}}else{if(i.type==="document")return{...i,...s?{cache_control:s}:{}};if(i.type==="thinking")return{type:"thinking",thinking:i.thinking,signature:i.signature,...s?{cache_control:s}:{}};if(i.type==="redacted_thinking")return{type:"redacted_thinking",data:i.data,...s?{cache_control:s}:{}};if(t.find(a=>a===i.type)&&"text"in i)return{type:"text",text:i.text,...s?{cache_control:s}:{}};if(e.find(a=>a===i.type)){const a={...i};if("index"in a&&delete a.index,a.type==="input_json_delta"&&(a.type="tool_use"),"input"in a)try{a.input=JSON.parse(a.input)}catch{}return{...a,...s?{cache_control:s}:{}}}else throw new Error("Unsupported message content format")}})}function i2(n){const e=Ose(n);let t;e.length>0&&e[0]._getType()==="system"&&(t=n[0].content);const i=(t!==void 0?e.slice(1):e).map(s=>{var o;let a;if(s._getType()==="human")a="user";else if(s._getType()==="ai")a="assistant";else if(s._getType()==="tool")a="user";else throw s._getType()==="system"?new Error("System messages are only permitted as the first passed message."):new Error(`Message type "${s._getType()}" is not supported.`);if(LZ(s)&&((o=s.tool_calls)!=null&&o.length)){if(typeof s.content=="string")return s.content===""?{role:a,content:s.tool_calls.map(r2)}:{role:a,content:[{type:"text",text:s.content},...s.tool_calls.map(r2)]};{const{content:l}=s;return!s.tool_calls.every(u=>l.find(d=>(d.type==="tool_use"||d.type==="input_json_delta")&&d.id===u.id))&&console.warn('The "tool_calls" field on a message is only respected if content is a string.'),{role:a,content:a1(s.content)}}}else return{role:a,content:a1(s.content)}});return{messages:Lse(i),system:t}}function Lse(n){if(!n||n.length<=1)return n;const e=[];let t=n[0];const r=s=>typeof s=="string"?[{type:"text",text:s}]:s,i=s=>s.role!=="user"||typeof s.content=="string"?!1:Array.isArray(s.content)&&s.content.every(a=>a.type==="tool_result");for(let s=1;s<n.length;s+=1){const a=n[s];i(t)&&i(a)?t={...t,content:[...r(t.content),...r(a.content)]}:(e.push(t),t=a)}return e.push(t),e}function Dse(n,e){var t;if(n.type==="message_start"){const{content:r,usage:i,...s}=n.message,a={};for(const[d,h]of Object.entries(s))h!=null&&(a[d]=h);const{input_tokens:o,output_tokens:l,...c}=i??{},u={input_tokens:o,output_tokens:l,total_tokens:o+l,input_token_details:{cache_creation:c.cache_creation_input_tokens,cache_read:c.cache_read_input_tokens}};return{chunk:new pr({content:e.coerceContentToString?"":[],additional_kwargs:a,usage_metadata:e.streamUsage?u:void 0,response_metadata:{usage:{...c}},id:n.message.id})}}else if(n.type==="message_delta"){const r={input_tokens:0,output_tokens:n.usage.output_tokens,total_tokens:n.usage.output_tokens,input_token_details:{cache_creation:n.usage.cache_creation_input_tokens,cache_read:n.usage.cache_read_input_tokens}};return{chunk:new pr({content:e.coerceContentToString?"":[],additional_kwargs:{...n.delta},usage_metadata:e.streamUsage?r:void 0})}}else if(n.type==="content_block_start"&&["tool_use","document"].includes(n.content_block.type)){const r=n.content_block;let i;return r.type==="tool_use"?i=[{id:r.id,index:n.index,name:r.name,args:""}]:i=[],{chunk:new pr({content:e.coerceContentToString?"":[{index:n.index,...n.content_block,input:""}],additional_kwargs:{},tool_call_chunks:i})}}else if(n.type==="content_block_delta"&&["text_delta","citations_delta","thinking_delta","signature_delta"].includes(n.delta.type)){if(e.coerceContentToString&&"text"in n.delta)return{chunk:new pr({content:n.delta.text})};{const r=n.delta;return"citation"in r&&(r.citations=[r.citation],delete r.citation),r.type==="thinking_delta"||r.type==="signature_delta"?{chunk:new pr({content:[{index:n.index,...r,type:"thinking"}]})}:{chunk:new pr({content:[{index:n.index,...r,type:"text"}]})}}}else{if(n.type==="content_block_delta"&&n.delta.type==="input_json_delta")return{chunk:new pr({content:e.coerceContentToString?"":[{index:n.index,input:n.delta.partial_json,type:n.delta.type}],additional_kwargs:{},tool_call_chunks:[{index:n.index,args:n.delta.partial_json}]})};if(n.type==="content_block_start"&&n.content_block.type==="text"){const r=(t=n.content_block)==null?void 0:t.text;if(r!==void 0)return{chunk:new pr({content:e.coerceContentToString?r:[{index:n.index,...n.content_block}],additional_kwargs:{}})}}else{if(n.type==="content_block_start"&&n.content_block.type==="redacted_thinking")return{chunk:new pr({content:e.coerceContentToString?"":[{index:n.index,...n.content_block}]})};if(n.type==="content_block_start"&&n.content_block.type==="thinking"){const r=n.content_block.thinking;return{chunk:new pr({content:e.coerceContentToString?r:[{index:n.index,...n.content_block}]})}}}}return null}function Ise(n,e){const t=e.usage,r=t!=null?{input_tokens:t.input_tokens??0,output_tokens:t.output_tokens??0,total_tokens:(t.input_tokens??0)+(t.output_tokens??0),input_token_details:{cache_creation:t.cache_creation_input_tokens,cache_read:t.cache_read_input_tokens}}:void 0;if(n.length===1&&n[0].type==="text")return[{text:n[0].text,message:new dd({content:n[0].text,additional_kwargs:e,usage_metadata:r,response_metadata:e,id:e.id})}];{const i=_U(n);return[{text:"",message:new dd({content:n,additional_kwargs:e,tool_calls:i,usage_metadata:r,response_metadata:e,id:e.id})}]}}function Ag(n,e){return n.lc_error_code=e,n.message=`${n.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${e}/
`,n}function s2(n){let e;return n.status===400&&n.message.includes("tool")?e=Ag(n,"INVALID_TOOL_RESULTS"):n.status===401?e=Ag(n,"MODEL_AUTHENTICATION"):n.status===404?e=Ag(n,"MODEL_NOT_FOUND"):n.status===429?e=Ag(n,"MODEL_RATE_LIMIT"):e=n,e}function jse(n){return!!(n.tools&&n.tools.length>0)}function Fse(n){for(const e of n.messages??[])if(typeof e.content!="string"){for(const t of e.content??[])if(typeof t=="object"&&t!=null&&t.type==="document"&&typeof t.citations=="object"&&t.citations.enabled)return!0}return!1}function Use(n){return!!(n.thinking&&n.thinking.type==="enabled")}function Bse(n){return"input_schema"in n}function zse(n){if(typeof n.content=="string")return n.content;if(Array.isArray(n.content)&&n.content.length>=1&&"input"in n.content[0])return typeof n.content[0].input=="string"?n.content[0].input:JSON.stringify(n.content[0].input);if(Array.isArray(n.content)&&n.content.length>=1&&"text"in n.content[0])return n.content[0].text}class $se extends lo{static lc_name(){return"ChatAnthropic"}get lc_secrets(){return{anthropicApiKey:"ANTHROPIC_API_KEY",apiKey:"ANTHROPIC_API_KEY"}}get lc_aliases(){return{modelName:"model"}}constructor(e){if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"anthropicApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topK",{enumerable:!0,configurable:!0,writable:!0,value:-1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:-1}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:2048}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"claude-2.1"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"claude-2.1"}),Object.defineProperty(this,"invocationKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"clientOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"thinking",{enumerable:!0,configurable:!0,writable:!0,value:{type:"disabled"}}),Object.defineProperty(this,"batchClient",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streamingClient",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"createClient",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.anthropicApiKey=(e==null?void 0:e.apiKey)??(e==null?void 0:e.anthropicApiKey)??hc("ANTHROPIC_API_KEY"),!this.anthropicApiKey&&!(e!=null&&e.createClient))throw new Error("Anthropic API key not found");this.clientOptions=(e==null?void 0:e.clientOptions)??{},this.apiKey=this.anthropicApiKey,this.apiUrl=e==null?void 0:e.anthropicApiUrl,this.modelName=(e==null?void 0:e.model)??(e==null?void 0:e.modelName)??this.model,this.model=this.modelName,this.invocationKwargs=(e==null?void 0:e.invocationKwargs)??{},this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.topK=(e==null?void 0:e.topK)??this.topK,this.topP=(e==null?void 0:e.topP)??this.topP,this.maxTokens=(e==null?void 0:e.maxTokensToSample)??(e==null?void 0:e.maxTokens)??this.maxTokens,this.stopSequences=(e==null?void 0:e.stopSequences)??this.stopSequences,this.streaming=(e==null?void 0:e.streaming)??!1,this.streamUsage=(e==null?void 0:e.streamUsage)??this.streamUsage,this.thinking=(e==null?void 0:e.thinking)??this.thinking,this.createClient=(e==null?void 0:e.createClient)??(t=>new Ht(t))}getLsParams(e){const t=this.invocationParams(e);return{ls_provider:"anthropic",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:t.temperature??void 0,ls_max_tokens:t.max_tokens??void 0,ls_stop:e.stop}}formatStructuredToolToAnthropic(e){if(!(!e||!e.length))return e.map(t=>{if(Bse(t))return t;if(Bie(t))return{name:t.function.name,description:t.function.description,input_schema:t.function.parameters};if(Kie(t))return{name:t.name,description:t.description,input_schema:R0(t.schema)};throw new Error(`Unknown tool type passed to ChatAnthropic: ${JSON.stringify(t,null,2)}`)})}bindTools(e,t){return this.bind({tools:this.formatStructuredToolToAnthropic(e),...t})}invocationParams(e){const t=Nse(e==null?void 0:e.tool_choice);if(this.thinking.type==="enabled"){if(this.topK!==-1)throw new Error("topK is not supported when thinking is enabled");if(this.topP!==-1)throw new Error("topP is not supported when thinking is enabled");if(this.temperature!==1)throw new Error("temperature is not supported when thinking is enabled");return{model:this.model,stop_sequences:(e==null?void 0:e.stop)??this.stopSequences,stream:this.streaming,max_tokens:this.maxTokens,tools:this.formatStructuredToolToAnthropic(e==null?void 0:e.tools),tool_choice:t,thinking:this.thinking,...this.invocationKwargs}}return{model:this.model,temperature:this.temperature,top_k:this.topK,top_p:this.topP,stop_sequences:(e==null?void 0:e.stop)??this.stopSequences,stream:this.streaming,max_tokens:this.maxTokens,tools:this.formatStructuredToolToAnthropic(e==null?void 0:e.tools),tool_choice:t,thinking:this.thinking,...this.invocationKwargs}}_identifyingParams(){return{model_name:this.model,...this.invocationParams()}}identifyingParams(){return{model_name:this.model,...this.invocationParams()}}async*_streamResponseChunks(e,t,r){var c;const i=this.invocationParams(t),s=i2(e),a={...i,...s,stream:!0},o=!jse(a)&&!Fse(a)&&!Use(a),l=await this.createStreamWithRetry(a,{headers:t.headers});for await(const u of l){if((c=t.signal)!=null&&c.aborted)throw l.controller.abort(),new Error("AbortError: User aborted the request.");const d=this.streamUsage??t.streamUsage,h=Dse(u,{streamUsage:d,coerceContentToString:o});if(!h)continue;const{chunk:p}=h,y=zse(p),v=new HT({message:new pr({content:p.content,additional_kwargs:p.additional_kwargs,tool_call_chunks:p.tool_call_chunks,usage_metadata:d?p.usage_metadata:void 0,response_metadata:p.response_metadata,id:p.id}),text:y??""});yield v,await(r==null?void 0:r.handleLLMNewToken(y??"",void 0,void 0,void 0,void 0,{chunk:v}))}}async _generateNonStreaming(e,t,r){const i=await this.completionWithRetry({...t,stream:!1,...i2(e)},r),{content:s,...a}=i,o=Ise(s,a),{role:l,type:c,...u}=a;return{generations:o,llmOutput:u}}async _generate(e,t,r){if(this.stopSequences&&t.stop)throw new Error('"stopSequence" parameter found in input and default params');const i=this.invocationParams(t);if(i.stream){let s;const a=this._streamResponseChunks(e,t,r);for await(const o of a)s===void 0?s=o:s=s.concat(o);if(s===void 0)throw new Error("No chunks returned from Anthropic API.");return{generations:[{text:s.text,message:s.message}]}}else return this._generateNonStreaming(e,i,{signal:t.signal,headers:t.headers})}async createStreamWithRetry(e,t){if(!this.streamingClient){const i=this.apiUrl?{baseURL:this.apiUrl}:void 0;this.streamingClient=this.createClient({dangerouslyAllowBrowser:!0,...this.clientOptions,...i,apiKey:this.apiKey,maxRetries:0})}const r=async()=>{try{return await this.streamingClient.messages.create({...e,...this.invocationKwargs,stream:!0},t)}catch(i){throw s2(i)}};return this.caller.call(r)}async completionWithRetry(e,t){if(!this.batchClient){const i=this.apiUrl?{baseURL:this.apiUrl}:void 0;this.batchClient=this.createClient({dangerouslyAllowBrowser:!0,...this.clientOptions,...i,apiKey:this.apiKey,maxRetries:0})}const r=async()=>{try{return await this.batchClient.messages.create({...e,...this.invocationKwargs},t)}catch(i){throw s2(i)}};return this.caller.callWithOptions({signal:t.signal??void 0},r)}_llmType(){return"anthropic"}withStructuredOutput(e,t){var y;const r=e,i=t==null?void 0:t.name,s=t==null?void 0:t.method,a=t==null?void 0:t.includeRaw;if(s==="jsonMode")throw new Error('Anthropic only supports "functionCalling" as a method.');let o=i??"extract",l,c;if(KT(r)){const v=R0(r);c=[{name:o,description:v.description??"A function available to call.",input_schema:v}],l=new t2({returnSingle:!0,keyName:o,zodSchema:r})}else{let v;typeof r.name=="string"&&typeof r.description=="string"&&typeof r.input_schema=="object"&&r.input_schema!=null?(v=r,o=r.name):v={name:o,description:r.description??"",input_schema:r},c=[v],l=new t2({returnSingle:!0,keyName:o})}let u;if(((y=this.thinking)==null?void 0:y.type)==="enabled"){const v="Anthropic structured output relies on forced tool calling, which is not supported when `thinking` is enabled. This method will raise OutputParserException if tool calls are not generated. Consider disabling `thinking` or adjust your prompt to ensure the tool is called.";console.warn(v),u=this.bind({tools:c});const g=m=>{if(!m.tool_calls||m.tool_calls.length===0)throw new Error(v);return m};u=u.pipe(g)}else u=this.bind({tools:c,tool_choice:{type:"tool",name:o}});if(!a)return u.pipe(l).withConfig({runName:"ChatAnthropicStructuredOutput"});const d=O0.assign({parsed:(v,g)=>l.invoke(v.raw,g)}),h=O0.assign({parsed:()=>null}),p=d.withFallbacks({fallbacks:[h]});return va.from([{raw:u},p]).withConfig({runName:"StructuredOutputRunnable"})}}class Vse extends $se{}const Hse="modulepreload",Wse=function(n){return"/"+n},a2={},Ta=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(t.map(l=>{if(l=Wse(l),l in a2)return;a2[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":Hse,c||(d.as="script"),d.crossOrigin="",d.href=l,o&&d.setAttribute("nonce",o),document.head.appendChild(d),c)return new Promise((h,p)=>{d.addEventListener("load",h),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})};class aM extends _n{get lc_attributes(){return{partialVariables:void 0}}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts",this._getPromptType()]}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{inputVariables:t}=e;if(t.includes("stop"))throw new Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");Object.assign(this,e)}async mergePartialAndUserVariables(e){const t=this.partialVariables??{},r={};for(const[s,a]of Object.entries(t))typeof a=="string"?r[s]=a:r[s]=await a();return{...r,...e}}async invoke(e,t){return this._callWithConfig(r=>this.formatPromptValue(r),e,{...t,runType:"prompt"})}serialize(){throw new Error("Use .toJSON() instead")}static async deserialize(e){switch(e._type){case"prompt":{const{PromptTemplate:t}=await Ta(async()=>{const{PromptTemplate:r}=await Promise.resolve().then(()=>c2);return{PromptTemplate:r}},void 0);return t.deserialize(e)}case void 0:{const{PromptTemplate:t}=await Ta(async()=>{const{PromptTemplate:r}=await Promise.resolve().then(()=>c2);return{PromptTemplate:r}},void 0);return t.deserialize({...e,_type:"prompt"})}case"few_shot":{const{FewShotPromptTemplate:t}=await Ta(async()=>{const{FewShotPromptTemplate:r}=await import("./few_shot-BgK0zBcE.js");return{FewShotPromptTemplate:r}},[]);return t.deserialize(e)}default:throw new Error(`Invalid prompt type in config: ${e._type}`)}}}class o1 extends aM{async formatPromptValue(e){const t=await this.format(e);return new YF(t)}}/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */var Gse=Object.prototype.toString,Dd=Array.isArray||function(e){return Gse.call(e)==="[object Array]"};function oM(n){return typeof n=="function"}function qse(n){return Dd(n)?"array":typeof n}function jb(n){return n.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function o2(n,e){return n!=null&&typeof n=="object"&&e in n}function Xse(n,e){return n!=null&&typeof n!="object"&&n.hasOwnProperty&&n.hasOwnProperty(e)}var Yse=RegExp.prototype.test;function Kse(n,e){return Yse.call(n,e)}var Zse=/\S/;function Jse(n){return!Kse(Zse,n)}var Qse={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function eae(n){return String(n).replace(/[&<>"'`=\/]/g,function(t){return Qse[t]})}var tae=/\s*/,nae=/\s+/,l2=/\s*=/,rae=/\s*\}/,iae=/#|\^|\/|>|\{|&|=|!/;function sae(n,e){if(!n)return[];var t=!1,r=[],i=[],s=[],a=!1,o=!1,l="",c=0;function u(){if(a&&!o)for(;s.length;)delete i[s.pop()];else s=[];a=!1,o=!1}var d,h,p;function y(M){if(typeof M=="string"&&(M=M.split(nae,2)),!Dd(M)||M.length!==2)throw new Error("Invalid tags: "+M);d=new RegExp(jb(M[0])+"\\s*"),h=new RegExp("\\s*"+jb(M[1])),p=new RegExp("\\s*"+jb("}"+M[1]))}y(e||Hr.tags);for(var v=new tm(n),g,m,x,_,b,w;!v.eos();){if(g=v.pos,x=v.scanUntil(d),x)for(var E=0,S=x.length;E<S;++E)_=x.charAt(E),Jse(_)?(s.push(i.length),l+=_):(o=!0,t=!0,l+=" "),i.push(["text",_,g,g+1]),g+=1,_===`
`&&(u(),l="",c=0,t=!1);if(!v.scan(d))break;if(a=!0,m=v.scan(iae)||"name",v.scan(tae),m==="="?(x=v.scanUntil(l2),v.scan(l2),v.scanUntil(h)):m==="{"?(x=v.scanUntil(p),v.scan(rae),v.scanUntil(h),m="&"):x=v.scanUntil(h),!v.scan(h))throw new Error("Unclosed tag at "+v.pos);if(m==">"?b=[m,x,g,v.pos,l,c,t]:b=[m,x,g,v.pos],c++,i.push(b),m==="#"||m==="^")r.push(b);else if(m==="/"){if(w=r.pop(),!w)throw new Error('Unopened section "'+x+'" at '+g);if(w[1]!==x)throw new Error('Unclosed section "'+w[1]+'" at '+g)}else m==="name"||m==="{"||m==="&"?o=!0:m==="="&&y(x)}if(u(),w=r.pop(),w)throw new Error('Unclosed section "'+w[1]+'" at '+v.pos);return oae(aae(i))}function aae(n){for(var e=[],t,r,i=0,s=n.length;i<s;++i)t=n[i],t&&(t[0]==="text"&&r&&r[0]==="text"?(r[1]+=t[1],r[3]=t[3]):(e.push(t),r=t));return e}function oae(n){for(var e=[],t=e,r=[],i,s,a=0,o=n.length;a<o;++a)switch(i=n[a],i[0]){case"#":case"^":t.push(i),r.push(i),t=i[4]=[];break;case"/":s=r.pop(),s[5]=i[2],t=r.length>0?r[r.length-1][4]:e;break;default:t.push(i)}return e}function tm(n){this.string=n,this.tail=n,this.pos=0}tm.prototype.eos=function(){return this.tail===""};tm.prototype.scan=function(e){var t=this.tail.match(e);if(!t||t.index!==0)return"";var r=t[0];return this.tail=this.tail.substring(r.length),this.pos+=r.length,r};tm.prototype.scanUntil=function(e){var t=this.tail.search(e),r;switch(t){case-1:r=this.tail,this.tail="";break;case 0:r="";break;default:r=this.tail.substring(0,t),this.tail=this.tail.substring(t)}return this.pos+=r.length,r};function gd(n,e){this.view=n,this.cache={".":this.view},this.parent=e}gd.prototype.push=function(e){return new gd(e,this)};gd.prototype.lookup=function(e){var t=this.cache,r;if(t.hasOwnProperty(e))r=t[e];else{for(var i=this,s,a,o,l=!1;i;){if(e.indexOf(".")>0)for(s=i.view,a=e.split("."),o=0;s!=null&&o<a.length;)o===a.length-1&&(l=o2(s,a[o])||Xse(s,a[o])),s=s[a[o++]];else s=i.view[e],l=o2(i.view,e);if(l){r=s;break}i=i.parent}t[e]=r}return oM(r)&&(r=r.call(this.view)),r};function Er(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}Er.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()};Er.prototype.parse=function(e,t){var r=this.templateCache,i=e+":"+(t||Hr.tags).join(":"),s=typeof r<"u",a=s?r.get(i):void 0;return a==null&&(a=sae(e,t),s&&r.set(i,a)),a};Er.prototype.render=function(e,t,r,i){var s=this.getConfigTags(i),a=this.parse(e,s),o=t instanceof gd?t:new gd(t,void 0);return this.renderTokens(a,o,r,e,i)};Er.prototype.renderTokens=function(e,t,r,i,s){for(var a="",o,l,c,u=0,d=e.length;u<d;++u)c=void 0,o=e[u],l=o[0],l==="#"?c=this.renderSection(o,t,r,i,s):l==="^"?c=this.renderInverted(o,t,r,i,s):l===">"?c=this.renderPartial(o,t,r,s):l==="&"?c=this.unescapedValue(o,t):l==="name"?c=this.escapedValue(o,t,s):l==="text"&&(c=this.rawValue(o)),c!==void 0&&(a+=c);return a};Er.prototype.renderSection=function(e,t,r,i,s){var a=this,o="",l=t.lookup(e[1]);function c(h){return a.render(h,t,r,s)}if(l){if(Dd(l))for(var u=0,d=l.length;u<d;++u)o+=this.renderTokens(e[4],t.push(l[u]),r,i,s);else if(typeof l=="object"||typeof l=="string"||typeof l=="number")o+=this.renderTokens(e[4],t.push(l),r,i,s);else if(oM(l)){if(typeof i!="string")throw new Error("Cannot use higher-order sections without the original template");l=l.call(t.view,i.slice(e[3],e[5]),c),l!=null&&(o+=l)}else o+=this.renderTokens(e[4],t,r,i,s);return o}};Er.prototype.renderInverted=function(e,t,r,i,s){var a=t.lookup(e[1]);if(!a||Dd(a)&&a.length===0)return this.renderTokens(e[4],t,r,i,s)};Er.prototype.indentPartial=function(e,t,r){for(var i=t.replace(/[^ \t]/g,""),s=e.split(`
`),a=0;a<s.length;a++)s[a].length&&(a>0||!r)&&(s[a]=i+s[a]);return s.join(`
`)};Er.prototype.renderPartial=function(e,t,r,i){if(r){var s=this.getConfigTags(i),a=oM(r)?r(e[1]):r[e[1]];if(a!=null){var o=e[6],l=e[5],c=e[4],u=a;l==0&&c&&(u=this.indentPartial(a,c,o));var d=this.parse(u,s);return this.renderTokens(d,t,r,u,i)}}};Er.prototype.unescapedValue=function(e,t){var r=t.lookup(e[1]);if(r!=null)return r};Er.prototype.escapedValue=function(e,t,r){var i=this.getConfigEscape(r)||Hr.escape,s=t.lookup(e[1]);if(s!=null)return typeof s=="number"&&i===Hr.escape?String(s):i(s)};Er.prototype.rawValue=function(e){return e[1]};Er.prototype.getConfigTags=function(e){return Dd(e)?e:e&&typeof e=="object"?e.tags:void 0};Er.prototype.getConfigEscape=function(e){if(e&&typeof e=="object"&&!Dd(e))return e.escape};var Hr={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(n){mp.templateCache=n},get templateCache(){return mp.templateCache}},mp=new Er;Hr.clearCache=function(){return mp.clearCache()};Hr.parse=function(e,t){return mp.parse(e,t)};Hr.render=function(e,t,r,i){if(typeof e!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+qse(e)+'" was given as the first argument for mustache#render(template, view, partials)');return mp.render(e,t,r,i)};Hr.escape=eae;Hr.Scanner=tm;Hr.Context=gd;Hr.Writer=Er;function bU(){Hr.escape=n=>n}const j0=n=>{const e=n.split(""),t=[],r=(s,a)=>{for(let o=a;o<e.length;o+=1)if(s.includes(e[o]))return o;return-1};let i=0;for(;i<e.length;)if(e[i]==="{"&&i+1<e.length&&e[i+1]==="{")t.push({type:"literal",text:"{"}),i+=2;else if(e[i]==="}"&&i+1<e.length&&e[i+1]==="}")t.push({type:"literal",text:"}"}),i+=2;else if(e[i]==="{"){const s=r("}",i);if(s<0)throw new Error("Unclosed '{' in template.");t.push({type:"variable",name:e.slice(i+1,s).join("")}),i=s+1}else{if(e[i]==="}")throw new Error("Single '}' in template.");{const s=r("{}",i),a=(s<0?e.slice(i):e.slice(i,s)).join("");t.push({type:"literal",text:a}),i=s<0?e.length:s}}return t},lae=n=>n.map(e=>e[0]==="name"?{type:"variable",name:e[1].includes(".")?e[1].split(".")[0]:e[1]}:["#","&","^",">"].includes(e[0])?{type:"variable",name:e[1]}:{type:"literal",text:e[1]}),l1=n=>{bU();const e=Hr.parse(n);return lae(e)},cae=(n,e)=>j0(n).reduce((t,r)=>{if(r.type==="variable"){if(r.name in e)return t+e[r.name];throw new Error(`(f-string) Missing value for input ${r.name}`)}return t+r.text},""),uae=(n,e)=>(bU(),Hr.render(n,e)),c1={"f-string":cae,mustache:uae},dae={"f-string":j0,mustache:l1},Cu=(n,e,t)=>c1[e](n,t),hae=(n,e)=>dae[e](n),wU=(n,e,t)=>{if(!(e in c1)){const r=Object.keys(c1);throw new Error(`Invalid template format. Got \`${e}\`;
                         should be one of ${r}`)}try{const r=t.reduce((i,s)=>(i[s]="foo",i),{});Array.isArray(n)?n.forEach(i=>{if(i.type==="text")Cu(i.text,e,r);else if(i.type==="image_url")if(typeof i.image_url=="string")Cu(i.image_url,e,r);else{const s=i.image_url.url;Cu(s,e,r)}else throw new Error(`Invalid message template received. ${JSON.stringify(i,null,2)}`)}):Cu(n,e,r)}catch(r){throw new Error(`Invalid prompt schema: ${r.message}`)}};class Yi extends o1{static lc_name(){return"PromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"additionalContentFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e.templateFormat==="mustache"&&e.validateTemplate===void 0&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){if(this.templateFormat==="mustache")throw new Error("Mustache templates cannot be validated.");let t=this.inputVariables;this.partialVariables&&(t=t.concat(Object.keys(this.partialVariables))),wU(this.template,this.templateFormat,t)}}_getPromptType(){return"prompt"}async format(e){const t=await this.mergePartialAndUserVariables(e);return Cu(this.template,this.templateFormat,t)}static fromExamples(e,t,r,i=`

`,s=""){const a=[s,...e,t].join(i);return new Yi({inputVariables:r,template:a})}static fromTemplate(e,t){const{templateFormat:r="f-string",...i}=t??{},s=new Set;return hae(e,r).forEach(a=>{a.type==="variable"&&s.add(a.name)}),new Yi({inputVariables:[...s],templateFormat:r,template:e,...i})}async partial(e){const t=this.inputVariables.filter(s=>!(s in e)),r={...this.partialVariables??{},...e},i={...this,inputVariables:t,partialVariables:r};return new Yi(i)}serialize(){if(this.outputParser!==void 0)throw new Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}static async deserialize(e){if(!e.template)throw new Error("Prompt template must have a template");return new Yi({inputVariables:e.input_variables,template:e.template,templateFormat:e.template_format})}}const c2=Object.freeze(Object.defineProperty({__proto__:null,PromptTemplate:Yi},Symbol.toStringTag,{value:"Module"}));class gf extends aM{static lc_name(){return"ImagePromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","image"]}),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"additionalContentFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.template=e.template,this.templateFormat=e.templateFormat??this.templateFormat,this.validateTemplate=e.validateTemplate??this.validateTemplate,this.additionalContentFields=e.additionalContentFields,this.validateTemplate){let t=this.inputVariables;this.partialVariables&&(t=t.concat(Object.keys(this.partialVariables))),wU([{type:"image_url",image_url:this.template}],this.templateFormat,t)}}_getPromptType(){return"prompt"}async partial(e){const t=this.inputVariables.filter(s=>!(s in e)),r={...this.partialVariables??{},...e},i={...this,inputVariables:t,partialVariables:r};return new gf(i)}async format(e){const t={};for(const[a,o]of Object.entries(this.template))typeof o=="string"?t[a]=Cu(o,this.templateFormat,e):t[a]=o;const r=e.url||t.url,i=e.detail||t.detail;if(!r)throw new Error("Must provide either an image URL.");if(typeof r!="string")throw new Error("url must be a string.");const s={url:r};return i&&(s.detail=i),s}async formatPromptValue(e){const t=await this.format(e);return new _ie(t)}}class lM extends _n{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}async invoke(e,t){return this._callWithConfig(r=>this.formatMessages(r),e,{...t,runType:"prompt"})}}class fae extends lM{static lc_name(){return"MessagesPlaceholder"}constructor(e){typeof e=="string"&&(e={variableName:e}),super(e),Object.defineProperty(this,"variableName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"optional",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.variableName=e.variableName,this.optional=e.optional??!1}get inputVariables(){return[this.variableName]}async formatMessages(e){const t=e[this.variableName];if(this.optional&&!t)return[];if(!t){const i=new Error(`Field "${this.variableName}" in prompt uses a MessagesPlaceholder, which expects an array of BaseMessages as an input value. Received: undefined`);throw i.name="InputFormatError",i}let r;try{Array.isArray(t)?r=t.map(_o):r=[_o(t)]}catch(i){const s=typeof t=="string"?t:JSON.stringify(t,null,2),a=new Error([`Field "${this.variableName}" in prompt uses a MessagesPlaceholder, which expects an array of BaseMessages or coerceable values as input.`,`Received value: ${s}`,`Additional message: ${i.message}`].join(`

`));throw a.name="InputFormatError",a}return r}}class pae extends lM{constructor(e){"prompt"in e||(e={prompt:e}),super(e),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt}get inputVariables(){return this.prompt.inputVariables}async formatMessages(e){return[await this.format(e)]}}class mae extends aM{constructor(e){super(e)}async format(e){return(await this.formatPromptValue(e)).toString()}async formatPromptValue(e){const t=await this.formatMessages(e);return new KF(t)}}class gae extends pae{static lc_name(){return"ChatMessagePromptTemplate"}constructor(e,t){"prompt"in e||(e={prompt:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}async format(e){return new Wv(await this.prompt.format(e),this.role)}static fromTemplate(e,t,r){return new this(Yi.fromTemplate(e,{templateFormat:r==null?void 0:r.templateFormat}),t)}}class cM extends lM{static _messageClass(){throw new Error("Can not invoke _messageClass from inside _StringImageMessagePromptTemplate")}constructor(e,t){if("prompt"in e||(e={prompt:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"additionalOptions",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"messageClass",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"chatMessageClass",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt,Array.isArray(this.prompt)){let r=[];this.prompt.forEach(i=>{"inputVariables"in i&&(r=r.concat(i.inputVariables))}),this.inputVariables=r}else this.inputVariables=this.prompt.inputVariables;this.additionalOptions=t??this.additionalOptions}createMessage(e){const t=this.constructor;if(t._messageClass()){const r=t._messageClass();return new r({content:e})}else if(t.chatMessageClass){const r=t.chatMessageClass();return new r({content:e,role:this.getRoleFromMessageClass(r.lc_name())})}else throw new Error("No message class defined")}getRoleFromMessageClass(e){switch(e){case"HumanMessage":return"human";case"AIMessage":return"ai";case"SystemMessage":return"system";case"ChatMessage":return"chat";default:throw new Error("Invalid message class name")}}static fromTemplate(e,t){if(typeof e=="string")return new this(Yi.fromTemplate(e,t));const r=[];for(const i of e)if(typeof i=="string"||typeof i=="object"&&"text"in i){let s="";typeof i=="string"?s=i:typeof i.text=="string"&&(s=i.text??"");const a={...t,...typeof i!="string"?{additionalContentFields:i}:{}};r.push(Yi.fromTemplate(s,a))}else if(typeof i=="object"&&"image_url"in i){let s=i.image_url??"",a,o=[];if(typeof s=="string"){let l;(t==null?void 0:t.templateFormat)==="mustache"?l=l1(s):l=j0(s);const c=l.flatMap(u=>u.type==="variable"?[u.name]:[]);if(((c==null?void 0:c.length)??0)>0){if(c.length>1)throw new Error(`Only one format variable allowed per image template.
Got: ${c}
From: ${s}`);o=[c[0]]}else o=[];s={url:s},a=new gf({template:s,inputVariables:o,templateFormat:t==null?void 0:t.templateFormat,additionalContentFields:i})}else if(typeof s=="object"){if("url"in s){let l;(t==null?void 0:t.templateFormat)==="mustache"?l=l1(s.url):l=j0(s.url),o=l.flatMap(c=>c.type==="variable"?[c.name]:[])}else o=[];a=new gf({template:s,inputVariables:o,templateFormat:t==null?void 0:t.templateFormat,additionalContentFields:i})}else throw new Error("Invalid image template");r.push(a)}return new this({prompt:r,additionalOptions:t})}async format(e){if(this.prompt instanceof o1){const t=await this.prompt.format(e);return this.createMessage(t)}else{const t=[];for(const r of this.prompt){let i={};if(!("inputVariables"in r))throw new Error(`Prompt ${r} does not have inputVariables defined.`);for(const s of r.inputVariables)i||(i={[s]:e[s]}),i={...i,[s]:e[s]};if(r instanceof o1){const s=await r.format(i);let a;"additionalContentFields"in r&&(a=r.additionalContentFields),t.push({...a,type:"text",text:s})}else if(r instanceof gf){const s=await r.format(i);let a;"additionalContentFields"in r&&(a=r.additionalContentFields),t.push({...a,type:"image_url",image_url:s})}}return this.createMessage(t)}}async formatMessages(e){return[await this.format(e)]}}class SU extends cM{static _messageClass(){return Ds}static lc_name(){return"HumanMessagePromptTemplate"}}class yae extends cM{static _messageClass(){return dd}static lc_name(){return"AIMessagePromptTemplate"}}class vae extends cM{static _messageClass(){return nF}static lc_name(){return"SystemMessagePromptTemplate"}}function xae(n){return typeof n.formatMessages=="function"}function _ae(n,e){if(xae(n)||tF(n))return n;if(Array.isArray(n)&&n[0]==="placeholder"){const i=n[1];if(typeof i!="string"||i[0]!=="{"||i[i.length-1]!=="}")throw new Error(`Invalid placeholder template: "${n[1]}". Expected a variable name surrounded by curly braces.`);const s=i.slice(1,-1);return new fae({variableName:s,optional:!0})}const t=_o(n);let r;if(typeof t.content=="string"?r=t.content:r=t.content.map(i=>"text"in i?{...i,text:i.text}:"image_url"in i?{...i,image_url:i.image_url}:i),t._getType()==="human")return SU.fromTemplate(r,e);if(t._getType()==="ai")return yae.fromTemplate(r,e);if(t._getType()==="system")return vae.fromTemplate(r,e);if(Wv.isInstance(t))return gae.fromTemplate(t.content,t.role,e);throw new Error(`Could not coerce message prompt template from input. Received message type: "${t._getType()}".`)}function bae(n){return n.constructor.lc_name()==="MessagesPlaceholder"}class yf extends mae{static lc_name(){return"ChatPromptTemplate"}get lc_aliases(){return{promptMessages:"messages"}}constructor(e){if(super(e),Object.defineProperty(this,"promptMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),e.templateFormat==="mustache"&&e.validateTemplate===void 0&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){const t=new Set;for(const o of this.promptMessages)if(!(o instanceof Sa))for(const l of o.inputVariables)t.add(l);const r=this.inputVariables,i=new Set(this.partialVariables?r.concat(Object.keys(this.partialVariables)):r),s=new Set([...i].filter(o=>!t.has(o)));if(s.size>0)throw new Error(`Input variables \`${[...s]}\` are not used in any of the prompt messages.`);const a=new Set([...t].filter(o=>!i.has(o)));if(a.size>0)throw new Error(`Input variables \`${[...a]}\` are used in prompt messages but not in the prompt template.`)}}_getPromptType(){return"chat"}async _parseImagePrompts(e,t){if(typeof e.content=="string")return e;const r=await Promise.all(e.content.map(async i=>{if(i.type!=="image_url")return i;let s="";typeof i.image_url=="string"?s=i.image_url:s=i.image_url.url;const o=await Yi.fromTemplate(s,{templateFormat:this.templateFormat}).format(t);return typeof i.image_url!="string"&&"url"in i.image_url?i.image_url.url=o:i.image_url=o,i}));return e.content=r,e}async formatMessages(e){const t=await this.mergePartialAndUserVariables(e);let r=[];for(const i of this.promptMessages)if(i instanceof Sa)r.push(await this._parseImagePrompts(i,t));else{const s=i.inputVariables.reduce((o,l)=>{if(!(l in t)&&!(bae(i)&&i.optional))throw new Error(`Missing value for input variable \`${l.toString()}\``);return o[l]=t[l],o},{}),a=await i.formatMessages(s);r=r.concat(a)}return r}async partial(e){const t=this.inputVariables.filter(s=>!(s in e)),r={...this.partialVariables??{},...e},i={...this,inputVariables:t,partialVariables:r};return new yf(i)}static fromTemplate(e,t){const r=Yi.fromTemplate(e,t),i=new SU({prompt:r});return this.fromMessages([i])}static fromMessages(e,t){const r=e.reduce((a,o)=>a.concat(o instanceof yf?o.promptMessages:[_ae(o,t)]),[]),i=e.reduce((a,o)=>o instanceof yf?Object.assign(a,o.partialVariables):a,Object.create(null)),s=new Set;for(const a of r)if(!(a instanceof Sa))for(const o of a.inputVariables)o in i||s.add(o);return new this({...t,inputVariables:[...s],promptMessages:r,partialVariables:i,templateFormat:t==null?void 0:t.templateFormat})}static fromPromptMessages(e){return this.fromMessages(e)}}const u1="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",wae=(n="claude-3-7-sonnet-20250219")=>new Vse({apiKey:u1,model:n,temperature:.5,anthropicApiKey:u1,maxTokens:1024}),EU=()=>wae(),Sae=async(n,e,t)=>{const r=EU(),i=yf.fromMessages([["system",`You are TradesXBT, an AI trading agent specializing in Solana ecosystem tokens. 
     You analyze market data and provide trading signals with high confidence. 
     Your analysis should be factual, precise, and focused on actionable insights.`],["human",`Analyze the following token and provide a trading signal:
      Token: {token}
      Current Price: {price}
      Market Data: {marketData}
      
      Generate a comprehensive analysis including:
      1. Recommended action (BUY/SELL)
      2. Confidence level (0-100%)
      3. Target price (for 50% gain)
      4. Stop loss price
      5. Brief explanation of reasoning based on market conditions
      6. Risk/reward ratio
      
      Format your response as a JSON object with the following structure:
      {
        "action": "BUY" or "SELL",
        "confidence": number,
        "target": number,
        "stopLoss": number,
        "explanation": "string",
        "riskReward": number
      }
      `]]),s=new Gie,a=i.pipe(r).pipe(s);try{const o=await a.invoke({token:n,price:e,marketData:JSON.stringify(t)});return JSON.parse(o)}catch(o){return console.error("Error generating trade analysis:",o),null}},Eae=async(n,e=[])=>{const t=EU(),r=`You are TradesXBT, an AI trading agent specializing in Solana ecosystem tokens.
  You provide concise, accurate information about crypto trading, market analysis, and investment strategies.
  When discussing tokens or market trends, focus on facts and be transparent about uncertainty.
  Do not make guaranteed price predictions or returns.
  
  If asked about specific tokens, you can provide:
  - ONLY provide analysis for Solana ecosystem tokens
  - For non-Solana tokens, politely explain that you specialize in Solana ecosystem analysis
  - Recent price performance
  - Market capitalization and volume
  - Technical analysis patterns (if valid)
  - News events that might be impacting the token

  IMPORTANT: After analyzing a token, always provide a sentiment score from 0-100 based on:
  - Recent price action
  - Volume trends in the 5min, 15min, and 30min timeframes
  - Market cap movement
  - Technical indicators
  
  Then display one of these ratings based on the score:
  - BEARISH  (score  35)
  - DYOR  (score 36-66)
  - BULLISH  (score  67)
  
  If the momentum score is above 65, also display: "APE IN SIGNAL " to indicate strong momentum.
  
  Example format for the rating:
  "Sentiment Score: 75/100
   Rating: BULLISH 
   APE IN SIGNAL "
  
  Always remind users that all trading involves risk and decisions should be made carefully.`,i=[new Ds({content:[{type:"text",text:n}]})],s=[...e,...i];try{return(await t.invoke(s,{system:r})).content}catch(a){return console.error("Error in chat with agent:",a),"I'm experiencing some technical difficulties. Please try again later."}},Tae=async(n,e=[])=>{try{const t=e.map(s=>({role:s.role,content:s.content}));t.push({role:"user",content:n});const r=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":u1,"anthropic-version":"2023-06-01"},body:JSON.stringify({model:"claude-3-7-sonnet-20250219",messages:t,max_tokens:1024,temperature:.7,system:`You are TradesXBT, an AI trading agent specializing in Solana ecosystem tokens.
        You provide concise, accurate information about crypto trading, market analysis, and investment strategies.
        When discussing tokens or market trends, focus on facts and be transparent about uncertainty.
        Do not make guaranteed price predictions or returns.
        You ONLY provide analysis for Solana ecosystem tokens. For other tokens, politely explain that you specialize in Solana ecosystem analysis.
        
        IMPORTANT: After analyzing a token, always provide a sentiment score from 0-100 based on:
        - Recent price action
        - Volume trends in the 5min, 15min, and 30min timeframes
        - Market cap movement
        - Technical indicators
        
        Then display one of these ratings based on the score:
        - BEARISH  (score  35)
        - DYOR  (score 36-66)
        - BULLISH  (score  67)
        
        If the momentum score is above 65, also display: "APE IN SIGNAL " to indicate strong momentum.
        
        Example format for the rating:
        "Sentiment Score: 75/100
         Rating: BULLISH 
         APE IN SIGNAL "
         
        Always remind users that all trading involves risk and decisions should be made carefully.`})});if(!r.ok)throw new Error(`Anthropic API error: ${r.status}`);const i=await r.json();return{content:i.content[0].text,usage:i.usage}}catch(t){throw console.error("Error in direct Anthropic chat:",t),t}},Mae=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ta(async()=>{const{default:r}=await Promise.resolve().then(()=>Id);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class uM extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class kae extends uM{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Aae extends uM{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Pae extends uM{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var d1;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(d1||(d1={}));var Cae=function(n,e,t,r){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(u){try{c(r.next(u))}catch(d){a(d)}}function l(u){try{c(r.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};class Rae{constructor(e,{headers:t={},customFetch:r,region:i=d1.Any}={}){this.url=e,this.headers=t,this.region=i,this.fetch=Mae(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return Cae(this,void 0,void 0,function*(){try{const{headers:i,method:s,body:a}=t;let o={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let c;a&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=a):typeof a=="string"?(o["Content-Type"]="text/plain",c=a):typeof FormData<"u"&&a instanceof FormData?c=a:(o["Content-Type"]="application/json",c=JSON.stringify(a)));const u=yield this.fetch(`${this.url}/${e}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),i),body:c}).catch(y=>{throw new kae(y)}),d=u.headers.get("x-relay-error");if(d&&d==="true")throw new Aae(u);if(!u.ok)throw new Pae(u);let h=((r=u.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),p;return h==="application/json"?p=yield u.json():h==="application/octet-stream"?p=yield u.blob():h==="text/event-stream"?p=u:h==="multipart/form-data"?p=yield u.formData():p=yield u.text(),{data:p,error:null}}catch(i){return{data:null,error:i}}})}}var Lr={},dM={},cx={},nm={},ux={},dx={},Nae=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},yd=Nae();const Oae=yd.fetch,TU=yd.fetch.bind(yd),MU=yd.Headers,Lae=yd.Request,Dae=yd.Response,Id=Object.freeze(Object.defineProperty({__proto__:null,Headers:MU,Request:Lae,Response:Dae,default:TU,fetch:Oae},Symbol.toStringTag,{value:"Module"})),Iae=K1(Id);var hx={};Object.defineProperty(hx,"__esModule",{value:!0});let jae=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};hx.default=jae;var kU=ai&&ai.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(dx,"__esModule",{value:!0});const Fae=kU(Iae),Uae=kU(hx);let Bae=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Fae.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let i=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var a,o,l;let c=null,u=null,d=null,h=s.status,p=s.statusText;if(s.ok){if(this.method!=="HEAD"){const m=await s.text();m===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=m:u=JSON.parse(m))}const v=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),g=(o=s.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");v&&g&&g.length>1&&(d=parseInt(g[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,d=null,h=406,p="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const v=await s.text();try{c=JSON.parse(v),Array.isArray(c)&&s.status===404&&(u=[],c=null,h=200,p="OK")}catch{s.status===404&&v===""?(h=204,p="No Content"):c={message:v}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,h=200,p="OK"),c&&this.shouldThrowOnError)throw new Uae.default(c)}return{error:c,data:u,count:d,status:h,statusText:p}});return this.shouldThrowOnError||(i=i.catch(s=>{var a,o,l;return{error:{message:`${(a=s==null?void 0:s.name)!==null&&a!==void 0?a:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}};dx.default=Bae;var zae=ai&&ai.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ux,"__esModule",{value:!0});const $ae=zae(dx);let Vae=class extends $ae.default{select(e){let t=!1;const r=(e??"*").split("").map(i=>/\s/.test(i)&&!t?"":(i==='"'&&(t=!t),i)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:i,referencedTable:s=i}={}){const a=s?`${s}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const i=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:i=r}={}){const s=typeof i>"u"?"offset":`${i}.offset`,a=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:i=!1,wal:s=!1,format:a="text"}={}){var o;const l=[e?"analyze":null,t?"verbose":null,r?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${c}"; options=${l};`,a==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};ux.default=Vae;var Hae=ai&&ai.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(nm,"__esModule",{value:!0});const Wae=Hae(ux);let Gae=class extends Wae.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");const a=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${s}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const i=r?`${r}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}};nm.default=Gae;var qae=ai&&ai.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(cx,"__esModule",{value:!0});const bh=qae(nm);let Xae=class{constructor(e,{headers:t={},schema:r,fetch:i}){this.url=e,this.headers=t,this.schema=r,this.fetch=i}select(e,{head:t=!1,count:r}={}){const i=t?"HEAD":"GET";let s=!1;const a=(e??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",a),r&&(this.headers.Prefer=`count=${r}`),new bh.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){const i="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),r||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){const a=e.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(a.length>0){const o=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new bh.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:i,defaultToNull:s=!0}={}){const a="POST",o=[`resolution=${r?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&o.push(this.headers.Prefer),i&&o.push(`count=${i}`),s||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){const l=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new bh.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const r="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),this.headers.Prefer=i.join(","),new bh.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new bh.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};cx.default=Xae;var fx={},px={};Object.defineProperty(px,"__esModule",{value:!0});px.version=void 0;px.version="0.0.0-automated";Object.defineProperty(fx,"__esModule",{value:!0});fx.DEFAULT_HEADERS=void 0;const Yae=px;fx.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Yae.version}`};var AU=ai&&ai.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(dM,"__esModule",{value:!0});const Kae=AU(cx),Zae=AU(nm),Jae=fx;let Qae=class PU{constructor(e,{headers:t={},schema:r,fetch:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},Jae.DEFAULT_HEADERS),t),this.schemaName=r,this.fetch=i}from(e){const t=new URL(`${this.url}/${e}`);return new Kae.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new PU(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:i=!1,count:s}={}){let a;const o=new URL(`${this.url}/rpc/${e}`);let l;r||i?(a=r?"HEAD":"GET",Object.entries(t).filter(([u,d])=>d!==void 0).map(([u,d])=>[u,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([u,d])=>{o.searchParams.append(u,d)})):(a="POST",l=t);const c=Object.assign({},this.headers);return s&&(c.Prefer=`count=${s}`),new Zae.default({method:a,url:o,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};dM.default=Qae;var jd=ai&&ai.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Lr,"__esModule",{value:!0});Lr.PostgrestError=Lr.PostgrestBuilder=Lr.PostgrestTransformBuilder=Lr.PostgrestFilterBuilder=Lr.PostgrestQueryBuilder=Lr.PostgrestClient=void 0;const CU=jd(dM);Lr.PostgrestClient=CU.default;const RU=jd(cx);Lr.PostgrestQueryBuilder=RU.default;const NU=jd(nm);Lr.PostgrestFilterBuilder=NU.default;const OU=jd(ux);Lr.PostgrestTransformBuilder=OU.default;const LU=jd(dx);Lr.PostgrestBuilder=LU.default;const DU=jd(hx);Lr.PostgrestError=DU.default;var eoe=Lr.default={PostgrestClient:CU.default,PostgrestQueryBuilder:RU.default,PostgrestFilterBuilder:NU.default,PostgrestTransformBuilder:OU.default,PostgrestBuilder:LU.default,PostgrestError:DU.default};const{PostgrestClient:toe,PostgrestQueryBuilder:Xxe,PostgrestFilterBuilder:Yxe,PostgrestTransformBuilder:Kxe,PostgrestBuilder:Zxe,PostgrestError:Jxe}=eoe,noe="2.11.2",roe={"X-Client-Info":`realtime-js/${noe}`},ioe="1.0.0",IU=1e4,soe=1e3;var Xu;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Xu||(Xu={}));var Kr;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Kr||(Kr={}));var Vi;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(Vi||(Vi={}));var h1;(function(n){n.websocket="websocket"})(h1||(h1={}));var Rl;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Rl||(Rl={}));class aoe{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const i=t.getUint8(1),s=t.getUint8(2);let a=this.HEADER_LENGTH+2;const o=r.decode(e.slice(a,a+i));a=a+i;const l=r.decode(e.slice(a,a+s));a=a+s;const c=JSON.parse(r.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class jU{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var zt;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(zt||(zt={}));const u2=(n,e,t={})=>{var r;const i=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((s,a)=>(s[a]=ooe(a,n,e,i),s),{})},ooe=(n,e,t,r)=>{const i=e.find(o=>o.name===n),s=i==null?void 0:i.type,a=t[n];return s&&!r.includes(s)?FU(s,a):f1(a)},FU=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return doe(e,t)}switch(n){case zt.bool:return loe(e);case zt.float4:case zt.float8:case zt.int2:case zt.int4:case zt.int8:case zt.numeric:case zt.oid:return coe(e);case zt.json:case zt.jsonb:return uoe(e);case zt.timestamp:return hoe(e);case zt.abstime:case zt.date:case zt.daterange:case zt.int4range:case zt.int8range:case zt.money:case zt.reltime:case zt.text:case zt.time:case zt.timestamptz:case zt.timetz:case zt.tsrange:case zt.tstzrange:return f1(e);default:return f1(e)}},f1=n=>n,loe=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},coe=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},uoe=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},doe=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let s;const a=n.slice(1,t);try{s=JSON.parse("["+a+"]")}catch{s=a?a.split(","):[]}return s.map(o=>FU(e,o))}return n},hoe=n=>typeof n=="string"?n.replace(" ","T"):n,UU=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Fb{constructor(e,t,r={},i=IU){this.channel=e,this.event=t,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var d2;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(d2||(d2={}));class vf{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=vf.syncState(this.state,i,s,a),this.pendingDiffs.forEach(l=>{this.state=vf.syncDiff(this.state,l,s,a)}),this.pendingDiffs=[],o()}),this.channel._on(r.diff,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=vf.syncDiff(this.state,i,s,a),o())}),this.onJoin((i,s,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:a})}),this.onLeave((i,s,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,i){const s=this.cloneDeep(e),a=this.transformState(t),o={},l={};return this.map(s,(c,u)=>{a[c]||(l[c]=u)}),this.map(a,(c,u)=>{const d=s[c];if(d){const h=u.map(g=>g.presence_ref),p=d.map(g=>g.presence_ref),y=u.filter(g=>p.indexOf(g.presence_ref)<0),v=d.filter(g=>h.indexOf(g.presence_ref)<0);y.length>0&&(o[c]=y),v.length>0&&(l[c]=v)}else o[c]=u}),this.syncDiff(s,{joins:o,leaves:l},r,i)}static syncDiff(e,t,r,i){const{joins:s,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(s,(o,l)=>{var c;const u=(c=e[o])!==null&&c!==void 0?c:[];if(e[o]=this.cloneDeep(l),u.length>0){const d=e[o].map(p=>p.presence_ref),h=u.filter(p=>d.indexOf(p.presence_ref)<0);e[o].unshift(...h)}r(o,u,l)}),this.map(a,(o,l)=>{let c=e[o];if(!c)return;const u=l.map(d=>d.presence_ref);c=c.filter(d=>u.indexOf(d.presence_ref)<0),e[o]=c,i(o,c,l),c.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const i=e[r];return"metas"in i?t[r]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):t[r]=i,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var h2;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(h2||(h2={}));var f2;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(f2||(f2={}));var oa;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(oa||(oa={}));class hM{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=Kr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Fb(this,Vi.join,this.params,this.timeout),this.rejoinTimer=new jU(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Kr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Kr.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Kr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Kr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Vi.reply,{},(i,s)=>{this._trigger(this._replyEventName(s),i)}),this.presence=new vf(this),this.broadcastEndpointURL=UU(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:a,private:o}}=this.params;this._onError(u=>e==null?void 0:e(oa.CHANNEL_ERROR,u)),this._onClose(()=>e==null?void 0:e(oa.CLOSED));const l={},c={broadcast:s,presence:a,postgres_changes:(i=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(u=>u.filter))!==null&&i!==void 0?i:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:u})=>{var d;if(this.socket.setAuth(),u===void 0){e==null||e(oa.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,p=(d=h==null?void 0:h.length)!==null&&d!==void 0?d:0,y=[];for(let v=0;v<p;v++){const g=h[v],{filter:{event:m,schema:x,table:_,filter:b}}=g,w=u&&u[v];if(w&&w.event===m&&w.schema===x&&w.table===_&&w.filter===b)y.push(Object.assign(Object.assign({},g),{id:w.id}));else{this.unsubscribe(),e==null||e(oa.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,e&&e(oa.SUBSCRIBED);return}}).receive("error",u=>{e==null||e(oa.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(oa.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,i;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:a}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,o,l;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Kr.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Vi.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const i=new Fb(this,Vi.leave,{},e);i.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}async _fetchWithTimeout(e,t,r){const i=new AbortController,s=setTimeout(()=>i.abort(),r),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(s),a}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Fb(this,e,t,r);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var i,s;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=Vi;if(r&&[o,l,c,u].indexOf(a)>=0&&r!==this._joinRef())return;let h=this._onMessage(a,t,r);if(t&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(p=>{var y,v,g;return((y=p.filter)===null||y===void 0?void 0:y.event)==="*"||((g=(v=p.filter)===null||v===void 0?void 0:v.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===a}).map(p=>p.callback(h,r)):(s=this.bindings[a])===null||s===void 0||s.filter(p=>{var y,v,g,m,x,_;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in p){const b=p.id,w=(y=p.filter)===null||y===void 0?void 0:y.event;return b&&((v=t.ids)===null||v===void 0?void 0:v.includes(b))&&(w==="*"||(w==null?void 0:w.toLocaleLowerCase())===((g=t.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const b=(x=(m=p==null?void 0:p.filter)===null||m===void 0?void 0:m.event)===null||x===void 0?void 0:x.toLocaleLowerCase();return b==="*"||b===((_=t==null?void 0:t.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===a}).map(p=>{if(typeof h=="object"&&"ids"in h){const y=h.data,{schema:v,table:g,commit_timestamp:m,type:x,errors:_}=y;h=Object.assign(Object.assign({},{schema:v,table:g,commit_timestamp:m,eventType:x,new:{},old:{},errors:_}),this._getPayloadRecords(y))}p.callback(h,r)})}_isClosed(){return this.state===Kr.closed}_isJoined(){return this.state===Kr.joined}_isJoining(){return this.state===Kr.joining}_isLeaving(){return this.state===Kr.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const i=e.toLocaleLowerCase(),s={type:i,filter:t,callback:r};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===r&&hM.isEqual(i.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Vi.close,{},e)}_onError(e){this._on(Vi.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Kr.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=u2(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=u2(e.columns,e.old_record)),t}}const foe=()=>{},poe=typeof WebSocket<"u",moe=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class goe{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=roe,this.params={},this.timeout=IU,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=foe,this.conn=null,this.sendBuffer=[],this.serializer=new aoe,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let a;return s?a=s:typeof fetch>"u"?a=(...o)=>Ta(async()=>{const{default:l}=await Promise.resolve().then(()=>Id);return{default:l}},void 0).then(({default:l})=>l(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${e}/${h1.websocket}`,this.httpEndpoint=UU(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const i=(r=t==null?void 0:t.params)===null||r===void 0?void 0:r.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(s,a)=>a(JSON.stringify(s)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new jU(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(poe){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new yoe(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),Ta(async()=>{const{default:e}=await import("./browser-BnSuDdfY.js").then(t=>t.b);return{default:e}},[]).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:ioe}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Xu.connecting:return Rl.Connecting;case Xu.open:return Rl.Open;case Xu.closing:return Rl.Closing;default:return Rl.Closed}}isConnected(){return this.connectionState()===Rl.Open}channel(e,t={config:{}}){const r=new hM(`realtime:${e}`,t,this);return this.channels.push(r),r}push(e){const{topic:t,event:r,payload:i,ref:s}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${t} ${r} (${s})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let r=null;try{r=JSON.parse(atob(t.split(".")[1]))}catch{}if(r&&r.exp&&!(Math.floor(Date.now()/1e3)-r.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`);this.accessTokenValue=t,this.channels.forEach(i=>{t&&i.updateJoinPayload({access_token:t}),i.joinedOnce&&i._isJoined()&&i._push(Vi.access_token,{access_token:t})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(soe,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:i,payload:s,ref:a}=t;a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${r} ${i} ${a&&"("+a+")"||""}`,s),this.channels.filter(o=>o._isMember(r)).forEach(o=>o._trigger(i,s,a)),this.stateChangeCallbacks.message.forEach(o=>o(t))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Vi.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",i=new URLSearchParams(t);return`${e}${r}${i}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([moe],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}}class yoe{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Xu.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class fM extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Cn(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class voe extends fM{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class p1 extends fM{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var xoe=function(n,e,t,r){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(u){try{c(r.next(u))}catch(d){a(d)}}function l(u){try{c(r.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};const BU=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ta(async()=>{const{default:r}=await Promise.resolve().then(()=>Id);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},_oe=()=>xoe(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ta(()=>Promise.resolve().then(()=>Id),void 0)).Response:Response}),m1=n=>{if(Array.isArray(n))return n.map(t=>m1(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const i=t.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[i]=m1(r)}),e};var Ec=function(n,e,t,r){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(u){try{c(r.next(u))}catch(d){a(d)}}function l(u){try{c(r.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};const Ub=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),boe=(n,e,t)=>Ec(void 0,void 0,void 0,function*(){const r=yield _oe();n instanceof r&&!(t!=null&&t.noResolveJson)?n.json().then(i=>{e(new voe(Ub(i),n.status||500))}).catch(i=>{e(new p1(Ub(i),i))}):e(new p1(Ub(n),n))}),woe=(n,e,t,r)=>{const i={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(i.body=JSON.stringify(r)),Object.assign(Object.assign({},i),t))};function rm(n,e,t,r,i,s){return Ec(this,void 0,void 0,function*(){return new Promise((a,o)=>{n(t,woe(e,r,i,s)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>boe(l,o,r))})})}function F0(n,e,t,r){return Ec(this,void 0,void 0,function*(){return rm(n,"GET",e,t,r)})}function co(n,e,t,r,i){return Ec(this,void 0,void 0,function*(){return rm(n,"POST",e,r,i,t)})}function Soe(n,e,t,r,i){return Ec(this,void 0,void 0,function*(){return rm(n,"PUT",e,r,i,t)})}function Eoe(n,e,t,r){return Ec(this,void 0,void 0,function*(){return rm(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function zU(n,e,t,r,i){return Ec(this,void 0,void 0,function*(){return rm(n,"DELETE",e,r,i,t)})}var Pr=function(n,e,t,r){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(u){try{c(r.next(u))}catch(d){a(d)}}function l(u){try{c(r.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};const Toe={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},p2={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Moe{constructor(e,t={},r,i){this.url=e,this.headers=t,this.bucketId=r,this.fetch=BU(i)}uploadOrUpdate(e,t,r,i){return Pr(this,void 0,void 0,function*(){try{let s;const a=Object.assign(Object.assign({},p2),i);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=r,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),i!=null&&i.headers&&(o=Object.assign(Object.assign({},o),i.headers));const c=this._removeEmptyFolders(t),u=this._getFinalPath(c),d=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:s,headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{})),h=yield d.json();return d.ok?{data:{path:c,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(s){if(Cn(s))return{data:null,error:s};throw s}})}upload(e,t,r){return Pr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,i){return Pr(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),a=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",t);try{let l;const c=Object.assign({upsert:p2.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const d=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:u}),h=yield d.json();return d.ok?{data:{path:s,fullPath:h.Key},error:null}:{data:null,error:h}}catch(l){if(Cn(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return Pr(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const i=Object.assign({},this.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");const s=yield co(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:i}),a=new URL(this.url+s.url),o=a.searchParams.get("token");if(!o)throw new fM("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(r){if(Cn(r))return{data:null,error:r};throw r}})}update(e,t,r){return Pr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return Pr(this,void 0,void 0,function*(){try{return{data:yield co(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(Cn(i))return{data:null,error:i};throw i}})}copy(e,t,r){return Pr(this,void 0,void 0,function*(){try{return{data:{path:(yield co(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(Cn(i))return{data:null,error:i};throw i}})}createSignedUrl(e,t,r){return Pr(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),s=yield co(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${a}`)},{data:s,error:null}}catch(i){if(Cn(i))return{data:null,error:i};throw i}})}createSignedUrls(e,t,r){return Pr(this,void 0,void 0,function*(){try{const i=yield co(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${s}`):null})),error:null}}catch(i){if(Cn(i))return{data:null,error:i};throw i}})}download(e,t){return Pr(this,void 0,void 0,function*(){const i=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=s?`?${s}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield F0(this.fetch,`${this.url}/${i}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Cn(o))return{data:null,error:o};throw o}})}info(e){return Pr(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield F0(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:m1(r),error:null}}catch(r){if(Cn(r))return{data:null,error:r};throw r}})}exists(e){return Pr(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Eoe(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(Cn(r)&&r instanceof p1){const i=r.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),i=[],s=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";s!==""&&i.push(s);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&i.push(l);let c=i.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${r}${c}`)}}}remove(e){return Pr(this,void 0,void 0,function*(){try{return{data:yield zU(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Cn(t))return{data:null,error:t};throw t}})}list(e,t,r){return Pr(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},Toe),t),{prefix:e||""});return{data:yield co(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(i){if(Cn(i))return{data:null,error:i};throw i}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const koe="2.7.1",Aoe={"X-Client-Info":`storage-js/${koe}`};var Qc=function(n,e,t,r){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(u){try{c(r.next(u))}catch(d){a(d)}}function l(u){try{c(r.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};class Poe{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},Aoe),t),this.fetch=BU(r)}listBuckets(){return Qc(this,void 0,void 0,function*(){try{return{data:yield F0(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Cn(e))return{data:null,error:e};throw e}})}getBucket(e){return Qc(this,void 0,void 0,function*(){try{return{data:yield F0(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Cn(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Qc(this,void 0,void 0,function*(){try{return{data:yield co(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Cn(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return Qc(this,void 0,void 0,function*(){try{return{data:yield Soe(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Cn(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Qc(this,void 0,void 0,function*(){try{return{data:yield co(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Cn(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Qc(this,void 0,void 0,function*(){try{return{data:yield zU(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Cn(t))return{data:null,error:t};throw t}})}}class Coe extends Poe{constructor(e,t={},r){super(e,t,r)}from(e){return new Moe(this.url,this.headers,e,this.fetch)}}const Roe="2.49.1";let Vh="";typeof Deno<"u"?Vh="deno":typeof document<"u"?Vh="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Vh="react-native":Vh="node";const Noe={"X-Client-Info":`supabase-js-${Vh}/${Roe}`},Ooe={headers:Noe},Loe={schema:"public"},Doe={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Ioe={};var joe=function(n,e,t,r){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(u){try{c(r.next(u))}catch(d){a(d)}}function l(u){try{c(r.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};const Foe=n=>{let e;return n?e=n:typeof fetch>"u"?e=TU:e=fetch,(...t)=>e(...t)},Uoe=()=>typeof Headers>"u"?MU:Headers,Boe=(n,e,t)=>{const r=Foe(t),i=Uoe();return(s,a)=>joe(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:n;let c=new i(a==null?void 0:a.headers);return c.has("apikey")||c.set("apikey",n),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),r(s,Object.assign(Object.assign({},a),{headers:c}))})};var zoe=function(n,e,t,r){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(u){try{c(r.next(u))}catch(d){a(d)}}function l(u){try{c(r.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};function $oe(n){return n.replace(/\/$/,"")}function Voe(n,e){const{db:t,auth:r,realtime:i,global:s}=n,{db:a,auth:o,realtime:l,global:c}=e,u={db:Object.assign(Object.assign({},a),t),auth:Object.assign(Object.assign({},o),r),realtime:Object.assign(Object.assign({},l),i),global:Object.assign(Object.assign({},c),s),accessToken:()=>zoe(this,void 0,void 0,function*(){return""})};return n.accessToken?u.accessToken=n.accessToken:delete u.accessToken,u}const $U="2.68.0",du=30*1e3,g1=3,Bb=g1*du,Hoe="http://localhost:9999",Woe="supabase.auth.token",Goe={"X-Client-Info":`gotrue-js/${$U}`},y1="X-Supabase-Api-Version",VU={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function qoe(n){return Math.round(Date.now()/1e3)+n}function Xoe(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const gs=()=>typeof window<"u"&&typeof document<"u",fl={tested:!1,writable:!1},xf=()=>{if(!gs())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(fl.tested)return fl.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),fl.tested=!0,fl.writable=!0}catch{fl.tested=!0,fl.writable=!1}return fl.writable};function Yoe(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((i,s)=>{e[s]=i})}catch{}return t.searchParams.forEach((r,i)=>{e[i]=r}),e}const HU=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ta(async()=>{const{default:r}=await Promise.resolve().then(()=>Id);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Koe=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",WU=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},Pg=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Cg=async(n,e)=>{await n.removeItem(e)};function Zoe(n){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",r,i,s,a,o,l,c,u=0;for(n=n.replace("-","+").replace("_","/");u<n.length;)a=e.indexOf(n.charAt(u++)),o=e.indexOf(n.charAt(u++)),l=e.indexOf(n.charAt(u++)),c=e.indexOf(n.charAt(u++)),r=a<<2|o>>4,i=(o&15)<<4|l>>2,s=(l&3)<<6|c,t=t+String.fromCharCode(r),l!=64&&i!=0&&(t=t+String.fromCharCode(i)),c!=64&&s!=0&&(t=t+String.fromCharCode(s));return t}class mx{constructor(){this.promise=new mx.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}mx.promiseConstructor=Promise;function m2(n){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=n.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=t[1];return JSON.parse(Zoe(r))}async function Joe(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function Qoe(n,e){return new Promise((r,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const a=await n(s);if(!e(s,null,a)){r(a);return}}catch(a){if(!e(s,a)){i(a);return}}})()})}function ele(n){return("0"+n.toString(16)).substr(-2)}function tle(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let i="";for(let s=0;s<56;s++)i+=t.charAt(Math.floor(Math.random()*r));return i}return crypto.getRandomValues(e),Array.from(e,ele).join("")}async function nle(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),i=new Uint8Array(r);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}function rle(n){return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ile(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await nle(n);return rle(t)}async function eu(n,e,t=!1){const r=tle();let i=r;t&&(i+="/PASSWORD_RECOVERY"),await WU(n,`${e}-code-verifier`,i);const s=await ile(r);return[s,r===s?"plain":"s256"]}const sle=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function ale(n){const e=n.headers.get(y1);if(!e||!e.match(sle))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class pM extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function lt(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class ole extends pM{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function lle(n){return lt(n)&&n.name==="AuthApiError"}class GU extends pM{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Tc extends pM{constructor(e,t,r,i){super(e,r,i),this.name=t,this.status=r}}class to extends Tc{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function cle(n){return lt(n)&&n.name==="AuthSessionMissingError"}class zb extends Tc{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Rg extends Tc{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ng extends Tc{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function ule(n){return lt(n)&&n.name==="AuthImplicitGrantRedirectError"}class g2 extends Tc{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class v1 extends Tc{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function $b(n){return lt(n)&&n.name==="AuthRetryableFetchError"}class y2 extends Tc{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}var dle=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const wl=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),hle=[502,503,504];async function v2(n){var e;if(!Koe(n))throw new v1(wl(n),0);if(hle.includes(n.status))throw new v1(wl(n),n.status);let t;try{t=await n.json()}catch(s){throw new GU(wl(s),s)}let r;const i=ale(n);if(i&&i.getTime()>=VU["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new y2(wl(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new to}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0))throw new y2(wl(t),n.status,t.weak_password.reasons);throw new ole(wl(t),n.status||500,r)}const fle=(n,e,t,r)=>{const i={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),t))};async function bt(n,e,t,r){var i;const s=Object.assign({},r==null?void 0:r.headers);s[y1]||(s[y1]=VU["2024-01-01"].name),r!=null&&r.jwt&&(s.Authorization=`Bearer ${r.jwt}`);const a=(i=r==null?void 0:r.query)!==null&&i!==void 0?i:{};r!=null&&r.redirectTo&&(a.redirect_to=r.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await ple(n,e,t+o,{headers:s,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function ple(n,e,t,r,i,s){const a=fle(e,r,i,s);let o;try{o=await n(t,Object.assign({},a))}catch(l){throw console.error(l),new v1(wl(l),0)}if(o.ok||await v2(o),r!=null&&r.noResolveJson)return o;try{return await o.json()}catch(l){await v2(l)}}function no(n){var e;let t=null;vle(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=qoe(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function x2(n){const e=no(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function mo(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function mle(n){return{data:n,error:null}}function gle(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:i,verification_type:s}=n,a=dle(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:r,redirect_to:i,verification_type:s},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function yle(n){return n}function vle(n){return n.access_token&&n.refresh_token&&n.expires_in}var xle=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};class _le{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=HU(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await bt(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(lt(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await bt(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:mo})}catch(r){if(lt(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=xle(e,["options"]),i=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(i.new_email=r==null?void 0:r.newEmail,delete i.newEmail),await bt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:gle,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(lt(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await bt(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:mo})}catch(t){if(lt(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,i,s,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await bt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(s=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:yle});if(u.error)throw u.error;const d=await u.json(),h=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,p=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(y=>{const v=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(y.split(";")[1].split("=")[1]);c[`${g}Page`]=v}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(lt(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){try{return await bt(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:mo})}catch(t){if(lt(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await bt(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:mo})}catch(r){if(lt(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){try{return await bt(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:mo})}catch(r){if(lt(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:t,error:r}=await bt(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:t,error:r}}catch(t){if(lt(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await bt(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(lt(t))return{data:null,error:t};throw t}}}const ble={getItem:n=>xf()?globalThis.localStorage.getItem(n):null,setItem:(n,e)=>{xf()&&globalThis.localStorage.setItem(n,e)},removeItem:n=>{xf()&&globalThis.localStorage.removeItem(n)}};function _2(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function wle(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const tu={debug:!!(globalThis&&xf()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class qU extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Sle extends qU{}async function Ele(n,e,t){tu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),tu.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async i=>{if(i){tu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,i.name);try{return await t()}finally{tu.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,i.name)}}else{if(e===0)throw tu.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new Sle(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(tu.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}wle();const Tle={url:Hoe,storageKey:Woe,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Goe,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function b2(n,e,t){return await t()}class gp{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=gp.nextInstanceID,gp.nextInstanceID+=1,this.instanceID>0&&gs()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},Tle),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new _le({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=HU(i.fetch),this.lock=i.lock||b2,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:gs()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=Ele:this.lock=b2,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:xf()?this.storage=ble:(this.memoryStorage={},this.storage=_2(this.memoryStorage)):(this.memoryStorage={},this.storage=_2(this.memoryStorage)),gs()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${$U}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=Yoe(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),gs()&&this.detectSessionInUrl&&r!=="none"){const{data:i,error:s}=await this._getSessionFromURL(t,r);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),ule(s)){const l=(e=s.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:a,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return lt(t)?{error:t}:{error:new GU("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,i;try{const s=await bt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:no}),{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(lt(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var t,r,i;try{let s;if("email"in e){const{email:u,password:d,options:h}=e;let p=null,y=null;this.flowType==="pkce"&&([p,y]=await eu(this.storage,this.storageKey)),s=await bt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:u,password:d,data:(t=h==null?void 0:h.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:p,code_challenge_method:y},xform:no})}else if("phone"in e){const{phone:u,password:d,options:h}=e;s=await bt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},channel:(i=h==null?void 0:h.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:no})}else throw new Rg("You must provide either an email or phone number and a password");const{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(lt(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let t;if("email"in e){const{email:s,password:a,options:o}=e;t=await bt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:x2})}else if("phone"in e){const{phone:s,password:a,options:o}=e;t=await bt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:x2})}else throw new Rg("You must provide either an email or phone number and a password");const{data:r,error:i}=t;return i?{data:{user:null,session:null},error:i}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new zb}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:i})}catch(t){if(lt(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,i,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await Pg(this.storage,`${this.storageKey}-code-verifier`),[r,i]=(t??"").split("/");try{const{data:s,error:a}=await bt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:no});if(await Cg(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new zb}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:a})}catch(s){if(lt(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:t,provider:r,token:i,access_token:s,nonce:a}=e,o=await bt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:i,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:no}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new zb}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(t){if(lt(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,i,s,a;try{if("email"in e){const{email:o,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await eu(this.storage,this.storageKey));const{error:d}=await bt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:o,options:l}=e,{data:c,error:u}=await bt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Rg("You must provide either an email or phone number.")}catch(o){if(lt(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,r;try{let i,s;"options"in e&&(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo,s=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:a,error:o}=await bt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:no});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(lt(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var t,r,i;try{let s=null,a=null;return this.flowType==="pkce"&&([s,a]=await eu(this.storage,this.storageKey)),await bt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:a}),headers:this.headers,xform:mle})}catch(s){if(lt(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new to;const{error:i}=await bt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(lt(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:i,options:s}=e,{error:a}=await bt(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:r,type:i,options:s}=e,{data:a,error:o}=await bt(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new Rg("You must provide either an email or phone number and a type")}catch(t){if(lt(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Pg(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<Bb:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!a&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await bt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:mo}):await this._useSession(async t=>{var r,i,s;const{data:a,error:o}=t;if(o)throw o;return!(!((r=a.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new to}:await bt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:mo})})}catch(t){if(lt(t))return cle(t)&&(await this._removeSession(),await Cg(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:i,error:s}=r;if(s)throw s;if(!i.session)throw new to;const a=i.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await eu(this.storage,this.storageKey));const{data:c,error:u}=await bt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:mo});if(u)throw u;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(r){if(lt(r))return{data:{user:null},error:r};throw r}}_decodeJWT(e){return m2(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new to;const t=Date.now()/1e3;let r=t,i=!0,s=null;const a=m2(e.access_token);if(a.exp&&(r=a.exp,i=r<=t),i){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;s={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(t){if(lt(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:a,error:o}=t;if(o)throw o;e=(r=a.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new to;const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(lt(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!gs())throw new Ng("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ng(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new g2("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ng("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new g2("No code detected.");const{data:x,error:_}=await this._exchangeCodeForSession(e.code);if(_)throw _;const b=new URL(window.location.href);return b.searchParams.delete("code"),window.history.replaceState(window.history.state,"",b.toString()),{data:{session:x.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:i,access_token:s,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=e;if(!s||!o||!a||!c)throw new Ng("No session defined in URL");const u=Math.round(Date.now()/1e3),d=parseInt(o);let h=u+d;l&&(h=parseInt(l));const p=h-u;p*1e3<=du&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${d}s`);const y=h-d;u-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,h,u):u-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,h,u);const{data:v,error:g}=await this._getUser(s);if(g)throw g;const m={provider_token:r,provider_refresh_token:i,access_token:s,expires_in:d,expires_at:h,refresh_token:a,token_type:c,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:m,redirectType:e.type},error:null}}catch(r){if(lt(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Pg(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:i,error:s}=t;if(s)return{error:s};const a=(r=i.session)===null||r===void 0?void 0:r.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(lle(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await Cg(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=Xoe(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,i;try{const{data:{session:s},error:a}=t;if(a)throw a;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,t={}){let r=null,i=null;this.flowType==="pkce"&&([r,i]=await eu(this.storage,this.storageKey,!0));try{return await bt(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(s){if(lt(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(lt(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:i}=await this._useSession(async s=>{var a,o,l,c,u;const{data:d,error:h}=s;if(h)throw h;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await bt(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return gs()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(lt(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,i;const{data:s,error:a}=t;if(a)throw a;return await bt(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0})})}catch(t){if(lt(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await Qoe(async i=>(i>0&&await Joe(200*Math.pow(2,i-1)),this._debug(t,"refreshing attempt",i),await bt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:no})),(i,s)=>{const a=200*Math.pow(2,i);return s&&$b(s)&&Date.now()+a-r<du})}catch(r){if(this._debug(t,"error",r),lt(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),gs()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const r=await Pg(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),r!==null&&await this._removeSession();return}const i=((e=r.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<Bb;if(this._debug(t,`session has${i?"":" not"} expired with margin of ${Bb}s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:s}=await this._callRefreshToken(r.refresh_token);s&&(console.error(s),$b(s)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(t,"error",r),console.error(r);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new to;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new mx;const{data:s,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!s.session)throw new to;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(i,"error",s),lt(s)){const a={session:null,error:s};return $b(s)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,t,r=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(l){s.push(l)}});if(await Promise.all(a),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await WU(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Cg(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&gs()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),du);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((r.expires_at*1e3-e)/du);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${du}ms, refresh threshold is ${g1} ticks`),i<=g1&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof qU)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!gs()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const i=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&i.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&i.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[s,a]=await eu(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(o.toString())}if(r!=null&&r.queryParams){const s=new URLSearchParams(r.queryParams);i.push(s.toString())}return r!=null&&r.skipBrowserRedirect&&i.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:i,error:s}=t;return s?{data:null,error:s}:await bt(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(lt(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,i;const{data:s,error:a}=t;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await bt(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(lt(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:i,error:s}=t;if(s)return{data:null,error:s};const{data:a,error:o}=await bt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(t){if(lt(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:i,error:s}=t;return s?{data:null,error:s}:await bt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(lt(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(e==null?void 0:e.factors)||[],i=r.filter(a=>a.factor_type==="totp"&&a.status==="verified"),s=r.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:r,totp:i,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:i},error:s}=e;if(s)return{data:null,error:s};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const a=this._decodeJWT(i.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((r=(t=i.user.factors)===null||t===void 0?void 0:t.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}}gp.nextInstanceID=0;const Mle=gp;class kle extends Mle{constructor(e){super(e)}}var Ale=function(n,e,t,r){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(u){try{c(r.next(u))}catch(d){a(d)}}function l(u){try{c(r.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};class Ple{constructor(e,t,r){var i,s,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=$oe(e);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:Loe,realtime:Ioe,auth:Object.assign(Object.assign({},Doe),{storageKey:l}),global:Ooe},u=Voe(r??{},c);this.storageKey=(i=u.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=u.global.headers)!==null&&s!==void 0?s:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=u.auth)!==null&&a!==void 0?a:{},this.headers,u.global.fetch),this.fetch=Boe(t,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new toe(`${o}/rest/v1`,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),u.accessToken||this._listenForAuthEvents()}get functions(){return new Rae(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Coe(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Ale(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:i,storageKey:s,flowType:a,lock:o,debug:l},c,u){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new kle({url:this.authUrl,headers:Object.assign(Object.assign({},d),c),storageKey:s,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:i,flowType:a,lock:o,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new goe(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Cle=(n,e,t)=>new Ple(n,e,t),Rle="https://ryvnhewpmbfrjmaodtto.supabase.co",Nle="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ5dm5oZXdwbWJmcmptYW9kdHRvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzk4OTU3MzUsImV4cCI6MjA1NTQ3MTczNX0.w9mlZZd6n6t10MLRT4UzKvPvMXcPgyO3UYOXeGc9D5g",Et=Cle(Rle,Nle),wh={async getUserProfile(n){try{const{data:e,error:t}=await Et.from("users").select("*").eq("id",n).single();if(t){if(t.code==="PGRST116"){const{data:r}=await Et.auth.getUser();if(r&&r.user){const{data:i}=await Et.from("users").select("id").eq("id",n).maybeSingle();if(!i)try{await Et.rpc("create_user_profile",{user_id:n,user_email:r.user.email||"user@example.com"})}catch(o){console.error("RPC error creating profile:",o);try{await Et.from("users").insert({id:n,email:r.user.email||"user@example.com",balance:25e3,invested_amount:0,portfolio_value:0,join_date:new Date().toISOString().split("T")[0]})}catch(l){l.code!=="23505"&&console.error("Insert error creating profile:",l)}}const{data:s,error:a}=await Et.from("users").select("*").eq("id",n).single();if(a)throw a;return s}}throw t}return e}catch(e){throw console.error("Error in getUserProfile:",e),e}},async updateUsername(n,e){try{const{data:t,error:r}=await Et.rpc("update_username",{uid:n,new_username:e});if(r)throw r;return t}catch(t){throw console.error("Error updating username:",t),t}},async ensureUserProfile(n,e){try{const{data:t}=await Et.from("users").select("id").eq("id",n).maybeSingle();if(!t)try{await Et.rpc("create_user_profile",{user_id:n,user_email:e})}catch(r){console.error("RPC error creating profile:",r);try{await Et.from("users").insert({id:n,email:e,balance:25e3,invested_amount:0,portfolio_value:0,join_date:new Date().toISOString().split("T")[0]})}catch(i){if(i.code!=="23505")return console.error("Insert error creating profile:",i),!1}}return!0}catch(t){return console.error("Error ensuring user profile exists:",t),!1}},async updateUserBalance(n,e){const{data:t,error:r}=await Et.from("users").update({balance:e}).eq("id",n).select().single();if(r)throw r;return t},async updateInvestedAmount(n,e){try{const{data:t}=await Et.from("users").select("invested_amount, balance").eq("id",n).single();if(!t)throw new Error("User not found");const r=t.invested_amount+e,i=t.balance-e;if(i<0&&e>0)throw new Error("Insufficient balance");const{data:s,error:a}=await Et.from("users").update({invested_amount:r,balance:i}).eq("id",n).select().single();if(a)throw a;return s}catch(t){throw console.error("Error updating invested amount:",t),t}},async updatePortfolioValue(n,e){const{data:t,error:r}=await Et.from("users").update({portfolio_value:e}).eq("id",n).select().single();if(r)throw r;return t},async updateUserReturns(n,e,t){const{data:r,error:i}=await Et.from("users").update({monthly_return:e,all_time_return:t}).eq("id",n).select().single();if(i)throw i;return r}},Og={async saveUserMessage(n,e,t,r){const{data:i,error:s}=await Et.from("chat_history").insert({user_id:n,message:e,role:"user",session_id:t,token_id:r}).select().single();if(s)throw s;return i},async saveAssistantMessage(n,e,t,r,i,s){const{data:a,error:o}=await Et.from("chat_history").insert({user_id:n,message:e,role:"assistant",session_id:t,token_id:r,sentiment_score:i,sentiment_type:s}).select().single();if(o)throw o;return a},async getUserChatHistory(n,e=50){try{const{data:t,error:r}=await Et.from("chat_history").select("session_id").eq("user_id",n).not("session_id","is",null).order("created_at",{ascending:!1});if(r)throw r;const i=[...new Set(t==null?void 0:t.map(c=>c.session_id))],a=(await Promise.all(i.map(async c=>{const{data:u,error:d}=await Et.from("chat_history").select("role").eq("session_id",c).eq("user_id",n);if(d)return null;const h=u==null?void 0:u.some(y=>y.role==="user"),p=u==null?void 0:u.some(y=>y.role==="assistant");return h&&p?c:null}))).filter(c=>c!==null),{data:o,error:l}=await Et.from("chat_history").select("*").eq("user_id",n).in("session_id",a).order("created_at",{ascending:!1}).limit(e);if(l)throw l;return o}catch(t){return console.error("Error getting chat history:",t),[]}},async getTokenChatHistory(n,e,t=20){try{const{data:r}=await Et.from("chat_history").select("session_id").eq("user_id",n).eq("token_id",e).not("session_id","is",null).order("created_at",{ascending:!1}),i=[...new Set(r==null?void 0:r.map(c=>c.session_id))],a=(await Promise.all(i.map(async c=>{const{data:u}=await Et.from("chat_history").select("role").eq("session_id",c).eq("user_id",n),d=u==null?void 0:u.some(p=>p.role==="user"),h=u==null?void 0:u.some(p=>p.role==="assistant");return d&&h?c:null}))).filter(c=>c!==null),{data:o,error:l}=await Et.from("chat_history").select("*").eq("user_id",n).eq("token_id",e).in("session_id",a).order("created_at",{ascending:!1}).limit(t);if(l)throw l;return o}catch(r){return console.error("Error getting token chat history:",r),[]}},async createChatSession(){return crypto.randomUUID()}},XU=k.createContext(void 0),Ole=({children:n})=>{const[e,t]=k.useState(null),[r,i]=k.useState(null),[s,a]=k.useState(!0);k.useEffect(()=>{Et.auth.getSession().then(({data:{session:y}})=>{t(y),i((y==null?void 0:y.user)??null),a(!1)});const{data:{subscription:p}}=Et.auth.onAuthStateChange((y,v)=>{t(v),i((v==null?void 0:v.user)??null),a(!1)});return()=>p.unsubscribe()},[]);const o=async(p,y)=>{a(!0);const v=await Et.auth.signUp({email:p,password:y,options:{emailRedirectTo:`${window.location.origin}/confirm`,data:{email:p}}});if(v.data.user&&!v.error)try{await u(v.data.user.id,p)}catch(g){console.error("Error creating user profile:",g)}return a(!1),v},l=async(p,y)=>{a(!0);const v=await Et.auth.signInWithPassword({email:p,password:y});if(v.data.user&&!v.error)try{await u(v.data.user.id,p)}catch(g){console.error("Error ensuring user profile exists:",g)}return a(!1),v},c=async()=>{a(!0);const{error:p}=await Et.auth.signOut();return a(!1),{error:p}},u=async(p,y)=>{try{const{data:v,error:g}=await Et.from("users").select("id").eq("id",p).maybeSingle();if(g&&console.error("Error checking if user profile exists:",g),!v)try{const{error:m}=await Et.rpc("create_user_profile",{user_id:p,user_email:y});if(m){console.error("RPC error creating profile:",m);try{const{error:x}=await Et.from("users").insert({id:p,email:y,balance:25e3,invested_amount:0,portfolio_value:0,join_date:new Date().toISOString().split("T")[0]}).single();if(x){if(x.code==="23505")return console.log("User profile already exists (concurrent creation)"),!0;throw console.error("Insert error creating profile:",x),x}}catch(x){if(x.code==="23505")return console.log("User profile already exists (concurrent creation)"),!0;throw x}}}catch(m){throw console.error("Error in RPC call:",m),m}return!0}catch(v){return console.error("Error in createUserProfile:",v),!1}},d=async p=>await Et.auth.resetPasswordForEmail(p,{redirectTo:`${window.location.origin}/reset-password`}),h=async p=>await Et.auth.updateUser({password:p});return f.jsx(XU.Provider,{value:{session:e,user:r,loading:s,signUp:o,signIn:l,signOut:c,createUserProfile:u,resetPassword:d,updatePassword:h},children:n})},$s=()=>{const n=k.useContext(XU);if(n===void 0)throw new Error("useSupabase must be used within a SupabaseProvider");return n},YU=k.createContext(void 0),Lle=({children:n})=>{const[e,t]=k.useState(!1),[r,i]=k.useState(null),[s,a]=k.useState([]),[o,l]=k.useState([]),[c,u]=k.useState([]),[d,h]=k.useState(null),[p,y]=k.useState(!1),[v,g]=k.useState(!1),{user:m}=$s();k.useEffect(()=>{h(crypto.randomUUID())},[]);const x=k.useCallback(async()=>{if(!(!m||v)){g(!0);try{const S=await Og.getUserChatHistory(m.id,100);u(S||[])}catch(S){console.error("Error fetching chat history:",S)}finally{g(!1)}}},[m,v]);k.useEffect(()=>{m&&x()},[m,x]);const _=S=>{const M=S.toString().match(/Sentiment Score: (\d+)\/100/i);let N=null,T=null;return M&&M[1]&&(N=parseInt(M[1]),N<=35?T="BEARISH":N<=66?T="DYOR":T="BULLISH",N>65&&S.toString().includes("APE IN SIGNAL")&&(T="APE IN")),{sentimentScore:N,sentimentType:T}},b=async S=>{if(!m){i("You must be logged in to chat with the AI");return}t(!0),i(null);try{try{await Og.saveUserMessage(m.id,S,d||void 0)}catch(M){console.error("Error saving user message:",M)}if(p){const M={role:"user",content:S};l(W=>[...W,M]);let N;try{N=await Tae(S,o)}catch(W){throw console.error("Error calling Anthropic API:",W),new Error("Failed to get a response from the AI. Please try again.")}const T={role:"assistant",content:N.content};l(W=>[...W,T]);const{sentimentScore:P,sentimentType:H}=_(N.content);try{await Og.saveAssistantMessage(m.id,N.content,d||void 0,void 0,P,H)}catch(W){console.error("Error saving assistant message:",W)}}else{const M=new Ds(S);a(W=>[...W,M]);let N;try{N=await Eae(S,s)}catch(W){throw console.error("Error calling LangChain API:",W),new Error("Failed to get a response from the AI. Please try again.")}const T=new dd(N);a(W=>[...W,T]);const{sentimentScore:P,sentimentType:H}=_(N);try{await Og.saveAssistantMessage(m.id,N,d||void 0,void 0,P,H)}catch(W){console.error("Error saving assistant message:",W)}}await x()}catch(M){i("Failed to get a response. Please try again."),console.error("Error in chat:",M)}finally{t(!1)}},w=()=>{a([]),l([]),h(crypto.randomUUID())},E=async(S,M,N)=>{t(!0),i(null);try{return await Sae(S,M,N)}catch(T){return i("Failed to generate trading signal"),console.error("Error generating signal:",T),null}finally{t(!1)}};return f.jsx(YU.Provider,{value:{isLoading:e,error:r,chatHistory:s,directChatHistory:o,storedChatHistory:c,currentSessionId:d,addUserMessage:b,clearChatHistory:w,generateTradeSignal:E,fetchChatHistory:x,useDirectAnthropicAPI:p,setUseDirectAnthropicAPI:y},children:n})},Fd=()=>{const n=k.useContext(YU);if(n===void 0)throw new Error("useAI must be used within an AIProvider");return n},Dle=()=>{const[n,e]=k.useState(""),[t,r]=k.useState([]),[i,s]=k.useState([]),[a,o]=k.useState([]),[l,c]=k.useState(!1),[u,d]=k.useState(!1),[h,p]=k.useState(null),{setSelectedToken:y}=PT(),{addUserMessage:v}=Fd(),g=X3(n,500);k.useEffect(()=>{(async()=>{d(!0),p(null);try{const E=(await ya.getTrendingCoins()).coins.filter(N=>N.item).map(N=>N.item.id).slice(0,5),M=(await ya.getMarketData(E)||[]).map(N=>({id:N.id,symbol:N.symbol.toUpperCase(),name:N.name,image:N.image,current_price:N.current_price||0,market_cap:N.market_cap||0,market_cap_rank:N.market_cap_rank||null,price_change_percentage_24h:N.price_change_percentage_24h||0}));o(M)}catch(w){console.error("Error fetching trending tokens:",w),p("Failed to load trending tokens")}finally{d(!1)}})()},[]);const m=async b=>{if(b.length===0){s([]);return}try{const E=(await ya.getMarketData(b)||[]).map(S=>({id:S.id,symbol:S.symbol.toUpperCase(),name:S.name,image:S.image,current_price:S.current_price||0,market_cap:S.market_cap||0,market_cap_rank:S.market_cap_rank||null,price_change_percentage_24h:S.price_change_percentage_24h||0}));s(E)}catch(w){console.error("Market data error:",w),p("Error fetching token details.")}};k.useEffect(()=>{(async()=>{if(!g||g.length<2){r([]),s([]);return}c(!0),p(null),r([]),s([]);try{const{coins:w}=await ya.searchCoins(g);if(!w||!Array.isArray(w))throw new Error("Invalid search response");r(w),w.length>0&&await m(w.map(E=>E.id))}catch(w){console.error("Search error:",w),p(w instanceof Error?w.message:"Failed to search tokens. Please try again.")}finally{c(!1)}})()},[g]);const x=b=>{const w=b.target.value;e(w),w||(r([]),s([]))},_=async b=>{y(b);const w=`Analyze ${b.name} (${b.symbol}) for me. Current price: $${b.current_price.toLocaleString()}, 24h change: ${b.price_change_percentage_24h.toFixed(2)}%. Market cap: $${b.market_cap.toLocaleString()}. Please provide a detailed analysis including current market conditions, technical indicators, and potential trading opportunities.`;await v(w),e(""),r([])};return f.jsxs("div",{className:"dashboard-card flex flex-col h-full",children:[f.jsxs("div",{className:"relative mb-3",children:[f.jsx(Iv,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 text-light-subtext dark:text-dark-subtext",size:16}),f.jsx("input",{type:"text",value:n,onChange:x,placeholder:"Search Solana tokens...",className:"w-full bg-light-bg/90 dark:bg-dark-bg/90 border border-light-border/20 dark:border-viridian/40 rounded-lg py-1.5 pl-8 pr-3 text-light-text dark:text-dark-text placeholder:text-light-subtext dark:placeholder:text-dark-subtext focus:outline-none focus:border-viridian/40 dark:focus:border-viridian/70 text-sm"})]}),l&&f.jsx("div",{className:"flex justify-center items-center p-4",children:f.jsx(cd,{className:"w-6 h-6 text-viridian animate-spin"})}),h&&f.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/20 border border-red-300 dark:border-red-700 rounded-lg text-red-600 dark:text-red-400 text-xs mb-3",children:h}),!l&&!h&&n&&t.length===0&&f.jsxs("div",{className:"text-center p-4 text-light-subtext dark:text-dark-subtext text-sm",children:['No tokens found matching "',n,'"']}),!l&&i.length>0&&f.jsx("div",{className:"space-y-2 flex-grow overflow-y-auto dashboard-card-content",children:i.map(b=>f.jsxs("div",{className:"flex items-center justify-between p-2.5 rounded-lg bg-light-bg/90 dark:bg-dark-bg/90 hover:bg-light-bg/70 dark:hover:bg-viridian/10 transition-colors border border-light-border/10 dark:border-viridian/30 hover:border-viridian/30 dark:hover:border-viridian/70 cursor-pointer",onClick:()=>_(b),children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("img",{src:b.image,alt:b.name,className:"w-6 h-6 rounded-full"}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-light-text dark:text-dark-text text-sm",children:b.name}),f.jsx("p",{className:"text-xs text-light-subtext dark:text-dark-subtext",children:b.symbol})]})]}),f.jsxs("div",{className:"text-right",children:[f.jsxs("p",{className:"font-medium text-light-text dark:text-dark-text text-sm",children:["$",b.current_price.toLocaleString()]}),f.jsxs("p",{className:`text-xs ${b.price_change_percentage_24h>=0?"text-smaragdine dark:text-smaragdine":"text-red-600 dark:text-red-400"}`,children:[b.price_change_percentage_24h>=0?"+":"",b.price_change_percentage_24h.toFixed(2),"%"]})]})]},b.id))}),!l&&!n&&f.jsxs("div",{className:"flex-grow overflow-y-auto dashboard-card-content",children:[f.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[f.jsx(ud,{size:16,className:"text-viridian"}),f.jsx("h3",{className:"font-semibold text-light-text dark:text-dark-text text-sm",children:"Trending Tokens"})]}),u?f.jsx("div",{className:"flex justify-center items-center p-4",children:f.jsx(cd,{className:"w-5 h-5 text-viridian animate-spin"})}):f.jsx("div",{className:"space-y-2",children:a.map(b=>f.jsxs("div",{className:"flex items-center justify-between p-2.5 rounded-lg bg-light-bg/90 dark:bg-dark-bg/90 hover:bg-light-bg/70 dark:hover:bg-viridian/10 transition-colors border border-light-border/10 dark:border-viridian/30 hover:border-viridian/30 dark:hover:border-viridian/70 cursor-pointer",onClick:()=>_(b),children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("img",{src:b.image,alt:b.name,className:"w-6 h-6 rounded-full"}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-light-text dark:text-dark-text text-sm",children:b.name}),f.jsx("p",{className:"text-xs text-light-subtext dark:text-dark-subtext",children:b.symbol})]})]}),f.jsxs("div",{className:"text-right",children:[f.jsxs("p",{className:"font-medium text-light-text dark:text-dark-text text-sm",children:["$",b.current_price.toLocaleString()]}),f.jsxs("p",{className:`text-xs ${b.price_change_percentage_24h>=0?"text-smaragdine dark:text-smaragdine":"text-red-600 dark:text-red-400"}`,children:[b.price_change_percentage_24h>=0?"+":"",b.price_change_percentage_24h.toFixed(2),"%"]})]})]},b.id))})]})]})},Ja={id:"",email:"",username:null,balance:25e3,investedAmount:0,portfolioValue:0,joinDate:new Date().toLocaleDateString(),nextDistribution:new Date(new Date().setMonth(new Date().getMonth()+1)).toLocaleDateString(),monthlyReturn:18.7,allTimeReturn:142.3},KU=k.createContext(void 0),Ile=({children:n})=>{const[e,t]=k.useState(Ja),[r,i]=k.useState(!0),[s,a]=k.useState(null),{user:o}=$s();k.useEffect(()=>{(async()=>{if(o){i(!0);try{const p=await wh.getUserProfile(o.id);if(p){const y=new Date(p.join_date).toLocaleDateString(),v=p.next_distribution?new Date(p.next_distribution).toLocaleDateString():new Date(new Date().setMonth(new Date().getMonth()+1)).toLocaleDateString();t({id:p.id,email:p.email,username:p.username,balance:p.balance,investedAmount:p.invested_amount,portfolioValue:p.portfolio_value,joinDate:y,nextDistribution:v,monthlyReturn:p.monthly_return||Ja.monthlyReturn,allTimeReturn:p.all_time_return||Ja.allTimeReturn})}else t({...Ja,id:o.id,email:o.email||""})}catch(p){console.error("Error loading user data:",p),a("Failed to load user profile"),t({...Ja,id:o.id,email:o.email||""})}finally{i(!1)}}else t(Ja),i(!1)})()},[o]);const l=async()=>{if(o){i(!0);try{const h=await wh.getUserProfile(o.id);if(h){const p=new Date(h.join_date).toLocaleDateString(),y=h.next_distribution?new Date(h.next_distribution).toLocaleDateString():new Date(new Date().setMonth(new Date().getMonth()+1)).toLocaleDateString();t({id:h.id,email:h.email,username:h.username,balance:h.balance,investedAmount:h.invested_amount,portfolioValue:h.portfolio_value,joinDate:p,nextDistribution:y,monthlyReturn:h.monthly_return||Ja.monthlyReturn,allTimeReturn:h.all_time_return||Ja.allTimeReturn})}}catch(h){console.error("Error refreshing user data:",h),a("Failed to refresh user profile")}finally{i(!1)}}},c=async h=>{if(o)try{await wh.updatePortfolioValue(o.id,h),t(p=>({...p,portfolioValue:h}))}catch(p){console.error("Error updating portfolio value:",p),a("Failed to update portfolio value")}},u=async h=>{if(o)try{const p=e.investedAmount+h,y=e.balance-h;await wh.updateInvestedAmount(o.id,h),t(v=>({...v,investedAmount:p,balance:y}))}catch(p){throw console.error("Error updating invested amount:",p),a("Failed to update investment"),p}},d=async h=>{if(!o)return!1;try{return await wh.updateUsername(o.id,h)?(t(y=>({...y,username:h})),!0):!1}catch(p){return console.error("Error updating username:",p),a("Failed to update username"),!1}};return f.jsx(KU.Provider,{value:{user:e,loading:r,error:s,updatePortfolioValue:c,updateInvestedAmount:u,updateUsername:d,refreshUserData:l},children:n})},im=()=>{const n=k.useContext(KU);if(n===void 0)throw new Error("useUser must be used within a UserProvider");return n},ZU=()=>{const{user:n}=im();return f.jsxs("div",{className:"dashboard-card flex flex-col h-full",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[f.jsx("div",{className:"w-12 h-12 bg-emerald rounded-full flex items-center justify-center text-lg font-bold text-white",children:"T"}),f.jsxs("div",{children:[f.jsx("h3",{className:"card-title",children:"TradesXBT"}),f.jsx("p",{className:"text-light-subtext dark:text-dark-subtext text-xs",children:"AI Trading Specialist"})]})]}),f.jsxs("div",{className:"flex items-center gap-2 mb-3 text-xs",children:[f.jsx("span",{className:"text-light-text dark:text-dark-text",children:"Specialization:"}),f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("div",{className:"w-3 h-3 bg-[#9945FF] rounded-full flex items-center justify-center text-[6px] font-bold text-white",children:"S"}),f.jsx("span",{className:"text-light-subtext dark:text-dark-subtext",children:"Solana Token Analysis"})]})]}),f.jsxs("div",{className:"space-y-3 mb-3",children:[f.jsx("div",{className:"flex justify-between items-center",children:f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(g3,{size:14,className:"text-viridian"}),f.jsx("span",{className:"text-light-subtext dark:text-dark-subtext text-xs",children:"Performance Metrics"})]})}),f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-light-subtext dark:text-dark-subtext text-xs",children:"Monthly Return:"}),f.jsxs("span",{className:"text-lime dark:text-lime flex items-center text-xs",children:[f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 mr-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 10l7-7m0 0l7 7m-7-7v18"})}),"+",n.monthlyReturn,"%"]})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-light-subtext dark:text-dark-subtext text-xs",children:"All-Time Return:"}),f.jsxs("span",{className:"text-lime dark:text-lime flex items-center text-xs",children:[f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 mr-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 10l7-7m0 0l7 7m-7-7v18"})}),"+",n.allTimeReturn,"%"]})]})]})]}),f.jsxs("div",{className:"bg-viridian/10 dark:bg-viridian/20 rounded-lg p-2 mb-3 border border-viridian/30 dark:border-viridian/40 text-xs",children:[f.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[f.jsx(b3,{size:14,className:"text-viridian"}),f.jsx("p",{className:"text-light-text dark:text-dark-text font-medium",children:"Agent Status"})]}),f.jsx("p",{className:"text-light-subtext dark:text-dark-subtext",children:"TradesXBT is continuously monitoring the Solana ecosystem to identify trading opportunities and market insights."})]}),f.jsxs("button",{className:"primary-btn w-full flex items-center justify-center gap-1.5 mt-auto text-xs",children:[f.jsx(Oa,{size:14}),"CHAT WITH AGENT"]})]})},jle=[{id:"solana",name:"Solana",symbol:"SOL",image:"https://assets.coingecko.com/coins/images/4128/large/solana.png",current_price:122.45,market_cap:55453245123,price_change_percentage_30m:.8,price_change_percentage_24h:2.5,last_updated:new Date().toISOString(),confidence_score:87,type:"AI",entry_price:120.5,target_price:135.2,stop_loss:115.3,risk_reward:2.9},{id:"render-token",name:"Render Token",symbol:"RNDR",image:"https://assets.coingecko.com/coins/images/11636/large/rndr.png",current_price:7.82,market_cap:3121489536,price_change_percentage_30m:1.2,price_change_percentage_24h:5.7,last_updated:new Date().toISOString(),confidence_score:82,type:"AI",entry_price:7.75,target_price:8.5,stop_loss:7.25,risk_reward:3},{id:"bonk",name:"Bonk",symbol:"BONK",image:"https://assets.coingecko.com/coins/images/28600/large/bonk.png",current_price:2953e-8,market_cap:1851123456,price_change_percentage_30m:-.7,price_change_percentage_24h:-1.2,last_updated:new Date().toISOString(),confidence_score:65,type:"MEME",entry_price:2953e-8,target_price:354e-7,stop_loss:265e-7,risk_reward:2.1}],Fle=()=>{const n=Ia(),[e,t]=k.useState([]),[r,i]=k.useState(!1),[s,a]=k.useState(null),[o,l]=k.useState(new Date),[c,u]=k.useState(!1),d=g=>g>=1e9?`$${(g/1e9).toFixed(2)}B`:g>=1e6?`$${(g/1e6).toFixed(2)}M`:`$${(g/1e3).toFixed(2)}K`,h=g=>{var _;if(g.length<2)return 0;const m=g[g.length-1][1],x=((_=g[g.length-30])==null?void 0:_[1])||g[0][1];return(m-x)/x*100},p=g=>{let m=50;if(!g)return m;const x=(g.total_volume||0)/(g.market_cap||1);return m+=x*100,g.price_change_percentage_24h>0&&(m+=10),g.market_cap_rank<100&&(m+=10),Math.min(Math.max(Math.round(m),0),100)},y=g=>{if(!g||!g.current_price)return{entry_price:0,target_price:0,stop_loss:0,risk_reward:0};const m=g.current_price,x=Math.abs(g.price_change_percentage_24h||0)/100,_=m*(1-x*.2),b=m*(1+x*2),w=_*(1-x),E=b-_,S=_-w,M=S===0?0:E/S;return{entry_price:_,target_price:b,stop_loss:w,risk_reward:M}};k.useEffect(()=>{let g=!0;const m=async()=>{if(g){i(!0),a(null);try{let _=0,b=!1,w;for(;_<3&&!b;)try{const E=["solana","pyth-network","render-token"],S=["bonk","samoyedcoin"],M=["raydium","marinade-staked-sol","jito-staked-sol"],N=[...E,...S,...M];w=await ya.getMarketData(N),b=!0}catch(E){if(_++,_<3)await new Promise(S=>setTimeout(S,1e3*Math.pow(2,_)));else throw E}if(b&&w){u(!1);const E=w.map(S=>{var T;const M=y(S),N=["solana","pyth-network","render-token"].includes(S.id)?"AI":["bonk","samoyedcoin"].includes(S.id)?"MEME":"DEFI";return{id:S.id,name:S.name,symbol:S.symbol.toUpperCase(),image:S.image,current_price:S.current_price,market_cap:S.market_cap,price_change_percentage_30m:(T=S.sparkline_in_7d)!=null&&T.price?h(S.sparkline_in_7d.price):0,price_change_percentage_24h:S.price_change_percentage_24h,last_updated:S.last_updated,confidence_score:p(S),type:N,...M}});g&&(t(E),l(new Date))}else throw new Error("Failed to fetch market data")}catch(_){console.error("Error fetching signals:",_),g&&(a("Using cached data. Unable to fetch live signals."),t(jle),u(!0))}finally{g&&i(!1)}}};m();const x=setInterval(m,5*60*1e3);return()=>{g=!1,clearInterval(x)}},[]);const v=()=>{n("/portal?tab=signals")};return f.jsxs("div",{className:"dashboard-card flex flex-col h-full",children:[f.jsxs("div",{className:"flex justify-between items-center mb-3",children:[f.jsx("h3",{className:"card-title",children:"Latest Trading Signals"}),f.jsxs("div",{className:"flex items-center gap-1.5",children:[f.jsxs("span",{className:"card-label flex items-center gap-1",children:[f.jsx("span",{className:"w-1.5 h-1.5 bg-lime rounded-full animate-pulse"}),c?"CACHED":"LIVE"]}),f.jsxs("span",{className:"text-xs text-light-subtext dark:text-dark-subtext",children:["Updated ",Math.round((new Date().getTime()-o.getTime())/1e3/60),"m ago"]})]})]}),f.jsx("div",{className:"space-y-2.5 mb-3 flex-grow dashboard-card-content",children:r&&e.length===0?f.jsx("div",{className:"flex justify-center items-center py-4",children:f.jsx("div",{className:"w-5 h-5 border-2 border-viridian border-t-transparent rounded-full animate-spin"})}):s?f.jsx("div",{className:"p-2.5 rounded-lg bg-orange-500/10 border border-orange-500/20 text-orange-400 text-xs mb-2",children:s}):e.map(g=>f.jsxs("div",{className:"p-3 rounded-lg bg-light-bg/80 dark:bg-forest/60 border border-emerald/10 dark:border-emerald/20",children:[f.jsxs("div",{className:"flex justify-between items-start mb-2",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("img",{src:g.image,alt:g.name,className:"w-8 h-8 rounded-full",onError:m=>{m.target.src="https://via.placeholder.com/32"}}),f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-1.5",children:[f.jsx("h4",{className:"font-semibold text-light-text dark:text-dark-text text-sm",children:g.symbol}),f.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${g.type==="AI"?"bg-viridian/20 text-viridian":g.type==="MEME"?"bg-pink-500/20 text-pink-500":"bg-blue-500/20 text-blue-500"}`,children:g.type}),f.jsxs("span",{className:`text-xs ${g.price_change_percentage_30m>=0?"text-lime dark:text-lime":"text-red-500 dark:text-red-400"}`,children:[g.price_change_percentage_30m>=0?"+":"",g.price_change_percentage_30m.toFixed(2),"% (30m)"]})]}),f.jsx("p",{className:"text-xs text-light-subtext dark:text-dark-subtext",children:d(g.market_cap)})]})]}),f.jsxs("div",{className:"text-right",children:[f.jsxs("p",{className:"font-medium text-light-text dark:text-dark-text text-sm",children:["$",g.current_price.toLocaleString()]}),f.jsxs("p",{className:`text-xs ${g.price_change_percentage_24h>=0?"text-lime dark:text-lime":"text-red-500 dark:text-red-400"}`,children:["24h: ",g.price_change_percentage_24h>=0?"+":"",g.price_change_percentage_24h.toFixed(2),"%"]})]})]}),f.jsxs("div",{className:"grid grid-cols-4 gap-1.5 mb-2 text-[0.65rem]",children:[f.jsxs("div",{className:"p-1.5 rounded bg-light-bg/50 dark:bg-dark-bg/50",children:[f.jsx("p",{className:"text-light-subtext dark:text-dark-subtext mb-0.5",children:"Entry"}),f.jsxs("p",{className:"font-medium text-light-text dark:text-dark-text",children:["$",g.entry_price.toFixed(4)]})]}),f.jsxs("div",{className:"p-1.5 rounded bg-light-bg/50 dark:bg-dark-bg/50",children:[f.jsx("p",{className:"text-light-subtext dark:text-dark-subtext mb-0.5",children:"Target"}),f.jsxs("p",{className:"font-medium text-lime dark:text-lime",children:["$",g.target_price.toFixed(4)]})]}),f.jsxs("div",{className:"p-1.5 rounded bg-light-bg/50 dark:bg-dark-bg/50",children:[f.jsx("p",{className:"text-light-subtext dark:text-dark-subtext mb-0.5",children:"Stop Loss"}),f.jsxs("p",{className:"font-medium text-red-500 dark:text-red-400",children:["$",g.stop_loss.toFixed(4)]})]}),f.jsxs("div",{className:"p-1.5 rounded bg-light-bg/50 dark:bg-dark-bg/50",children:[f.jsx("p",{className:"text-light-subtext dark:text-dark-subtext mb-0.5",children:"R/R Ratio"}),f.jsx("p",{className:"font-medium text-light-text dark:text-dark-text",children:g.risk_reward.toFixed(2)})]})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-1.5",children:[f.jsxs("div",{className:`px-1.5 py-0.5 rounded text-[0.65rem] font-medium ${g.confidence_score>=70?"bg-lime/20 text-lime":g.confidence_score>=50?"bg-yellow-500/20 text-yellow-500":"bg-red-500/20 text-red-500"}`,children:[g.confidence_score,"% Confidence"]}),f.jsxs("span",{className:"text-[0.65rem] text-light-subtext dark:text-dark-subtext",children:["Updated ",new Date(g.last_updated).toLocaleTimeString()]})]}),f.jsxs("button",{className:"px-2 py-1 bg-viridian/20 text-viridian rounded-md text-[0.65rem] font-medium hover:bg-viridian/30 transition-colors",children:["BUY ",g.symbol]})]})]},g.id))}),f.jsxs("button",{className:"secondary-btn w-full flex items-center justify-center gap-1.5 mt-auto text-xs",onClick:v,children:["VIEW ALL SIGNALS",f.jsx(p3,{size:14})]})]})},JU=k.createContext(void 0),QU=({children:n})=>{const[e,t]=k.useState({}),[r,i]=k.useState(null),s=(u,d,h)=>{t(p=>({...p,[u]:{cardId:u,title:d,data:h}}))},a=u=>{t(d=>{const h={...d};return delete h[u],h})},o=u=>e[u],l=()=>Object.values(e),c=()=>r?e[r]:void 0;return f.jsx(JU.Provider,{value:{registerCardData:s,unregisterCardData:a,getCardData:o,getAllCardData:l,getFocusedCardData:c,setFocusedCardId:i},children:n})},e4=()=>{const n=k.useContext(JU);if(n===void 0)throw new Error("useCardData must be used within a CardDataProvider");return n},Ule=()=>{const n=Ia(),{selectedToken:e,loadingToken:t,tokenError:r}=PT(),{addUserMessage:i}=Fd(),s=k.useRef(`token-details-${Date.now()}`).current,{registerCardData:a,unregisterCardData:o,setFocusedCardId:l}=e4(),c=async()=>{if(!e)return;const v=`Analyze ${e.name} (${e.symbol}) for me. 
Current price: $${e.current_price.toLocaleString()}
24h change: ${e.price_change_percentage_24h.toFixed(2)}%
Market cap: $${e.market_cap.toLocaleString()}
    
Please provide a detailed analysis including:
1. Current market sentiment based on 5min, 15min, and 30min volume and market cap data
2. Technical analysis with key indicators
3. Support and resistance levels
4. Potential trading opportunities and risks
5. Short-term price forecast
6. Momentum sentiment score (0-100)
7. Your recommendation (BEARISH, DYOR, or BULLISH)`;n("/portal?tab=chat"),setTimeout(()=>{i(v)},100)};k.useEffect(()=>(a(s,"Token Details",e||{}),()=>{o(s)}),[s,a,o,e]);const u=()=>{l(s)},d=()=>{l(null)};if(t)return f.jsx("div",{className:"dashboard-card flex justify-center items-center h-full",children:f.jsx("div",{className:"w-6 h-6 border-2 border-viridian border-t-transparent rounded-full animate-spin"})});if(r)return f.jsxs("div",{className:"dashboard-card flex flex-col items-center justify-center h-full text-center p-4",children:[f.jsx("p",{className:"text-red-500 dark:text-red-400 mb-2 text-sm",children:"Error loading token details"}),f.jsx("p",{className:"text-light-subtext dark:text-dark-subtext text-xs",children:r})]});if(!e)return f.jsxs("div",{className:"dashboard-card flex flex-col items-center justify-center h-full text-center p-4",children:[f.jsx("p",{className:"text-base font-semibold text-light-text dark:text-dark-text mb-2",children:"No Token Selected"}),f.jsx("p",{className:"text-light-subtext dark:text-dark-subtext text-xs",children:"Search and select a token to view detailed information"})]});const h=v=>v>=1e9?`$${(v/1e9).toFixed(2)}B`:v>=1e6?`$${(v/1e6).toFixed(2)}M`:v>=1e3?`$${(v/1e3).toFixed(2)}K`:`$${v.toFixed(2)}`,p=v=>v<1e-6?`$${v.toFixed(10)}`:v<.001?`$${v.toFixed(8)}`:v<1?`$${v.toFixed(6)}`:v<10?`$${v.toFixed(4)}`:`$${v.toFixed(2)}`,y=e.symbol.charAt(0);return f.jsxs("div",{className:"dashboard-card flex flex-col h-full",onClick:u,onFocus:u,onBlur:d,tabIndex:0,children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.image?f.jsx("img",{src:e.image,alt:e.symbol,className:"w-7 h-7 rounded-full"}):f.jsx("div",{className:"w-7 h-7 bg-white dark:bg-dark-bg border-0 dark:border-2 dark:border-viridian rounded-full flex items-center justify-center text-xs font-bold text-black dark:text-viridian",children:y}),f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("h3",{className:"text-sm font-bold text-light-text dark:text-dark-text",children:e.symbol}),f.jsxs("span",{className:`${e.price_change_percentage_24h>=0?"text-smaragdine dark:text-smaragdine":"text-red-600 dark:text-red-400"} text-xs flex items-center gap-0.5`,children:[e.price_change_percentage_24h>=0?f.jsx(ud,{size:12}):f.jsx(Fv,{size:12}),e.price_change_percentage_24h>=0?"+":"",e.price_change_percentage_24h.toFixed(2),"%"]})]}),f.jsx("p",{className:"text-base text-light-text dark:text-dark-text",children:p(e.current_price)})]})]}),f.jsxs("div",{className:"flex-grow overflow-y-auto dashboard-card-content space-y-2",children:[f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsxs("div",{children:[f.jsx("p",{className:"stat-label",children:"Market Cap"}),f.jsx("p",{className:"stat-value text-sm",children:h(e.market_cap)})]}),f.jsxs("div",{children:[f.jsx("p",{className:"stat-label",children:"Rank"}),f.jsxs("p",{className:"stat-value text-sm",children:["#",(e==null?void 0:e.market_cap)||"--"]})]})]}),f.jsxs("div",{className:"bg-light-bg/80 dark:bg-forest/60 rounded-lg p-2 border border-emerald/10 dark:border-emerald/20",children:[f.jsxs("h4",{className:"font-medium text-light-text dark:text-dark-text mb-1.5 flex items-center gap-1 text-xs",children:[f.jsx(Pd,{size:12,className:"text-viridian"}),"Market Metrics"]}),f.jsxs("div",{className:"grid grid-cols-2 gap-x-2 gap-y-1.5",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-[0.65rem] text-light-subtext dark:text-dark-subtext mb-0.5",children:"24h Volume"}),f.jsx("p",{className:"text-xs font-medium text-light-text dark:text-dark-text",children:h((e==null?void 0:e.market_cap)||0)})]}),f.jsxs("div",{children:[f.jsx("p",{className:"text-[0.65rem] text-light-subtext dark:text-dark-subtext mb-0.5",children:"Market Dominance"}),f.jsxs("p",{className:"text-xs font-medium text-light-text dark:text-dark-text",children:[(((e==null?void 0:e.market_cap)||0)/1e9).toFixed(2),"%"]})]}),f.jsxs("div",{children:[f.jsx("p",{className:"text-[0.65rem] text-light-subtext dark:text-dark-subtext mb-0.5",children:"7d Change"}),f.jsxs("p",{className:`text-xs font-medium ${((e==null?void 0:e.price_change_percentage_24h)||0)>=0?"text-smaragdine dark:text-smaragdine":"text-red-600 dark:text-red-400"}`,children:[((e==null?void 0:e.price_change_percentage_24h)||0)>=0?"+":"",((e==null?void 0:e.price_change_percentage_24h)||0).toFixed(2),"%"]})]}),f.jsxs("div",{children:[f.jsx("p",{className:"text-[0.65rem] text-light-subtext dark:text-dark-subtext mb-0.5",children:"30d Change"}),f.jsxs("p",{className:`text-xs font-medium ${((e==null?void 0:e.price_change_percentage_24h)||0)>=0?"text-smaragdine dark:text-smaragdine":"text-red-600 dark:text-red-400"}`,children:[((e==null?void 0:e.price_change_percentage_24h)||0)>=0?"+":"",((e==null?void 0:e.price_change_percentage_24h)||0).toFixed(2),"%"]})]})]})]}),f.jsxs("div",{className:"bg-light-bg/80 dark:bg-forest/60 rounded-lg p-2 border border-emerald/10 dark:border-emerald/20",children:[f.jsxs("h4",{className:"font-medium text-light-text dark:text-dark-text mb-1.5 flex items-center gap-1 text-xs",children:[f.jsx(ud,{size:12,className:"text-viridian"}),"Technical Indicators"]}),f.jsxs("div",{className:"space-y-1",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-[0.65rem] text-light-subtext dark:text-dark-subtext",children:"RSI (14)"}),f.jsx("span",{className:"text-xs font-medium text-light-text dark:text-dark-text",children:"67.8"})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-[0.65rem] text-light-subtext dark:text-dark-subtext",children:"MACD"}),f.jsx("span",{className:"text-xs font-medium text-smaragdine dark:text-smaragdine",children:"Bullish"})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-[0.65rem] text-light-subtext dark:text-dark-subtext",children:"MA (50)"}),f.jsx("span",{className:"text-xs font-medium text-light-text dark:text-dark-text",children:p(e.current_price*.95)})]})]})]})]}),f.jsxs("div",{className:"mt-2 pt-2 border-t border-light-border/10 dark:border-viridian/20",children:[f.jsxs("button",{onClick:c,className:"w-full py-1.5 mb-1 bg-viridian/20 dark:bg-viridian/20 text-viridian font-semibold rounded-md hover:bg-viridian/30 transition-colors dark:border dark:border-viridian flex items-center justify-center gap-1.5 text-xs",children:[f.jsx(y3,{size:12}),"AI INSIGHTS"]}),f.jsxs("a",{href:`https://www.coingecko.com/en/coins/${e.id}`,target:"_blank",rel:"noopener noreferrer",className:"text-[0.65rem] text-light-subtext dark:text-dark-subtext hover:text-viridian dark:hover:text-viridian flex items-center justify-center gap-0.5 transition-colors",children:["View on CoinGecko",f.jsx(_3,{size:9})]})]})]})},Ble=[{content:"Bullish movement predicted for SOL in next 24h based on on-chain data and social media",time:"2h ago",likes:152,comments:24,shares:38},{content:"New trading signal for RAY with 73% confidence, check it on the dashboard",time:"3h ago",likes:98,comments:12,shares:25}],zle=()=>f.jsxs("div",{className:"dashboard-card flex flex-col h-full",children:[f.jsxs("div",{className:"flex justify-between items-center mb-3",children:[f.jsx("h3",{className:"card-title",children:"Social Presence"}),f.jsxs("span",{className:"px-1.5 py-0.5 bg-lime/20 text-lime text-[0.65rem] font-medium rounded-full flex items-center gap-1",children:[f.jsx(u0,{size:10,className:"fill-lime stroke-lime"}),"CONNECTED"]})]}),f.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-base font-semibold text-light-text dark:text-dark-text",children:"12.5K"}),f.jsx("p",{className:"text-light-subtext dark:text-dark-subtext text-xs",children:"Followers"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-base font-semibold text-light-text dark:text-dark-text",children:"347"}),f.jsx("p",{className:"text-light-subtext dark:text-dark-subtext text-xs",children:"Posts"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-base font-semibold text-light-text dark:text-dark-text",children:"4.8%"}),f.jsx("p",{className:"text-light-subtext dark:text-dark-subtext text-xs",children:"Engagement"})]})]}),f.jsx("h4",{className:"text-light-text dark:text-dark-text font-medium mb-2 text-xs",children:"Recent Updates"}),f.jsx("div",{className:"space-y-2 flex-grow dashboard-card-content",children:Ble.map((n,e)=>f.jsxs("div",{className:"p-2.5 rounded-lg bg-light-bg/80 dark:bg-forest/60 border border-emerald/10 dark:border-emerald/20",children:[f.jsx("p",{className:"text-xs text-light-subtext dark:text-dark-subtext mb-2",children:n.content}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-light-subtext dark:text-dark-subtext text-[0.65rem]",children:n.time}),f.jsxs("div",{className:"flex items-center gap-2 text-[0.65rem] text-light-subtext dark:text-dark-subtext",children:[f.jsxs("div",{className:"flex items-center gap-0.5",children:[f.jsx(u0,{size:10}),f.jsx("span",{children:n.likes})]}),f.jsxs("div",{className:"flex items-center gap-0.5",children:[f.jsx(d0,{size:10}),f.jsx("span",{children:n.comments})]}),f.jsxs("div",{className:"flex items-center gap-0.5",children:[f.jsx(ST,{size:10}),f.jsx("span",{children:n.shares})]})]})]})]},e))})]}),Sh=({icon:n,label:e,active:t,onClick:r})=>f.jsxs("button",{onClick:r,className:`flex items-center gap-2 px-3 py-1.5 rounded-lg transition-colors text-sm ${t?"text-viridian dark:text-viridian border-b-2 border-viridian":"text-light-text dark:text-dark-subtext hover:text-viridian dark:hover:text-viridian"}`,children:[n,f.jsx("span",{className:"font-medium",children:e})]}),$le=({activeTab:n,onTabChange:e})=>f.jsxs("div",{className:"flex items-center gap-1 overflow-x-auto pb-1 border-b border-dark-border/20",children:[f.jsx(Sh,{icon:f.jsx(vY,{size:16}),label:"Dashboard",active:n==="dashboard",onClick:()=>e("dashboard")}),f.jsx(Sh,{icon:f.jsx(Zf,{size:16}),label:"Charts",active:n==="charts",onClick:()=>e("charts")}),f.jsx(Sh,{icon:f.jsx(Pd,{size:16}),label:"Signals",active:n==="signals",onClick:()=>e("signals")}),f.jsx(Sh,{icon:f.jsx(Oa,{size:16}),label:"AI Chat",active:n==="chat",onClick:()=>e("chat")}),f.jsx(Sh,{icon:f.jsx(hy,{size:16}),label:"Profile",active:n==="profile",onClick:()=>e("profile")})]}),t4=k.createContext(void 0),Vle=({children:n})=>{const[e,t]=k.useState(()=>{const i=localStorage.getItem("theme");return i?i==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches});k.useEffect(()=>{e?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("theme",e?"dark":"light")},[e]);const r=()=>{t(!e)};return f.jsx(t4.Provider,{value:{isDark:e,toggleTheme:r},children:n})},Mc=()=>{const n=k.useContext(t4);if(n===void 0)throw new Error("useTheme must be used within a ThemeProvider");return n},Hle=()=>{const{isDark:n,toggleTheme:e}=Mc();return f.jsx("button",{onClick:e,className:"p-1.5 rounded-full bg-viridian/10 dark:bg-transparent text-viridian dark:text-viridian hover:bg-viridian/20 dark:hover:bg-viridian/20 transition-colors dark:border dark:border-viridian/70","aria-label":n?"Switch to light mode":"Switch to dark mode",children:n?f.jsx(NY,{size:16}):f.jsx(TY,{size:16})})},Wle=({onClose:n})=>{const{user:e,updateUsername:t}=im(),[r,i]=k.useState(e.username||""),[s,a]=k.useState(!1),[o,l]=k.useState(null),[c,u]=k.useState(!1),d=k.useRef(null);k.useEffect(()=>{function y(v){d.current&&!d.current.contains(v.target)&&n()}return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[n]);const h=y=>y.trim()?y.length<3?"Username must be at least 3 characters":y.length>20?"Username must be less than 20 characters":/^[a-zA-Z0-9_]+$/.test(y)?null:"Username can only contain letters, numbers, and underscores":"Username cannot be empty",p=async y=>{y.preventDefault();const v=h(r);if(v){l(v);return}a(!0),l(null);try{await t(r)?(u(!0),setTimeout(()=>{n()},1500)):l("Failed to update username. Please try again.")}catch(g){l("An error occurred while updating username."),console.error("Error updating username:",g)}finally{a(!1)}};return f.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:f.jsxs("div",{ref:d,className:"bg-light-card dark:bg-dark-card border border-light-border/20 dark:border-viridian/30 rounded-lg p-6 w-full max-w-md shadow-lg",children:[f.jsxs("div",{className:"flex justify-between items-center mb-4",children:[f.jsx("h3",{className:"text-xl font-bold text-light-text dark:text-dark-text",children:e.username?"Update Username":"Create Username"}),f.jsx("button",{onClick:n,className:"p-2 hover:bg-viridian/10 rounded-lg text-light-subtext dark:text-dark-subtext",children:f.jsx(yr,{size:20})})]}),o&&f.jsx("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-500/10 border border-red-300 dark:border-red-500/30 rounded-lg text-red-500 dark:text-red-400 text-sm",children:o}),c&&f.jsx("div",{className:"mb-4 p-3 bg-green-100 dark:bg-green-500/10 border border-green-300 dark:border-green-500/30 rounded-lg text-green-600 dark:text-green-400 text-sm",children:"Username updated successfully!"}),f.jsxs("form",{onSubmit:p,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-light-subtext dark:text-dark-subtext mb-1",children:"Username"}),f.jsx("input",{id:"username",type:"text",value:r,onChange:y=>i(y.target.value),disabled:s||c,className:"w-full bg-light-bg/90 dark:bg-dark-bg/90 border border-light-border/20 dark:border-viridian/40 rounded-lg py-2 px-3 text-light-text dark:text-dark-text focus:outline-none focus:border-viridian/40 dark:focus:border-viridian/70",placeholder:"Enter username"}),f.jsx("p",{className:"mt-1 text-xs text-light-subtext dark:text-dark-subtext",children:"Your username will be displayed in the application."})]}),f.jsxs("div",{className:"flex justify-end gap-3",children:[f.jsx("button",{type:"button",onClick:n,disabled:s||c,className:"secondary-btn py-2 px-4",children:"Cancel"}),f.jsx("button",{type:"submit",disabled:s||c,className:"primary-btn py-2 px-4",children:s?f.jsxs("span",{className:"flex items-center justify-center",children:[f.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):c?"Saved!":"Save"})]})]})]})})};function us(n){const e=Object.prototype.toString.call(n);return n instanceof Date||typeof n=="object"&&e==="[object Date]"?new n.constructor(+n):typeof n=="number"||e==="[object Number]"||typeof n=="string"||e==="[object String]"?new Date(n):new Date(NaN)}function pc(n,e){return n instanceof Date?new n.constructor(e):new Date(e)}const n4=6048e5,Gle=864e5;let qle={};function gx(){return qle}function yp(n,e){var o,l,c,u;const t=gx(),r=(e==null?void 0:e.weekStartsOn)??((l=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??t.weekStartsOn??((u=(c=t.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,i=us(n),s=i.getDay(),a=(s<r?7:0)+s-r;return i.setDate(i.getDate()-a),i.setHours(0,0,0,0),i}function U0(n){return yp(n,{weekStartsOn:1})}function r4(n){const e=us(n),t=e.getFullYear(),r=pc(n,0);r.setFullYear(t+1,0,4),r.setHours(0,0,0,0);const i=U0(r),s=pc(n,0);s.setFullYear(t,0,4),s.setHours(0,0,0,0);const a=U0(s);return e.getTime()>=i.getTime()?t+1:e.getTime()>=a.getTime()?t:t-1}function w2(n){const e=us(n);return e.setHours(0,0,0,0),e}function S2(n){const e=us(n),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+n-+t}function Xle(n,e){const t=w2(n),r=w2(e),i=+t-S2(t),s=+r-S2(r);return Math.round((i-s)/Gle)}function Yle(n){const e=r4(n),t=pc(n,0);return t.setFullYear(e,0,4),t.setHours(0,0,0,0),U0(t)}function Kle(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function Zle(n){if(!Kle(n)&&typeof n!="number")return!1;const e=us(n);return!isNaN(Number(e))}function Jle(n){const e=us(n),t=pc(n,0);return t.setFullYear(e.getFullYear(),0,1),t.setHours(0,0,0,0),t}const Qle={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},ece=(n,e,t)=>{let r;const i=Qle[n];return typeof i=="string"?r=i:e===1?r=i.one:r=i.other.replace("{{count}}",e.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function Vb(n){return(e={})=>{const t=e.width?String(e.width):n.defaultWidth;return n.formats[t]||n.formats[n.defaultWidth]}}const tce={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},nce={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},rce={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},ice={date:Vb({formats:tce,defaultWidth:"full"}),time:Vb({formats:nce,defaultWidth:"full"}),dateTime:Vb({formats:rce,defaultWidth:"full"})},sce={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},ace=(n,e,t,r)=>sce[n];function Eh(n){return(e,t)=>{const r=t!=null&&t.context?String(t.context):"standalone";let i;if(r==="formatting"&&n.formattingValues){const a=n.defaultFormattingWidth||n.defaultWidth,o=t!=null&&t.width?String(t.width):a;i=n.formattingValues[o]||n.formattingValues[a]}else{const a=n.defaultWidth,o=t!=null&&t.width?String(t.width):n.defaultWidth;i=n.values[o]||n.values[a]}const s=n.argumentCallback?n.argumentCallback(e):e;return i[s]}}const oce={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},lce={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},cce={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},uce={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},dce={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},hce={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},fce=(n,e)=>{const t=Number(n),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},pce={ordinalNumber:fce,era:Eh({values:oce,defaultWidth:"wide"}),quarter:Eh({values:lce,defaultWidth:"wide",argumentCallback:n=>n-1}),month:Eh({values:cce,defaultWidth:"wide"}),day:Eh({values:uce,defaultWidth:"wide"}),dayPeriod:Eh({values:dce,defaultWidth:"wide",formattingValues:hce,defaultFormattingWidth:"wide"})};function Th(n){return(e,t={})=>{const r=t.width,i=r&&n.matchPatterns[r]||n.matchPatterns[n.defaultMatchWidth],s=e.match(i);if(!s)return null;const a=s[0],o=r&&n.parsePatterns[r]||n.parsePatterns[n.defaultParseWidth],l=Array.isArray(o)?gce(o,d=>d.test(a)):mce(o,d=>d.test(a));let c;c=n.valueCallback?n.valueCallback(l):l,c=t.valueCallback?t.valueCallback(c):c;const u=e.slice(a.length);return{value:c,rest:u}}}function mce(n,e){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&e(n[t]))return t}function gce(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return t}function yce(n){return(e,t={})=>{const r=e.match(n.matchPattern);if(!r)return null;const i=r[0],s=e.match(n.parsePattern);if(!s)return null;let a=n.valueCallback?n.valueCallback(s[0]):s[0];a=t.valueCallback?t.valueCallback(a):a;const o=e.slice(i.length);return{value:a,rest:o}}}const vce=/^(\d+)(th|st|nd|rd)?/i,xce=/\d+/i,_ce={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},bce={any:[/^b/i,/^(a|c)/i]},wce={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Sce={any:[/1/i,/2/i,/3/i,/4/i]},Ece={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Tce={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Mce={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},kce={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Ace={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Pce={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Cce={ordinalNumber:yce({matchPattern:vce,parsePattern:xce,valueCallback:n=>parseInt(n,10)}),era:Th({matchPatterns:_ce,defaultMatchWidth:"wide",parsePatterns:bce,defaultParseWidth:"any"}),quarter:Th({matchPatterns:wce,defaultMatchWidth:"wide",parsePatterns:Sce,defaultParseWidth:"any",valueCallback:n=>n+1}),month:Th({matchPatterns:Ece,defaultMatchWidth:"wide",parsePatterns:Tce,defaultParseWidth:"any"}),day:Th({matchPatterns:Mce,defaultMatchWidth:"wide",parsePatterns:kce,defaultParseWidth:"any"}),dayPeriod:Th({matchPatterns:Ace,defaultMatchWidth:"any",parsePatterns:Pce,defaultParseWidth:"any"})},Rce={code:"en-US",formatDistance:ece,formatLong:ice,formatRelative:ace,localize:pce,match:Cce,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Nce(n){const e=us(n);return Xle(e,Jle(e))+1}function Oce(n){const e=us(n),t=+U0(e)-+Yle(e);return Math.round(t/n4)+1}function i4(n,e){var u,d,h,p;const t=us(n),r=t.getFullYear(),i=gx(),s=(e==null?void 0:e.firstWeekContainsDate)??((d=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??i.firstWeekContainsDate??((p=(h=i.locale)==null?void 0:h.options)==null?void 0:p.firstWeekContainsDate)??1,a=pc(n,0);a.setFullYear(r+1,0,s),a.setHours(0,0,0,0);const o=yp(a,e),l=pc(n,0);l.setFullYear(r,0,s),l.setHours(0,0,0,0);const c=yp(l,e);return t.getTime()>=o.getTime()?r+1:t.getTime()>=c.getTime()?r:r-1}function Lce(n,e){var o,l,c,u;const t=gx(),r=(e==null?void 0:e.firstWeekContainsDate)??((l=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??t.firstWeekContainsDate??((u=(c=t.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,i=i4(n,e),s=pc(n,0);return s.setFullYear(i,0,r),s.setHours(0,0,0,0),yp(s,e)}function Dce(n,e){const t=us(n),r=+yp(t,e)-+Lce(t,e);return Math.round(r/n4)+1}function Ot(n,e){const t=n<0?"-":"",r=Math.abs(n).toString().padStart(e,"0");return t+r}const Qa={y(n,e){const t=n.getFullYear(),r=t>0?t:1-t;return Ot(e==="yy"?r%100:r,e.length)},M(n,e){const t=n.getMonth();return e==="M"?String(t+1):Ot(t+1,2)},d(n,e){return Ot(n.getDate(),e.length)},a(n,e){const t=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(n,e){return Ot(n.getHours()%12||12,e.length)},H(n,e){return Ot(n.getHours(),e.length)},m(n,e){return Ot(n.getMinutes(),e.length)},s(n,e){return Ot(n.getSeconds(),e.length)},S(n,e){const t=e.length,r=n.getMilliseconds(),i=Math.trunc(r*Math.pow(10,t-3));return Ot(i,e.length)}},nu={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},E2={G:function(n,e,t){const r=n.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(n,e,t){if(e==="yo"){const r=n.getFullYear(),i=r>0?r:1-r;return t.ordinalNumber(i,{unit:"year"})}return Qa.y(n,e)},Y:function(n,e,t,r){const i=i4(n,r),s=i>0?i:1-i;if(e==="YY"){const a=s%100;return Ot(a,2)}return e==="Yo"?t.ordinalNumber(s,{unit:"year"}):Ot(s,e.length)},R:function(n,e){const t=r4(n);return Ot(t,e.length)},u:function(n,e){const t=n.getFullYear();return Ot(t,e.length)},Q:function(n,e,t){const r=Math.ceil((n.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return Ot(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(n,e,t){const r=Math.ceil((n.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return Ot(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(n,e,t){const r=n.getMonth();switch(e){case"M":case"MM":return Qa.M(n,e);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(n,e,t){const r=n.getMonth();switch(e){case"L":return String(r+1);case"LL":return Ot(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(n,e,t,r){const i=Dce(n,r);return e==="wo"?t.ordinalNumber(i,{unit:"week"}):Ot(i,e.length)},I:function(n,e,t){const r=Oce(n);return e==="Io"?t.ordinalNumber(r,{unit:"week"}):Ot(r,e.length)},d:function(n,e,t){return e==="do"?t.ordinalNumber(n.getDate(),{unit:"date"}):Qa.d(n,e)},D:function(n,e,t){const r=Nce(n);return e==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):Ot(r,e.length)},E:function(n,e,t){const r=n.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(n,e,t,r){const i=n.getDay(),s=(i-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(s);case"ee":return Ot(s,2);case"eo":return t.ordinalNumber(s,{unit:"day"});case"eee":return t.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(i,{width:"short",context:"formatting"});case"eeee":default:return t.day(i,{width:"wide",context:"formatting"})}},c:function(n,e,t,r){const i=n.getDay(),s=(i-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(s);case"cc":return Ot(s,e.length);case"co":return t.ordinalNumber(s,{unit:"day"});case"ccc":return t.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(i,{width:"narrow",context:"standalone"});case"cccccc":return t.day(i,{width:"short",context:"standalone"});case"cccc":default:return t.day(i,{width:"wide",context:"standalone"})}},i:function(n,e,t){const r=n.getDay(),i=r===0?7:r;switch(e){case"i":return String(i);case"ii":return Ot(i,e.length);case"io":return t.ordinalNumber(i,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(n,e,t){const i=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(n,e,t){const r=n.getHours();let i;switch(r===12?i=nu.noon:r===0?i=nu.midnight:i=r/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(n,e,t){const r=n.getHours();let i;switch(r>=17?i=nu.evening:r>=12?i=nu.afternoon:r>=4?i=nu.morning:i=nu.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(n,e,t){if(e==="ho"){let r=n.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return Qa.h(n,e)},H:function(n,e,t){return e==="Ho"?t.ordinalNumber(n.getHours(),{unit:"hour"}):Qa.H(n,e)},K:function(n,e,t){const r=n.getHours()%12;return e==="Ko"?t.ordinalNumber(r,{unit:"hour"}):Ot(r,e.length)},k:function(n,e,t){let r=n.getHours();return r===0&&(r=24),e==="ko"?t.ordinalNumber(r,{unit:"hour"}):Ot(r,e.length)},m:function(n,e,t){return e==="mo"?t.ordinalNumber(n.getMinutes(),{unit:"minute"}):Qa.m(n,e)},s:function(n,e,t){return e==="so"?t.ordinalNumber(n.getSeconds(),{unit:"second"}):Qa.s(n,e)},S:function(n,e){return Qa.S(n,e)},X:function(n,e,t){const r=n.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return M2(r);case"XXXX":case"XX":return Sl(r);case"XXXXX":case"XXX":default:return Sl(r,":")}},x:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"x":return M2(r);case"xxxx":case"xx":return Sl(r);case"xxxxx":case"xxx":default:return Sl(r,":")}},O:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+T2(r,":");case"OOOO":default:return"GMT"+Sl(r,":")}},z:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+T2(r,":");case"zzzz":default:return"GMT"+Sl(r,":")}},t:function(n,e,t){const r=Math.trunc(n.getTime()/1e3);return Ot(r,e.length)},T:function(n,e,t){const r=n.getTime();return Ot(r,e.length)}};function T2(n,e=""){const t=n>0?"-":"+",r=Math.abs(n),i=Math.trunc(r/60),s=r%60;return s===0?t+String(i):t+String(i)+e+Ot(s,2)}function M2(n,e){return n%60===0?(n>0?"-":"+")+Ot(Math.abs(n)/60,2):Sl(n,e)}function Sl(n,e=""){const t=n>0?"-":"+",r=Math.abs(n),i=Ot(Math.trunc(r/60),2),s=Ot(r%60,2);return t+i+e+s}const k2=(n,e)=>{switch(n){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},s4=(n,e)=>{switch(n){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},Ice=(n,e)=>{const t=n.match(/(P+)(p+)?/)||[],r=t[1],i=t[2];if(!i)return k2(n,e);let s;switch(r){case"P":s=e.dateTime({width:"short"});break;case"PP":s=e.dateTime({width:"medium"});break;case"PPP":s=e.dateTime({width:"long"});break;case"PPPP":default:s=e.dateTime({width:"full"});break}return s.replace("{{date}}",k2(r,e)).replace("{{time}}",s4(i,e))},jce={p:s4,P:Ice},Fce=/^D+$/,Uce=/^Y+$/,Bce=["D","DD","YY","YYYY"];function zce(n){return Fce.test(n)}function $ce(n){return Uce.test(n)}function Vce(n,e,t){const r=Hce(n,e,t);if(console.warn(r),Bce.includes(n))throw new RangeError(r)}function Hce(n,e,t){const r=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${e}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Wce=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Gce=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,qce=/^'([^]*?)'?$/,Xce=/''/g,Yce=/[a-zA-Z]/;function _f(n,e,t){var u,d,h,p;const r=gx(),i=r.locale??Rce,s=r.firstWeekContainsDate??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,a=r.weekStartsOn??((p=(h=r.locale)==null?void 0:h.options)==null?void 0:p.weekStartsOn)??0,o=us(n);if(!Zle(o))throw new RangeError("Invalid time value");let l=e.match(Gce).map(y=>{const v=y[0];if(v==="p"||v==="P"){const g=jce[v];return g(y,i.formatLong)}return y}).join("").match(Wce).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const v=y[0];if(v==="'")return{isToken:!1,value:Kce(y)};if(E2[v])return{isToken:!0,value:y};if(v.match(Yce))throw new RangeError("Format string contains an unescaped latin alphabet character `"+v+"`");return{isToken:!1,value:y}});i.localize.preprocessor&&(l=i.localize.preprocessor(o,l));const c={firstWeekContainsDate:s,weekStartsOn:a,locale:i};return l.map(y=>{if(!y.isToken)return y.value;const v=y.value;($ce(v)||zce(v))&&Vce(v,e,String(n));const g=E2[v[0]];return g(o,v,i.localize,c)}).join("")}function Kce(n){const e=n.match(qce);return e?e[1].replace(Xce,"'"):n}const Zce=({onClose:n})=>{const{storedChatHistory:e,fetchChatHistory:t}=Fd(),[r,i]=k.useState(""),[s,a]=k.useState([]),[o,l]=k.useState([]),[c,u]=k.useState([]);k.useEffect(()=>{t()},[t]),k.useEffect(()=>{const m=r?e.filter(b=>b.message.toLowerCase().includes(r.toLowerCase())):e,x={};m.forEach(b=>{const w=_f(new Date(b.created_at),"yyyy-MM-dd");x[w]||(x[w]=[]),x[w].push(b)});const _=Object.keys(x).map(b=>({date:b,messages:x[b]})).sort((b,w)=>new Date(w.date).getTime()-new Date(b.date).getTime());a(_),_.length>0&&o.length===0&&l([_[0].date])},[e,r]);const d=m=>{l(x=>x.includes(m)?x.filter(_=>_!==m):[...x,m])},h=m=>{u(x=>x.includes(m)?x.filter(_=>_!==m):[...x,m])},p=m=>{const x=new Date(m);return _f(x,"MMMM d, yyyy")},y=m=>{const x=new Date(m);return _f(x,"h:mm a")},v=(m,x)=>!x&&m.length>120?m.substring(0,120)+"...":m,g=(m,x)=>{if(!m||!x)return null;let _="",b="";switch(m){case"BEARISH":_="bg-red-500/20",b="text-red-500";break;case"NEUTRAL":case"DYOR":_="bg-yellow-500/20",b="text-yellow-500";break;case"BULLISH":_="bg-lime/20",b="text-lime";break;case"APE IN":_="bg-viridian/20",b="text-viridian";break;default:return null}return f.jsxs("div",{className:`text-xs px-2 py-1 rounded-full ${_} ${b} flex items-center gap-1`,children:[f.jsx(Pd,{size:10}),f.jsxs("span",{children:[m," ",x,"/100"]})]})};return f.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:f.jsxs("div",{className:"bg-light-card dark:bg-dark-card border border-light-border/20 dark:border-viridian/30 rounded-lg w-full max-w-3xl h-[80vh] flex flex-col overflow-hidden shadow-lg",children:[f.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-light-border/10 dark:border-viridian/20",children:[f.jsxs("h2",{className:"text-xl font-bold text-light-text dark:text-dark-text flex items-center gap-2",children:[f.jsx(Oa,{size:20,className:"text-viridian"}),"Chat History"]}),f.jsx("button",{onClick:n,className:"p-2 hover:bg-viridian/10 rounded-lg text-light-subtext dark:text-dark-subtext",children:f.jsx(yr,{size:20})})]}),f.jsx("div",{className:"p-4 border-b border-light-border/10 dark:border-viridian/20",children:f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:"text",value:r,onChange:m=>i(m.target.value),placeholder:"Search chat history...",className:"w-full bg-light-bg/90 dark:bg-dark-bg/90 border border-light-border/20 dark:border-viridian/40 rounded-lg py-2 pl-10 pr-3 text-light-text dark:text-dark-text focus:outline-none focus:border-viridian/40 dark:focus:border-viridian/70"}),f.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-light-subtext dark:text-dark-subtext",children:f.jsx(Iv,{size:16})})]})}),f.jsx("div",{className:"flex-grow overflow-y-auto p-4",children:s.length===0?f.jsxs("div",{className:"text-center py-8",children:[f.jsx(d0,{size:48,className:"mx-auto mb-4 text-light-subtext dark:text-dark-subtext opacity-30"}),f.jsx("p",{className:"text-light-subtext dark:text-dark-subtext",children:r?"No chat messages found for your search.":"No chat history found."}),r&&f.jsx("button",{onClick:()=>i(""),className:"mt-4 text-viridian hover:underline",children:"Clear search"})]}):f.jsx("div",{className:"space-y-6",children:s.map(m=>f.jsxs("div",{className:"bg-light-bg/30 dark:bg-forest/20 rounded-lg",children:[f.jsxs("button",{onClick:()=>d(m.date),className:"w-full flex justify-between items-center p-3 font-medium text-light-text dark:text-dark-text hover:bg-light-bg/50 dark:hover:bg-forest/30 rounded-lg",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(v3,{size:16,className:"text-viridian"}),f.jsx("span",{children:p(m.date)}),f.jsxs("span",{className:"text-xs text-light-subtext dark:text-dark-subtext",children:["(",m.messages.length," messages)"]})]}),f.jsx(p3,{size:16,className:`transform transition-transform ${o.includes(m.date)?"rotate-90":""}`})]}),o.includes(m.date)&&f.jsx("div",{className:"p-2 space-y-2",children:m.messages.map(x=>f.jsxs("div",{className:`p-3 rounded-lg border ${x.role==="user"?"border-light-border/10 dark:border-viridian/20 bg-light-bg/50 dark:bg-dark-bg/30":"border-light-border/20 dark:border-viridian/30 bg-light-bg/80 dark:bg-viridian/5"}`,children:[f.jsxs("div",{className:"flex justify-between items-start mb-1",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs ${x.role==="user"?"bg-viridian/20 text-viridian":"bg-viridian text-white"}`,children:x.role==="user"?"U":"AI"}),f.jsx("span",{className:"font-medium text-sm text-light-text dark:text-dark-text",children:x.role==="user"?"You":"TradesXBT AI"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[x.role==="assistant"&&g(x.sentiment_type,x.sentiment_score),f.jsx("span",{className:"text-xs text-light-subtext dark:text-dark-subtext",children:y(x.created_at)})]})]}),f.jsx("div",{className:`text-sm ${x.role==="user","text-light-text dark:text-dark-text"}`,children:v(x.message,c.includes(x.id))}),x.message.length>120&&f.jsx("button",{onClick:()=>h(x.id),className:"mt-1 text-xs text-viridian hover:underline",children:c.includes(x.id)?"Show less":"Show more"})]},x.id))})]},m.date))})})]})})},Jce=()=>{const{signOut:n,user:e}=$s(),{user:t}=im(),[r,i]=k.useState(!1),[s,a]=k.useState(!1),[o,l]=k.useState(!1),c=k.useRef(null),u=Ia();k.useEffect(()=>{function y(v){c.current&&!c.current.contains(v.target)&&i(!1)}return document.addEventListener("mousedown",y),()=>{document.removeEventListener("mousedown",y)}},[]);const d=async()=>{try{await n(),u("/")}catch(y){console.error("Error signing out:",y)}},h=()=>{a(!1)},p=y=>{y.stopPropagation(),l(!o),i(!1)};return f.jsxs("div",{className:"relative",ref:c,children:[f.jsx("button",{onClick:()=>i(!r),className:"flex items-center gap-2 p-1.5 hover:bg-viridian/10 rounded-full","aria-label":"User menu",children:f.jsx("div",{className:"w-8 h-8 rounded-full bg-viridian/20 flex items-center justify-center text-viridian",children:t.username?f.jsx("span",{className:"font-semibold text-sm",children:t.username.charAt(0).toUpperCase()}):f.jsx(hy,{size:16})})}),r&&f.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-light-card dark:bg-dark-card border border-light-border/10 dark:border-viridian/30 rounded-lg shadow-lg z-50",children:[f.jsxs("div",{className:"p-4 border-b border-light-border/10 dark:border-viridian/20",children:[f.jsx("div",{className:"flex items-center justify-between mb-1",children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-10 h-10 rounded-full bg-viridian/20 flex items-center justify-center text-viridian",children:t.username?f.jsx("span",{className:"font-semibold",children:t.username.charAt(0).toUpperCase()}):f.jsx(hy,{size:20})}),f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("p",{className:"font-medium text-light-text dark:text-dark-text",children:t.username||"Set username"}),f.jsx("button",{onClick:()=>a(!0),className:"p-1 text-viridian hover:bg-viridian/10 rounded",children:f.jsx(PY,{size:14})})]}),f.jsx("p",{className:"text-xs text-light-subtext dark:text-dark-subtext",children:e==null?void 0:e.email})]})]})}),f.jsxs("p",{className:"text-xs text-light-subtext dark:text-dark-subtext mt-2",children:["Balance: $",t.balance.toLocaleString()]})]}),f.jsxs("div",{className:"py-2",children:[f.jsxs("button",{className:"dropdown-item",onClick:()=>u("/portal?tab=profile"),children:[f.jsx(hy,{size:16,className:"mr-2"}),f.jsx("span",{children:"Your Profile"})]}),f.jsxs("button",{className:"dropdown-item",onClick:()=>u("/portal?tab=portfolio"),children:[f.jsx(hY,{size:16,className:"mr-2"}),f.jsx("span",{children:"Portfolio"})]}),f.jsxs("button",{className:"dropdown-item",onClick:p,children:[f.jsx(Oa,{size:16,className:"mr-2"}),f.jsx("span",{children:"Chat History"})]}),f.jsxs("button",{className:"dropdown-item",children:[f.jsx(jv,{size:16,className:"mr-2"}),f.jsx("span",{children:"Settings"})]}),f.jsx("div",{className:"border-t border-light-border/10 dark:border-viridian/20 my-1"}),f.jsxs("button",{className:"dropdown-item text-red-500 dark:text-red-400",onClick:d,children:[f.jsx(wY,{size:16,className:"mr-2"}),f.jsx("span",{children:"Sign Out"})]})]})]}),s&&f.jsx(Wle,{onClose:h}),o&&f.jsx(Zce,{onClose:()=>l(!1)})]})},Qce=()=>{const{storedChatHistory:n,fetchChatHistory:e}=Fd(),{user:t}=$s(),[r,i]=k.useState([]),[s,a]=k.useState({BULLISH:0,BEARISH:0,NEUTRAL:0,"APE IN":0}),[o,l]=k.useState([]),[c,u]=k.useState(!1),[d,h]=k.useState(null),[p,y]=k.useState(!1),v=k.useCallback(async()=>{if(t){u(!0),h(null);try{await e()}catch(M){console.error("Error loading chat history:",M),h("Could not load chat history")}finally{u(!1)}}},[t,e]);k.useEffect(()=>{t&&!p&&(v(),y(!0))},[t,p,v]);const g=k.useMemo(()=>{if(!n||!Array.isArray(n))return{assistantMessages:[],stats:{BULLISH:0,BEARISH:0,NEUTRAL:0,"APE IN":0},activity:[]};try{const M=n.filter(H=>H&&H.role==="assistant").slice(0,5),N={BULLISH:0,BEARISH:0,NEUTRAL:0,"APE IN":0};n.forEach(H=>{H&&H.role==="assistant"&&H.sentiment_type&&N[H.sentiment_type]++});const T={};n.forEach(H=>{if(!(!H||!H.created_at))try{const W=_f(new Date(H.created_at),"yyyy-MM-dd");T[W]||(T[W]={date:W,count:0,sentimentCounts:{BULLISH:0,BEARISH:0,NEUTRAL:0,"APE IN":0}}),T[W].count++,H.role==="assistant"&&H.sentiment_type&&T[W].sentimentCounts[H.sentiment_type]++}catch(W){console.error("Error processing chat message date:",W)}});const P=Object.values(T).sort((H,W)=>new Date(H.date).getTime()-new Date(W.date).getTime()).slice(-7);return{assistantMessages:M,stats:N,activity:P}}catch(M){return console.error("Error processing chat history:",M),{assistantMessages:[],stats:{BULLISH:0,BEARISH:0,NEUTRAL:0,"APE IN":0},activity:[]}}},[n]);k.useEffect(()=>{i(g.assistantMessages),a(g.stats),l(g.activity)},[g]);const m=M=>{try{return _f(new Date(M),"MMM d, h:mm a")}catch{return"Invalid date"}},x=M=>M?M.length>80?M.substring(0,80)+"...":M:"",_=M=>{switch(M){case"BULLISH":return"bg-lime/20 text-lime";case"BEARISH":return"bg-red-500/20 text-red-500";case"NEUTRAL":case"DYOR":return"bg-yellow-500/20 text-yellow-500";case"APE IN":return"bg-viridian/20 text-viridian";default:return"bg-gray-500/20 text-gray-500"}},b=()=>s.BULLISH+s.BEARISH+s.NEUTRAL+s["APE IN"],w=M=>{const N=b();return N===0?0:Math.round(M/N*100)},E=()=>f.jsx("div",{className:"animate-pulse",children:f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex justify-between items-center mb-1",children:[f.jsx("div",{className:"h-3 w-20 bg-gray-700 rounded"}),f.jsx("div",{className:"h-3 w-10 bg-gray-700 rounded"})]}),f.jsx("div",{className:"h-1.5 bg-gray-700 rounded-full"})]}),f.jsxs("div",{children:[f.jsxs("div",{className:"flex justify-between items-center mb-1",children:[f.jsx("div",{className:"h-3 w-20 bg-gray-700 rounded"}),f.jsx("div",{className:"h-3 w-10 bg-gray-700 rounded"})]}),f.jsx("div",{className:"h-1.5 bg-gray-700 rounded-full"})]}),f.jsx("div",{className:"col-span-2 mt-1",children:f.jsxs("div",{className:"flex justify-between items-center mb-1",children:[f.jsx("div",{className:"h-3 w-24 bg-gray-700 rounded"}),f.jsx("div",{className:"h-3 w-8 bg-gray-700 rounded"})]})})]})}),S=()=>f.jsx("div",{className:"animate-pulse space-y-2",children:[1,2,3].map(M=>f.jsxs("div",{className:"p-2 rounded bg-gray-800 border border-gray-700",children:[f.jsxs("div",{className:"flex justify-between items-center mb-1",children:[f.jsxs("div",{className:"flex items-center gap-1.5",children:[f.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-700"}),f.jsx("div",{className:"h-3 w-24 bg-gray-700 rounded"})]}),f.jsx("div",{className:"h-3 w-14 bg-gray-700 rounded-full"})]}),f.jsxs("div",{className:"space-y-1",children:[f.jsx("div",{className:"h-2 bg-gray-700 rounded w-full"}),f.jsx("div",{className:"h-2 bg-gray-700 rounded w-5/6"}),f.jsx("div",{className:"h-2 bg-gray-700 rounded w-3/4"})]})]},M))});return f.jsxs("div",{className:"space-y-4 h-full overflow-y-auto pb-2",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-sm font-medium text-white",children:"AI Chat History"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"text-xs text-gray-400",children:c?"Loading...":`${n.length} messages`}),c&&f.jsx("div",{className:"w-4 h-4 border-2 border-viridian border-t-transparent rounded-full animate-spin"}),d&&f.jsx("button",{onClick:v,className:"p-1 hover:bg-viridian/10 rounded-full text-viridian",title:"Retry loading",children:f.jsx(jS,{size:14})})]})]}),f.jsxs("div",{className:"bg-black/30 rounded-lg border border-viridian/30 p-3",children:[f.jsx("h3",{className:"text-xs font-medium text-gray-300 mb-2",children:"Sentiment Analysis"}),c?f.jsx(E,{}):d?f.jsx("div",{className:"text-center py-1 text-xs text-red-400",children:"Error loading sentiment data"}):f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex justify-between items-center mb-1",children:[f.jsx("span",{className:"text-xs text-green-400",children:"Bullish"}),f.jsxs("span",{className:"text-xs text-gray-400",children:[w(s.BULLISH),"%"]})]}),f.jsx("div",{className:"h-1.5 bg-black/50 rounded-full overflow-hidden",children:f.jsx("div",{className:"h-full bg-green-500 rounded-full",style:{width:`${w(s.BULLISH)}%`}})})]}),f.jsxs("div",{children:[f.jsxs("div",{className:"flex justify-between items-center mb-1",children:[f.jsx("span",{className:"text-xs text-red-400",children:"Bearish"}),f.jsxs("span",{className:"text-xs text-gray-400",children:[w(s.BEARISH),"%"]})]}),f.jsx("div",{className:"h-1.5 bg-black/50 rounded-full overflow-hidden",children:f.jsx("div",{className:"h-full bg-red-500 rounded-full",style:{width:`${w(s.BEARISH)}%`}})})]}),f.jsx("div",{className:"col-span-2 mt-1",children:f.jsxs("div",{className:"flex justify-between items-center mb-1",children:[f.jsx("span",{className:"text-xs text-viridian",children:"Ape In Signals"}),f.jsx("span",{className:"text-xs text-gray-400",children:s["APE IN"]})]})})]})]}),f.jsxs("div",{className:"bg-black/30 rounded-lg border border-viridian/30 p-3",children:[f.jsx("h3",{className:"text-xs font-medium text-gray-300 mb-2",children:"Recent AI Insights"}),c?f.jsx(S,{}):d?f.jsxs("div",{className:"text-center py-4 text-sm",children:[f.jsx("p",{className:"text-red-400 mb-2",children:d}),f.jsx("button",{onClick:v,className:"text-viridian hover:underline text-xs",children:"Try again"})]}):r.length>0?f.jsx("div",{className:"space-y-2",children:r.map(M=>f.jsxs("div",{className:"p-2 rounded bg-black/50 border border-viridian/20 text-xs",children:[f.jsxs("div",{className:"flex justify-between items-center mb-1",children:[f.jsxs("div",{className:"flex items-center gap-1.5",children:[f.jsx(Oa,{size:12,className:"text-viridian"}),f.jsx("span",{className:"text-gray-300",children:m(M.created_at)})]}),M.sentiment_type&&f.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[9px] ${_(M.sentiment_type)}`,children:M.sentiment_type})]}),f.jsx("p",{className:"text-gray-200",children:x(M.message)})]},M.id))}):f.jsx("div",{className:"text-center py-2 text-gray-400 text-xs",children:"No chat history yet"})]}),f.jsxs("button",{className:"w-full py-2 bg-viridian/20 hover:bg-viridian/30 text-viridian rounded-lg text-sm flex items-center justify-center gap-1.5 border border-viridian/40 transition-colors",onClick:()=>{const M=new CustomEvent("navigate",{detail:{tab:"chat"}});window.dispatchEvent(M)},children:[f.jsx(Oa,{size:14}),"Chat with AI",f.jsx(au,{size:14})]})]})},eue=({onSave:n,onClose:e,defaultColumns:t=3,availableCards:r,traderProfiles:i,activeProfile:s})=>{const[a,o]=k.useState(t),[l,c]=k.useState([]),[u,d]=k.useState(s);k.useEffect(()=>{if(u==="custom")return;const v=i.find(g=>g.id===u);v&&(o(v.columns),c(v.visibleCards))},[u,i]),k.useEffect(()=>{if(s){d(s);const v=i.find(g=>g.id===s);v?(o(v.columns),c(v.visibleCards)):c(r.map(g=>g.id))}else c(r.map(v=>v.id))},[s,r,i]);const h=()=>{n({columns:a,visibleCards:l,traderProfile:u}),e()},p=v=>{u!=="custom"&&d("custom"),c(g=>g.includes(v)?g.filter(m=>m!==v):[...g,v])},y=v=>{d(v)};return f.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:f.jsx("div",{className:"bg-[#0C1016] border border-viridian/30 rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"flex justify-between items-start mb-6",children:[f.jsxs("div",{children:[f.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Welcome to TradesXBT"}),f.jsx("p",{className:"text-gray-400",children:"Let's customize your dashboard experience"})]}),f.jsx("button",{onClick:e,className:"p-2 hover:bg-viridian/10 rounded-lg text-gray-400 hover:text-white transition-colors",children:f.jsx(yr,{size:20})})]}),f.jsxs("div",{className:"space-y-8",children:[f.jsxs("div",{children:[f.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[f.jsx(x3,{size:20,className:"text-viridian"}),"Choose Your Trader Profile"]}),f.jsx("div",{className:"grid grid-cols-1 gap-3",children:i.map(v=>f.jsxs("button",{onClick:()=>y(v.id),className:`p-4 rounded-lg border flex items-start ${u===v.id?"bg-viridian/20 border-viridian text-viridian":"border-gray-700 text-gray-400 hover:border-viridian/50"} transition-colors`,children:[f.jsx("div",{className:`mt-0.5 mr-3 ${u===v.id?"text-viridian":"text-gray-500"}`,children:f.jsx(lf,{size:20,className:u===v.id?"opacity-100":"opacity-30"})}),f.jsxs("div",{className:"flex-1 text-left",children:[f.jsx("div",{className:"font-medium text-white",children:v.name}),f.jsx("div",{className:"text-xs mt-1 text-gray-400",children:v.description}),v.id!=="custom"&&f.jsxs("div",{className:"text-xs mt-2 text-gray-500",children:[v.visibleCards.length," components  ",v.columns," column layout"]})]})]},v.id))})]}),u==="custom"&&f.jsxs("div",{children:[f.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[f.jsx(_Y,{size:20,className:"text-viridian"}),"Choose Your Layout"]}),f.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[f.jsxs("button",{onClick:()=>o(1),className:`p-4 rounded-lg border ${a===1?"bg-viridian/20 border-viridian text-viridian":"border-gray-700 text-gray-400 hover:border-viridian/50"} transition-colors`,children:[f.jsx(AY,{size:24,className:"mx-auto mb-2"}),f.jsx("div",{className:"text-sm font-medium",children:"Single Column"}),f.jsx("div",{className:"text-xs opacity-70",children:"Best for mobile"})]}),f.jsxs("button",{onClick:()=>o(2),className:`p-4 rounded-lg border ${a===2?"bg-viridian/20 border-viridian text-viridian":"border-gray-700 text-gray-400 hover:border-viridian/50"} transition-colors`,children:[f.jsx(gY,{size:24,className:"mx-auto mb-2"}),f.jsx("div",{className:"text-sm font-medium",children:"Two Columns"}),f.jsx("div",{className:"text-xs opacity-70",children:"Balanced view"})]}),f.jsxs("button",{onClick:()=>o(3),className:`p-4 rounded-lg border ${a===3?"bg-viridian/20 border-viridian text-viridian":"border-gray-700 text-gray-400 hover:border-viridian/50"} transition-colors`,children:[f.jsx(yY,{size:24,className:"mx-auto mb-2"}),f.jsx("div",{className:"text-sm font-medium",children:"Three Columns"}),f.jsx("div",{className:"text-xs opacity-70",children:"Full experience"})]})]})]}),u==="custom"&&f.jsxs("div",{className:"mt-8 space-y-6",children:[f.jsx("h3",{className:"text-white font-medium",children:"Select Dashboard Cards"}),f.jsxs("div",{className:"bg-black/30 p-4 rounded-lg mb-6",children:[f.jsx("h4",{className:"text-viridian font-medium mb-3",children:"Main Dashboard Cards"}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.slice(0,6).map(v=>f.jsx("div",{className:`p-4 rounded-lg cursor-pointer transition-colors ${l.includes(v.id)?"bg-viridian/20 border border-viridian":"bg-black/50 border border-gray-800 hover:border-viridian/50"}`,onClick:()=>p(v.id),children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{children:[f.jsx("h5",{className:"font-medium text-white",children:v.title}),f.jsx("p",{className:"text-sm text-gray-400 mt-1",children:v.description})]}),f.jsx("div",{className:`${l.includes(v.id)?"text-viridian":"text-gray-600"}`,children:f.jsx(lf,{size:20})})]})},v.id))})]}),f.jsxs("div",{className:"bg-black/30 p-4 rounded-lg",children:[f.jsx("h4",{className:"text-viridian font-medium mb-3",children:"AI Analysis Tools"}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.slice(6).map(v=>f.jsx("div",{className:`p-4 rounded-lg cursor-pointer transition-colors ${l.includes(v.id)?"bg-viridian/20 border border-viridian":"bg-black/50 border border-gray-800 hover:border-viridian/50"}`,onClick:()=>p(v.id),children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{children:[f.jsx("h5",{className:"font-medium text-white",children:v.title}),f.jsx("p",{className:"text-sm text-gray-400 mt-1",children:v.description})]}),f.jsx("div",{className:`${l.includes(v.id)?"text-viridian":"text-gray-600"}`,children:f.jsx(lf,{size:20})})]})},v.id))})]})]})]}),f.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-800 flex justify-end gap-4",children:[f.jsx("button",{onClick:e,className:"px-6 py-2 rounded-lg border border-gray-700 text-gray-300 hover:bg-gray-800 transition-colors",children:"Cancel"}),f.jsx("button",{onClick:h,className:"px-6 py-2 bg-viridian text-white rounded-lg hover:bg-viridian/90 transition-colors",children:"Apply Changes"})]})]})})})};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function sm(n){return n+.5|0}const bo=(n,e,t)=>Math.max(Math.min(n,t),e);function Hh(n){return bo(sm(n*2.55),0,255)}function Io(n){return bo(sm(n*255),0,255)}function ua(n){return bo(sm(n/2.55)/100,0,1)}function A2(n){return bo(sm(n*100),0,100)}const yi={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},x1=[..."0123456789ABCDEF"],tue=n=>x1[n&15],nue=n=>x1[(n&240)>>4]+x1[n&15],Lg=n=>(n&240)>>4===(n&15),rue=n=>Lg(n.r)&&Lg(n.g)&&Lg(n.b)&&Lg(n.a);function iue(n){var e=n.length,t;return n[0]==="#"&&(e===4||e===5?t={r:255&yi[n[1]]*17,g:255&yi[n[2]]*17,b:255&yi[n[3]]*17,a:e===5?yi[n[4]]*17:255}:(e===7||e===9)&&(t={r:yi[n[1]]<<4|yi[n[2]],g:yi[n[3]]<<4|yi[n[4]],b:yi[n[5]]<<4|yi[n[6]],a:e===9?yi[n[7]]<<4|yi[n[8]]:255})),t}const sue=(n,e)=>n<255?e(n):"";function aue(n){var e=rue(n)?tue:nue;return n?"#"+e(n.r)+e(n.g)+e(n.b)+sue(n.a,e):void 0}const oue=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function a4(n,e,t){const r=e*Math.min(t,1-t),i=(s,a=(s+n/30)%12)=>t-r*Math.max(Math.min(a-3,9-a,1),-1);return[i(0),i(8),i(4)]}function lue(n,e,t){const r=(i,s=(i+n/60)%6)=>t-t*e*Math.max(Math.min(s,4-s,1),0);return[r(5),r(3),r(1)]}function cue(n,e,t){const r=a4(n,1,.5);let i;for(e+t>1&&(i=1/(e+t),e*=i,t*=i),i=0;i<3;i++)r[i]*=1-e-t,r[i]+=e;return r}function uue(n,e,t,r,i){return n===i?(e-t)/r+(e<t?6:0):e===i?(t-n)/r+2:(n-e)/r+4}function mM(n){const t=n.r/255,r=n.g/255,i=n.b/255,s=Math.max(t,r,i),a=Math.min(t,r,i),o=(s+a)/2;let l,c,u;return s!==a&&(u=s-a,c=o>.5?u/(2-s-a):u/(s+a),l=uue(t,r,i,u,s),l=l*60+.5),[l|0,c||0,o]}function gM(n,e,t,r){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,t,r)).map(Io)}function yM(n,e,t){return gM(a4,n,e,t)}function due(n,e,t){return gM(cue,n,e,t)}function hue(n,e,t){return gM(lue,n,e,t)}function o4(n){return(n%360+360)%360}function fue(n){const e=oue.exec(n);let t=255,r;if(!e)return;e[5]!==r&&(t=e[6]?Hh(+e[5]):Io(+e[5]));const i=o4(+e[2]),s=+e[3]/100,a=+e[4]/100;return e[1]==="hwb"?r=due(i,s,a):e[1]==="hsv"?r=hue(i,s,a):r=yM(i,s,a),{r:r[0],g:r[1],b:r[2],a:t}}function pue(n,e){var t=mM(n);t[0]=o4(t[0]+e),t=yM(t),n.r=t[0],n.g=t[1],n.b=t[2]}function mue(n){if(!n)return;const e=mM(n),t=e[0],r=A2(e[1]),i=A2(e[2]);return n.a<255?`hsla(${t}, ${r}%, ${i}%, ${ua(n.a)})`:`hsl(${t}, ${r}%, ${i}%)`}const P2={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},C2={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function gue(){const n={},e=Object.keys(C2),t=Object.keys(P2);let r,i,s,a,o;for(r=0;r<e.length;r++){for(a=o=e[r],i=0;i<t.length;i++)s=t[i],o=o.replace(s,P2[s]);s=parseInt(C2[a],16),n[o]=[s>>16&255,s>>8&255,s&255]}return n}let Dg;function yue(n){Dg||(Dg=gue(),Dg.transparent=[0,0,0,0]);const e=Dg[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const vue=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function xue(n){const e=vue.exec(n);let t=255,r,i,s;if(e){if(e[7]!==r){const a=+e[7];t=e[8]?Hh(a):bo(a*255,0,255)}return r=+e[1],i=+e[3],s=+e[5],r=255&(e[2]?Hh(r):bo(r,0,255)),i=255&(e[4]?Hh(i):bo(i,0,255)),s=255&(e[6]?Hh(s):bo(s,0,255)),{r,g:i,b:s,a:t}}}function _ue(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${ua(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const Hb=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,ru=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function bue(n,e,t){const r=ru(ua(n.r)),i=ru(ua(n.g)),s=ru(ua(n.b));return{r:Io(Hb(r+t*(ru(ua(e.r))-r))),g:Io(Hb(i+t*(ru(ua(e.g))-i))),b:Io(Hb(s+t*(ru(ua(e.b))-s))),a:n.a+t*(e.a-n.a)}}function Ig(n,e,t){if(n){let r=mM(n);r[e]=Math.max(0,Math.min(r[e]+r[e]*t,e===0?360:1)),r=yM(r),n.r=r[0],n.g=r[1],n.b=r[2]}}function l4(n,e){return n&&Object.assign(e||{},n)}function R2(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=Io(n[3]))):(e=l4(n,{r:0,g:0,b:0,a:1}),e.a=Io(e.a)),e}function wue(n){return n.charAt(0)==="r"?xue(n):fue(n)}class vp{constructor(e){if(e instanceof vp)return e;const t=typeof e;let r;t==="object"?r=R2(e):t==="string"&&(r=iue(e)||yue(e)||wue(e)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var e=l4(this._rgb);return e&&(e.a=ua(e.a)),e}set rgb(e){this._rgb=R2(e)}rgbString(){return this._valid?_ue(this._rgb):void 0}hexString(){return this._valid?aue(this._rgb):void 0}hslString(){return this._valid?mue(this._rgb):void 0}mix(e,t){if(e){const r=this.rgb,i=e.rgb;let s;const a=t===s?.5:t,o=2*a-1,l=r.a-i.a,c=((o*l===-1?o:(o+l)/(1+o*l))+1)/2;s=1-c,r.r=255&c*r.r+s*i.r+.5,r.g=255&c*r.g+s*i.g+.5,r.b=255&c*r.b+s*i.b+.5,r.a=a*r.a+(1-a)*i.a,this.rgb=r}return this}interpolate(e,t){return e&&(this._rgb=bue(this._rgb,e._rgb,t)),this}clone(){return new vp(this.rgb)}alpha(e){return this._rgb.a=Io(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=sm(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Ig(this._rgb,2,e),this}darken(e){return Ig(this._rgb,2,-e),this}saturate(e){return Ig(this._rgb,1,e),this}desaturate(e){return Ig(this._rgb,1,-e),this}rotate(e){return pue(this._rgb,e),this}}/*!
 * Chart.js v4.4.8
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function Js(){}const Sue=(()=>{let n=0;return()=>n++})();function At(n){return n==null}function yn(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function _t(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function lr(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function ps(n,e){return lr(n)?n:e}function pt(n,e){return typeof n>"u"?e:n}const Eue=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/e,c4=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function qt(n,e,t){if(n&&typeof n.call=="function")return n.apply(t,e)}function Lt(n,e,t,r){let i,s,a;if(yn(n))for(s=n.length,i=0;i<s;i++)e.call(t,n[i],i);else if(_t(n))for(a=Object.keys(n),s=a.length,i=0;i<s;i++)e.call(t,n[a[i]],a[i])}function B0(n,e){let t,r,i,s;if(!n||!e||n.length!==e.length)return!1;for(t=0,r=n.length;t<r;++t)if(i=n[t],s=e[t],i.datasetIndex!==s.datasetIndex||i.index!==s.index)return!1;return!0}function z0(n){if(yn(n))return n.map(z0);if(_t(n)){const e=Object.create(null),t=Object.keys(n),r=t.length;let i=0;for(;i<r;++i)e[t[i]]=z0(n[t[i]]);return e}return n}function u4(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function Tue(n,e,t,r){if(!u4(n))return;const i=e[n],s=t[n];_t(i)&&_t(s)?xp(i,s,r):e[n]=z0(s)}function xp(n,e,t){const r=yn(e)?e:[e],i=r.length;if(!_t(n))return n;t=t||{};const s=t.merger||Tue;let a;for(let o=0;o<i;++o){if(a=r[o],!_t(a))continue;const l=Object.keys(a);for(let c=0,u=l.length;c<u;++c)s(l[c],n,a,t)}return n}function bf(n,e){return xp(n,e,{merger:Mue})}function Mue(n,e,t){if(!u4(n))return;const r=e[n],i=t[n];_t(r)&&_t(i)?bf(r,i):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=z0(i))}const N2={"":n=>n,x:n=>n.x,y:n=>n.y};function kue(n){const e=n.split("."),t=[];let r="";for(const i of e)r+=i,r.endsWith("\\")?r=r.slice(0,-1)+".":(t.push(r),r="");return t}function Aue(n){const e=kue(n);return t=>{for(const r of e){if(r==="")break;t=t&&t[r]}return t}}function mc(n,e){return(N2[e]||(N2[e]=Aue(e)))(n)}function vM(n){return n.charAt(0).toUpperCase()+n.slice(1)}const _p=n=>typeof n<"u",qo=n=>typeof n=="function",O2=(n,e)=>{if(n.size!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;return!0};function Pue(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const ln=Math.PI,nn=2*ln,Cue=nn+ln,$0=Number.POSITIVE_INFINITY,Rue=ln/180,En=ln/2,pl=ln/4,L2=ln*2/3,_1=Math.log10,Ns=Math.sign;function wf(n,e,t){return Math.abs(n-e)<t}function D2(n){const e=Math.round(n);n=wf(n,e,n/1e3)?e:n;const t=Math.pow(10,Math.floor(_1(n))),r=n/t;return(r<=1?1:r<=2?2:r<=5?5:10)*t}function Nue(n){const e=[],t=Math.sqrt(n);let r;for(r=1;r<t;r++)n%r===0&&(e.push(r),e.push(n/r));return t===(t|0)&&e.push(t),e.sort((i,s)=>i-s).pop(),e}function Oue(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function vd(n){return!Oue(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function Lue(n,e){const t=Math.round(n);return t-e<=n&&t+e>=n}function Due(n,e,t){let r,i,s;for(r=0,i=n.length;r<i;r++)s=n[r][t],isNaN(s)||(e.min=Math.min(e.min,s),e.max=Math.max(e.max,s))}function xa(n){return n*(ln/180)}function Iue(n){return n*(180/ln)}function I2(n){if(!lr(n))return;let e=1,t=0;for(;Math.round(n*e)/e!==n;)e*=10,t++;return t}function d4(n,e){const t=e.x-n.x,r=e.y-n.y,i=Math.sqrt(t*t+r*r);let s=Math.atan2(r,t);return s<-.5*ln&&(s+=nn),{angle:s,distance:i}}function b1(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function jue(n,e){return(n-e+Cue)%nn-ln}function Ss(n){return(n%nn+nn)%nn}function bp(n,e,t,r){const i=Ss(n),s=Ss(e),a=Ss(t),o=Ss(s-i),l=Ss(a-i),c=Ss(i-s),u=Ss(i-a);return i===s||i===a||r&&s===a||o>l&&c<u}function nr(n,e,t){return Math.max(e,Math.min(t,n))}function Fue(n){return nr(n,-32768,32767)}function _a(n,e,t,r=1e-6){return n>=Math.min(e,t)-r&&n<=Math.max(e,t)+r}function xM(n,e,t){t=t||(a=>n[a]<e);let r=n.length-1,i=0,s;for(;r-i>1;)s=i+r>>1,t(s)?i=s:r=s;return{lo:i,hi:r}}const zl=(n,e,t,r)=>xM(n,t,r?i=>{const s=n[i][e];return s<t||s===t&&n[i+1][e]===t}:i=>n[i][e]<t),Uue=(n,e,t)=>xM(n,t,r=>n[r][e]>=t);function Bue(n,e,t){let r=0,i=n.length;for(;r<i&&n[r]<e;)r++;for(;i>r&&n[i-1]>t;)i--;return r>0||i<n.length?n.slice(r,i):n}const h4=["push","pop","shift","splice","unshift"];function zue(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),h4.forEach(t=>{const r="_onData"+vM(t),i=n[t];Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value(...s){const a=i.apply(this,s);return n._chartjs.listeners.forEach(o=>{typeof o[r]=="function"&&o[r](...s)}),a}})})}function j2(n,e){const t=n._chartjs;if(!t)return;const r=t.listeners,i=r.indexOf(e);i!==-1&&r.splice(i,1),!(r.length>0)&&(h4.forEach(s=>{delete n[s]}),delete n._chartjs)}function f4(n){const e=new Set(n);return e.size===n.length?n:Array.from(e)}const p4=function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame}();function m4(n,e){let t=[],r=!1;return function(...i){t=i,r||(r=!0,p4.call(window,()=>{r=!1,n.apply(e,t)}))}}function $ue(n,e){let t;return function(...r){return e?(clearTimeout(t),t=setTimeout(n,e,r)):n.apply(this,r),e}}const _M=n=>n==="start"?"left":n==="end"?"right":"center",Zn=(n,e,t)=>n==="start"?e:n==="end"?t:(e+t)/2,Vue=(n,e,t,r)=>n===(r?"left":"right")?t:n==="center"?(e+t)/2:e;function g4(n,e,t){const r=e.length;let i=0,s=r;if(n._sorted){const{iScale:a,vScale:o,_parsed:l}=n,c=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,u=a.axis,{min:d,max:h,minDefined:p,maxDefined:y}=a.getUserBounds();if(p){if(i=Math.min(zl(l,u,d).lo,t?r:zl(e,u,a.getPixelForValue(d)).lo),c){const v=l.slice(0,i+1).reverse().findIndex(g=>!At(g[o.axis]));i-=Math.max(0,v)}i=nr(i,0,r-1)}if(y){let v=Math.max(zl(l,a.axis,h,!0).hi+1,t?0:zl(e,u,a.getPixelForValue(h),!0).hi+1);if(c){const g=l.slice(v-1).findIndex(m=>!At(m[o.axis]));v+=Math.max(0,g)}s=nr(v,i,r)-i}else s=r-i}return{start:i,count:s}}function y4(n){const{xScale:e,yScale:t,_scaleRanges:r}=n,i={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!r)return n._scaleRanges=i,!0;const s=r.xmin!==e.min||r.xmax!==e.max||r.ymin!==t.min||r.ymax!==t.max;return Object.assign(r,i),s}const jg=n=>n===0||n===1,F2=(n,e,t)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*nn/t)),U2=(n,e,t)=>Math.pow(2,-10*n)*Math.sin((n-e)*nn/t)+1,Sf={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*En)+1,easeOutSine:n=>Math.sin(n*En),easeInOutSine:n=>-.5*(Math.cos(ln*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>jg(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>jg(n)?n:F2(n,.075,.3),easeOutElastic:n=>jg(n)?n:U2(n,.075,.3),easeInOutElastic(n){return jg(n)?n:n<.5?.5*F2(n*2,.1125,.45):.5+.5*U2(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-Sf.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?Sf.easeInBounce(n*2)*.5:Sf.easeOutBounce(n*2-1)*.5+.5};function bM(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function B2(n){return bM(n)?n:new vp(n)}function Wb(n){return bM(n)?n:new vp(n).saturate(.5).darken(.1).hexString()}const Hue=["x","y","borderWidth","radius","tension"],Wue=["color","borderColor","backgroundColor"];function Gue(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),n.set("animations",{colors:{type:"color",properties:Wue},numbers:{type:"number",properties:Hue}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function que(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const z2=new Map;function Xue(n,e){e=e||{};const t=n+JSON.stringify(e);let r=z2.get(t);return r||(r=new Intl.NumberFormat(n,e),z2.set(t,r)),r}function wM(n,e,t){return Xue(e,t).format(n)}const v4={values(n){return yn(n)?n:""+n},numeric(n,e,t){if(n===0)return"0";const r=this.chart.options.locale;let i,s=n;if(t.length>1){const c=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(c<1e-4||c>1e15)&&(i="scientific"),s=Yue(n,t)}const a=_1(Math.abs(s)),o=isNaN(a)?1:Math.max(Math.min(-1*Math.floor(a),20),0),l={notation:i,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(l,this.options.ticks.format),wM(n,r,l)},logarithmic(n,e,t){if(n===0)return"0";const r=t[e].significand||n/Math.pow(10,Math.floor(_1(n)));return[1,2,3,5,10,15].includes(r)||e>.8*t.length?v4.numeric.call(this,n,e,t):""}};function Yue(n,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&n!==Math.floor(n)&&(t=n-Math.floor(n)),t}var x4={formatters:v4};function Kue(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:x4.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const gc=Object.create(null),w1=Object.create(null);function Ef(n,e){if(!e)return n;const t=e.split(".");for(let r=0,i=t.length;r<i;++r){const s=t[r];n=n[s]||(n[s]=Object.create(null))}return n}function Gb(n,e,t){return typeof e=="string"?xp(Ef(n,e),t):xp(Ef(n,""),e)}class Zue{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,i)=>Wb(i.backgroundColor),this.hoverBorderColor=(r,i)=>Wb(i.borderColor),this.hoverColor=(r,i)=>Wb(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return Gb(this,e,t)}get(e){return Ef(this,e)}describe(e,t){return Gb(w1,e,t)}override(e,t){return Gb(gc,e,t)}route(e,t,r,i){const s=Ef(this,e),a=Ef(this,r),o="_"+t;Object.defineProperties(s,{[o]:{value:s[t],writable:!0},[t]:{enumerable:!0,get(){const l=this[o],c=a[i];return _t(l)?Object.assign({},c,l):pt(l,c)},set(l){this[o]=l}}})}apply(e){e.forEach(t=>t(this))}}var fn=new Zue({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Gue,que,Kue]);function Jue(n){return!n||At(n.size)||At(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function $2(n,e,t,r,i){let s=e[i];return s||(s=e[i]=n.measureText(i).width,t.push(i)),s>r&&(r=s),r}function ml(n,e,t){const r=n.currentDevicePixelRatio,i=t!==0?Math.max(t/2,.5):0;return Math.round((e-i)*r)/r+i}function V2(n,e){!e&&!n||(e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore())}function S1(n,e,t,r){_4(n,e,t,r,null)}function _4(n,e,t,r,i){let s,a,o,l,c,u,d,h;const p=e.pointStyle,y=e.rotation,v=e.radius;let g=(y||0)*Rue;if(p&&typeof p=="object"&&(s=p.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){n.save(),n.translate(t,r),n.rotate(g),n.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),n.restore();return}if(!(isNaN(v)||v<=0)){switch(n.beginPath(),p){default:i?n.ellipse(t,r,i/2,v,0,0,nn):n.arc(t,r,v,0,nn),n.closePath();break;case"triangle":u=i?i/2:v,n.moveTo(t+Math.sin(g)*u,r-Math.cos(g)*v),g+=L2,n.lineTo(t+Math.sin(g)*u,r-Math.cos(g)*v),g+=L2,n.lineTo(t+Math.sin(g)*u,r-Math.cos(g)*v),n.closePath();break;case"rectRounded":c=v*.516,l=v-c,a=Math.cos(g+pl)*l,d=Math.cos(g+pl)*(i?i/2-c:l),o=Math.sin(g+pl)*l,h=Math.sin(g+pl)*(i?i/2-c:l),n.arc(t-d,r-o,c,g-ln,g-En),n.arc(t+h,r-a,c,g-En,g),n.arc(t+d,r+o,c,g,g+En),n.arc(t-h,r+a,c,g+En,g+ln),n.closePath();break;case"rect":if(!y){l=Math.SQRT1_2*v,u=i?i/2:l,n.rect(t-u,r-l,2*u,2*l);break}g+=pl;case"rectRot":d=Math.cos(g)*(i?i/2:v),a=Math.cos(g)*v,o=Math.sin(g)*v,h=Math.sin(g)*(i?i/2:v),n.moveTo(t-d,r-o),n.lineTo(t+h,r-a),n.lineTo(t+d,r+o),n.lineTo(t-h,r+a),n.closePath();break;case"crossRot":g+=pl;case"cross":d=Math.cos(g)*(i?i/2:v),a=Math.cos(g)*v,o=Math.sin(g)*v,h=Math.sin(g)*(i?i/2:v),n.moveTo(t-d,r-o),n.lineTo(t+d,r+o),n.moveTo(t+h,r-a),n.lineTo(t-h,r+a);break;case"star":d=Math.cos(g)*(i?i/2:v),a=Math.cos(g)*v,o=Math.sin(g)*v,h=Math.sin(g)*(i?i/2:v),n.moveTo(t-d,r-o),n.lineTo(t+d,r+o),n.moveTo(t+h,r-a),n.lineTo(t-h,r+a),g+=pl,d=Math.cos(g)*(i?i/2:v),a=Math.cos(g)*v,o=Math.sin(g)*v,h=Math.sin(g)*(i?i/2:v),n.moveTo(t-d,r-o),n.lineTo(t+d,r+o),n.moveTo(t+h,r-a),n.lineTo(t-h,r+a);break;case"line":a=i?i/2:Math.cos(g)*v,o=Math.sin(g)*v,n.moveTo(t-a,r-o),n.lineTo(t+a,r+o);break;case"dash":n.moveTo(t,r),n.lineTo(t+Math.cos(g)*(i?i/2:v),r+Math.sin(g)*v);break;case!1:n.closePath();break}n.fill(),e.borderWidth>0&&n.stroke()}}function wp(n,e,t){return t=t||.5,!e||n&&n.x>e.left-t&&n.x<e.right+t&&n.y>e.top-t&&n.y<e.bottom+t}function yx(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function vx(n){n.restore()}function Que(n,e,t,r,i){if(!e)return n.lineTo(t.x,t.y);if(i==="middle"){const s=(e.x+t.x)/2;n.lineTo(s,e.y),n.lineTo(s,t.y)}else i==="after"!=!!r?n.lineTo(e.x,t.y):n.lineTo(t.x,e.y);n.lineTo(t.x,t.y)}function ede(n,e,t,r){if(!e)return n.lineTo(t.x,t.y);n.bezierCurveTo(r?e.cp1x:e.cp2x,r?e.cp1y:e.cp2y,r?t.cp2x:t.cp1x,r?t.cp2y:t.cp1y,t.x,t.y)}function tde(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),At(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function nde(n,e,t,r,i){if(i.strikethrough||i.underline){const s=n.measureText(r),a=e-s.actualBoundingBoxLeft,o=e+s.actualBoundingBoxRight,l=t-s.actualBoundingBoxAscent,c=t+s.actualBoundingBoxDescent,u=i.strikethrough?(l+c)/2:c;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=i.decorationWidth||2,n.moveTo(a,u),n.lineTo(o,u),n.stroke()}}function rde(n,e){const t=n.fillStyle;n.fillStyle=e.color,n.fillRect(e.left,e.top,e.width,e.height),n.fillStyle=t}function Sp(n,e,t,r,i,s={}){const a=yn(e)?e:[e],o=s.strokeWidth>0&&s.strokeColor!=="";let l,c;for(n.save(),n.font=i.string,tde(n,s),l=0;l<a.length;++l)c=a[l],s.backdrop&&rde(n,s.backdrop),o&&(s.strokeColor&&(n.strokeStyle=s.strokeColor),At(s.strokeWidth)||(n.lineWidth=s.strokeWidth),n.strokeText(c,t,r,s.maxWidth)),n.fillText(c,t,r,s.maxWidth),nde(n,t,r,c,s),r+=Number(i.lineHeight);n.restore()}function V0(n,e){const{x:t,y:r,w:i,h:s,radius:a}=e;n.arc(t+a.topLeft,r+a.topLeft,a.topLeft,1.5*ln,ln,!0),n.lineTo(t,r+s-a.bottomLeft),n.arc(t+a.bottomLeft,r+s-a.bottomLeft,a.bottomLeft,ln,En,!0),n.lineTo(t+i-a.bottomRight,r+s),n.arc(t+i-a.bottomRight,r+s-a.bottomRight,a.bottomRight,En,0,!0),n.lineTo(t+i,r+a.topRight),n.arc(t+i-a.topRight,r+a.topRight,a.topRight,0,-En,!0),n.lineTo(t+a.topLeft,r)}const ide=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,sde=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function ade(n,e){const t=(""+n).match(ide);if(!t||t[1]==="normal")return e*1.2;switch(n=+t[2],t[3]){case"px":return n;case"%":n/=100;break}return e*n}const ode=n=>+n||0;function SM(n,e){const t={},r=_t(e),i=r?Object.keys(e):e,s=_t(n)?r?a=>pt(n[a],n[e[a]]):a=>n[a]:()=>n;for(const a of i)t[a]=ode(s(a));return t}function b4(n){return SM(n,{top:"y",right:"x",bottom:"y",left:"x"})}function Yu(n){return SM(n,["topLeft","topRight","bottomLeft","bottomRight"])}function Ri(n){const e=b4(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function rr(n,e){n=n||{},e=e||fn.font;let t=pt(n.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let r=pt(n.style,e.style);r&&!(""+r).match(sde)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const i={family:pt(n.family,e.family),lineHeight:ade(pt(n.lineHeight,e.lineHeight),t),size:t,style:r,weight:pt(n.weight,e.weight),string:""};return i.string=Jue(i),i}function Fg(n,e,t,r){let i,s,a;for(i=0,s=n.length;i<s;++i)if(a=n[i],a!==void 0&&a!==void 0)return a}function lde(n,e,t){const{min:r,max:i}=n,s=c4(e,(i-r)/2),a=(o,l)=>t&&o===0?0:o+l;return{min:a(r,-Math.abs(s)),max:a(i,s)}}function kc(n,e){return Object.assign(Object.create(n),e)}function EM(n,e=[""],t,r,i=()=>n[0]){const s=t||n;typeof r>"u"&&(r=T4("_fallback",n));const a={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:s,_fallback:r,_getTarget:i,override:o=>EM([o,...n],e,s,r)};return new Proxy(a,{deleteProperty(o,l){return delete o[l],delete o._keys,delete n[0][l],!0},get(o,l){return S4(o,l,()=>gde(l,e,n,o))},getOwnPropertyDescriptor(o,l){return Reflect.getOwnPropertyDescriptor(o._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(o,l){return W2(o).includes(l)},ownKeys(o){return W2(o)},set(o,l,c){const u=o._storage||(o._storage=i());return o[l]=u[l]=c,delete o._keys,!0}})}function xd(n,e,t,r){const i={_cacheable:!1,_proxy:n,_context:e,_subProxy:t,_stack:new Set,_descriptors:w4(n,r),setContext:s=>xd(n,s,t,r),override:s=>xd(n.override(s),e,t,r)};return new Proxy(i,{deleteProperty(s,a){return delete s[a],delete n[a],!0},get(s,a,o){return S4(s,a,()=>ude(s,a,o))},getOwnPropertyDescriptor(s,a){return s._descriptors.allKeys?Reflect.has(n,a)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,a)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(s,a){return Reflect.has(n,a)},ownKeys(){return Reflect.ownKeys(n)},set(s,a,o){return n[a]=o,delete s[a],!0}})}function w4(n,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:r=e.indexable,_allKeys:i=e.allKeys}=n;return{allKeys:i,scriptable:t,indexable:r,isScriptable:qo(t)?t:()=>t,isIndexable:qo(r)?r:()=>r}}const cde=(n,e)=>n?n+vM(e):e,TM=(n,e)=>_t(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function S4(n,e,t){if(Object.prototype.hasOwnProperty.call(n,e)||e==="constructor")return n[e];const r=t();return n[e]=r,r}function ude(n,e,t){const{_proxy:r,_context:i,_subProxy:s,_descriptors:a}=n;let o=r[e];return qo(o)&&a.isScriptable(e)&&(o=dde(e,o,n,t)),yn(o)&&o.length&&(o=hde(e,o,n,a.isIndexable)),TM(e,o)&&(o=xd(o,i,s&&s[e],a)),o}function dde(n,e,t,r){const{_proxy:i,_context:s,_subProxy:a,_stack:o}=t;if(o.has(n))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+n);o.add(n);let l=e(s,a||r);return o.delete(n),TM(n,l)&&(l=MM(i._scopes,i,n,l)),l}function hde(n,e,t,r){const{_proxy:i,_context:s,_subProxy:a,_descriptors:o}=t;if(typeof s.index<"u"&&r(n))return e[s.index%e.length];if(_t(e[0])){const l=e,c=i._scopes.filter(u=>u!==l);e=[];for(const u of l){const d=MM(c,i,n,u);e.push(xd(d,s,a&&a[n],o))}}return e}function E4(n,e,t){return qo(n)?n(e,t):n}const fde=(n,e)=>n===!0?e:typeof n=="string"?mc(e,n):void 0;function pde(n,e,t,r,i){for(const s of e){const a=fde(t,s);if(a){n.add(a);const o=E4(a._fallback,t,i);if(typeof o<"u"&&o!==t&&o!==r)return o}else if(a===!1&&typeof r<"u"&&t!==r)return null}return!1}function MM(n,e,t,r){const i=e._rootScopes,s=E4(e._fallback,t,r),a=[...n,...i],o=new Set;o.add(r);let l=H2(o,a,t,s||t,r);return l===null||typeof s<"u"&&s!==t&&(l=H2(o,a,s,l,r),l===null)?!1:EM(Array.from(o),[""],i,s,()=>mde(e,t,r))}function H2(n,e,t,r,i){for(;t;)t=pde(n,e,t,r,i);return t}function mde(n,e,t){const r=n._getTarget();e in r||(r[e]={});const i=r[e];return yn(i)&&_t(t)?t:i||{}}function gde(n,e,t,r){let i;for(const s of e)if(i=T4(cde(s,n),t),typeof i<"u")return TM(n,i)?MM(t,r,n,i):i}function T4(n,e){for(const t of e){if(!t)continue;const r=t[n];if(typeof r<"u")return r}}function W2(n){let e=n._keys;return e||(e=n._keys=yde(n._scopes)),e}function yde(n){const e=new Set;for(const t of n)for(const r of Object.keys(t).filter(i=>!i.startsWith("_")))e.add(r);return Array.from(e)}const vde=Number.EPSILON||1e-14,_d=(n,e)=>e<n.length&&!n[e].skip&&n[e],M4=n=>n==="x"?"y":"x";function xde(n,e,t,r){const i=n.skip?e:n,s=e,a=t.skip?e:t,o=b1(s,i),l=b1(a,s);let c=o/(o+l),u=l/(o+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const d=r*c,h=r*u;return{previous:{x:s.x-d*(a.x-i.x),y:s.y-d*(a.y-i.y)},next:{x:s.x+h*(a.x-i.x),y:s.y+h*(a.y-i.y)}}}function _de(n,e,t){const r=n.length;let i,s,a,o,l,c=_d(n,0);for(let u=0;u<r-1;++u)if(l=c,c=_d(n,u+1),!(!l||!c)){if(wf(e[u],0,vde)){t[u]=t[u+1]=0;continue}i=t[u]/e[u],s=t[u+1]/e[u],o=Math.pow(i,2)+Math.pow(s,2),!(o<=9)&&(a=3/Math.sqrt(o),t[u]=i*a*e[u],t[u+1]=s*a*e[u])}}function bde(n,e,t="x"){const r=M4(t),i=n.length;let s,a,o,l=_d(n,0);for(let c=0;c<i;++c){if(a=o,o=l,l=_d(n,c+1),!o)continue;const u=o[t],d=o[r];a&&(s=(u-a[t])/3,o[`cp1${t}`]=u-s,o[`cp1${r}`]=d-s*e[c]),l&&(s=(l[t]-u)/3,o[`cp2${t}`]=u+s,o[`cp2${r}`]=d+s*e[c])}}function wde(n,e="x"){const t=M4(e),r=n.length,i=Array(r).fill(0),s=Array(r);let a,o,l,c=_d(n,0);for(a=0;a<r;++a)if(o=l,l=c,c=_d(n,a+1),!!l){if(c){const u=c[e]-l[e];i[a]=u!==0?(c[t]-l[t])/u:0}s[a]=o?c?Ns(i[a-1])!==Ns(i[a])?0:(i[a-1]+i[a])/2:i[a-1]:i[a]}_de(n,i,s),bde(n,s,e)}function Ug(n,e,t){return Math.max(Math.min(n,t),e)}function Sde(n,e){let t,r,i,s,a,o=wp(n[0],e);for(t=0,r=n.length;t<r;++t)a=s,s=o,o=t<r-1&&wp(n[t+1],e),s&&(i=n[t],a&&(i.cp1x=Ug(i.cp1x,e.left,e.right),i.cp1y=Ug(i.cp1y,e.top,e.bottom)),o&&(i.cp2x=Ug(i.cp2x,e.left,e.right),i.cp2y=Ug(i.cp2y,e.top,e.bottom)))}function Ede(n,e,t,r,i){let s,a,o,l;if(e.spanGaps&&(n=n.filter(c=>!c.skip)),e.cubicInterpolationMode==="monotone")wde(n,i);else{let c=r?n[n.length-1]:n[0];for(s=0,a=n.length;s<a;++s)o=n[s],l=xde(c,o,n[Math.min(s+1,a-(r?0:1))%a],e.tension),o.cp1x=l.previous.x,o.cp1y=l.previous.y,o.cp2x=l.next.x,o.cp2y=l.next.y,c=o}e.capBezierPoints&&Sde(n,t)}function kM(){return typeof window<"u"&&typeof document<"u"}function AM(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function H0(n,e,t){let r;return typeof n=="string"?(r=parseInt(n,10),n.indexOf("%")!==-1&&(r=r/100*e.parentNode[t])):r=n,r}const xx=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function Tde(n,e){return xx(n).getPropertyValue(e)}const Mde=["top","right","bottom","left"];function Ql(n,e,t){const r={};t=t?"-"+t:"";for(let i=0;i<4;i++){const s=Mde[i];r[s]=parseFloat(n[e+"-"+s+t])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const kde=(n,e,t)=>(n>0||e>0)&&(!t||!t.shadowRoot);function Ade(n,e){const t=n.touches,r=t&&t.length?t[0]:n,{offsetX:i,offsetY:s}=r;let a=!1,o,l;if(kde(i,s,n.target))o=i,l=s;else{const c=e.getBoundingClientRect();o=r.clientX-c.left,l=r.clientY-c.top,a=!0}return{x:o,y:l,box:a}}function El(n,e){if("native"in n)return n;const{canvas:t,currentDevicePixelRatio:r}=e,i=xx(t),s=i.boxSizing==="border-box",a=Ql(i,"padding"),o=Ql(i,"border","width"),{x:l,y:c,box:u}=Ade(n,t),d=a.left+(u&&o.left),h=a.top+(u&&o.top);let{width:p,height:y}=e;return s&&(p-=a.width+o.width,y-=a.height+o.height),{x:Math.round((l-d)/p*t.width/r),y:Math.round((c-h)/y*t.height/r)}}function Pde(n,e,t){let r,i;if(e===void 0||t===void 0){const s=n&&AM(n);if(!s)e=n.clientWidth,t=n.clientHeight;else{const a=s.getBoundingClientRect(),o=xx(s),l=Ql(o,"border","width"),c=Ql(o,"padding");e=a.width-c.width-l.width,t=a.height-c.height-l.height,r=H0(o.maxWidth,s,"clientWidth"),i=H0(o.maxHeight,s,"clientHeight")}}return{width:e,height:t,maxWidth:r||$0,maxHeight:i||$0}}const Bg=n=>Math.round(n*10)/10;function Cde(n,e,t,r){const i=xx(n),s=Ql(i,"margin"),a=H0(i.maxWidth,n,"clientWidth")||$0,o=H0(i.maxHeight,n,"clientHeight")||$0,l=Pde(n,e,t);let{width:c,height:u}=l;if(i.boxSizing==="content-box"){const h=Ql(i,"border","width"),p=Ql(i,"padding");c-=p.width+h.width,u-=p.height+h.height}return c=Math.max(0,c-s.width),u=Math.max(0,r?c/r:u-s.height),c=Bg(Math.min(c,a,l.maxWidth)),u=Bg(Math.min(u,o,l.maxHeight)),c&&!u&&(u=Bg(c/2)),(e!==void 0||t!==void 0)&&r&&l.height&&u>l.height&&(u=l.height,c=Bg(Math.floor(u*r))),{width:c,height:u}}function G2(n,e,t){const r=e||1,i=Math.floor(n.height*r),s=Math.floor(n.width*r);n.height=Math.floor(n.height),n.width=Math.floor(n.width);const a=n.canvas;return a.style&&(t||!a.style.height&&!a.style.width)&&(a.style.height=`${n.height}px`,a.style.width=`${n.width}px`),n.currentDevicePixelRatio!==r||a.height!==i||a.width!==s?(n.currentDevicePixelRatio=r,a.height=i,a.width=s,n.ctx.setTransform(r,0,0,r,0,0),!0):!1}const Rde=function(){let n=!1;try{const e={get passive(){return n=!0,!1}};kM()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return n}();function q2(n,e){const t=Tde(n,e),r=t&&t.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function Tl(n,e,t,r){return{x:n.x+t*(e.x-n.x),y:n.y+t*(e.y-n.y)}}function Nde(n,e,t,r){return{x:n.x+t*(e.x-n.x),y:r==="middle"?t<.5?n.y:e.y:r==="after"?t<1?n.y:e.y:t>0?e.y:n.y}}function Ode(n,e,t,r){const i={x:n.cp2x,y:n.cp2y},s={x:e.cp1x,y:e.cp1y},a=Tl(n,i,t),o=Tl(i,s,t),l=Tl(s,e,t),c=Tl(a,o,t),u=Tl(o,l,t);return Tl(c,u,t)}const Lde=function(n,e){return{x(t){return n+n+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,r){return t-r},leftForLtr(t,r){return t-r}}},Dde=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function Ku(n,e,t){return n?Lde(e,t):Dde()}function k4(n,e){let t,r;(e==="ltr"||e==="rtl")&&(t=n.canvas.style,r=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),n.prevTextDirection=r)}function A4(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function P4(n){return n==="angle"?{between:bp,compare:jue,normalize:Ss}:{between:_a,compare:(e,t)=>e-t,normalize:e=>e}}function X2({start:n,end:e,count:t,loop:r,style:i}){return{start:n%t,end:e%t,loop:r&&(e-n+1)%t===0,style:i}}function Ide(n,e,t){const{property:r,start:i,end:s}=t,{between:a,normalize:o}=P4(r),l=e.length;let{start:c,end:u,loop:d}=n,h,p;if(d){for(c+=l,u+=l,h=0,p=l;h<p&&a(o(e[c%l][r]),i,s);++h)c--,u--;c%=l,u%=l}return u<c&&(u+=l),{start:c,end:u,loop:d,style:n.style}}function C4(n,e,t){if(!t)return[n];const{property:r,start:i,end:s}=t,a=e.length,{compare:o,between:l,normalize:c}=P4(r),{start:u,end:d,loop:h,style:p}=Ide(n,e,t),y=[];let v=!1,g=null,m,x,_;const b=()=>l(i,_,m)&&o(i,_)!==0,w=()=>o(s,m)===0||l(s,_,m),E=()=>v||b(),S=()=>!v||w();for(let M=u,N=u;M<=d;++M)x=e[M%a],!x.skip&&(m=c(x[r]),m!==_&&(v=l(m,i,s),g===null&&E()&&(g=o(m,i)===0?M:N),g!==null&&S()&&(y.push(X2({start:g,end:M,loop:h,count:a,style:p})),g=null),N=M,_=m));return g!==null&&y.push(X2({start:g,end:d,loop:h,count:a,style:p})),y}function R4(n,e){const t=[],r=n.segments;for(let i=0;i<r.length;i++){const s=C4(r[i],n.points,e);s.length&&t.push(...s)}return t}function jde(n,e,t,r){let i=0,s=e-1;if(t&&!r)for(;i<e&&!n[i].skip;)i++;for(;i<e&&n[i].skip;)i++;for(i%=e,t&&(s+=i);s>i&&n[s%e].skip;)s--;return s%=e,{start:i,end:s}}function Fde(n,e,t,r){const i=n.length,s=[];let a=e,o=n[e],l;for(l=e+1;l<=t;++l){const c=n[l%i];c.skip||c.stop?o.skip||(r=!1,s.push({start:e%i,end:(l-1)%i,loop:r}),e=a=c.stop?l:null):(a=l,o.skip&&(e=l)),o=c}return a!==null&&s.push({start:e%i,end:a%i,loop:r}),s}function Ude(n,e){const t=n.points,r=n.options.spanGaps,i=t.length;if(!i)return[];const s=!!n._loop,{start:a,end:o}=jde(t,i,s,r);if(r===!0)return Y2(n,[{start:a,end:o,loop:s}],t,e);const l=o<a?o+i:o,c=!!n._fullLoop&&a===0&&o===i-1;return Y2(n,Fde(t,a,l,c),t,e)}function Y2(n,e,t,r){return!r||!r.setContext||!t?e:Bde(n,e,t,r)}function Bde(n,e,t,r){const i=n._chart.getContext(),s=K2(n.options),{_datasetIndex:a,options:{spanGaps:o}}=n,l=t.length,c=[];let u=s,d=e[0].start,h=d;function p(y,v,g,m){const x=o?-1:1;if(y!==v){for(y+=l;t[y%l].skip;)y-=x;for(;t[v%l].skip;)v+=x;y%l!==v%l&&(c.push({start:y%l,end:v%l,loop:g,style:m}),u=m,d=v%l)}}for(const y of e){d=o?d:y.start;let v=t[d%l],g;for(h=d+1;h<=y.end;h++){const m=t[h%l];g=K2(r.setContext(kc(i,{type:"segment",p0:v,p1:m,p0DataIndex:(h-1)%l,p1DataIndex:h%l,datasetIndex:a}))),zde(g,u)&&p(d,h-1,y.loop,u),v=m,u=g}d<h-1&&p(d,h-1,y.loop,u)}return c}function K2(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function zde(n,e){if(!e)return!1;const t=[],r=function(i,s){return bM(s)?(t.includes(s)||t.push(s),t.indexOf(s)):s};return JSON.stringify(n,r)!==JSON.stringify(e,r)}/*!
 * Chart.js v4.4.8
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class $de{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,r,i){const s=t.listeners[i],a=t.duration;s.forEach(o=>o({chart:e,initial:t.initial,numSteps:a,currentStep:Math.min(r-t.start,a)}))}_refresh(){this._request||(this._running=!0,this._request=p4.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((r,i)=>{if(!r.running||!r.items.length)return;const s=r.items;let a=s.length-1,o=!1,l;for(;a>=0;--a)l=s[a],l._active?(l._total>r.duration&&(r.duration=l._total),l.tick(e),o=!0):(s[a]=s[s.length-1],s.pop());o&&(i.draw(),this._notify(i,r,e,"progress")),s.length||(r.running=!1,this._notify(i,r,e,"complete"),r.initial=!1),t+=s.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let r=t.get(e);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,r)),r}listen(e,t,r){this._getAnims(e).listeners[t].push(r)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((r,i)=>Math.max(r,i._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const r=t.items;let i=r.length-1;for(;i>=0;--i)r[i].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var ra=new $de;const Z2="transparent",Vde={boolean(n,e,t){return t>.5?e:n},color(n,e,t){const r=B2(n||Z2),i=r.valid&&B2(e||Z2);return i&&i.valid?i.mix(r,t).hexString():e},number(n,e,t){return n+(e-n)*t}};class Hde{constructor(e,t,r,i){const s=t[r];i=Fg([e.to,i,s,e.from]);const a=Fg([e.from,s,i]);this._active=!0,this._fn=e.fn||Vde[e.type||typeof a],this._easing=Sf[e.easing]||Sf.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=r,this._from=a,this._to=i,this._promises=void 0}active(){return this._active}update(e,t,r){if(this._active){this._notify(!1);const i=this._target[this._prop],s=r-this._start,a=this._duration-s;this._start=r,this._duration=Math.floor(Math.max(a,e.duration)),this._total+=s,this._loop=!!e.loop,this._to=Fg([e.to,t,i,e.from]),this._from=Fg([e.from,i,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,r=this._duration,i=this._prop,s=this._from,a=this._loop,o=this._to;let l;if(this._active=s!==o&&(a||t<r),!this._active){this._target[i]=o,this._notify(!0);return}if(t<0){this._target[i]=s;return}l=t/r%2,l=a&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[i]=this._fn(s,o,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,r)=>{e.push({res:t,rej:r})})}_notify(e){const t=e?"res":"rej",r=this._promises||[];for(let i=0;i<r.length;i++)r[i][t]()}}class N4{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!_t(e))return;const t=Object.keys(fn.animation),r=this._properties;Object.getOwnPropertyNames(e).forEach(i=>{const s=e[i];if(!_t(s))return;const a={};for(const o of t)a[o]=s[o];(yn(s.properties)&&s.properties||[i]).forEach(o=>{(o===i||!r.has(o))&&r.set(o,a)})})}_animateOptions(e,t){const r=t.options,i=Gde(e,r);if(!i)return[];const s=this._createAnimations(i,r);return r.$shared&&Wde(e.options.$animations,r).then(()=>{e.options=r},()=>{}),s}_createAnimations(e,t){const r=this._properties,i=[],s=e.$animations||(e.$animations={}),a=Object.keys(t),o=Date.now();let l;for(l=a.length-1;l>=0;--l){const c=a[l];if(c.charAt(0)==="$")continue;if(c==="options"){i.push(...this._animateOptions(e,t));continue}const u=t[c];let d=s[c];const h=r.get(c);if(d)if(h&&d.active()){d.update(h,u,o);continue}else d.cancel();if(!h||!h.duration){e[c]=u;continue}s[c]=d=new Hde(h,e,c,u),i.push(d)}return i}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const r=this._createAnimations(e,t);if(r.length)return ra.add(this._chart,r),!0}}function Wde(n,e){const t=[],r=Object.keys(e);for(let i=0;i<r.length;i++){const s=n[r[i]];s&&s.active()&&t.push(s.wait())}return Promise.all(t)}function Gde(n,e){if(!e)return;let t=n.options;if(!t){n.options=e;return}return t.$shared&&(n.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function J2(n,e){const t=n&&n.options||{},r=t.reverse,i=t.min===void 0?e:0,s=t.max===void 0?e:0;return{start:r?s:i,end:r?i:s}}function qde(n,e,t){if(t===!1)return!1;const r=J2(n,t),i=J2(e,t);return{top:i.end,right:r.end,bottom:i.start,left:r.start}}function Xde(n){let e,t,r,i;return _t(n)?(e=n.top,t=n.right,r=n.bottom,i=n.left):e=t=r=i=n,{top:e,right:t,bottom:r,left:i,disabled:n===!1}}function O4(n,e){const t=[],r=n._getSortedDatasetMetas(e);let i,s;for(i=0,s=r.length;i<s;++i)t.push(r[i].index);return t}function Q2(n,e,t,r={}){const i=n.keys,s=r.mode==="single";let a,o,l,c;if(e===null)return;let u=!1;for(a=0,o=i.length;a<o;++a){if(l=+i[a],l===t){if(u=!0,r.all)continue;break}c=n.values[l],lr(c)&&(s||e===0||Ns(e)===Ns(c))&&(e+=c)}return!u&&!r.all?0:e}function Yde(n,e){const{iScale:t,vScale:r}=e,i=t.axis==="x"?"x":"y",s=r.axis==="x"?"x":"y",a=Object.keys(n),o=new Array(a.length);let l,c,u;for(l=0,c=a.length;l<c;++l)u=a[l],o[l]={[i]:u,[s]:n[u]};return o}function qb(n,e){const t=n&&n.options.stacked;return t||t===void 0&&e.stack!==void 0}function Kde(n,e,t){return`${n.id}.${e.id}.${t.stack||t.type}`}function Zde(n){const{min:e,max:t,minDefined:r,maxDefined:i}=n.getUserBounds();return{min:r?e:Number.NEGATIVE_INFINITY,max:i?t:Number.POSITIVE_INFINITY}}function Jde(n,e,t){const r=n[e]||(n[e]={});return r[t]||(r[t]={})}function eN(n,e,t,r){for(const i of e.getMatchingVisibleMetas(r).reverse()){const s=n[i.index];if(t&&s>0||!t&&s<0)return i.index}return null}function tN(n,e){const{chart:t,_cachedMeta:r}=n,i=t._stacks||(t._stacks={}),{iScale:s,vScale:a,index:o}=r,l=s.axis,c=a.axis,u=Kde(s,a,r),d=e.length;let h;for(let p=0;p<d;++p){const y=e[p],{[l]:v,[c]:g}=y,m=y._stacks||(y._stacks={});h=m[c]=Jde(i,u,v),h[o]=g,h._top=eN(h,a,!0,r.type),h._bottom=eN(h,a,!1,r.type);const x=h._visualValues||(h._visualValues={});x[o]=g}}function Xb(n,e){const t=n.scales;return Object.keys(t).filter(r=>t[r].axis===e).shift()}function Qde(n,e){return kc(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function ehe(n,e,t){return kc(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function Mh(n,e){const t=n.controller.index,r=n.vScale&&n.vScale.axis;if(r){e=e||n._parsed;for(const i of e){const s=i._stacks;if(!s||s[r]===void 0||s[r][t]===void 0)return;delete s[r][t],s[r]._visualValues!==void 0&&s[r]._visualValues[t]!==void 0&&delete s[r]._visualValues[t]}}}const Yb=n=>n==="reset"||n==="none",nN=(n,e)=>e?n:Object.assign({},n),the=(n,e,t)=>n&&!e.hidden&&e._stacked&&{keys:O4(t,!0),values:null};class jo{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=qb(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Mh(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,r=this.getDataset(),i=(d,h,p,y)=>d==="x"?h:d==="r"?y:p,s=t.xAxisID=pt(r.xAxisID,Xb(e,"x")),a=t.yAxisID=pt(r.yAxisID,Xb(e,"y")),o=t.rAxisID=pt(r.rAxisID,Xb(e,"r")),l=t.indexAxis,c=t.iAxisID=i(l,s,a,o),u=t.vAxisID=i(l,a,s,o);t.xScale=this.getScaleForId(s),t.yScale=this.getScaleForId(a),t.rScale=this.getScaleForId(o),t.iScale=this.getScaleForId(c),t.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&j2(this._data,this),e._stacked&&Mh(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),r=this._data;if(_t(t)){const i=this._cachedMeta;this._data=Yde(t,i)}else if(r!==t){if(r){j2(r,this);const i=this._cachedMeta;Mh(i),i._parsed=[]}t&&Object.isExtensible(t)&&zue(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,r=this.getDataset();let i=!1;this._dataCheck();const s=t._stacked;t._stacked=qb(t.vScale,t),t.stack!==r.stack&&(i=!0,Mh(t),t.stack=r.stack),this._resyncElements(e),(i||s!==t._stacked)&&(tN(this,t._parsed),t._stacked=qb(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:r,_data:i}=this,{iScale:s,_stacked:a}=r,o=s.axis;let l=e===0&&t===i.length?!0:r._sorted,c=e>0&&r._parsed[e-1],u,d,h;if(this._parsing===!1)r._parsed=i,r._sorted=!0,h=i;else{yn(i[e])?h=this.parseArrayData(r,i,e,t):_t(i[e])?h=this.parseObjectData(r,i,e,t):h=this.parsePrimitiveData(r,i,e,t);const p=()=>d[o]===null||c&&d[o]<c[o];for(u=0;u<t;++u)r._parsed[u+e]=d=h[u],l&&(p()&&(l=!1),c=d);r._sorted=l}a&&tN(this,h)}parsePrimitiveData(e,t,r,i){const{iScale:s,vScale:a}=e,o=s.axis,l=a.axis,c=s.getLabels(),u=s===a,d=new Array(i);let h,p,y;for(h=0,p=i;h<p;++h)y=h+r,d[h]={[o]:u||s.parse(c[y],y),[l]:a.parse(t[y],y)};return d}parseArrayData(e,t,r,i){const{xScale:s,yScale:a}=e,o=new Array(i);let l,c,u,d;for(l=0,c=i;l<c;++l)u=l+r,d=t[u],o[l]={x:s.parse(d[0],u),y:a.parse(d[1],u)};return o}parseObjectData(e,t,r,i){const{xScale:s,yScale:a}=e,{xAxisKey:o="x",yAxisKey:l="y"}=this._parsing,c=new Array(i);let u,d,h,p;for(u=0,d=i;u<d;++u)h=u+r,p=t[h],c[u]={x:s.parse(mc(p,o),h),y:a.parse(mc(p,l),h)};return c}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,r){const i=this.chart,s=this._cachedMeta,a=t[e.axis],o={keys:O4(i,!0),values:t._stacks[e.axis]._visualValues};return Q2(o,a,s.index,{mode:r})}updateRangeFromParsed(e,t,r,i){const s=r[t.axis];let a=s===null?NaN:s;const o=i&&r._stacks[t.axis];i&&o&&(i.values=o,a=Q2(i,s,this._cachedMeta.index)),e.min=Math.min(e.min,a),e.max=Math.max(e.max,a)}getMinMax(e,t){const r=this._cachedMeta,i=r._parsed,s=r._sorted&&e===r.iScale,a=i.length,o=this._getOtherScale(e),l=the(t,r,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:d}=Zde(o);let h,p;function y(){p=i[h];const v=p[o.axis];return!lr(p[e.axis])||u>v||d<v}for(h=0;h<a&&!(!y()&&(this.updateRangeFromParsed(c,e,p,l),s));++h);if(s){for(h=a-1;h>=0;--h)if(!y()){this.updateRangeFromParsed(c,e,p,l);break}}return c}getAllParsedValues(e){const t=this._cachedMeta._parsed,r=[];let i,s,a;for(i=0,s=t.length;i<s;++i)a=t[i][e.axis],lr(a)&&r.push(a);return r}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,r=t.iScale,i=t.vScale,s=this.getParsed(e);return{label:r?""+r.getLabelForValue(s[r.axis]):"",value:i?""+i.getLabelForValue(s[i.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=Xde(pt(this.options.clip,qde(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,r=this._cachedMeta,i=r.data||[],s=t.chartArea,a=[],o=this._drawStart||0,l=this._drawCount||i.length-o,c=this.options.drawActiveElementsOnTop;let u;for(r.dataset&&r.dataset.draw(e,s,o,l),u=o;u<o+l;++u){const d=i[u];d.hidden||(d.active&&c?a.push(d):d.draw(e,s))}for(u=0;u<a.length;++u)a[u].draw(e,s)}getStyle(e,t){const r=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,t,r){const i=this.getDataset();let s;if(e>=0&&e<this._cachedMeta.data.length){const a=this._cachedMeta.data[e];s=a.$context||(a.$context=ehe(this.getContext(),e,a)),s.parsed=this.getParsed(e),s.raw=i.data[e],s.index=s.dataIndex=e}else s=this.$context||(this.$context=Qde(this.chart.getContext(),this.index)),s.dataset=i,s.index=s.datasetIndex=this.index;return s.active=!!t,s.mode=r,s}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",r){const i=t==="active",s=this._cachedDataOpts,a=e+"-"+t,o=s[a],l=this.enableOptionSharing&&_p(r);if(o)return nN(o,l);const c=this.chart.config,u=c.datasetElementScopeKeys(this._type,e),d=i?[`${e}Hover`,"hover",e,""]:[e,""],h=c.getOptionScopes(this.getDataset(),u),p=Object.keys(fn.elements[e]),y=()=>this.getContext(r,i,t),v=c.resolveNamedOptions(h,p,y,d);return v.$shared&&(v.$shared=l,s[a]=Object.freeze(nN(v,l))),v}_resolveAnimations(e,t,r){const i=this.chart,s=this._cachedDataOpts,a=`animation-${t}`,o=s[a];if(o)return o;let l;if(i.options.animation!==!1){const u=this.chart.config,d=u.datasetAnimationScopeKeys(this._type,t),h=u.getOptionScopes(this.getDataset(),d);l=u.createResolver(h,this.getContext(e,r,t))}const c=new N4(i,l&&l.animations);return l&&l._cacheable&&(s[a]=Object.freeze(c)),c}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||Yb(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const r=this.resolveDataElementOptions(e,t),i=this._sharedOptions,s=this.getSharedOptions(r),a=this.includeOptions(t,s)||s!==i;return this.updateSharedOptions(s,t,r),{sharedOptions:s,includeOptions:a}}updateElement(e,t,r,i){Yb(i)?Object.assign(e,r):this._resolveAnimations(t,i).update(e,r)}updateSharedOptions(e,t,r){e&&!Yb(t)&&this._resolveAnimations(void 0,t).update(e,r)}_setStyle(e,t,r,i){e.active=i;const s=this.getStyle(t,i);this._resolveAnimations(t,r,i).update(e,{options:!i&&this.getSharedOptions(s)||s})}removeHoverStyle(e,t,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,t,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,r=this._cachedMeta.data;for(const[o,l,c]of this._syncList)this[o](l,c);this._syncList=[];const i=r.length,s=t.length,a=Math.min(s,i);a&&this.parse(0,a),s>i?this._insertElements(i,s-i,e):s<i&&this._removeElements(s,i-s)}_insertElements(e,t,r=!0){const i=this._cachedMeta,s=i.data,a=e+t;let o;const l=c=>{for(c.length+=t,o=c.length-1;o>=a;o--)c[o]=c[o-t]};for(l(s),o=e;o<a;++o)s[o]=new this.dataElementType;this._parsing&&l(i._parsed),this.parse(e,t),r&&this.updateElements(s,e,t,"reset")}updateElements(e,t,r,i){}_removeElements(e,t){const r=this._cachedMeta;if(this._parsing){const i=r._parsed.splice(e,t);r._stacked&&Mh(r,i)}r.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,r,i]=e;this[t](r,i)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Re(jo,"defaults",{}),Re(jo,"datasetElementType",null),Re(jo,"dataElementType",null);function nhe(n,e){if(!n._cache.$bar){const t=n.getMatchingVisibleMetas(e);let r=[];for(let i=0,s=t.length;i<s;i++)r=r.concat(t[i].controller.getAllParsedValues(n));n._cache.$bar=f4(r.sort((i,s)=>i-s))}return n._cache.$bar}function rhe(n){const e=n.iScale,t=nhe(e,n.type);let r=e._length,i,s,a,o;const l=()=>{a===32767||a===-32768||(_p(o)&&(r=Math.min(r,Math.abs(a-o)||r)),o=a)};for(i=0,s=t.length;i<s;++i)a=e.getPixelForValue(t[i]),l();for(o=void 0,i=0,s=e.ticks.length;i<s;++i)a=e.getPixelForTick(i),l();return r}function ihe(n,e,t,r){const i=t.barThickness;let s,a;return At(i)?(s=e.min*t.categoryPercentage,a=t.barPercentage):(s=i*r,a=1),{chunk:s/r,ratio:a,start:e.pixels[n]-s/2}}function she(n,e,t,r){const i=e.pixels,s=i[n];let a=n>0?i[n-1]:null,o=n<i.length-1?i[n+1]:null;const l=t.categoryPercentage;a===null&&(a=s-(o===null?e.end-e.start:o-s)),o===null&&(o=s+s-a);const c=s-(s-Math.min(a,o))/2*l;return{chunk:Math.abs(o-a)/2*l/r,ratio:t.barPercentage,start:c}}function ahe(n,e,t,r){const i=t.parse(n[0],r),s=t.parse(n[1],r),a=Math.min(i,s),o=Math.max(i,s);let l=a,c=o;Math.abs(a)>Math.abs(o)&&(l=o,c=a),e[t.axis]=c,e._custom={barStart:l,barEnd:c,start:i,end:s,min:a,max:o}}function L4(n,e,t,r){return yn(n)?ahe(n,e,t,r):e[t.axis]=t.parse(n,r),e}function rN(n,e,t,r){const i=n.iScale,s=n.vScale,a=i.getLabels(),o=i===s,l=[];let c,u,d,h;for(c=t,u=t+r;c<u;++c)h=e[c],d={},d[i.axis]=o||i.parse(a[c],c),l.push(L4(h,d,s,c));return l}function Kb(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function ohe(n,e,t){return n!==0?Ns(n):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function lhe(n){let e,t,r,i,s;return n.horizontal?(e=n.base>n.x,t="left",r="right"):(e=n.base<n.y,t="bottom",r="top"),e?(i="end",s="start"):(i="start",s="end"),{start:t,end:r,reverse:e,top:i,bottom:s}}function che(n,e,t,r){let i=e.borderSkipped;const s={};if(!i){n.borderSkipped=s;return}if(i===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:a,end:o,reverse:l,top:c,bottom:u}=lhe(n);i==="middle"&&t&&(n.enableBorderRadius=!0,(t._top||0)===r?i=c:(t._bottom||0)===r?i=u:(s[iN(u,a,o,l)]=!0,i=c)),s[iN(i,a,o,l)]=!0,n.borderSkipped=s}function iN(n,e,t,r){return r?(n=uhe(n,e,t),n=sN(n,t,e)):n=sN(n,e,t),n}function uhe(n,e,t){return n===e?t:n===t?e:n}function sN(n,e,t){return n==="start"?e:n==="end"?t:n}function dhe(n,{inflateAmount:e},t){n.inflateAmount=e==="auto"?t===1?.33:0:e}class gy extends jo{parsePrimitiveData(e,t,r,i){return rN(e,t,r,i)}parseArrayData(e,t,r,i){return rN(e,t,r,i)}parseObjectData(e,t,r,i){const{iScale:s,vScale:a}=e,{xAxisKey:o="x",yAxisKey:l="y"}=this._parsing,c=s.axis==="x"?o:l,u=a.axis==="x"?o:l,d=[];let h,p,y,v;for(h=r,p=r+i;h<p;++h)v=t[h],y={},y[s.axis]=s.parse(mc(v,c),h),d.push(L4(mc(v,u),y,a,h));return d}updateRangeFromParsed(e,t,r,i){super.updateRangeFromParsed(e,t,r,i);const s=r._custom;s&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,s.min),e.max=Math.max(e.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:r,vScale:i}=t,s=this.getParsed(e),a=s._custom,o=Kb(a)?"["+a.start+", "+a.end+"]":""+i.getLabelForValue(s[i.axis]);return{label:""+r.getLabelForValue(s[r.axis]),value:o}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,r,i){const s=i==="reset",{index:a,_cachedMeta:{vScale:o}}=this,l=o.getBasePixel(),c=o.isHorizontal(),u=this._getRuler(),{sharedOptions:d,includeOptions:h}=this._getSharedOptions(t,i);for(let p=t;p<t+r;p++){const y=this.getParsed(p),v=s||At(y[o.axis])?{base:l,head:l}:this._calculateBarValuePixels(p),g=this._calculateBarIndexPixels(p,u),m=(y._stacks||{})[o.axis],x={horizontal:c,base:v.base,enableBorderRadius:!m||Kb(y._custom)||a===m._top||a===m._bottom,x:c?v.head:g.center,y:c?g.center:v.head,height:c?g.size:Math.abs(v.size),width:c?Math.abs(v.size):g.size};h&&(x.options=d||this.resolveDataElementOptions(p,e[p].active?"active":i));const _=x.options||e[p].options;che(x,_,m,a),dhe(x,_,u.ratio),this.updateElement(e[p],p,x,i)}}_getStacks(e,t){const{iScale:r}=this._cachedMeta,i=r.getMatchingVisibleMetas(this._type).filter(u=>u.controller.options.grouped),s=r.options.stacked,a=[],o=this._cachedMeta.controller.getParsed(t),l=o&&o[r.axis],c=u=>{const d=u._parsed.find(p=>p[r.axis]===l),h=d&&d[u.vScale.axis];if(At(h)||isNaN(h))return!0};for(const u of i)if(!(t!==void 0&&c(u))&&((s===!1||a.indexOf(u.stack)===-1||s===void 0&&u.stack===void 0)&&a.push(u.stack),u.index===e))break;return a.length||a.push(void 0),a}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,t,r){const i=this._getStacks(e,r),s=t!==void 0?i.indexOf(t):-1;return s===-1?i.length-1:s}_getRuler(){const e=this.options,t=this._cachedMeta,r=t.iScale,i=[];let s,a;for(s=0,a=t.data.length;s<a;++s)i.push(r.getPixelForValue(this.getParsed(s)[r.axis],s));const o=e.barThickness;return{min:o||rhe(t),pixels:i,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:o?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:r,index:i},options:{base:s,minBarLength:a}}=this,o=s||0,l=this.getParsed(e),c=l._custom,u=Kb(c);let d=l[t.axis],h=0,p=r?this.applyStack(t,l,r):d,y,v;p!==d&&(h=p-d,p=d),u&&(d=c.barStart,p=c.barEnd-c.barStart,d!==0&&Ns(d)!==Ns(c.barEnd)&&(h=0),h+=d);const g=!At(s)&&!u?s:h;let m=t.getPixelForValue(g);if(this.chart.getDataVisibility(e)?y=t.getPixelForValue(h+p):y=m,v=y-m,Math.abs(v)<a){v=ohe(v,t,o)*a,d===o&&(m-=v/2);const x=t.getPixelForDecimal(0),_=t.getPixelForDecimal(1),b=Math.min(x,_),w=Math.max(x,_);m=Math.max(Math.min(m,w),b),y=m+v,r&&!u&&(l._stacks[t.axis]._visualValues[i]=t.getValueForPixel(y)-t.getValueForPixel(m))}if(m===t.getPixelForValue(o)){const x=Ns(v)*t.getLineWidthForValue(o)/2;m+=x,v-=x}return{size:v,base:m,head:y,center:y+v/2}}_calculateBarIndexPixels(e,t){const r=t.scale,i=this.options,s=i.skipNull,a=pt(i.maxBarThickness,1/0);let o,l;if(t.grouped){const c=s?this._getStackCount(e):t.stackCount,u=i.barThickness==="flex"?she(e,t,i,c):ihe(e,t,i,c),d=this._getStackIndex(this.index,this._cachedMeta.stack,s?e:void 0);o=u.start+u.chunk*d+u.chunk/2,l=Math.min(a,u.chunk*u.ratio)}else o=r.getPixelForValue(this.getParsed(e)[r.axis],e),l=Math.min(a,t.min*t.ratio);return{base:o-l/2,head:o+l/2,center:o,size:l}}draw(){const e=this._cachedMeta,t=e.vScale,r=e.data,i=r.length;let s=0;for(;s<i;++s)this.getParsed(s)[t.axis]!==null&&!r[s].hidden&&r[s].draw(this._ctx)}}Re(gy,"id","bar"),Re(gy,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Re(gy,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function hhe(n,e,t){let r=1,i=1,s=0,a=0;if(e<nn){const o=n,l=o+e,c=Math.cos(o),u=Math.sin(o),d=Math.cos(l),h=Math.sin(l),p=(_,b,w)=>bp(_,o,l,!0)?1:Math.max(b,b*t,w,w*t),y=(_,b,w)=>bp(_,o,l,!0)?-1:Math.min(b,b*t,w,w*t),v=p(0,c,d),g=p(En,u,h),m=y(ln,c,d),x=y(ln+En,u,h);r=(v-m)/2,i=(g-x)/2,s=-(v+m)/2,a=-(g+x)/2}return{ratioX:r,ratioY:i,offsetX:s,offsetY:a}}class Wh extends jo{constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const r=this.getDataset().data,i=this._cachedMeta;if(this._parsing===!1)i._parsed=r;else{let s=l=>+r[l];if(_t(r[e])){const{key:l="value"}=this._parsing;s=c=>+mc(r[c],l)}let a,o;for(a=e,o=e+t;a<o;++a)i._parsed[a]=s(a)}}_getRotation(){return xa(this.options.rotation-90)}_getCircumference(){return xa(this.options.circumference)}_getRotationExtents(){let e=nn,t=-nn;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){const i=this.chart.getDatasetMeta(r).controller,s=i._getRotation(),a=i._getCircumference();e=Math.min(e,s),t=Math.max(t,s+a)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:r}=t,i=this._cachedMeta,s=i.data,a=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,o=Math.max((Math.min(r.width,r.height)-a)/2,0),l=Math.min(Eue(this.options.cutout,o),1),c=this._getRingWeight(this.index),{circumference:u,rotation:d}=this._getRotationExtents(),{ratioX:h,ratioY:p,offsetX:y,offsetY:v}=hhe(d,u,l),g=(r.width-a)/h,m=(r.height-a)/p,x=Math.max(Math.min(g,m)/2,0),_=c4(this.options.radius,x),b=Math.max(_*l,0),w=(_-b)/this._getVisibleDatasetWeightTotal();this.offsetX=y*_,this.offsetY=v*_,i.total=this.calculateTotal(),this.outerRadius=_-w*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-w*c,0),this.updateElements(s,0,s.length,e)}_circumference(e,t){const r=this.options,i=this._cachedMeta,s=this._getCircumference();return t&&r.animation.animateRotate||!this.chart.getDataVisibility(e)||i._parsed[e]===null||i.data[e].hidden?0:this.calculateCircumference(i._parsed[e]*s/nn)}updateElements(e,t,r,i){const s=i==="reset",a=this.chart,o=a.chartArea,c=a.options.animation,u=(o.left+o.right)/2,d=(o.top+o.bottom)/2,h=s&&c.animateScale,p=h?0:this.innerRadius,y=h?0:this.outerRadius,{sharedOptions:v,includeOptions:g}=this._getSharedOptions(t,i);let m=this._getRotation(),x;for(x=0;x<t;++x)m+=this._circumference(x,s);for(x=t;x<t+r;++x){const _=this._circumference(x,s),b=e[x],w={x:u+this.offsetX,y:d+this.offsetY,startAngle:m,endAngle:m+_,circumference:_,outerRadius:y,innerRadius:p};g&&(w.options=v||this.resolveDataElementOptions(x,b.active?"active":i)),m+=_,this.updateElement(b,x,w,i)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let r=0,i;for(i=0;i<t.length;i++){const s=e._parsed[i];s!==null&&!isNaN(s)&&this.chart.getDataVisibility(i)&&!t[i].hidden&&(r+=Math.abs(s))}return r}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?nn*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,r=this.chart,i=r.data.labels||[],s=wM(t._parsed[e],r.options.locale);return{label:i[e]||"",value:s}}getMaxBorderWidth(e){let t=0;const r=this.chart;let i,s,a,o,l;if(!e){for(i=0,s=r.data.datasets.length;i<s;++i)if(r.isDatasetVisible(i)){a=r.getDatasetMeta(i),e=a.data,o=a.controller;break}}if(!e)return 0;for(i=0,s=e.length;i<s;++i)l=o.resolveDataElementOptions(i),l.borderAlign!=="inner"&&(t=Math.max(t,l.borderWidth||0,l.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let r=0,i=e.length;r<i;++r){const s=this.resolveDataElementOptions(r);t=Math.max(t,s.offset||0,s.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let r=0;r<e;++r)this.chart.isDatasetVisible(r)&&(t+=this._getRingWeight(r));return t}_getRingWeight(e){return Math.max(pt(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Re(Wh,"id","doughnut"),Re(Wh,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Re(Wh,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),Re(Wh,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:r,color:i}}=e.legend.options;return t.labels.map((s,a)=>{const l=e.getDatasetMeta(0).controller.getStyle(a);return{text:s,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:i,lineWidth:l.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(a),index:a}})}return[]}},onClick(e,t,r){r.chart.toggleDataVisibility(t.index),r.chart.update()}}}});class yy extends jo{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:r,data:i=[],_dataset:s}=t,a=this.chart._animationsDisabled;let{start:o,count:l}=g4(t,i,a);this._drawStart=o,this._drawCount=l,y4(t)&&(o=0,l=i.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!s._decimated,r.points=i;const c=this.resolveDatasetElementOptions(e);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(r,void 0,{animated:!a,options:c},e),this.updateElements(i,o,l,e)}updateElements(e,t,r,i){const s=i==="reset",{iScale:a,vScale:o,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:u,includeOptions:d}=this._getSharedOptions(t,i),h=a.axis,p=o.axis,{spanGaps:y,segment:v}=this.options,g=vd(y)?y:Number.POSITIVE_INFINITY,m=this.chart._animationsDisabled||s||i==="none",x=t+r,_=e.length;let b=t>0&&this.getParsed(t-1);for(let w=0;w<_;++w){const E=e[w],S=m?E:{};if(w<t||w>=x){S.skip=!0;continue}const M=this.getParsed(w),N=At(M[p]),T=S[h]=a.getPixelForValue(M[h],w),P=S[p]=s||N?o.getBasePixel():o.getPixelForValue(l?this.applyStack(o,M,l):M[p],w);S.skip=isNaN(T)||isNaN(P)||N,S.stop=w>0&&Math.abs(M[h]-b[h])>g,v&&(S.parsed=M,S.raw=c.data[w]),d&&(S.options=u||this.resolveDataElementOptions(w,E.active?"active":i)),m||this.updateElement(E,w,S,i),b=M}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,r=t.options&&t.options.borderWidth||0,i=e.data||[];if(!i.length)return r;const s=i[0].size(this.resolveDataElementOptions(0)),a=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(r,s,a)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}Re(yy,"id","line"),Re(yy,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Re(yy,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class E1 extends Wh{}Re(E1,"id","pie"),Re(E1,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class vy extends jo{getLabelAndValue(e){const t=this._cachedMeta,r=this.chart.data.labels||[],{xScale:i,yScale:s}=t,a=this.getParsed(e),o=i.getLabelForValue(a.x),l=s.getLabelForValue(a.y);return{label:r[e]||"",value:"("+o+", "+l+")"}}update(e){const t=this._cachedMeta,{data:r=[]}=t,i=this.chart._animationsDisabled;let{start:s,count:a}=g4(t,r,i);if(this._drawStart=s,this._drawCount=a,y4(t)&&(s=0,a=r.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:o,_dataset:l}=t;o._chart=this.chart,o._datasetIndex=this.index,o._decimated=!!l._decimated,o.points=r;const c=this.resolveDatasetElementOptions(e);c.segment=this.options.segment,this.updateElement(o,void 0,{animated:!i,options:c},e)}else this.datasetElementType&&(delete t.dataset,this.datasetElementType=!1);this.updateElements(r,s,a,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,t,r,i){const s=i==="reset",{iScale:a,vScale:o,_stacked:l,_dataset:c}=this._cachedMeta,u=this.resolveDataElementOptions(t,i),d=this.getSharedOptions(u),h=this.includeOptions(i,d),p=a.axis,y=o.axis,{spanGaps:v,segment:g}=this.options,m=vd(v)?v:Number.POSITIVE_INFINITY,x=this.chart._animationsDisabled||s||i==="none";let _=t>0&&this.getParsed(t-1);for(let b=t;b<t+r;++b){const w=e[b],E=this.getParsed(b),S=x?w:{},M=At(E[y]),N=S[p]=a.getPixelForValue(E[p],b),T=S[y]=s||M?o.getBasePixel():o.getPixelForValue(l?this.applyStack(o,E,l):E[y],b);S.skip=isNaN(N)||isNaN(T)||M,S.stop=b>0&&Math.abs(E[p]-_[p])>m,g&&(S.parsed=E,S.raw=c.data[b]),h&&(S.options=d||this.resolveDataElementOptions(b,w.active?"active":i)),x||this.updateElement(w,b,S,i),_=E}this.updateSharedOptions(d,i,u)}getMaxOverflow(){const e=this._cachedMeta,t=e.data||[];if(!this.options.showLine){let o=0;for(let l=t.length-1;l>=0;--l)o=Math.max(o,t[l].size(this.resolveDataElementOptions(l))/2);return o>0&&o}const r=e.dataset,i=r.options&&r.options.borderWidth||0;if(!t.length)return i;const s=t[0].size(this.resolveDataElementOptions(0)),a=t[t.length-1].size(this.resolveDataElementOptions(t.length-1));return Math.max(i,s,a)/2}}Re(vy,"id","scatter"),Re(vy,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),Re(vy,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});function gl(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class PM{constructor(e){Re(this,"options");this.options=e||{}}static override(e){Object.assign(PM.prototype,e)}init(){}formats(){return gl()}parse(){return gl()}format(){return gl()}add(){return gl()}diff(){return gl()}startOf(){return gl()}endOf(){return gl()}}var fhe={_date:PM};function phe(n,e,t,r){const{controller:i,data:s,_sorted:a}=n,o=i._cachedMeta.iScale,l=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(o&&e===o.axis&&e!=="r"&&a&&s.length){const c=o._reversePixels?Uue:zl;if(r){if(i._sharedOptions){const u=s[0],d=typeof u.getRange=="function"&&u.getRange(e);if(d){const h=c(s,e,t-d),p=c(s,e,t+d);return{lo:h.lo,hi:p.hi}}}}else{const u=c(s,e,t);if(l){const{vScale:d}=i._cachedMeta,{_parsed:h}=n,p=h.slice(0,u.lo+1).reverse().findIndex(v=>!At(v[d.axis]));u.lo-=Math.max(0,p);const y=h.slice(u.hi).findIndex(v=>!At(v[d.axis]));u.hi+=Math.max(0,y)}return u}}return{lo:0,hi:s.length-1}}function am(n,e,t,r,i){const s=n.getSortedVisibleDatasetMetas(),a=t[e];for(let o=0,l=s.length;o<l;++o){const{index:c,data:u}=s[o],{lo:d,hi:h}=phe(s[o],e,a,i);for(let p=d;p<=h;++p){const y=u[p];y.skip||r(y,c,p)}}}function mhe(n){const e=n.indexOf("x")!==-1,t=n.indexOf("y")!==-1;return function(r,i){const s=e?Math.abs(r.x-i.x):0,a=t?Math.abs(r.y-i.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(a,2))}}function Zb(n,e,t,r,i){const s=[];return!i&&!n.isPointInArea(e)||am(n,t,e,function(o,l,c){!i&&!wp(o,n.chartArea,0)||o.inRange(e.x,e.y,r)&&s.push({element:o,datasetIndex:l,index:c})},!0),s}function ghe(n,e,t,r){let i=[];function s(a,o,l){const{startAngle:c,endAngle:u}=a.getProps(["startAngle","endAngle"],r),{angle:d}=d4(a,{x:e.x,y:e.y});bp(d,c,u)&&i.push({element:a,datasetIndex:o,index:l})}return am(n,t,e,s),i}function yhe(n,e,t,r,i,s){let a=[];const o=mhe(t);let l=Number.POSITIVE_INFINITY;function c(u,d,h){const p=u.inRange(e.x,e.y,i);if(r&&!p)return;const y=u.getCenterPoint(i);if(!(!!s||n.isPointInArea(y))&&!p)return;const g=o(e,y);g<l?(a=[{element:u,datasetIndex:d,index:h}],l=g):g===l&&a.push({element:u,datasetIndex:d,index:h})}return am(n,t,e,c),a}function Jb(n,e,t,r,i,s){return!s&&!n.isPointInArea(e)?[]:t==="r"&&!r?ghe(n,e,t,i):yhe(n,e,t,r,i,s)}function aN(n,e,t,r,i){const s=[],a=t==="x"?"inXRange":"inYRange";let o=!1;return am(n,t,e,(l,c,u)=>{l[a]&&l[a](e[t],i)&&(s.push({element:l,datasetIndex:c,index:u}),o=o||l.inRange(e.x,e.y,i))}),r&&!o?[]:s}var vhe={evaluateInteractionItems:am,modes:{index(n,e,t,r){const i=El(e,n),s=t.axis||"x",a=t.includeInvisible||!1,o=t.intersect?Zb(n,i,s,r,a):Jb(n,i,s,!1,r,a),l=[];return o.length?(n.getSortedVisibleDatasetMetas().forEach(c=>{const u=o[0].index,d=c.data[u];d&&!d.skip&&l.push({element:d,datasetIndex:c.index,index:u})}),l):[]},dataset(n,e,t,r){const i=El(e,n),s=t.axis||"xy",a=t.includeInvisible||!1;let o=t.intersect?Zb(n,i,s,r,a):Jb(n,i,s,!1,r,a);if(o.length>0){const l=o[0].datasetIndex,c=n.getDatasetMeta(l).data;o=[];for(let u=0;u<c.length;++u)o.push({element:c[u],datasetIndex:l,index:u})}return o},point(n,e,t,r){const i=El(e,n),s=t.axis||"xy",a=t.includeInvisible||!1;return Zb(n,i,s,r,a)},nearest(n,e,t,r){const i=El(e,n),s=t.axis||"xy",a=t.includeInvisible||!1;return Jb(n,i,s,t.intersect,r,a)},x(n,e,t,r){const i=El(e,n);return aN(n,i,"x",t.intersect,r)},y(n,e,t,r){const i=El(e,n);return aN(n,i,"y",t.intersect,r)}}};const D4=["left","top","right","bottom"];function kh(n,e){return n.filter(t=>t.pos===e)}function oN(n,e){return n.filter(t=>D4.indexOf(t.pos)===-1&&t.box.axis===e)}function Ah(n,e){return n.sort((t,r)=>{const i=e?r:t,s=e?t:r;return i.weight===s.weight?i.index-s.index:i.weight-s.weight})}function xhe(n){const e=[];let t,r,i,s,a,o;for(t=0,r=(n||[]).length;t<r;++t)i=n[t],{position:s,options:{stack:a,stackWeight:o=1}}=i,e.push({index:t,box:i,pos:s,horizontal:i.isHorizontal(),weight:i.weight,stack:a&&s+a,stackWeight:o});return e}function _he(n){const e={};for(const t of n){const{stack:r,pos:i,stackWeight:s}=t;if(!r||!D4.includes(i))continue;const a=e[r]||(e[r]={count:0,placed:0,weight:0,size:0});a.count++,a.weight+=s}return e}function bhe(n,e){const t=_he(n),{vBoxMaxWidth:r,hBoxMaxHeight:i}=e;let s,a,o;for(s=0,a=n.length;s<a;++s){o=n[s];const{fullSize:l}=o.box,c=t[o.stack],u=c&&o.stackWeight/c.weight;o.horizontal?(o.width=u?u*r:l&&e.availableWidth,o.height=i):(o.width=r,o.height=u?u*i:l&&e.availableHeight)}return t}function whe(n){const e=xhe(n),t=Ah(e.filter(c=>c.box.fullSize),!0),r=Ah(kh(e,"left"),!0),i=Ah(kh(e,"right")),s=Ah(kh(e,"top"),!0),a=Ah(kh(e,"bottom")),o=oN(e,"x"),l=oN(e,"y");return{fullSize:t,leftAndTop:r.concat(s),rightAndBottom:i.concat(l).concat(a).concat(o),chartArea:kh(e,"chartArea"),vertical:r.concat(i).concat(l),horizontal:s.concat(a).concat(o)}}function lN(n,e,t,r){return Math.max(n[t],e[t])+Math.max(n[r],e[r])}function I4(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function She(n,e,t,r){const{pos:i,box:s}=t,a=n.maxPadding;if(!_t(i)){t.size&&(n[i]-=t.size);const d=r[t.stack]||{size:0,count:1};d.size=Math.max(d.size,t.horizontal?s.height:s.width),t.size=d.size/d.count,n[i]+=t.size}s.getPadding&&I4(a,s.getPadding());const o=Math.max(0,e.outerWidth-lN(a,n,"left","right")),l=Math.max(0,e.outerHeight-lN(a,n,"top","bottom")),c=o!==n.w,u=l!==n.h;return n.w=o,n.h=l,t.horizontal?{same:c,other:u}:{same:u,other:c}}function Ehe(n){const e=n.maxPadding;function t(r){const i=Math.max(e[r]-n[r],0);return n[r]+=i,i}n.y+=t("top"),n.x+=t("left"),t("right"),t("bottom")}function The(n,e){const t=e.maxPadding;function r(i){const s={left:0,top:0,right:0,bottom:0};return i.forEach(a=>{s[a]=Math.max(e[a],t[a])}),s}return r(n?["left","right"]:["top","bottom"])}function Gh(n,e,t,r){const i=[];let s,a,o,l,c,u;for(s=0,a=n.length,c=0;s<a;++s){o=n[s],l=o.box,l.update(o.width||e.w,o.height||e.h,The(o.horizontal,e));const{same:d,other:h}=She(e,t,o,r);c|=d&&i.length,u=u||h,l.fullSize||i.push(o)}return c&&Gh(i,e,t,r)||u}function zg(n,e,t,r,i){n.top=t,n.left=e,n.right=e+r,n.bottom=t+i,n.width=r,n.height=i}function cN(n,e,t,r){const i=t.padding;let{x:s,y:a}=e;for(const o of n){const l=o.box,c=r[o.stack]||{count:1,placed:0,weight:1},u=o.stackWeight/c.weight||1;if(o.horizontal){const d=e.w*u,h=c.size||l.height;_p(c.start)&&(a=c.start),l.fullSize?zg(l,i.left,a,t.outerWidth-i.right-i.left,h):zg(l,e.left+c.placed,a,d,h),c.start=a,c.placed+=d,a=l.bottom}else{const d=e.h*u,h=c.size||l.width;_p(c.start)&&(s=c.start),l.fullSize?zg(l,s,i.top,h,t.outerHeight-i.bottom-i.top):zg(l,s,e.top+c.placed,h,d),c.start=s,c.placed+=d,s=l.right}}e.x=s,e.y=a}var Mi={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},n.boxes.push(e)},removeBox(n,e){const t=n.boxes?n.boxes.indexOf(e):-1;t!==-1&&n.boxes.splice(t,1)},configure(n,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(n,e,t,r){if(!n)return;const i=Ri(n.options.layout.padding),s=Math.max(e-i.width,0),a=Math.max(t-i.height,0),o=whe(n.boxes),l=o.vertical,c=o.horizontal;Lt(n.boxes,v=>{typeof v.beforeLayout=="function"&&v.beforeLayout()});const u=l.reduce((v,g)=>g.box.options&&g.box.options.display===!1?v:v+1,0)||1,d=Object.freeze({outerWidth:e,outerHeight:t,padding:i,availableWidth:s,availableHeight:a,vBoxMaxWidth:s/2/u,hBoxMaxHeight:a/2}),h=Object.assign({},i);I4(h,Ri(r));const p=Object.assign({maxPadding:h,w:s,h:a,x:i.left,y:i.top},i),y=bhe(l.concat(c),d);Gh(o.fullSize,p,d,y),Gh(l,p,d,y),Gh(c,p,d,y)&&Gh(l,p,d,y),Ehe(p),cN(o.leftAndTop,p,d,y),p.x+=p.w,p.y+=p.h,cN(o.rightAndBottom,p,d,y),n.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},Lt(o.chartArea,v=>{const g=v.box;Object.assign(g,n.chartArea),g.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})})}};class j4{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,r){}removeEventListener(e,t,r){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,r,i){return t=Math.max(0,t||e.width),r=r||e.height,{width:t,height:Math.max(0,i?Math.floor(t/i):r)}}isAttached(e){return!0}updateConfig(e){}}class Mhe extends j4{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const xy="$chartjs",khe={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},uN=n=>n===null||n==="";function Ahe(n,e){const t=n.style,r=n.getAttribute("height"),i=n.getAttribute("width");if(n[xy]={initial:{height:r,width:i,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",uN(i)){const s=q2(n,"width");s!==void 0&&(n.width=s)}if(uN(r))if(n.style.height==="")n.height=n.width/(e||2);else{const s=q2(n,"height");s!==void 0&&(n.height=s)}return n}const F4=Rde?{passive:!0}:!1;function Phe(n,e,t){n&&n.addEventListener(e,t,F4)}function Che(n,e,t){n&&n.canvas&&n.canvas.removeEventListener(e,t,F4)}function Rhe(n,e){const t=khe[n.type]||n.type,{x:r,y:i}=El(n,e);return{type:t,chart:e,native:n,x:r!==void 0?r:null,y:i!==void 0?i:null}}function W0(n,e){for(const t of n)if(t===e||t.contains(e))return!0}function Nhe(n,e,t){const r=n.canvas,i=new MutationObserver(s=>{let a=!1;for(const o of s)a=a||W0(o.addedNodes,r),a=a&&!W0(o.removedNodes,r);a&&t()});return i.observe(document,{childList:!0,subtree:!0}),i}function Ohe(n,e,t){const r=n.canvas,i=new MutationObserver(s=>{let a=!1;for(const o of s)a=a||W0(o.removedNodes,r),a=a&&!W0(o.addedNodes,r);a&&t()});return i.observe(document,{childList:!0,subtree:!0}),i}const Ep=new Map;let dN=0;function U4(){const n=window.devicePixelRatio;n!==dN&&(dN=n,Ep.forEach((e,t)=>{t.currentDevicePixelRatio!==n&&e()}))}function Lhe(n,e){Ep.size||window.addEventListener("resize",U4),Ep.set(n,e)}function Dhe(n){Ep.delete(n),Ep.size||window.removeEventListener("resize",U4)}function Ihe(n,e,t){const r=n.canvas,i=r&&AM(r);if(!i)return;const s=m4((o,l)=>{const c=i.clientWidth;t(o,l),c<i.clientWidth&&t()},window),a=new ResizeObserver(o=>{const l=o[0],c=l.contentRect.width,u=l.contentRect.height;c===0&&u===0||s(c,u)});return a.observe(i),Lhe(n,s),a}function Qb(n,e,t){t&&t.disconnect(),e==="resize"&&Dhe(n)}function jhe(n,e,t){const r=n.canvas,i=m4(s=>{n.ctx!==null&&t(Rhe(s,n))},n);return Phe(r,e,i),i}class Fhe extends j4{acquireContext(e,t){const r=e&&e.getContext&&e.getContext("2d");return r&&r.canvas===e?(Ahe(e,t),r):null}releaseContext(e){const t=e.canvas;if(!t[xy])return!1;const r=t[xy].initial;["height","width"].forEach(s=>{const a=r[s];At(a)?t.removeAttribute(s):t.setAttribute(s,a)});const i=r.style||{};return Object.keys(i).forEach(s=>{t.style[s]=i[s]}),t.width=t.width,delete t[xy],!0}addEventListener(e,t,r){this.removeEventListener(e,t);const i=e.$proxies||(e.$proxies={}),a={attach:Nhe,detach:Ohe,resize:Ihe}[t]||jhe;i[t]=a(e,t,r)}removeEventListener(e,t){const r=e.$proxies||(e.$proxies={}),i=r[t];if(!i)return;({attach:Qb,detach:Qb,resize:Qb}[t]||Che)(e,t,i),r[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,r,i){return Cde(e,t,r,i)}isAttached(e){const t=e&&AM(e);return!!(t&&t.isConnected)}}function Uhe(n){return!kM()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?Mhe:Fhe}var Jg;let Fa=(Jg=class{constructor(){Re(this,"x");Re(this,"y");Re(this,"active",!1);Re(this,"options");Re(this,"$animations")}tooltipPosition(e){const{x:t,y:r}=this.getProps(["x","y"],e);return{x:t,y:r}}hasValue(){return vd(this.x)&&vd(this.y)}getProps(e,t){const r=this.$animations;if(!t||!r)return this;const i={};return e.forEach(s=>{i[s]=r[s]&&r[s].active()?r[s]._to:this[s]}),i}},Re(Jg,"defaults",{}),Re(Jg,"defaultRoutes"),Jg);function Bhe(n,e){const t=n.options.ticks,r=zhe(n),i=Math.min(t.maxTicksLimit||r,r),s=t.major.enabled?Vhe(e):[],a=s.length,o=s[0],l=s[a-1],c=[];if(a>i)return Hhe(e,c,s,a/i),c;const u=$he(s,e,i);if(a>0){let d,h;const p=a>1?Math.round((l-o)/(a-1)):null;for($g(e,c,u,At(p)?0:o-p,o),d=0,h=a-1;d<h;d++)$g(e,c,u,s[d],s[d+1]);return $g(e,c,u,l,At(p)?e.length:l+p),c}return $g(e,c,u),c}function zhe(n){const e=n.options.offset,t=n._tickSize(),r=n._length/t+(e?0:1),i=n._maxLength/t;return Math.floor(Math.min(r,i))}function $he(n,e,t){const r=Whe(n),i=e.length/t;if(!r)return Math.max(i,1);const s=Nue(r);for(let a=0,o=s.length-1;a<o;a++){const l=s[a];if(l>i)return l}return Math.max(i,1)}function Vhe(n){const e=[];let t,r;for(t=0,r=n.length;t<r;t++)n[t].major&&e.push(t);return e}function Hhe(n,e,t,r){let i=0,s=t[0],a;for(r=Math.ceil(r),a=0;a<n.length;a++)a===s&&(e.push(n[a]),i++,s=t[i*r])}function $g(n,e,t,r,i){const s=pt(r,0),a=Math.min(pt(i,n.length),n.length);let o=0,l,c,u;for(t=Math.ceil(t),i&&(l=i-r,t=l/Math.floor(l/t)),u=s;u<0;)o++,u=Math.round(s+o*t);for(c=Math.max(s,0);c<a;c++)c===u&&(e.push(n[c]),o++,u=Math.round(s+o*t))}function Whe(n){const e=n.length;let t,r;if(e<2)return!1;for(r=n[0],t=1;t<e;++t)if(n[t]-n[t-1]!==r)return!1;return r}const Ghe=n=>n==="left"?"right":n==="right"?"left":n,hN=(n,e,t)=>e==="top"||e==="left"?n[e]+t:n[e]-t,fN=(n,e)=>Math.min(e||n,n);function pN(n,e){const t=[],r=n.length/e,i=n.length;let s=0;for(;s<i;s+=r)t.push(n[Math.floor(s)]);return t}function qhe(n,e,t){const r=n.ticks.length,i=Math.min(e,r-1),s=n._startPixel,a=n._endPixel,o=1e-6;let l=n.getPixelForTick(i),c;if(!(t&&(r===1?c=Math.max(l-s,a-l):e===0?c=(n.getPixelForTick(1)-l)/2:c=(l-n.getPixelForTick(i-1))/2,l+=i<e?c:-c,l<s-o||l>a+o)))return l}function Xhe(n,e){Lt(n,t=>{const r=t.gc,i=r.length/2;let s;if(i>e){for(s=0;s<i;++s)delete t.data[r[s]];r.splice(0,i)}})}function Ph(n){return n.drawTicks?n.tickLength:0}function mN(n,e){if(!n.display)return 0;const t=rr(n.font,e),r=Ri(n.padding);return(yn(n.text)?n.text.length:1)*t.lineHeight+r.height}function Yhe(n,e){return kc(n,{scale:e,type:"scale"})}function Khe(n,e,t){return kc(n,{tick:t,index:e,type:"tick"})}function Zhe(n,e,t){let r=_M(n);return(t&&e!=="right"||!t&&e==="right")&&(r=Ghe(r)),r}function Jhe(n,e,t,r){const{top:i,left:s,bottom:a,right:o,chart:l}=n,{chartArea:c,scales:u}=l;let d=0,h,p,y;const v=a-i,g=o-s;if(n.isHorizontal()){if(p=Zn(r,s,o),_t(t)){const m=Object.keys(t)[0],x=t[m];y=u[m].getPixelForValue(x)+v-e}else t==="center"?y=(c.bottom+c.top)/2+v-e:y=hN(n,t,e);h=o-s}else{if(_t(t)){const m=Object.keys(t)[0],x=t[m];p=u[m].getPixelForValue(x)-g+e}else t==="center"?p=(c.left+c.right)/2-g+e:p=hN(n,t,e);y=Zn(r,a,i),d=t==="left"?-En:En}return{titleX:p,titleY:y,maxWidth:h,rotation:d}}class Ud extends Fa{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:r,_suggestedMax:i}=this;return e=ps(e,Number.POSITIVE_INFINITY),t=ps(t,Number.NEGATIVE_INFINITY),r=ps(r,Number.POSITIVE_INFINITY),i=ps(i,Number.NEGATIVE_INFINITY),{min:ps(e,r),max:ps(t,i),minDefined:lr(e),maxDefined:lr(t)}}getMinMax(e){let{min:t,max:r,minDefined:i,maxDefined:s}=this.getUserBounds(),a;if(i&&s)return{min:t,max:r};const o=this.getMatchingVisibleMetas();for(let l=0,c=o.length;l<c;++l)a=o[l].controller.getMinMax(this,e),i||(t=Math.min(t,a.min)),s||(r=Math.max(r,a.max));return t=s&&t>r?r:t,r=i&&t>r?t:r,{min:ps(t,ps(r,t)),max:ps(r,ps(t,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){qt(this.options.beforeUpdate,[this])}update(e,t,r){const{beginAtZero:i,grace:s,ticks:a}=this.options,o=a.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=lde(this,s,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=o<this.ticks.length;this._convertTicksToLabels(l?pN(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),a.display&&(a.autoSkip||a.source==="auto")&&(this.ticks=Bhe(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,r;this.isHorizontal()?(t=this.left,r=this.right):(t=this.top,r=this.bottom,e=!e),this._startPixel=t,this._endPixel=r,this._reversePixels=e,this._length=r-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){qt(this.options.afterUpdate,[this])}beforeSetDimensions(){qt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){qt(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),qt(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){qt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let r,i,s;for(r=0,i=e.length;r<i;r++)s=e[r],s.label=qt(t.callback,[s.value,r,e],this)}afterTickToLabelConversion(){qt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){qt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,r=fN(this.ticks.length,e.ticks.maxTicksLimit),i=t.minRotation||0,s=t.maxRotation;let a=i,o,l,c;if(!this._isVisible()||!t.display||i>=s||r<=1||!this.isHorizontal()){this.labelRotation=i;return}const u=this._getLabelSizes(),d=u.widest.width,h=u.highest.height,p=nr(this.chart.width-d,0,this.maxWidth);o=e.offset?this.maxWidth/r:p/(r-1),d+6>o&&(o=p/(r-(e.offset?.5:1)),l=this.maxHeight-Ph(e.grid)-t.padding-mN(e.title,this.chart.options.font),c=Math.sqrt(d*d+h*h),a=Iue(Math.min(Math.asin(nr((u.highest.height+6)/o,-1,1)),Math.asin(nr(l/c,-1,1))-Math.asin(nr(h/c,-1,1)))),a=Math.max(i,Math.min(s,a))),this.labelRotation=a}afterCalculateLabelRotation(){qt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){qt(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:r,title:i,grid:s}}=this,a=this._isVisible(),o=this.isHorizontal();if(a){const l=mN(i,t.options.font);if(o?(e.width=this.maxWidth,e.height=Ph(s)+l):(e.height=this.maxHeight,e.width=Ph(s)+l),r.display&&this.ticks.length){const{first:c,last:u,widest:d,highest:h}=this._getLabelSizes(),p=r.padding*2,y=xa(this.labelRotation),v=Math.cos(y),g=Math.sin(y);if(o){const m=r.mirror?0:g*d.width+v*h.height;e.height=Math.min(this.maxHeight,e.height+m+p)}else{const m=r.mirror?0:v*d.width+g*h.height;e.width=Math.min(this.maxWidth,e.width+m+p)}this._calculatePadding(c,u,g,v)}}this._handleMargins(),o?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,r,i){const{ticks:{align:s,padding:a},position:o}=this.options,l=this.labelRotation!==0,c=o!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1);let h=0,p=0;l?c?(h=i*e.width,p=r*t.height):(h=r*e.height,p=i*t.width):s==="start"?p=t.width:s==="end"?h=e.width:s!=="inner"&&(h=e.width/2,p=t.width/2),this.paddingLeft=Math.max((h-u+a)*this.width/(this.width-u),0),this.paddingRight=Math.max((p-d+a)*this.width/(this.width-d),0)}else{let u=t.height/2,d=e.height/2;s==="start"?(u=0,d=e.height):s==="end"&&(u=t.height,d=0),this.paddingTop=u+a,this.paddingBottom=d+a}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){qt(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,r;for(t=0,r=e.length;t<r;t++)At(e[t].label)&&(e.splice(t,1),r--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let r=this.ticks;t<r.length&&(r=pN(r,t)),this._labelSizes=e=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,r){const{ctx:i,_longestTextCache:s}=this,a=[],o=[],l=Math.floor(t/fN(t,r));let c=0,u=0,d,h,p,y,v,g,m,x,_,b,w;for(d=0;d<t;d+=l){if(y=e[d].label,v=this._resolveTickFontOptions(d),i.font=g=v.string,m=s[g]=s[g]||{data:{},gc:[]},x=v.lineHeight,_=b=0,!At(y)&&!yn(y))_=$2(i,m.data,m.gc,_,y),b=x;else if(yn(y))for(h=0,p=y.length;h<p;++h)w=y[h],!At(w)&&!yn(w)&&(_=$2(i,m.data,m.gc,_,w),b+=x);a.push(_),o.push(b),c=Math.max(_,c),u=Math.max(b,u)}Xhe(s,t);const E=a.indexOf(c),S=o.indexOf(u),M=N=>({width:a[N]||0,height:o[N]||0});return{first:M(0),last:M(t-1),widest:M(E),highest:M(S),widths:a,heights:o}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return Fue(this._alignToPixels?ml(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const r=t[e];return r.$context||(r.$context=Khe(this.getContext(),e,r))}return this.$context||(this.$context=Yhe(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=xa(this.labelRotation),r=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t)),s=this._getLabelSizes(),a=e.autoSkipPadding||0,o=s?s.widest.width+a:0,l=s?s.highest.height+a:0;return this.isHorizontal()?l*r>o*i?o/r:l/i:l*i<o*r?l/r:o/i}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,r=this.chart,i=this.options,{grid:s,position:a,border:o}=i,l=s.offset,c=this.isHorizontal(),d=this.ticks.length+(l?1:0),h=Ph(s),p=[],y=o.setContext(this.getContext()),v=y.display?y.width:0,g=v/2,m=function(F){return ml(r,F,v)};let x,_,b,w,E,S,M,N,T,P,H,W;if(a==="top")x=m(this.bottom),S=this.bottom-h,N=x-g,P=m(e.top)+g,W=e.bottom;else if(a==="bottom")x=m(this.top),P=e.top,W=m(e.bottom)-g,S=x+g,N=this.top+h;else if(a==="left")x=m(this.right),E=this.right-h,M=x-g,T=m(e.left)+g,H=e.right;else if(a==="right")x=m(this.left),T=e.left,H=m(e.right)-g,E=x+g,M=this.left+h;else if(t==="x"){if(a==="center")x=m((e.top+e.bottom)/2+.5);else if(_t(a)){const F=Object.keys(a)[0],j=a[F];x=m(this.chart.scales[F].getPixelForValue(j))}P=e.top,W=e.bottom,S=x+g,N=S+h}else if(t==="y"){if(a==="center")x=m((e.left+e.right)/2);else if(_t(a)){const F=Object.keys(a)[0],j=a[F];x=m(this.chart.scales[F].getPixelForValue(j))}E=x-g,M=E-h,T=e.left,H=e.right}const O=pt(i.ticks.maxTicksLimit,d),I=Math.max(1,Math.ceil(d/O));for(_=0;_<d;_+=I){const F=this.getContext(_),j=s.setContext(F),L=o.setContext(F),D=j.lineWidth,z=j.color,K=L.dash||[],re=L.dashOffset,Se=j.tickWidth,G=j.tickColor,ne=j.tickBorderDash||[],ye=j.tickBorderDashOffset;b=qhe(this,_,l),b!==void 0&&(w=ml(r,b,D),c?E=M=T=H=w:S=N=P=W=w,p.push({tx1:E,ty1:S,tx2:M,ty2:N,x1:T,y1:P,x2:H,y2:W,width:D,color:z,borderDash:K,borderDashOffset:re,tickWidth:Se,tickColor:G,tickBorderDash:ne,tickBorderDashOffset:ye}))}return this._ticksLength=d,this._borderValue=x,p}_computeLabelItems(e){const t=this.axis,r=this.options,{position:i,ticks:s}=r,a=this.isHorizontal(),o=this.ticks,{align:l,crossAlign:c,padding:u,mirror:d}=s,h=Ph(r.grid),p=h+u,y=d?-u:p,v=-xa(this.labelRotation),g=[];let m,x,_,b,w,E,S,M,N,T,P,H,W="middle";if(i==="top")E=this.bottom-y,S=this._getXAxisLabelAlignment();else if(i==="bottom")E=this.top+y,S=this._getXAxisLabelAlignment();else if(i==="left"){const I=this._getYAxisLabelAlignment(h);S=I.textAlign,w=I.x}else if(i==="right"){const I=this._getYAxisLabelAlignment(h);S=I.textAlign,w=I.x}else if(t==="x"){if(i==="center")E=(e.top+e.bottom)/2+p;else if(_t(i)){const I=Object.keys(i)[0],F=i[I];E=this.chart.scales[I].getPixelForValue(F)+p}S=this._getXAxisLabelAlignment()}else if(t==="y"){if(i==="center")w=(e.left+e.right)/2-p;else if(_t(i)){const I=Object.keys(i)[0],F=i[I];w=this.chart.scales[I].getPixelForValue(F)}S=this._getYAxisLabelAlignment(h).textAlign}t==="y"&&(l==="start"?W="top":l==="end"&&(W="bottom"));const O=this._getLabelSizes();for(m=0,x=o.length;m<x;++m){_=o[m],b=_.label;const I=s.setContext(this.getContext(m));M=this.getPixelForTick(m)+s.labelOffset,N=this._resolveTickFontOptions(m),T=N.lineHeight,P=yn(b)?b.length:1;const F=P/2,j=I.color,L=I.textStrokeColor,D=I.textStrokeWidth;let z=S;a?(w=M,S==="inner"&&(m===x-1?z=this.options.reverse?"left":"right":m===0?z=this.options.reverse?"right":"left":z="center"),i==="top"?c==="near"||v!==0?H=-P*T+T/2:c==="center"?H=-O.highest.height/2-F*T+T:H=-O.highest.height+T/2:c==="near"||v!==0?H=T/2:c==="center"?H=O.highest.height/2-F*T:H=O.highest.height-P*T,d&&(H*=-1),v!==0&&!I.showLabelBackdrop&&(w+=T/2*Math.sin(v))):(E=M,H=(1-P)*T/2);let K;if(I.showLabelBackdrop){const re=Ri(I.backdropPadding),Se=O.heights[m],G=O.widths[m];let ne=H-re.top,ye=0-re.left;switch(W){case"middle":ne-=Se/2;break;case"bottom":ne-=Se;break}switch(S){case"center":ye-=G/2;break;case"right":ye-=G;break;case"inner":m===x-1?ye-=G:m>0&&(ye-=G/2);break}K={left:ye,top:ne,width:G+re.width,height:Se+re.height,color:I.backdropColor}}g.push({label:b,font:N,textOffset:H,options:{rotation:v,color:j,strokeColor:L,strokeWidth:D,textAlign:z,textBaseline:W,translation:[w,E],backdrop:K}})}return g}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-xa(this.labelRotation))return e==="top"?"left":"right";let i="center";return t.align==="start"?i="left":t.align==="end"?i="right":t.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:r,mirror:i,padding:s}}=this.options,a=this._getLabelSizes(),o=e+s,l=a.widest.width;let c,u;return t==="left"?i?(u=this.right+s,r==="near"?c="left":r==="center"?(c="center",u+=l/2):(c="right",u+=l)):(u=this.right-o,r==="near"?c="right":r==="center"?(c="center",u-=l/2):(c="left",u=this.left)):t==="right"?i?(u=this.left+s,r==="near"?c="right":r==="center"?(c="center",u-=l/2):(c="left",u-=l)):(u=this.left+o,r==="near"?c="left":r==="center"?(c="center",u+=l/2):(c="right",u=this.right)):c="right",{textAlign:c,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:r,top:i,width:s,height:a}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(r,i,s,a),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const i=this.ticks.findIndex(s=>s.value===e);return i>=0?t.setContext(this.getContext(i)).lineWidth:0}drawGrid(e){const t=this.options.grid,r=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let s,a;const o=(l,c,u)=>{!u.width||!u.color||(r.save(),r.lineWidth=u.width,r.strokeStyle=u.color,r.setLineDash(u.borderDash||[]),r.lineDashOffset=u.borderDashOffset,r.beginPath(),r.moveTo(l.x,l.y),r.lineTo(c.x,c.y),r.stroke(),r.restore())};if(t.display)for(s=0,a=i.length;s<a;++s){const l=i[s];t.drawOnChartArea&&o({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),t.drawTicks&&o({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:r,grid:i}}=this,s=r.setContext(this.getContext()),a=r.display?s.width:0;if(!a)return;const o=i.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,u,d,h;this.isHorizontal()?(c=ml(e,this.left,a)-a/2,u=ml(e,this.right,o)+o/2,d=h=l):(d=ml(e,this.top,a)-a/2,h=ml(e,this.bottom,o)+o/2,c=u=l),t.save(),t.lineWidth=s.width,t.strokeStyle=s.color,t.beginPath(),t.moveTo(c,d),t.lineTo(u,h),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const r=this.ctx,i=this._computeLabelArea();i&&yx(r,i);const s=this.getLabelItems(e);for(const a of s){const o=a.options,l=a.font,c=a.label,u=a.textOffset;Sp(r,c,0,u,l,o)}i&&vx(r)}drawTitle(){const{ctx:e,options:{position:t,title:r,reverse:i}}=this;if(!r.display)return;const s=rr(r.font),a=Ri(r.padding),o=r.align;let l=s.lineHeight/2;t==="bottom"||t==="center"||_t(t)?(l+=a.bottom,yn(r.text)&&(l+=s.lineHeight*(r.text.length-1))):l+=a.top;const{titleX:c,titleY:u,maxWidth:d,rotation:h}=Jhe(this,l,t,o);Sp(e,r.text,0,0,s,{color:r.color,maxWidth:d,rotation:h,textAlign:Zhe(o,t,i),textBaseline:"middle",translation:[c,u]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,r=pt(e.grid&&e.grid.z,-1),i=pt(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Ud.prototype.draw?[{z:t,draw:s=>{this.draw(s)}}]:[{z:r,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:t,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",i=[];let s,a;for(s=0,a=t.length;s<a;++s){const o=t[s];o[r]===this.id&&(!e||o.type===e)&&i.push(o)}return i}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return rr(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Vg{constructor(e,t,r){this.type=e,this.scope=t,this.override=r,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let r;tfe(t)&&(r=this.register(t));const i=this.items,s=e.id,a=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+e);return s in i||(i[s]=e,Qhe(e,a,r),this.override&&fn.override(e.id,e.overrides)),a}get(e){return this.items[e]}unregister(e){const t=this.items,r=e.id,i=this.scope;r in t&&delete t[r],i&&r in fn[i]&&(delete fn[i][r],this.override&&delete gc[r])}}function Qhe(n,e,t){const r=xp(Object.create(null),[t?fn.get(t):{},fn.get(e),n.defaults]);fn.set(e,r),n.defaultRoutes&&efe(e,n.defaultRoutes),n.descriptors&&fn.describe(e,n.descriptors)}function efe(n,e){Object.keys(e).forEach(t=>{const r=t.split("."),i=r.pop(),s=[n].concat(r).join("."),a=e[t].split("."),o=a.pop(),l=a.join(".");fn.route(s,i,l,o)})}function tfe(n){return"id"in n&&"defaults"in n}class nfe{constructor(){this.controllers=new Vg(jo,"datasets",!0),this.elements=new Vg(Fa,"elements"),this.plugins=new Vg(Object,"plugins"),this.scales=new Vg(Ud,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,r){[...t].forEach(i=>{const s=r||this._getRegistryForType(i);r||s.isForType(i)||s===this.plugins&&i.id?this._exec(e,s,i):Lt(i,a=>{const o=r||this._getRegistryForType(a);this._exec(e,o,a)})})}_exec(e,t,r){const i=vM(e);qt(r["before"+i],[],r),t[e](r),qt(r["after"+i],[],r)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const r=this._typedRegistries[t];if(r.isForType(e))return r}return this.plugins}_get(e,t,r){const i=t.get(e);if(i===void 0)throw new Error('"'+e+'" is not a registered '+r+".");return i}}var _s=new nfe;class rfe{constructor(){this._init=[]}notify(e,t,r,i){t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const s=i?this._descriptors(e).filter(i):this._descriptors(e),a=this._notify(s,e,t,r);return t==="afterDestroy"&&(this._notify(s,e,"stop"),this._notify(this._init,e,"uninstall")),a}_notify(e,t,r,i){i=i||{};for(const s of e){const a=s.plugin,o=a[r],l=[t,i,s.options];if(qt(o,l,a)===!1&&i.cancelable)return!1}return!0}invalidate(){At(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const r=e&&e.config,i=pt(r.options&&r.options.plugins,{}),s=ife(r);return i===!1&&!t?[]:afe(e,s,i,t)}_notifyStateChanges(e){const t=this._oldCache||[],r=this._cache,i=(s,a)=>s.filter(o=>!a.some(l=>o.plugin.id===l.plugin.id));this._notify(i(t,r),e,"stop"),this._notify(i(r,t),e,"start")}}function ife(n){const e={},t=[],r=Object.keys(_s.plugins.items);for(let s=0;s<r.length;s++)t.push(_s.getPlugin(r[s]));const i=n.plugins||[];for(let s=0;s<i.length;s++){const a=i[s];t.indexOf(a)===-1&&(t.push(a),e[a.id]=!0)}return{plugins:t,localIds:e}}function sfe(n,e){return!e&&n===!1?null:n===!0?{}:n}function afe(n,{plugins:e,localIds:t},r,i){const s=[],a=n.getContext();for(const o of e){const l=o.id,c=sfe(r[l],i);c!==null&&s.push({plugin:o,options:ofe(n.config,{plugin:o,local:t[l]},c,a)})}return s}function ofe(n,{plugin:e,local:t},r,i){const s=n.pluginScopeKeys(e),a=n.getOptionScopes(r,s);return t&&e.defaults&&a.push(e.defaults),n.createResolver(a,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function T1(n,e){const t=fn.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function lfe(n,e){let t=n;return n==="_index_"?t=e:n==="_value_"&&(t=e==="x"?"y":"x"),t}function cfe(n,e){return n===e?"_index_":"_value_"}function gN(n){if(n==="x"||n==="y"||n==="r")return n}function ufe(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function M1(n,...e){if(gN(n))return n;for(const t of e){const r=t.axis||ufe(t.position)||n.length>1&&gN(n[0].toLowerCase());if(r)return r}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function yN(n,e,t){if(t[e+"AxisID"]===n)return{axis:e}}function dfe(n,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(r=>r.xAxisID===n||r.yAxisID===n);if(t.length)return yN(n,"x",t[0])||yN(n,"y",t[0])}return{}}function hfe(n,e){const t=gc[n.type]||{scales:{}},r=e.scales||{},i=T1(n.type,e),s=Object.create(null);return Object.keys(r).forEach(a=>{const o=r[a];if(!_t(o))return console.error(`Invalid scale configuration for scale: ${a}`);if(o._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${a}`);const l=M1(a,o,dfe(a,n),fn.scales[o.type]),c=cfe(l,i),u=t.scales||{};s[a]=bf(Object.create(null),[{axis:l},o,u[l],u[c]])}),n.data.datasets.forEach(a=>{const o=a.type||n.type,l=a.indexAxis||T1(o,e),u=(gc[o]||{}).scales||{};Object.keys(u).forEach(d=>{const h=lfe(d,l),p=a[h+"AxisID"]||h;s[p]=s[p]||Object.create(null),bf(s[p],[{axis:h},r[p],u[d]])})}),Object.keys(s).forEach(a=>{const o=s[a];bf(o,[fn.scales[o.type],fn.scale])}),s}function B4(n){const e=n.options||(n.options={});e.plugins=pt(e.plugins,{}),e.scales=hfe(n,e)}function z4(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function ffe(n){return n=n||{},n.data=z4(n.data),B4(n),n}const vN=new Map,$4=new Set;function Hg(n,e){let t=vN.get(n);return t||(t=e(),vN.set(n,t),$4.add(t)),t}const Ch=(n,e,t)=>{const r=mc(e,t);r!==void 0&&n.add(r)};class pfe{constructor(e){this._config=ffe(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=z4(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),B4(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Hg(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return Hg(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return Hg(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,r=this.type;return Hg(`${r}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const r=this._scopeCache;let i=r.get(e);return(!i||t)&&(i=new Map,r.set(e,i)),i}getOptionScopes(e,t,r){const{options:i,type:s}=this,a=this._cachedScopes(e,r),o=a.get(t);if(o)return o;const l=new Set;t.forEach(u=>{e&&(l.add(e),u.forEach(d=>Ch(l,e,d))),u.forEach(d=>Ch(l,i,d)),u.forEach(d=>Ch(l,gc[s]||{},d)),u.forEach(d=>Ch(l,fn,d)),u.forEach(d=>Ch(l,w1,d))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),$4.has(t)&&a.set(t,c),c}chartOptionScopes(){const{options:e,type:t}=this;return[e,gc[t]||{},fn.datasets[t]||{},{type:t},fn,w1]}resolveNamedOptions(e,t,r,i=[""]){const s={$shared:!0},{resolver:a,subPrefixes:o}=xN(this._resolverCache,e,i);let l=a;if(gfe(a,t)){s.$shared=!1,r=qo(r)?r():r;const c=this.createResolver(e,r,o);l=xd(a,r,c)}for(const c of t)s[c]=l[c];return s}createResolver(e,t,r=[""],i){const{resolver:s}=xN(this._resolverCache,e,r);return _t(t)?xd(s,t,void 0,i):s}}function xN(n,e,t){let r=n.get(e);r||(r=new Map,n.set(e,r));const i=t.join();let s=r.get(i);return s||(s={resolver:EM(e,t),subPrefixes:t.filter(o=>!o.toLowerCase().includes("hover"))},r.set(i,s)),s}const mfe=n=>_t(n)&&Object.getOwnPropertyNames(n).some(e=>qo(n[e]));function gfe(n,e){const{isScriptable:t,isIndexable:r}=w4(n);for(const i of e){const s=t(i),a=r(i),o=(a||s)&&n[i];if(s&&(qo(o)||mfe(o))||a&&yn(o))return!0}return!1}var yfe="4.4.8";const vfe=["top","bottom","left","right","chartArea"];function _N(n,e){return n==="top"||n==="bottom"||vfe.indexOf(n)===-1&&e==="x"}function bN(n,e){return function(t,r){return t[n]===r[n]?t[e]-r[e]:t[n]-r[n]}}function wN(n){const e=n.chart,t=e.options.animation;e.notifyPlugins("afterRender"),qt(t&&t.onComplete,[n],e)}function xfe(n){const e=n.chart,t=e.options.animation;qt(t&&t.onProgress,[n],e)}function V4(n){return kM()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const _y={},SN=n=>{const e=V4(n);return Object.values(_y).filter(t=>t.canvas===e).pop()};function _fe(n,e,t){const r=Object.keys(n);for(const i of r){const s=+i;if(s>=e){const a=n[i];delete n[i],(t>0||s>e)&&(n[s+t]=a)}}}function bfe(n,e,t,r){return!t||n.type==="mouseout"?null:r?e:n}function Wg(n,e,t){return n.options.clip?n[t]:e[t]}function wfe(n,e){const{xScale:t,yScale:r}=n;return t&&r?{left:Wg(t,e,"left"),right:Wg(t,e,"right"),top:Wg(r,e,"top"),bottom:Wg(r,e,"bottom")}:e}var eo;let _x=(eo=class{static register(...e){_s.add(...e),EN()}static unregister(...e){_s.remove(...e),EN()}constructor(e,t){const r=this.config=new pfe(t),i=V4(e),s=SN(i);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const a=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||Uhe(i)),this.platform.updateConfig(r);const o=this.platform.acquireContext(i,a.aspectRatio),l=o&&o.canvas,c=l&&l.height,u=l&&l.width;if(this.id=Sue(),this.ctx=o,this.canvas=l,this.width=u,this.height=c,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new rfe,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=$ue(d=>this.update(d),a.resizeDelay||0),this._dataChanges=[],_y[this.id]=this,!o||!l){console.error("Failed to create chart: can't acquire context from the given item");return}ra.listen(this,"complete",wN),ra.listen(this,"progress",xfe),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:r,height:i,_aspectRatio:s}=this;return At(e)?t&&s?s:i?r/i:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return _s}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():G2(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return V2(this.canvas,this.ctx),this}stop(){return ra.stop(this),this}resize(e,t){ra.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const r=this.options,i=this.canvas,s=r.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(i,e,t,s),o=r.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,G2(this,o,!0)&&(this.notifyPlugins("resize",{size:a}),qt(r.onResize,[this,a],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};Lt(t,(r,i)=>{r.id=i})}buildOrUpdateScales(){const e=this.options,t=e.scales,r=this.scales,i=Object.keys(r).reduce((a,o)=>(a[o]=!1,a),{});let s=[];t&&(s=s.concat(Object.keys(t).map(a=>{const o=t[a],l=M1(a,o),c=l==="r",u=l==="x";return{options:o,dposition:c?"chartArea":u?"bottom":"left",dtype:c?"radialLinear":u?"category":"linear"}}))),Lt(s,a=>{const o=a.options,l=o.id,c=M1(l,o),u=pt(o.type,a.dtype);(o.position===void 0||_N(o.position,c)!==_N(a.dposition))&&(o.position=a.dposition),i[l]=!0;let d=null;if(l in r&&r[l].type===u)d=r[l];else{const h=_s.getScale(u);d=new h({id:l,type:u,ctx:this.ctx,chart:this}),r[d.id]=d}d.init(o,e)}),Lt(i,(a,o)=>{a||delete r[o]}),Lt(r,a=>{Mi.configure(this,a,a.options),Mi.addBox(this,a)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,r=e.length;if(e.sort((i,s)=>i.index-s.index),r>t){for(let i=t;i<r;++i)this._destroyDatasetMeta(i);e.splice(t,r-t)}this._sortedMetasets=e.slice(0).sort(bN("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((r,i)=>{t.filter(s=>s===r._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let r,i;for(this._removeUnreferencedMetasets(),r=0,i=t.length;r<i;r++){const s=t[r];let a=this.getDatasetMeta(r);const o=s.type||this.config.type;if(a.type&&a.type!==o&&(this._destroyDatasetMeta(r),a=this.getDatasetMeta(r)),a.type=o,a.indexAxis=s.indexAxis||T1(o,this.options),a.order=s.order||0,a.index=r,a.label=""+s.label,a.visible=this.isDatasetVisible(r),a.controller)a.controller.updateIndex(r),a.controller.linkScales();else{const l=_s.getController(o),{datasetElementType:c,dataElementType:u}=fn.datasets[o];Object.assign(l,{dataElementType:_s.getElement(u),datasetElementType:c&&_s.getElement(c)}),a.controller=new l(this,r),e.push(a.controller)}}return this._updateMetasets(),e}_resetElements(){Lt(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const r=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let c=0,u=this.data.datasets.length;c<u;c++){const{controller:d}=this.getDatasetMeta(c),h=!i&&s.indexOf(d)===-1;d.buildOrUpdateElements(h),a=Math.max(+d.getMaxOverflow(),a)}a=this._minPadding=r.layout.autoPadding?a:0,this._updateLayout(a),i||Lt(s,c=>{c.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(bN("z","_idx"));const{_active:o,_lastEvent:l}=this;l?this._eventHandler(l,!0):o.length&&this._updateHoverStyles(o,o,!0),this.render()}_updateScales(){Lt(this.scales,e=>{Mi.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),r=new Set(e.events);(!O2(t,r)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:r,start:i,count:s}of t){const a=r==="_removeElements"?-s:s;_fe(e,i,a)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,r=s=>new Set(e.filter(a=>a[0]===s).map((a,o)=>o+","+a.splice(1).join(","))),i=r(0);for(let s=1;s<t;s++)if(!O2(i,r(s)))return;return Array.from(i).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Mi.update(this,this.width,this.height,e);const t=this.chartArea,r=t.width<=0||t.height<=0;this._layers=[],Lt(this.boxes,i=>{r&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,s)=>{i._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,r=this.data.datasets.length;t<r;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,r=this.data.datasets.length;t<r;++t)this._updateDataset(t,qo(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const r=this.getDatasetMeta(e),i={meta:r,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(r.controller._update(t),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(ra.has(this)?this.attached&&!ra.running(this)&&ra.start(this):(this.draw(),wN({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:r,height:i}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(r,i)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,r=[];let i,s;for(i=0,s=t.length;i<s;++i){const a=t[i];(!e||a.visible)&&r.push(a)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,r=e._clip,i=!r.disabled,s=wfe(e,this.chartArea),a={meta:e,index:e.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",a)!==!1&&(i&&yx(t,{left:r.left===!1?0:s.left-r.left,right:r.right===!1?this.width:s.right+r.right,top:r.top===!1?0:s.top-r.top,bottom:r.bottom===!1?this.height:s.bottom+r.bottom}),e.controller.draw(),i&&vx(t),a.cancelable=!1,this.notifyPlugins("afterDatasetDraw",a))}isPointInArea(e){return wp(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,r,i){const s=vhe.modes[t];return typeof s=="function"?s(this,e,r,i):[]}getDatasetMeta(e){const t=this.data.datasets[e],r=this._metasets;let i=r.filter(s=>s&&s._dataset===t).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},r.push(i)),i}getContext(){return this.$context||(this.$context=kc(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const r=this.getDatasetMeta(e);return typeof r.hidden=="boolean"?!r.hidden:!t.hidden}setDatasetVisibility(e,t){const r=this.getDatasetMeta(e);r.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,r){const i=r?"show":"hide",s=this.getDatasetMeta(e),a=s.controller._resolveAnimations(void 0,i);_p(t)?(s.data[t].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),a.update(s,{visible:r}),this.update(o=>o.datasetIndex===e?i:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),ra.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),V2(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete _y[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,r=(s,a)=>{t.addEventListener(this,s,a),e[s]=a},i=(s,a,o)=>{s.offsetX=a,s.offsetY=o,this._eventHandler(s)};Lt(this.options.events,s=>r(s,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,r=(l,c)=>{t.addEventListener(this,l,c),e[l]=c},i=(l,c)=>{e[l]&&(t.removeEventListener(this,l,c),delete e[l])},s=(l,c)=>{this.canvas&&this.resize(l,c)};let a;const o=()=>{i("attach",o),this.attached=!0,this.resize(),r("resize",s),r("detach",a)};a=()=>{this.attached=!1,i("resize",s),this._stop(),this._resize(0,0),r("attach",o)},t.isAttached(this.canvas)?o():a()}unbindEvents(){Lt(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},Lt(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,r){const i=r?"set":"remove";let s,a,o,l;for(t==="dataset"&&(s=this.getDatasetMeta(e[0].datasetIndex),s.controller["_"+i+"DatasetHoverStyle"]()),o=0,l=e.length;o<l;++o){a=e[o];const c=a&&this.getDatasetMeta(a.datasetIndex).controller;c&&c[i+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],r=e.map(({datasetIndex:s,index:a})=>{const o=this.getDatasetMeta(s);if(!o)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:o.data[a],index:a}});!B0(r,t)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,t))}notifyPlugins(e,t,r){return this._plugins.notify(this,e,t,r)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,r){const i=this.options.hover,s=(l,c)=>l.filter(u=>!c.some(d=>u.datasetIndex===d.datasetIndex&&u.index===d.index)),a=s(t,e),o=r?e:s(e,t);a.length&&this.updateHoverStyle(a,i.mode,!1),o.length&&i.mode&&this.updateHoverStyle(o,i.mode,!0)}_eventHandler(e,t){const r={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},i=a=>(a.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",r,i)===!1)return;const s=this._handleEvent(e,t,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,i),(s||r.changed)&&this.render(),this}_handleEvent(e,t,r){const{_active:i=[],options:s}=this,a=t,o=this._getActiveElements(e,i,r,a),l=Pue(e),c=bfe(e,this._lastEvent,r,l);r&&(this._lastEvent=null,qt(s.onHover,[e,o,this],this),l&&qt(s.onClick,[e,o,this],this));const u=!B0(o,i);return(u||t)&&(this._active=o,this._updateHoverStyles(o,i,t)),this._lastEvent=c,u}_getActiveElements(e,t,r,i){if(e.type==="mouseout")return[];if(!r)return t;const s=this.options.hover;return this.getElementsAtEventForMode(e,s.mode,s,i)}},Re(eo,"defaults",fn),Re(eo,"instances",_y),Re(eo,"overrides",gc),Re(eo,"registry",_s),Re(eo,"version",yfe),Re(eo,"getChart",SN),eo);function EN(){return Lt(_x.instances,n=>n._plugins.invalidate())}function Sfe(n,e,t){const{startAngle:r,pixelMargin:i,x:s,y:a,outerRadius:o,innerRadius:l}=e;let c=i/o;n.beginPath(),n.arc(s,a,o,r-c,t+c),l>i?(c=i/l,n.arc(s,a,l,t+c,r-c,!0)):n.arc(s,a,i,t+En,r-En),n.closePath(),n.clip()}function Efe(n){return SM(n,["outerStart","outerEnd","innerStart","innerEnd"])}function Tfe(n,e,t,r){const i=Efe(n.options.borderRadius),s=(t-e)/2,a=Math.min(s,r*e/2),o=l=>{const c=(t-Math.min(s,l))*r/2;return nr(l,0,Math.min(s,c))};return{outerStart:o(i.outerStart),outerEnd:o(i.outerEnd),innerStart:nr(i.innerStart,0,a),innerEnd:nr(i.innerEnd,0,a)}}function iu(n,e,t,r){return{x:t+n*Math.cos(e),y:r+n*Math.sin(e)}}function G0(n,e,t,r,i,s){const{x:a,y:o,startAngle:l,pixelMargin:c,innerRadius:u}=e,d=Math.max(e.outerRadius+r+t-c,0),h=u>0?u+r+t+c:0;let p=0;const y=i-l;if(r){const I=u>0?u-r:0,F=d>0?d-r:0,j=(I+F)/2,L=j!==0?y*j/(j+r):y;p=(y-L)/2}const v=Math.max(.001,y*d-t/ln)/d,g=(y-v)/2,m=l+g+p,x=i-g-p,{outerStart:_,outerEnd:b,innerStart:w,innerEnd:E}=Tfe(e,h,d,x-m),S=d-_,M=d-b,N=m+_/S,T=x-b/M,P=h+w,H=h+E,W=m+w/P,O=x-E/H;if(n.beginPath(),s){const I=(N+T)/2;if(n.arc(a,o,d,N,I),n.arc(a,o,d,I,T),b>0){const D=iu(M,T,a,o);n.arc(D.x,D.y,b,T,x+En)}const F=iu(H,x,a,o);if(n.lineTo(F.x,F.y),E>0){const D=iu(H,O,a,o);n.arc(D.x,D.y,E,x+En,O+Math.PI)}const j=(x-E/h+(m+w/h))/2;if(n.arc(a,o,h,x-E/h,j,!0),n.arc(a,o,h,j,m+w/h,!0),w>0){const D=iu(P,W,a,o);n.arc(D.x,D.y,w,W+Math.PI,m-En)}const L=iu(S,m,a,o);if(n.lineTo(L.x,L.y),_>0){const D=iu(S,N,a,o);n.arc(D.x,D.y,_,m-En,N)}}else{n.moveTo(a,o);const I=Math.cos(N)*d+a,F=Math.sin(N)*d+o;n.lineTo(I,F);const j=Math.cos(T)*d+a,L=Math.sin(T)*d+o;n.lineTo(j,L)}n.closePath()}function Mfe(n,e,t,r,i){const{fullCircles:s,startAngle:a,circumference:o}=e;let l=e.endAngle;if(s){G0(n,e,t,r,l,i);for(let c=0;c<s;++c)n.fill();isNaN(o)||(l=a+(o%nn||nn))}return G0(n,e,t,r,l,i),n.fill(),l}function kfe(n,e,t,r,i){const{fullCircles:s,startAngle:a,circumference:o,options:l}=e,{borderWidth:c,borderJoinStyle:u,borderDash:d,borderDashOffset:h}=l,p=l.borderAlign==="inner";if(!c)return;n.setLineDash(d||[]),n.lineDashOffset=h,p?(n.lineWidth=c*2,n.lineJoin=u||"round"):(n.lineWidth=c,n.lineJoin=u||"bevel");let y=e.endAngle;if(s){G0(n,e,t,r,y,i);for(let v=0;v<s;++v)n.stroke();isNaN(o)||(y=a+(o%nn||nn))}p&&Sfe(n,e,y),s||(G0(n,e,t,r,y,i),n.stroke())}class qh extends Fa{constructor(t){super();Re(this,"circumference");Re(this,"endAngle");Re(this,"fullCircles");Re(this,"innerRadius");Re(this,"outerRadius");Re(this,"pixelMargin");Re(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,r,i){const s=this.getProps(["x","y"],i),{angle:a,distance:o}=d4(s,{x:t,y:r}),{startAngle:l,endAngle:c,innerRadius:u,outerRadius:d,circumference:h}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),p=(this.options.spacing+this.options.borderWidth)/2,y=pt(h,c-l),v=bp(a,l,c)&&l!==c,g=y>=nn||v,m=_a(o,u+p,d+p);return g&&m}getCenterPoint(t){const{x:r,y:i,startAngle:s,endAngle:a,innerRadius:o,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:c,spacing:u}=this.options,d=(s+a)/2,h=(o+l+u+c)/2;return{x:r+Math.cos(d)*h,y:i+Math.sin(d)*h}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:r,circumference:i}=this,s=(r.offset||0)/4,a=(r.spacing||0)/2,o=r.circular;if(this.pixelMargin=r.borderAlign==="inner"?.33:0,this.fullCircles=i>nn?Math.floor(i/nn):0,i===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const l=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(l)*s,Math.sin(l)*s);const c=1-Math.sin(Math.min(ln,i||0)),u=s*c;t.fillStyle=r.backgroundColor,t.strokeStyle=r.borderColor,Mfe(t,this,u,a,o),kfe(t,this,u,a,o),t.restore()}}Re(qh,"id","arc"),Re(qh,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),Re(qh,"defaultRoutes",{backgroundColor:"backgroundColor"}),Re(qh,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"});function H4(n,e,t=e){n.lineCap=pt(t.borderCapStyle,e.borderCapStyle),n.setLineDash(pt(t.borderDash,e.borderDash)),n.lineDashOffset=pt(t.borderDashOffset,e.borderDashOffset),n.lineJoin=pt(t.borderJoinStyle,e.borderJoinStyle),n.lineWidth=pt(t.borderWidth,e.borderWidth),n.strokeStyle=pt(t.borderColor,e.borderColor)}function Afe(n,e,t){n.lineTo(t.x,t.y)}function Pfe(n){return n.stepped?Que:n.tension||n.cubicInterpolationMode==="monotone"?ede:Afe}function W4(n,e,t={}){const r=n.length,{start:i=0,end:s=r-1}=t,{start:a,end:o}=e,l=Math.max(i,a),c=Math.min(s,o),u=i<a&&s<a||i>o&&s>o;return{count:r,start:l,loop:e.loop,ilen:c<l&&!u?r+c-l:c-l}}function Cfe(n,e,t,r){const{points:i,options:s}=e,{count:a,start:o,loop:l,ilen:c}=W4(i,t,r),u=Pfe(s);let{move:d=!0,reverse:h}=r||{},p,y,v;for(p=0;p<=c;++p)y=i[(o+(h?c-p:p))%a],!y.skip&&(d?(n.moveTo(y.x,y.y),d=!1):u(n,v,y,h,s.stepped),v=y);return l&&(y=i[(o+(h?c:0))%a],u(n,v,y,h,s.stepped)),!!l}function Rfe(n,e,t,r){const i=e.points,{count:s,start:a,ilen:o}=W4(i,t,r),{move:l=!0,reverse:c}=r||{};let u=0,d=0,h,p,y,v,g,m;const x=b=>(a+(c?o-b:b))%s,_=()=>{v!==g&&(n.lineTo(u,g),n.lineTo(u,v),n.lineTo(u,m))};for(l&&(p=i[x(0)],n.moveTo(p.x,p.y)),h=0;h<=o;++h){if(p=i[x(h)],p.skip)continue;const b=p.x,w=p.y,E=b|0;E===y?(w<v?v=w:w>g&&(g=w),u=(d*u+b)/++d):(_(),n.lineTo(b,w),y=E,d=0,v=g=w),m=w}_()}function k1(n){const e=n.options,t=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?Rfe:Cfe}function Nfe(n){return n.stepped?Nde:n.tension||n.cubicInterpolationMode==="monotone"?Ode:Tl}function Ofe(n,e,t,r){let i=e._path;i||(i=e._path=new Path2D,e.path(i,t,r)&&i.closePath()),H4(n,e.options),n.stroke(i)}function Lfe(n,e,t,r){const{segments:i,options:s}=e,a=k1(e);for(const o of i)H4(n,s,o.style),n.beginPath(),a(n,e,o,{start:t,end:t+r-1})&&n.closePath(),n.stroke()}const Dfe=typeof Path2D=="function";function Ife(n,e,t,r){Dfe&&!e.options.segment?Ofe(n,e,t,r):Lfe(n,e,t,r)}class wo extends Fa{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const r=this.options;if((r.tension||r.cubicInterpolationMode==="monotone")&&!r.stepped&&!this._pointsUpdated){const i=r.spanGaps?this._loop:this._fullLoop;Ede(this._points,r,e,i,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Ude(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,r=e.length;return r&&t[e[r-1].end]}interpolate(e,t){const r=this.options,i=e[t],s=this.points,a=R4(this,{property:t,start:i,end:i});if(!a.length)return;const o=[],l=Nfe(r);let c,u;for(c=0,u=a.length;c<u;++c){const{start:d,end:h}=a[c],p=s[d],y=s[h];if(p===y){o.push(p);continue}const v=Math.abs((i-p[t])/(y[t]-p[t])),g=l(p,y,v,r.stepped);g[t]=e[t],o.push(g)}return o.length===1?o[0]:o}pathSegment(e,t,r){return k1(this)(e,this,t,r)}path(e,t,r){const i=this.segments,s=k1(this);let a=this._loop;t=t||0,r=r||this.points.length-t;for(const o of i)a&=s(e,this,o,{start:t,end:t+r-1});return!!a}draw(e,t,r,i){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(e.save(),Ife(e,this,r,i),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Re(wo,"id","line"),Re(wo,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Re(wo,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Re(wo,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function TN(n,e,t,r){const i=n.options,{[t]:s}=n.getProps([t],r);return Math.abs(e-s)<i.radius+i.hitRadius}class by extends Fa{constructor(t){super();Re(this,"parsed");Re(this,"skip");Re(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,r,i){const s=this.options,{x:a,y:o}=this.getProps(["x","y"],i);return Math.pow(t-a,2)+Math.pow(r-o,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(t,r){return TN(this,t,"x",r)}inYRange(t,r){return TN(this,t,"y",r)}getCenterPoint(t){const{x:r,y:i}=this.getProps(["x","y"],t);return{x:r,y:i}}size(t){t=t||this.options||{};let r=t.radius||0;r=Math.max(r,r&&t.hoverRadius||0);const i=r&&t.borderWidth||0;return(r+i)*2}draw(t,r){const i=this.options;this.skip||i.radius<.1||!wp(this,r,this.size(i)/2)||(t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.fillStyle=i.backgroundColor,S1(t,i,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}Re(by,"id","point"),Re(by,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Re(by,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function G4(n,e){const{x:t,y:r,base:i,width:s,height:a}=n.getProps(["x","y","base","width","height"],e);let o,l,c,u,d;return n.horizontal?(d=a/2,o=Math.min(t,i),l=Math.max(t,i),c=r-d,u=r+d):(d=s/2,o=t-d,l=t+d,c=Math.min(r,i),u=Math.max(r,i)),{left:o,top:c,right:l,bottom:u}}function So(n,e,t,r){return n?0:nr(e,t,r)}function jfe(n,e,t){const r=n.options.borderWidth,i=n.borderSkipped,s=b4(r);return{t:So(i.top,s.top,0,t),r:So(i.right,s.right,0,e),b:So(i.bottom,s.bottom,0,t),l:So(i.left,s.left,0,e)}}function Ffe(n,e,t){const{enableBorderRadius:r}=n.getProps(["enableBorderRadius"]),i=n.options.borderRadius,s=Yu(i),a=Math.min(e,t),o=n.borderSkipped,l=r||_t(i);return{topLeft:So(!l||o.top||o.left,s.topLeft,0,a),topRight:So(!l||o.top||o.right,s.topRight,0,a),bottomLeft:So(!l||o.bottom||o.left,s.bottomLeft,0,a),bottomRight:So(!l||o.bottom||o.right,s.bottomRight,0,a)}}function Ufe(n){const e=G4(n),t=e.right-e.left,r=e.bottom-e.top,i=jfe(n,t/2,r/2),s=Ffe(n,t/2,r/2);return{outer:{x:e.left,y:e.top,w:t,h:r,radius:s},inner:{x:e.left+i.l,y:e.top+i.t,w:t-i.l-i.r,h:r-i.t-i.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,s.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(i.b,i.r))}}}}function ew(n,e,t,r){const i=e===null,s=t===null,o=n&&!(i&&s)&&G4(n,r);return o&&(i||_a(e,o.left,o.right))&&(s||_a(t,o.top,o.bottom))}function Bfe(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function zfe(n,e){n.rect(e.x,e.y,e.w,e.h)}function tw(n,e,t={}){const r=n.x!==t.x?-e:0,i=n.y!==t.y?-e:0,s=(n.x+n.w!==t.x+t.w?e:0)-r,a=(n.y+n.h!==t.y+t.h?e:0)-i;return{x:n.x+r,y:n.y+i,w:n.w+s,h:n.h+a,radius:n.radius}}class wy extends Fa{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:r,backgroundColor:i}}=this,{inner:s,outer:a}=Ufe(this),o=Bfe(a.radius)?V0:zfe;e.save(),(a.w!==s.w||a.h!==s.h)&&(e.beginPath(),o(e,tw(a,t,s)),e.clip(),o(e,tw(s,-t,a)),e.fillStyle=r,e.fill("evenodd")),e.beginPath(),o(e,tw(s,t)),e.fillStyle=i,e.fill(),e.restore()}inRange(e,t,r){return ew(this,e,t,r)}inXRange(e,t){return ew(this,e,null,t)}inYRange(e,t){return ew(this,null,e,t)}getCenterPoint(e){const{x:t,y:r,base:i,horizontal:s}=this.getProps(["x","y","base","horizontal"],e);return{x:s?(t+i)/2:t,y:s?r:(r+i)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}Re(wy,"id","bar"),Re(wy,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Re(wy,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function $fe(n,e,t){const r=n.segments,i=n.points,s=e.points,a=[];for(const o of r){let{start:l,end:c}=o;c=CM(l,c,i);const u=A1(t,i[l],i[c],o.loop);if(!e.segments){a.push({source:o,target:u,start:i[l],end:i[c]});continue}const d=R4(e,u);for(const h of d){const p=A1(t,s[h.start],s[h.end],h.loop),y=C4(o,i,p);for(const v of y)a.push({source:v,target:h,start:{[t]:MN(u,p,"start",Math.max)},end:{[t]:MN(u,p,"end",Math.min)}})}}return a}function A1(n,e,t,r){if(r)return;let i=e[n],s=t[n];return n==="angle"&&(i=Ss(i),s=Ss(s)),{property:n,start:i,end:s}}function Vfe(n,e){const{x:t=null,y:r=null}=n||{},i=e.points,s=[];return e.segments.forEach(({start:a,end:o})=>{o=CM(a,o,i);const l=i[a],c=i[o];r!==null?(s.push({x:l.x,y:r}),s.push({x:c.x,y:r})):t!==null&&(s.push({x:t,y:l.y}),s.push({x:t,y:c.y}))}),s}function CM(n,e,t){for(;e>n;e--){const r=t[e];if(!isNaN(r.x)&&!isNaN(r.y))break}return e}function MN(n,e,t,r){return n&&e?r(n[t],e[t]):n?n[t]:e?e[t]:0}function q4(n,e){let t=[],r=!1;return yn(n)?(r=!0,t=n):t=Vfe(n,e),t.length?new wo({points:t,options:{tension:0},_loop:r,_fullLoop:r}):null}function kN(n){return n&&n.fill!==!1}function Hfe(n,e,t){let i=n[e].fill;const s=[e];let a;if(!t)return i;for(;i!==!1&&s.indexOf(i)===-1;){if(!lr(i))return i;if(a=n[i],!a)return!1;if(a.visible)return i;s.push(i),i=a.fill}return!1}function Wfe(n,e,t){const r=Yfe(n);if(_t(r))return isNaN(r.value)?!1:r;let i=parseFloat(r);return lr(i)&&Math.floor(i)===i?Gfe(r[0],e,i,t):["origin","start","end","stack","shape"].indexOf(r)>=0&&r}function Gfe(n,e,t,r){return(n==="-"||n==="+")&&(t=e+t),t===e||t<0||t>=r?!1:t}function qfe(n,e){let t=null;return n==="start"?t=e.bottom:n==="end"?t=e.top:_t(n)?t=e.getPixelForValue(n.value):e.getBasePixel&&(t=e.getBasePixel()),t}function Xfe(n,e,t){let r;return n==="start"?r=t:n==="end"?r=e.options.reverse?e.min:e.max:_t(n)?r=n.value:r=e.getBaseValue(),r}function Yfe(n){const e=n.options,t=e.fill;let r=pt(t&&t.target,t);return r===void 0&&(r=!!e.backgroundColor),r===!1||r===null?!1:r===!0?"origin":r}function Kfe(n){const{scale:e,index:t,line:r}=n,i=[],s=r.segments,a=r.points,o=Zfe(e,t);o.push(q4({x:null,y:e.bottom},r));for(let l=0;l<s.length;l++){const c=s[l];for(let u=c.start;u<=c.end;u++)Jfe(i,a[u],o)}return new wo({points:i,options:{}})}function Zfe(n,e){const t=[],r=n.getMatchingVisibleMetas("line");for(let i=0;i<r.length;i++){const s=r[i];if(s.index===e)break;s.hidden||t.unshift(s.dataset)}return t}function Jfe(n,e,t){const r=[];for(let i=0;i<t.length;i++){const s=t[i],{first:a,last:o,point:l}=Qfe(s,e,"x");if(!(!l||a&&o)){if(a)r.unshift(l);else if(n.push(l),!o)break}}n.push(...r)}function Qfe(n,e,t){const r=n.interpolate(e,t);if(!r)return{};const i=r[t],s=n.segments,a=n.points;let o=!1,l=!1;for(let c=0;c<s.length;c++){const u=s[c],d=a[u.start][t],h=a[u.end][t];if(_a(i,d,h)){o=i===d,l=i===h;break}}return{first:o,last:l,point:r}}class X4{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,r){const{x:i,y:s,radius:a}=this;return t=t||{start:0,end:nn},e.arc(i,s,a,t.end,t.start,!0),!r.bounds}interpolate(e){const{x:t,y:r,radius:i}=this,s=e.angle;return{x:t+Math.cos(s)*i,y:r+Math.sin(s)*i,angle:s}}}function epe(n){const{chart:e,fill:t,line:r}=n;if(lr(t))return tpe(e,t);if(t==="stack")return Kfe(n);if(t==="shape")return!0;const i=npe(n);return i instanceof X4?i:q4(i,r)}function tpe(n,e){const t=n.getDatasetMeta(e);return t&&n.isDatasetVisible(e)?t.dataset:null}function npe(n){return(n.scale||{}).getPointPositionForValue?ipe(n):rpe(n)}function rpe(n){const{scale:e={},fill:t}=n,r=qfe(t,e);if(lr(r)){const i=e.isHorizontal();return{x:i?r:null,y:i?null:r}}return null}function ipe(n){const{scale:e,fill:t}=n,r=e.options,i=e.getLabels().length,s=r.reverse?e.max:e.min,a=Xfe(t,e,s),o=[];if(r.grid.circular){const l=e.getPointPositionForValue(0,s);return new X4({x:l.x,y:l.y,radius:e.getDistanceFromCenterForValue(a)})}for(let l=0;l<i;++l)o.push(e.getPointPositionForValue(l,a));return o}function nw(n,e,t){const r=epe(e),{line:i,scale:s,axis:a}=e,o=i.options,l=o.fill,c=o.backgroundColor,{above:u=c,below:d=c}=l||{};r&&i.points.length&&(yx(n,t),spe(n,{line:i,target:r,above:u,below:d,area:t,scale:s,axis:a}),vx(n))}function spe(n,e){const{line:t,target:r,above:i,below:s,area:a,scale:o}=e,l=t._loop?"angle":e.axis;n.save(),l==="x"&&s!==i&&(AN(n,r,a.top),PN(n,{line:t,target:r,color:i,scale:o,property:l}),n.restore(),n.save(),AN(n,r,a.bottom)),PN(n,{line:t,target:r,color:s,scale:o,property:l}),n.restore()}function AN(n,e,t){const{segments:r,points:i}=e;let s=!0,a=!1;n.beginPath();for(const o of r){const{start:l,end:c}=o,u=i[l],d=i[CM(l,c,i)];s?(n.moveTo(u.x,u.y),s=!1):(n.lineTo(u.x,t),n.lineTo(u.x,u.y)),a=!!e.pathSegment(n,o,{move:a}),a?n.closePath():n.lineTo(d.x,t)}n.lineTo(e.first().x,t),n.closePath(),n.clip()}function PN(n,e){const{line:t,target:r,property:i,color:s,scale:a}=e,o=$fe(t,r,i);for(const{source:l,target:c,start:u,end:d}of o){const{style:{backgroundColor:h=s}={}}=l,p=r!==!0;n.save(),n.fillStyle=h,ape(n,a,p&&A1(i,u,d)),n.beginPath();const y=!!t.pathSegment(n,l);let v;if(p){y?n.closePath():CN(n,r,d,i);const g=!!r.pathSegment(n,c,{move:y,reverse:!0});v=y&&g,v||CN(n,r,u,i)}n.closePath(),n.fill(v?"evenodd":"nonzero"),n.restore()}}function ape(n,e,t){const{top:r,bottom:i}=e.chart.chartArea,{property:s,start:a,end:o}=t||{};s==="x"&&(n.beginPath(),n.rect(a,r,o-a,i-r),n.clip())}function CN(n,e,t,r){const i=e.interpolate(t,r);i&&n.lineTo(i.x,i.y)}var ope={id:"filler",afterDatasetsUpdate(n,e,t){const r=(n.data.datasets||[]).length,i=[];let s,a,o,l;for(a=0;a<r;++a)s=n.getDatasetMeta(a),o=s.dataset,l=null,o&&o.options&&o instanceof wo&&(l={visible:n.isDatasetVisible(a),index:a,fill:Wfe(o,a,r),chart:n,axis:s.controller.options.indexAxis,scale:s.vScale,line:o}),s.$filler=l,i.push(l);for(a=0;a<r;++a)l=i[a],!(!l||l.fill===!1)&&(l.fill=Hfe(i,a,t.propagate))},beforeDraw(n,e,t){const r=t.drawTime==="beforeDraw",i=n.getSortedVisibleDatasetMetas(),s=n.chartArea;for(let a=i.length-1;a>=0;--a){const o=i[a].$filler;o&&(o.line.updateControlPoints(s,o.axis),r&&o.fill&&nw(n.ctx,o,s))}},beforeDatasetsDraw(n,e,t){if(t.drawTime!=="beforeDatasetsDraw")return;const r=n.getSortedVisibleDatasetMetas();for(let i=r.length-1;i>=0;--i){const s=r[i].$filler;kN(s)&&nw(n.ctx,s,n.chartArea)}},beforeDatasetDraw(n,e,t){const r=e.meta.$filler;!kN(r)||t.drawTime!=="beforeDatasetDraw"||nw(n.ctx,r,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const RN=(n,e)=>{let{boxHeight:t=e,boxWidth:r=e}=n;return n.usePointStyle&&(t=Math.min(t,e),r=n.pointStyleWidth||Math.min(r,e)),{boxWidth:r,boxHeight:t,itemHeight:Math.max(e,t)}},lpe=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class NN extends Fa{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,r){this.maxWidth=e,this.maxHeight=t,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=qt(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(r=>e.filter(r,this.chart.data))),e.sort&&(t=t.sort((r,i)=>e.sort(r,i,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const r=e.labels,i=rr(r.font),s=i.size,a=this._computeTitleHeight(),{boxWidth:o,itemHeight:l}=RN(r,s);let c,u;t.font=i.string,this.isHorizontal()?(c=this.maxWidth,u=this._fitRows(a,s,o,l)+10):(u=this.maxHeight,c=this._fitCols(a,i,o,l)+10),this.width=Math.min(c,e.maxWidth||this.maxWidth),this.height=Math.min(u,e.maxHeight||this.maxHeight)}_fitRows(e,t,r,i){const{ctx:s,maxWidth:a,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],u=i+o;let d=e;s.textAlign="left",s.textBaseline="middle";let h=-1,p=-u;return this.legendItems.forEach((y,v)=>{const g=r+t/2+s.measureText(y.text).width;(v===0||c[c.length-1]+g+2*o>a)&&(d+=u,c[c.length-(v>0?0:1)]=0,p+=u,h++),l[v]={left:0,top:p,row:h,width:g,height:i},c[c.length-1]+=g+o}),d}_fitCols(e,t,r,i){const{ctx:s,maxHeight:a,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],u=a-e;let d=o,h=0,p=0,y=0,v=0;return this.legendItems.forEach((g,m)=>{const{itemWidth:x,itemHeight:_}=cpe(r,t,s,g,i);m>0&&p+_+2*o>u&&(d+=h+o,c.push({width:h,height:p}),y+=h+o,v++,h=p=0),l[m]={left:y,top:p,col:v,width:x,height:_},h=Math.max(h,x),p+=_+o}),d+=h,c.push({width:h,height:p}),d}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:r,labels:{padding:i},rtl:s}}=this,a=Ku(s,this.left,this.width);if(this.isHorizontal()){let o=0,l=Zn(r,this.left+i,this.right-this.lineWidths[o]);for(const c of t)o!==c.row&&(o=c.row,l=Zn(r,this.left+i,this.right-this.lineWidths[o])),c.top+=this.top+e+i,c.left=a.leftForLtr(a.x(l),c.width),l+=c.width+i}else{let o=0,l=Zn(r,this.top+e+i,this.bottom-this.columnSizes[o].height);for(const c of t)c.col!==o&&(o=c.col,l=Zn(r,this.top+e+i,this.bottom-this.columnSizes[o].height)),c.top=l,c.left+=this.left+i,c.left=a.leftForLtr(a.x(c.left),c.width),l+=c.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;yx(e,this),this._draw(),vx(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:r,ctx:i}=this,{align:s,labels:a}=e,o=fn.color,l=Ku(e.rtl,this.left,this.width),c=rr(a.font),{padding:u}=a,d=c.size,h=d/2;let p;this.drawTitle(),i.textAlign=l.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=c.string;const{boxWidth:y,boxHeight:v,itemHeight:g}=RN(a,d),m=function(E,S,M){if(isNaN(y)||y<=0||isNaN(v)||v<0)return;i.save();const N=pt(M.lineWidth,1);if(i.fillStyle=pt(M.fillStyle,o),i.lineCap=pt(M.lineCap,"butt"),i.lineDashOffset=pt(M.lineDashOffset,0),i.lineJoin=pt(M.lineJoin,"miter"),i.lineWidth=N,i.strokeStyle=pt(M.strokeStyle,o),i.setLineDash(pt(M.lineDash,[])),a.usePointStyle){const T={radius:v*Math.SQRT2/2,pointStyle:M.pointStyle,rotation:M.rotation,borderWidth:N},P=l.xPlus(E,y/2),H=S+h;_4(i,T,P,H,a.pointStyleWidth&&y)}else{const T=S+Math.max((d-v)/2,0),P=l.leftForLtr(E,y),H=Yu(M.borderRadius);i.beginPath(),Object.values(H).some(W=>W!==0)?V0(i,{x:P,y:T,w:y,h:v,radius:H}):i.rect(P,T,y,v),i.fill(),N!==0&&i.stroke()}i.restore()},x=function(E,S,M){Sp(i,M.text,E,S+g/2,c,{strikethrough:M.hidden,textAlign:l.textAlign(M.textAlign)})},_=this.isHorizontal(),b=this._computeTitleHeight();_?p={x:Zn(s,this.left+u,this.right-r[0]),y:this.top+u+b,line:0}:p={x:this.left+u,y:Zn(s,this.top+b+u,this.bottom-t[0].height),line:0},k4(this.ctx,e.textDirection);const w=g+u;this.legendItems.forEach((E,S)=>{i.strokeStyle=E.fontColor,i.fillStyle=E.fontColor;const M=i.measureText(E.text).width,N=l.textAlign(E.textAlign||(E.textAlign=a.textAlign)),T=y+h+M;let P=p.x,H=p.y;l.setWidth(this.width),_?S>0&&P+T+u>this.right&&(H=p.y+=w,p.line++,P=p.x=Zn(s,this.left+u,this.right-r[p.line])):S>0&&H+w>this.bottom&&(P=p.x=P+t[p.line].width+u,p.line++,H=p.y=Zn(s,this.top+b+u,this.bottom-t[p.line].height));const W=l.x(P);if(m(W,H,E),P=Vue(N,P+y+h,_?P+T:this.right,e.rtl),x(l.x(P),H,E),_)p.x+=T+u;else if(typeof E.text!="string"){const O=c.lineHeight;p.y+=Y4(E,O)+u}else p.y+=w}),A4(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,r=rr(t.font),i=Ri(t.padding);if(!t.display)return;const s=Ku(e.rtl,this.left,this.width),a=this.ctx,o=t.position,l=r.size/2,c=i.top+l;let u,d=this.left,h=this.width;if(this.isHorizontal())h=Math.max(...this.lineWidths),u=this.top+c,d=Zn(e.align,d,this.right-h);else{const y=this.columnSizes.reduce((v,g)=>Math.max(v,g.height),0);u=c+Zn(e.align,this.top,this.bottom-y-e.labels.padding-this._computeTitleHeight())}const p=Zn(o,d,d+h);a.textAlign=s.textAlign(_M(o)),a.textBaseline="middle",a.strokeStyle=t.color,a.fillStyle=t.color,a.font=r.string,Sp(a,t.text,p,u,r)}_computeTitleHeight(){const e=this.options.title,t=rr(e.font),r=Ri(e.padding);return e.display?t.lineHeight+r.height:0}_getLegendItemAt(e,t){let r,i,s;if(_a(e,this.left,this.right)&&_a(t,this.top,this.bottom)){for(s=this.legendHitBoxes,r=0;r<s.length;++r)if(i=s[r],_a(e,i.left,i.left+i.width)&&_a(t,i.top,i.top+i.height))return this.legendItems[r]}return null}handleEvent(e){const t=this.options;if(!hpe(e.type,t))return;const r=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const i=this._hoveredItem,s=lpe(i,r);i&&!s&&qt(t.onLeave,[e,i,this],this),this._hoveredItem=r,r&&!s&&qt(t.onHover,[e,r,this],this)}else r&&qt(t.onClick,[e,r,this],this)}}function cpe(n,e,t,r,i){const s=upe(r,n,e,t),a=dpe(i,r,e.lineHeight);return{itemWidth:s,itemHeight:a}}function upe(n,e,t,r){let i=n.text;return i&&typeof i!="string"&&(i=i.reduce((s,a)=>s.length>a.length?s:a)),e+t.size/2+r.measureText(i).width}function dpe(n,e,t){let r=n;return typeof e.text!="string"&&(r=Y4(e,t)),r}function Y4(n,e){const t=n.text?n.text.length:0;return e*t}function hpe(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var fpe={id:"legend",_element:NN,start(n,e,t){const r=n.legend=new NN({ctx:n.ctx,options:t,chart:n});Mi.configure(n,r,t),Mi.addBox(n,r)},stop(n){Mi.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,t){const r=n.legend;Mi.configure(n,r,t),r.options=t},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,t){const r=e.datasetIndex,i=t.chart;i.isDatasetVisible(r)?(i.hide(r),e.hidden=!0):(i.show(r),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:t,pointStyle:r,textAlign:i,color:s,useBorderRadius:a,borderRadius:o}}=n.legend.options;return n._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(t?0:void 0),u=Ri(c.borderWidth);return{text:e[l.index].label,fillStyle:c.backgroundColor,fontColor:s,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:c.borderColor,pointStyle:r||c.pointStyle,rotation:c.rotation,textAlign:i||c.textAlign,borderRadius:a&&(o||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class K4 extends Fa{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const r=this.options;if(this.left=0,this.top=0,!r.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=t;const i=yn(r.text)?r.text.length:1;this._padding=Ri(r.padding);const s=i*rr(r.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:t,left:r,bottom:i,right:s,options:a}=this,o=a.align;let l=0,c,u,d;return this.isHorizontal()?(u=Zn(o,r,s),d=t+e,c=s-r):(a.position==="left"?(u=r+e,d=Zn(o,i,t),l=ln*-.5):(u=s-e,d=Zn(o,t,i),l=ln*.5),c=i-t),{titleX:u,titleY:d,maxWidth:c,rotation:l}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const r=rr(t.font),s=r.lineHeight/2+this._padding.top,{titleX:a,titleY:o,maxWidth:l,rotation:c}=this._drawArgs(s);Sp(e,t.text,0,0,r,{color:t.color,maxWidth:l,rotation:c,textAlign:_M(t.align),textBaseline:"middle",translation:[a,o]})}}function ppe(n,e){const t=new K4({ctx:n.ctx,options:e,chart:n});Mi.configure(n,t,e),Mi.addBox(n,t),n.titleBlock=t}var mpe={id:"title",_element:K4,start(n,e,t){ppe(n,t)},stop(n){const e=n.titleBlock;Mi.removeBox(n,e),delete n.titleBlock},beforeUpdate(n,e,t){const r=n.titleBlock;Mi.configure(n,r,t),r.options=t},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Xh={average(n){if(!n.length)return!1;let e,t,r=new Set,i=0,s=0;for(e=0,t=n.length;e<t;++e){const o=n[e].element;if(o&&o.hasValue()){const l=o.tooltipPosition();r.add(l.x),i+=l.y,++s}}return s===0||r.size===0?!1:{x:[...r].reduce((o,l)=>o+l)/r.size,y:i/s}},nearest(n,e){if(!n.length)return!1;let t=e.x,r=e.y,i=Number.POSITIVE_INFINITY,s,a,o;for(s=0,a=n.length;s<a;++s){const l=n[s].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),u=b1(e,c);u<i&&(i=u,o=l)}}if(o){const l=o.tooltipPosition();t=l.x,r=l.y}return{x:t,y:r}}};function ys(n,e){return e&&(yn(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function ia(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function gpe(n,e){const{element:t,datasetIndex:r,index:i}=e,s=n.getDatasetMeta(r).controller,{label:a,value:o}=s.getLabelAndValue(i);return{chart:n,label:a,parsed:s.getParsed(i),raw:n.data.datasets[r].data[i],formattedValue:o,dataset:s.getDataset(),dataIndex:i,datasetIndex:r,element:t}}function ON(n,e){const t=n.chart.ctx,{body:r,footer:i,title:s}=n,{boxWidth:a,boxHeight:o}=e,l=rr(e.bodyFont),c=rr(e.titleFont),u=rr(e.footerFont),d=s.length,h=i.length,p=r.length,y=Ri(e.padding);let v=y.height,g=0,m=r.reduce((b,w)=>b+w.before.length+w.lines.length+w.after.length,0);if(m+=n.beforeBody.length+n.afterBody.length,d&&(v+=d*c.lineHeight+(d-1)*e.titleSpacing+e.titleMarginBottom),m){const b=e.displayColors?Math.max(o,l.lineHeight):l.lineHeight;v+=p*b+(m-p)*l.lineHeight+(m-1)*e.bodySpacing}h&&(v+=e.footerMarginTop+h*u.lineHeight+(h-1)*e.footerSpacing);let x=0;const _=function(b){g=Math.max(g,t.measureText(b).width+x)};return t.save(),t.font=c.string,Lt(n.title,_),t.font=l.string,Lt(n.beforeBody.concat(n.afterBody),_),x=e.displayColors?a+2+e.boxPadding:0,Lt(r,b=>{Lt(b.before,_),Lt(b.lines,_),Lt(b.after,_)}),x=0,t.font=u.string,Lt(n.footer,_),t.restore(),g+=y.width,{width:g,height:v}}function ype(n,e){const{y:t,height:r}=e;return t<r/2?"top":t>n.height-r/2?"bottom":"center"}function vpe(n,e,t,r){const{x:i,width:s}=r,a=t.caretSize+t.caretPadding;if(n==="left"&&i+s+a>e.width||n==="right"&&i-s-a<0)return!0}function xpe(n,e,t,r){const{x:i,width:s}=t,{width:a,chartArea:{left:o,right:l}}=n;let c="center";return r==="center"?c=i<=(o+l)/2?"left":"right":i<=s/2?c="left":i>=a-s/2&&(c="right"),vpe(c,n,e,t)&&(c="center"),c}function LN(n,e,t){const r=t.yAlign||e.yAlign||ype(n,t);return{xAlign:t.xAlign||e.xAlign||xpe(n,e,t,r),yAlign:r}}function _pe(n,e){let{x:t,width:r}=n;return e==="right"?t-=r:e==="center"&&(t-=r/2),t}function bpe(n,e,t){let{y:r,height:i}=n;return e==="top"?r+=t:e==="bottom"?r-=i+t:r-=i/2,r}function DN(n,e,t,r){const{caretSize:i,caretPadding:s,cornerRadius:a}=n,{xAlign:o,yAlign:l}=t,c=i+s,{topLeft:u,topRight:d,bottomLeft:h,bottomRight:p}=Yu(a);let y=_pe(e,o);const v=bpe(e,l,c);return l==="center"?o==="left"?y+=c:o==="right"&&(y-=c):o==="left"?y-=Math.max(u,h)+i:o==="right"&&(y+=Math.max(d,p)+i),{x:nr(y,0,r.width-e.width),y:nr(v,0,r.height-e.height)}}function Gg(n,e,t){const r=Ri(t.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-r.right:n.x+r.left}function IN(n){return ys([],ia(n))}function wpe(n,e,t){return kc(n,{tooltip:e,tooltipItems:t,type:"tooltip"})}function jN(n,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?n.override(t):n}const Z4={beforeTitle:Js,title(n){if(n.length>0){const e=n[0],t=e.chart.data.labels,r=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(r>0&&e.dataIndex<r)return t[e.dataIndex]}return""},afterTitle:Js,beforeBody:Js,beforeLabel:Js,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const t=n.formattedValue;return At(t)||(e+=t),e},labelColor(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:Js,afterBody:Js,beforeFooter:Js,footer:Js,afterFooter:Js};function Cr(n,e,t,r){const i=n[e].call(t,r);return typeof i>"u"?Z4[e].call(t,r):i}class P1 extends Fa{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,r=this.options.setContext(this.getContext()),i=r.enabled&&t.options.animation&&r.animations,s=new N4(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=wpe(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:r}=t,i=Cr(r,"beforeTitle",this,e),s=Cr(r,"title",this,e),a=Cr(r,"afterTitle",this,e);let o=[];return o=ys(o,ia(i)),o=ys(o,ia(s)),o=ys(o,ia(a)),o}getBeforeBody(e,t){return IN(Cr(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:r}=t,i=[];return Lt(e,s=>{const a={before:[],lines:[],after:[]},o=jN(r,s);ys(a.before,ia(Cr(o,"beforeLabel",this,s))),ys(a.lines,Cr(o,"label",this,s)),ys(a.after,ia(Cr(o,"afterLabel",this,s))),i.push(a)}),i}getAfterBody(e,t){return IN(Cr(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:r}=t,i=Cr(r,"beforeFooter",this,e),s=Cr(r,"footer",this,e),a=Cr(r,"afterFooter",this,e);let o=[];return o=ys(o,ia(i)),o=ys(o,ia(s)),o=ys(o,ia(a)),o}_createItems(e){const t=this._active,r=this.chart.data,i=[],s=[],a=[];let o=[],l,c;for(l=0,c=t.length;l<c;++l)o.push(gpe(this.chart,t[l]));return e.filter&&(o=o.filter((u,d,h)=>e.filter(u,d,h,r))),e.itemSort&&(o=o.sort((u,d)=>e.itemSort(u,d,r))),Lt(o,u=>{const d=jN(e.callbacks,u);i.push(Cr(d,"labelColor",this,u)),s.push(Cr(d,"labelPointStyle",this,u)),a.push(Cr(d,"labelTextColor",this,u))}),this.labelColors=i,this.labelPointStyles=s,this.labelTextColors=a,this.dataPoints=o,o}update(e,t){const r=this.options.setContext(this.getContext()),i=this._active;let s,a=[];if(!i.length)this.opacity!==0&&(s={opacity:0});else{const o=Xh[r.position].call(this,i,this._eventPosition);a=this._createItems(r),this.title=this.getTitle(a,r),this.beforeBody=this.getBeforeBody(a,r),this.body=this.getBody(a,r),this.afterBody=this.getAfterBody(a,r),this.footer=this.getFooter(a,r);const l=this._size=ON(this,r),c=Object.assign({},o,l),u=LN(this.chart,r,c),d=DN(r,c,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,s={opacity:1,x:d.x,y:d.y,width:l.width,height:l.height,caretX:o.x,caretY:o.y}}this._tooltipItems=a,this.$context=void 0,s&&this._resolveAnimations().update(this,s),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,r,i){const s=this.getCaretPosition(e,r,i);t.lineTo(s.x1,s.y1),t.lineTo(s.x2,s.y2),t.lineTo(s.x3,s.y3)}getCaretPosition(e,t,r){const{xAlign:i,yAlign:s}=this,{caretSize:a,cornerRadius:o}=r,{topLeft:l,topRight:c,bottomLeft:u,bottomRight:d}=Yu(o),{x:h,y:p}=e,{width:y,height:v}=t;let g,m,x,_,b,w;return s==="center"?(b=p+v/2,i==="left"?(g=h,m=g-a,_=b+a,w=b-a):(g=h+y,m=g+a,_=b-a,w=b+a),x=g):(i==="left"?m=h+Math.max(l,u)+a:i==="right"?m=h+y-Math.max(c,d)-a:m=this.caretX,s==="top"?(_=p,b=_-a,g=m-a,x=m+a):(_=p+v,b=_+a,g=m+a,x=m-a),w=_),{x1:g,x2:m,x3:x,y1:_,y2:b,y3:w}}drawTitle(e,t,r){const i=this.title,s=i.length;let a,o,l;if(s){const c=Ku(r.rtl,this.x,this.width);for(e.x=Gg(this,r.titleAlign,r),t.textAlign=c.textAlign(r.titleAlign),t.textBaseline="middle",a=rr(r.titleFont),o=r.titleSpacing,t.fillStyle=r.titleColor,t.font=a.string,l=0;l<s;++l)t.fillText(i[l],c.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+o,l+1===s&&(e.y+=r.titleMarginBottom-o)}}_drawColorBox(e,t,r,i,s){const a=this.labelColors[r],o=this.labelPointStyles[r],{boxHeight:l,boxWidth:c}=s,u=rr(s.bodyFont),d=Gg(this,"left",s),h=i.x(d),p=l<u.lineHeight?(u.lineHeight-l)/2:0,y=t.y+p;if(s.usePointStyle){const v={radius:Math.min(c,l)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},g=i.leftForLtr(h,c)+c/2,m=y+l/2;e.strokeStyle=s.multiKeyBackground,e.fillStyle=s.multiKeyBackground,S1(e,v,g,m),e.strokeStyle=a.borderColor,e.fillStyle=a.backgroundColor,S1(e,v,g,m)}else{e.lineWidth=_t(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,e.strokeStyle=a.borderColor,e.setLineDash(a.borderDash||[]),e.lineDashOffset=a.borderDashOffset||0;const v=i.leftForLtr(h,c),g=i.leftForLtr(i.xPlus(h,1),c-2),m=Yu(a.borderRadius);Object.values(m).some(x=>x!==0)?(e.beginPath(),e.fillStyle=s.multiKeyBackground,V0(e,{x:v,y,w:c,h:l,radius:m}),e.fill(),e.stroke(),e.fillStyle=a.backgroundColor,e.beginPath(),V0(e,{x:g,y:y+1,w:c-2,h:l-2,radius:m}),e.fill()):(e.fillStyle=s.multiKeyBackground,e.fillRect(v,y,c,l),e.strokeRect(v,y,c,l),e.fillStyle=a.backgroundColor,e.fillRect(g,y+1,c-2,l-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,t,r){const{body:i}=this,{bodySpacing:s,bodyAlign:a,displayColors:o,boxHeight:l,boxWidth:c,boxPadding:u}=r,d=rr(r.bodyFont);let h=d.lineHeight,p=0;const y=Ku(r.rtl,this.x,this.width),v=function(M){t.fillText(M,y.x(e.x+p),e.y+h/2),e.y+=h+s},g=y.textAlign(a);let m,x,_,b,w,E,S;for(t.textAlign=a,t.textBaseline="middle",t.font=d.string,e.x=Gg(this,g,r),t.fillStyle=r.bodyColor,Lt(this.beforeBody,v),p=o&&g!=="right"?a==="center"?c/2+u:c+2+u:0,b=0,E=i.length;b<E;++b){for(m=i[b],x=this.labelTextColors[b],t.fillStyle=x,Lt(m.before,v),_=m.lines,o&&_.length&&(this._drawColorBox(t,e,b,y,r),h=Math.max(d.lineHeight,l)),w=0,S=_.length;w<S;++w)v(_[w]),h=d.lineHeight;Lt(m.after,v)}p=0,h=d.lineHeight,Lt(this.afterBody,v),e.y-=s}drawFooter(e,t,r){const i=this.footer,s=i.length;let a,o;if(s){const l=Ku(r.rtl,this.x,this.width);for(e.x=Gg(this,r.footerAlign,r),e.y+=r.footerMarginTop,t.textAlign=l.textAlign(r.footerAlign),t.textBaseline="middle",a=rr(r.footerFont),t.fillStyle=r.footerColor,t.font=a.string,o=0;o<s;++o)t.fillText(i[o],l.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+r.footerSpacing}}drawBackground(e,t,r,i){const{xAlign:s,yAlign:a}=this,{x:o,y:l}=e,{width:c,height:u}=r,{topLeft:d,topRight:h,bottomLeft:p,bottomRight:y}=Yu(i.cornerRadius);t.fillStyle=i.backgroundColor,t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.beginPath(),t.moveTo(o+d,l),a==="top"&&this.drawCaret(e,t,r,i),t.lineTo(o+c-h,l),t.quadraticCurveTo(o+c,l,o+c,l+h),a==="center"&&s==="right"&&this.drawCaret(e,t,r,i),t.lineTo(o+c,l+u-y),t.quadraticCurveTo(o+c,l+u,o+c-y,l+u),a==="bottom"&&this.drawCaret(e,t,r,i),t.lineTo(o+p,l+u),t.quadraticCurveTo(o,l+u,o,l+u-p),a==="center"&&s==="left"&&this.drawCaret(e,t,r,i),t.lineTo(o,l+d),t.quadraticCurveTo(o,l,o+d,l),t.closePath(),t.fill(),i.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,r=this.$animations,i=r&&r.x,s=r&&r.y;if(i||s){const a=Xh[e.position].call(this,this._active,this._eventPosition);if(!a)return;const o=this._size=ON(this,e),l=Object.assign({},a,this._size),c=LN(t,e,l),u=DN(e,l,c,t);(i._to!==u.x||s._to!==u.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=o.width,this.height=o.height,this.caretX=a.x,this.caretY=a.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(t);const i={width:this.width,height:this.height},s={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const a=Ri(t.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&o&&(e.save(),e.globalAlpha=r,this.drawBackground(s,e,i,t),k4(e,t.textDirection),s.y+=a.top,this.drawTitle(s,e,t),this.drawBody(s,e,t),this.drawFooter(s,e,t),A4(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const r=this._active,i=e.map(({datasetIndex:o,index:l})=>{const c=this.chart.getDatasetMeta(o);if(!c)throw new Error("Cannot find a dataset at index "+o);return{datasetIndex:o,element:c.data[l],index:l}}),s=!B0(r,i),a=this._positionChanged(i,t);(s||a)&&(this._active=i,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,r=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,s=this._active||[],a=this._getActiveElements(e,s,t,r),o=this._positionChanged(a,e),l=t||!B0(a,s)||o;return l&&(this._active=a,(i.enabled||i.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),l}_getActiveElements(e,t,r,i){const s=this.options;if(e.type==="mouseout")return[];if(!i)return t.filter(o=>this.chart.data.datasets[o.datasetIndex]&&this.chart.getDatasetMeta(o.datasetIndex).controller.getParsed(o.index)!==void 0);const a=this.chart.getElementsAtEventForMode(e,s.mode,s,r);return s.reverse&&a.reverse(),a}_positionChanged(e,t){const{caretX:r,caretY:i,options:s}=this,a=Xh[s.position].call(this,e,t);return a!==!1&&(r!==a.x||i!==a.y)}}Re(P1,"positioners",Xh);var Spe={id:"tooltip",_element:P1,positioners:Xh,afterInit(n,e,t){t&&(n.tooltip=new P1({chart:n,options:t}))},beforeUpdate(n,e,t){n.tooltip&&n.tooltip.initialize(t)},reset(n,e,t){n.tooltip&&n.tooltip.initialize(t)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",t)}},afterEvent(n,e){if(n.tooltip){const t=e.replay;n.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Z4},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const Epe=(n,e,t,r)=>(typeof e=="string"?(t=n.push(e)-1,r.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function Tpe(n,e,t,r){const i=n.indexOf(e);if(i===-1)return Epe(n,e,t,r);const s=n.lastIndexOf(e);return i!==s?t:i}const Mpe=(n,e)=>n===null?null:nr(Math.round(n),0,e);function FN(n){const e=this.getLabels();return n>=0&&n<e.length?e[n]:n}class C1 extends Ud{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const r=this.getLabels();for(const{index:i,label:s}of t)r[i]===s&&r.splice(i,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(At(e))return null;const r=this.getLabels();return t=isFinite(t)&&r[t]===e?t:Tpe(r,e,pt(t,e),this._addedLabels),Mpe(t,r.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:r,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(r=0),t||(i=this.getLabels().length-1)),this.min=r,this.max=i}buildTicks(){const e=this.min,t=this.max,r=this.options.offset,i=[];let s=this.getLabels();s=e===0&&t===s.length-1?s:s.slice(e,t+1),this._valueRange=Math.max(s.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let a=e;a<=t;a++)i.push({value:a});return i}getLabelForValue(e){return FN.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}Re(C1,"id","category"),Re(C1,"defaults",{ticks:{callback:FN}});function kpe(n,e){const t=[],{bounds:i,step:s,min:a,max:o,precision:l,count:c,maxTicks:u,maxDigits:d,includeBounds:h}=n,p=s||1,y=u-1,{min:v,max:g}=e,m=!At(a),x=!At(o),_=!At(c),b=(g-v)/(d+1);let w=D2((g-v)/y/p)*p,E,S,M,N;if(w<1e-14&&!m&&!x)return[{value:v},{value:g}];N=Math.ceil(g/w)-Math.floor(v/w),N>y&&(w=D2(N*w/y/p)*p),At(l)||(E=Math.pow(10,l),w=Math.ceil(w*E)/E),i==="ticks"?(S=Math.floor(v/w)*w,M=Math.ceil(g/w)*w):(S=v,M=g),m&&x&&s&&Lue((o-a)/s,w/1e3)?(N=Math.round(Math.min((o-a)/w,u)),w=(o-a)/N,S=a,M=o):_?(S=m?a:S,M=x?o:M,N=c-1,w=(M-S)/N):(N=(M-S)/w,wf(N,Math.round(N),w/1e3)?N=Math.round(N):N=Math.ceil(N));const T=Math.max(I2(w),I2(S));E=Math.pow(10,At(l)?T:l),S=Math.round(S*E)/E,M=Math.round(M*E)/E;let P=0;for(m&&(h&&S!==a?(t.push({value:a}),S<a&&P++,wf(Math.round((S+P*w)*E)/E,a,UN(a,b,n))&&P++):S<a&&P++);P<N;++P){const H=Math.round((S+P*w)*E)/E;if(x&&H>o)break;t.push({value:H})}return x&&h&&M!==o?t.length&&wf(t[t.length-1].value,o,UN(o,b,n))?t[t.length-1].value=o:t.push({value:o}):(!x||M===o)&&t.push({value:M}),t}function UN(n,e,{horizontal:t,minRotation:r}){const i=xa(r),s=(t?Math.sin(i):Math.cos(i))||.001,a=.75*e*(""+n).length;return Math.min(e/s,a)}class Ape extends Ud{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return At(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:r}=this.getUserBounds();let{min:i,max:s}=this;const a=l=>i=t?i:l,o=l=>s=r?s:l;if(e){const l=Ns(i),c=Ns(s);l<0&&c<0?o(0):l>0&&c>0&&a(0)}if(i===s){let l=s===0?1:Math.abs(s*.05);o(s+l),e||a(i-l)}this.min=i,this.max=s}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:r}=e,i;return r?(i=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),t=t||11),t&&(i=Math.min(t,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let r=this.getTickLimit();r=Math.max(2,r);const i={maxTicks:r,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},s=this._range||this,a=kpe(i,s);return e.bounds==="ticks"&&Due(a,this,"value"),e.reverse?(a.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),a}configure(){const e=this.ticks;let t=this.min,r=this.max;if(super.configure(),this.options.offset&&e.length){const i=(r-t)/Math.max(e.length-1,1)/2;t-=i,r+=i}this._startValue=t,this._endValue=r,this._valueRange=r-t}getLabelForValue(e){return wM(e,this.chart.options.locale,this.options.ticks.format)}}class R1 extends Ape{determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=lr(e)?e:0,this.max=lr(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,r=xa(this.options.ticks.minRotation),i=(e?Math.sin(r):Math.cos(r))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,s.lineHeight/i))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}Re(R1,"id","linear"),Re(R1,"defaults",{ticks:{callback:x4.formatters.numeric}});const bx={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Dr=Object.keys(bx);function BN(n,e){return n-e}function zN(n,e){if(At(e))return null;const t=n._adapter,{parser:r,round:i,isoWeekday:s}=n._parseOpts;let a=e;return typeof r=="function"&&(a=r(a)),lr(a)||(a=typeof r=="string"?t.parse(a,r):t.parse(a)),a===null?null:(i&&(a=i==="week"&&(vd(s)||s===!0)?t.startOf(a,"isoWeek",s):t.startOf(a,i)),+a)}function $N(n,e,t,r){const i=Dr.length;for(let s=Dr.indexOf(n);s<i-1;++s){const a=bx[Dr[s]],o=a.steps?a.steps:Number.MAX_SAFE_INTEGER;if(a.common&&Math.ceil((t-e)/(o*a.size))<=r)return Dr[s]}return Dr[i-1]}function Ppe(n,e,t,r,i){for(let s=Dr.length-1;s>=Dr.indexOf(t);s--){const a=Dr[s];if(bx[a].common&&n._adapter.diff(i,r,a)>=e-1)return a}return Dr[t?Dr.indexOf(t):0]}function Cpe(n){for(let e=Dr.indexOf(n)+1,t=Dr.length;e<t;++e)if(bx[Dr[e]].common)return Dr[e]}function VN(n,e,t){if(!t)n[e]=!0;else if(t.length){const{lo:r,hi:i}=xM(t,e),s=t[r]>=e?t[r]:t[i];n[s]=!0}}function Rpe(n,e,t,r){const i=n._adapter,s=+i.startOf(e[0].value,r),a=e[e.length-1].value;let o,l;for(o=s;o<=a;o=+i.add(o,1,r))l=t[o],l>=0&&(e[l].major=!0);return e}function HN(n,e,t){const r=[],i={},s=e.length;let a,o;for(a=0;a<s;++a)o=e[a],i[o]=a,r.push({value:o,major:!1});return s===0||!t?r:Rpe(n,r,i,t)}class q0 extends Ud{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const r=e.time||(e.time={}),i=this._adapter=new fhe._date(e.adapters.date);i.init(t),bf(r.displayFormats,i.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:zN(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,r=e.time.unit||"day";let{min:i,max:s,minDefined:a,maxDefined:o}=this.getUserBounds();function l(c){!a&&!isNaN(c.min)&&(i=Math.min(i,c.min)),!o&&!isNaN(c.max)&&(s=Math.max(s,c.max))}(!a||!o)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),i=lr(i)&&!isNaN(i)?i:+t.startOf(Date.now(),r),s=lr(s)&&!isNaN(s)?s:+t.endOf(Date.now(),r)+1,this.min=Math.min(i,s-1),this.max=Math.max(i+1,s)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],r=e[e.length-1]),{min:t,max:r}}buildTicks(){const e=this.options,t=e.time,r=e.ticks,i=r.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const s=this.min,a=this.max,o=Bue(i,s,a);return this._unit=t.unit||(r.autoSkip?$N(t.minUnit,this.min,this.max,this._getLabelCapacity(s)):Ppe(this,o.length,t.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:Cpe(this._unit),this.initOffsets(i),e.reverse&&o.reverse(),HN(this,o,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,r=0,i,s;this.options.offset&&e.length&&(i=this.getDecimalForValue(e[0]),e.length===1?t=1-i:t=(this.getDecimalForValue(e[1])-i)/2,s=this.getDecimalForValue(e[e.length-1]),e.length===1?r=s:r=(s-this.getDecimalForValue(e[e.length-2]))/2);const a=e.length<3?.5:.25;t=nr(t,0,a),r=nr(r,0,a),this._offsets={start:t,end:r,factor:1/(t+1+r)}}_generate(){const e=this._adapter,t=this.min,r=this.max,i=this.options,s=i.time,a=s.unit||$N(s.minUnit,t,r,this._getLabelCapacity(t)),o=pt(i.ticks.stepSize,1),l=a==="week"?s.isoWeekday:!1,c=vd(l)||l===!0,u={};let d=t,h,p;if(c&&(d=+e.startOf(d,"isoWeek",l)),d=+e.startOf(d,c?"day":a),e.diff(r,t,a)>1e5*o)throw new Error(t+" and "+r+" are too far apart with stepSize of "+o+" "+a);const y=i.ticks.source==="data"&&this.getDataTimestamps();for(h=d,p=0;h<r;h=+e.add(h,o,a),p++)VN(u,h,y);return(h===r||i.bounds==="ticks"||p===1)&&VN(u,h,y),Object.keys(u).sort(BN).map(v=>+v)}getLabelForValue(e){const t=this._adapter,r=this.options.time;return r.tooltipFormat?t.format(e,r.tooltipFormat):t.format(e,r.displayFormats.datetime)}format(e,t){const i=this.options.time.displayFormats,s=this._unit,a=t||i[s];return this._adapter.format(e,a)}_tickFormatFunction(e,t,r,i){const s=this.options,a=s.ticks.callback;if(a)return qt(a,[e,t,r],this);const o=s.time.displayFormats,l=this._unit,c=this._majorUnit,u=l&&o[l],d=c&&o[c],h=r[t],p=c&&d&&h&&h.major;return this._adapter.format(e,i||(p?d:u))}generateTickLabels(e){let t,r,i;for(t=0,r=e.length;t<r;++t)i=e[t],i.label=this._tickFormatFunction(i.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+r)*t.factor)}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,r=this.ctx.measureText(e).width,i=xa(this.isHorizontal()?t.maxRotation:t.minRotation),s=Math.cos(i),a=Math.sin(i),o=this._resolveTickFontOptions(0).size;return{w:r*s+o*a,h:r*a+o*s}}_getLabelCapacity(e){const t=this.options.time,r=t.displayFormats,i=r[t.unit]||r.millisecond,s=this._tickFormatFunction(e,0,HN(this,[e],this._majorUnit),i),a=this._getLabelSize(s),o=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return o>0?o:1}getDataTimestamps(){let e=this._cache.data||[],t,r;if(e.length)return e;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(t=0,r=i.length;t<r;++t)e=e.concat(i[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,r;if(e.length)return e;const i=this.getLabels();for(t=0,r=i.length;t<r;++t)e.push(zN(this,i[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return f4(e.sort(BN))}}Re(q0,"id","time"),Re(q0,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function qg(n,e,t){let r=0,i=n.length-1,s,a,o,l;t?(e>=n[r].pos&&e<=n[i].pos&&({lo:r,hi:i}=zl(n,"pos",e)),{pos:s,time:o}=n[r],{pos:a,time:l}=n[i]):(e>=n[r].time&&e<=n[i].time&&({lo:r,hi:i}=zl(n,"time",e)),{time:s,pos:o}=n[r],{time:a,pos:l}=n[i]);const c=a-s;return c?o+(l-o)*(e-s)/c:o}class WN extends q0{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=qg(t,this.min),this._tableRange=qg(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:r}=this,i=[],s=[];let a,o,l,c,u;for(a=0,o=e.length;a<o;++a)c=e[a],c>=t&&c<=r&&i.push(c);if(i.length<2)return[{time:t,pos:0},{time:r,pos:1}];for(a=0,o=i.length;a<o;++a)u=i[a+1],l=i[a-1],c=i[a],Math.round((u+l)/2)!==c&&s.push({time:c,pos:a/(o-1)});return s}_generate(){const e=this.min,t=this.max;let r=super.getDataTimestamps();return(!r.includes(e)||!r.length)&&r.splice(0,0,e),(!r.includes(t)||r.length===1)&&r.push(t),r.sort((i,s)=>i-s)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),r=this.getLabelTimestamps();return t.length&&r.length?e=this.normalize(t.concat(r)):e=t.length?t:r,e=this._cache.all=e,e}getDecimalForValue(e){return(qg(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return qg(this._table,r*this._tableRange+this._minPos,!0)}}Re(WN,"id","timeseries"),Re(WN,"defaults",q0.defaults);const J4="label";function GN(n,e){typeof n=="function"?n(e):n&&(n.current=e)}function Npe(n,e){const t=n.options;t&&e&&Object.assign(t,e)}function Q4(n,e){n.labels=e}function eB(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:J4;const r=[];n.datasets=e.map(i=>{const s=n.datasets.find(a=>a[t]===i[t]);return!s||!i.data||r.includes(s)?{...i}:(r.push(s),Object.assign(s,i),s)})}function Ope(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:J4;const t={labels:[],datasets:[]};return Q4(t,n.labels),eB(t,n.datasets,e),t}function Lpe(n,e){const{height:t=150,width:r=300,redraw:i=!1,datasetIdKey:s,type:a,data:o,options:l,plugins:c=[],fallbackContent:u,updateMode:d,...h}=n,p=k.useRef(null),y=k.useRef(null),v=()=>{p.current&&(y.current=new _x(p.current,{type:a,data:Ope(o,s),options:l&&{...l},plugins:c}),GN(e,y.current))},g=()=>{GN(e,null),y.current&&(y.current.destroy(),y.current=null)};return k.useEffect(()=>{!i&&y.current&&l&&Npe(y.current,l)},[i,l]),k.useEffect(()=>{!i&&y.current&&Q4(y.current.config.data,o.labels)},[i,o.labels]),k.useEffect(()=>{!i&&y.current&&o.datasets&&eB(y.current.config.data,o.datasets,s)},[i,o.datasets]),k.useEffect(()=>{y.current&&(i?(g(),setTimeout(v)):y.current.update(d))},[i,l,o.labels,o.datasets,d]),k.useEffect(()=>{y.current&&(g(),setTimeout(v))},[a]),k.useEffect(()=>(v(),()=>g()),[]),tE.createElement("canvas",{ref:p,role:"img",height:t,width:r,...h},u)}const Dpe=k.forwardRef(Lpe);function wx(n,e){return _x.register(e),k.forwardRef((t,r)=>tE.createElement(Dpe,{...t,ref:r,type:n}))}const Tp=wx("line",yy),RM=wx("bar",gy),Ipe=wx("pie",E1),jpe=wx("scatter",vy),Fpe=({data:n})=>{const{isDark:e}=Mc(),t={labels:["Jan","Feb","Mar","Apr","May","Jun"],datasets:[{label:"Price",data:[65,59,80,81,56,55],borderColor:"rgba(22, 153, 118, 1)",backgroundColor:"rgba(22, 153, 118, 0.1)",borderWidth:2,pointRadius:1,pointHoverRadius:5,tension:.4,fill:!0}]},r={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{mode:"index",intersect:!1,backgroundColor:e?"rgba(0, 0, 0, 0.8)":"rgba(255, 255, 255, 0.8)",titleColor:e?"#fff":"#000",bodyColor:e?"#fff":"#000",borderColor:"rgba(22, 153, 118, 0.3)",borderWidth:1}},scales:{x:{grid:{display:!1},ticks:{color:e?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.7)",maxRotation:0}},y:{grid:{color:e?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},ticks:{color:e?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.7)"}}}};return f.jsx("div",{className:"h-[300px]",children:f.jsx(Tp,{data:t,options:r})})},Upe=({symbol:n="SOLUSDT",interval:e="1D"})=>{const t=k.useRef(null);return k.useEffect(()=>{t.current&&(t.current.innerHTML="");const r=document.createElement("script");return r.src="https://s3.tradingview.com/tv.js",r.async=!0,r.onload=()=>{typeof window.TradingView<"u"&&t.current&&new window.TradingView.widget({autosize:!0,symbol:n,interval:e,timezone:"Etc/UTC",theme:"dark",style:"1",locale:"en",toolbar_bg:"#0C1016",enable_publishing:!1,allow_symbol_change:!0,container_id:t.current.id,save_image:!1})},document.head.appendChild(r),()=>{r.parentNode&&r.parentNode.removeChild(r)}},[n,e]),f.jsx("div",{className:"h-[400px] w-full",children:f.jsx("div",{id:"tradingview_chart",ref:t,className:"h-full w-full"})})},Bpe=[{name:"RSI (14)",value:65.8,signal:"BUY",description:"Momentum is strong but not overbought"},{name:"MACD",value:1.23,signal:"BUY",description:"Bullish crossover detected"},{name:"Stochastic",value:82.5,signal:"SELL",description:"Approaching overbought territory"},{name:"Moving Average (50)",value:122.45,signal:"BUY",description:"Price above MA, uptrend confirmed"}],zpe=()=>f.jsx("div",{className:"space-y-4 h-[400px] overflow-y-auto",children:Bpe.map((n,e)=>f.jsxs("div",{className:"p-4 rounded-lg bg-black/20 border border-viridian/30",children:[f.jsxs("div",{className:"flex justify-between items-start mb-2",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"font-medium text-white",children:n.name}),f.jsx("p",{className:"text-2xl font-semibold text-viridian",children:n.value})]}),f.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${n.signal==="BUY"?"bg-emerald/20 text-emerald":n.signal==="SELL"?"bg-red-500/20 text-red-500":"bg-gray-500/20 text-gray-400"}`,children:n.signal})]}),f.jsx("p",{className:"text-sm text-gray-400",children:n.description})]},e))}),$pe=(n,e=20)=>{const t=[],r=n*.1,i=r/e;for(let s=0;s<e;s++){const a=n-r/2+s*i,o=Math.random()*1e3+200,l=Math.random()>.5?"buy":"sell";t.push({price:a,volume:o,type:l})}return t},Vpe=()=>{const{isDark:n}=Mc(),e=122.45,t=$pe(e),r={labels:t.map(s=>s.price.toFixed(2)),datasets:[{label:"Buy Volume",data:t.map(s=>s.type==="buy"?s.volume:0),backgroundColor:"rgba(22, 153, 118, 0.8)",borderColor:"rgba(22, 153, 118, 1)",borderWidth:1,barPercentage:1,categoryPercentage:1},{label:"Sell Volume",data:t.map(s=>s.type==="sell"?s.volume:0),backgroundColor:"rgba(239, 68, 68, 0.8)",borderColor:"rgba(239, 68, 68, 1)",borderWidth:1,barPercentage:1,categoryPercentage:1}]},i={indexAxis:"y",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"top",labels:{color:n?"#fff":"#000"}},tooltip:{mode:"index",intersect:!1,backgroundColor:n?"rgba(0, 0, 0, 0.8)":"rgba(255, 255, 255, 0.8)",titleColor:n?"#fff":"#000",bodyColor:n?"#fff":"#000",borderColor:"rgba(22, 153, 118, 0.3)",borderWidth:1}},scales:{x:{stacked:!0,grid:{color:n?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},ticks:{color:n?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.7)"}},y:{stacked:!0,grid:{display:!1},ticks:{color:n?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.7)",callback:function(s){return`$${s}`}}}}};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"text-sm text-gray-400",children:"Volume Profile"}),f.jsx("p",{className:"text-xl font-semibold text-white",children:"Price Distribution"})]}),f.jsxs("div",{className:"text-right",children:[f.jsx("h4",{className:"text-sm text-gray-400",children:"POC"}),f.jsxs("p",{className:"text-xl font-semibold text-viridian",children:["$",e]})]})]}),f.jsx("div",{className:"h-[300px]",children:f.jsx(RM,{data:r,options:i})})]})},Hpe=[{name:"RSI",value:65.8,signal:"bullish",change:2.3},{name:"MACD",value:1.23,signal:"bullish",change:.45},{name:"Stochastic",value:82.5,signal:"bearish",change:-1.8},{name:"ADX",value:28.4,signal:"neutral",change:.2}],Wpe=(n=50)=>{const e=[];let t=50;for(let r=0;r<n;r++)t+=(Math.random()-.5)*5,t=Math.max(0,Math.min(100,t)),e.push(t);return e},Gpe=()=>{const{isDark:n}=Mc(),e=Wpe(),t={labels:Array.from({length:e.length},(i,s)=>s),datasets:[{label:"Momentum",data:e,borderColor:"rgba(22, 153, 118, 1)",backgroundColor:"rgba(22, 153, 118, 0.1)",fill:!0,tension:.4}]},r={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:n?"rgba(0, 0, 0, 0.8)":"rgba(255, 255, 255, 0.8)",titleColor:n?"#fff":"#000",bodyColor:n?"#fff":"#000",borderColor:"rgba(22, 153, 118, 0.3)",borderWidth:1}},scales:{x:{display:!1},y:{grid:{color:n?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},ticks:{color:n?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.7)"},min:0,max:100}}};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h4",{className:"text-sm text-gray-400",children:"Momentum Scanner"}),f.jsxs("div",{className:"text-right",children:[f.jsx("p",{className:"text-xs text-gray-400",children:"Overall Signal"}),f.jsx("p",{className:"text-sm text-emerald font-medium",children:"BULLISH"})]})]}),f.jsx("div",{className:"grid grid-cols-2 gap-4",children:Hpe.map(i=>f.jsxs("div",{className:`p-3 rounded-lg ${i.signal==="bullish"?"bg-emerald/10 border border-emerald/30":i.signal==="bearish"?"bg-red-500/10 border border-red-500/30":"bg-gray-500/10 border border-gray-500/30"}`,children:[f.jsxs("div",{className:"flex justify-between items-center mb-1",children:[f.jsx("span",{className:"text-gray-400",children:i.name}),f.jsxs("span",{className:`flex items-center gap-1 ${i.change>=0?"text-emerald":"text-red-500"}`,children:[i.change>=0?f.jsx(ud,{size:14}):f.jsx(Fv,{size:14}),Math.abs(i.change).toFixed(1),"%"]})]}),f.jsx("p",{className:`text-lg font-semibold ${i.signal==="bullish"?"text-emerald":i.signal==="bearish"?"text-red-500":"text-gray-400"}`,children:i.value.toFixed(1)})]},i.name))}),f.jsx("div",{className:"h-[150px]",children:f.jsx(Tp,{data:t,options:r})})]})},qpe=(n,e=10)=>{const t=[],i=n*.002,s=n,a=s-i/2,o=s+i/2;for(let l=0;l<e;l++){const c=a-l*n*.001,u=Math.random()*1e3+500,d=l===0?u:t[l-1].total+u;t.push({price:c,size:u,total:d,side:"bid"})}for(let l=0;l<e;l++){const c=o+l*n*.001,u=Math.random()*1e3+500,d=l===0?u:t[e+l-1].total+u;t.push({price:c,size:u,total:d,side:"ask"})}return t},Xpe=()=>{const{isDark:n}=Mc(),e=122.45,t=qpe(e),r={labels:t.map(s=>s.price.toFixed(2)),datasets:[{label:"Bids",data:t.filter(s=>s.side==="bid").map(s=>s.total),backgroundColor:"rgba(22, 153, 118, 0.3)",borderColor:"rgba(22, 153, 118, 1)",borderWidth:1,fill:!0},{label:"Asks",data:t.filter(s=>s.side==="ask").map(s=>s.total),backgroundColor:"rgba(239, 68, 68, 0.3)",borderColor:"rgba(239, 68, 68, 1)",borderWidth:1,fill:!0}]},i={responsive:!0,maintainAspectRatio:!1,interaction:{intersect:!1,mode:"index"},plugins:{legend:{display:!0,labels:{color:n?"#fff":"#000"}},tooltip:{backgroundColor:n?"rgba(0, 0, 0, 0.8)":"rgba(255, 255, 255, 0.8)",titleColor:n?"#fff":"#000",bodyColor:n?"#fff":"#000",borderColor:"rgba(22, 153, 118, 0.3)",borderWidth:1,callbacks:{label:function(s){return`Volume: ${s.raw.toFixed(2)}`}}}},scales:{x:{grid:{display:!1},ticks:{color:n?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.7)",maxRotation:0,callback:function(s){return`$${s}`}}},y:{grid:{color:n?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},ticks:{color:n?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.7)"}}}};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"text-sm text-gray-400",children:"Current Price"}),f.jsxs("p",{className:"text-xl font-semibold text-white",children:["$",e]})]}),f.jsxs("div",{className:"text-right",children:[f.jsx("h4",{className:"text-sm text-gray-400",children:"Spread"}),f.jsx("p",{className:"text-xl font-semibold text-viridian",children:"0.20%"})]})]}),f.jsx("div",{className:"h-[200px]",children:f.jsx(RM,{data:r,options:i})})]})},Ype=[{id:"1",price:122.45,size:1250,type:"buy",time:"12:30:45",exchange:"Raydium"},{id:"2",price:122.43,size:850,type:"sell",time:"12:30:42",exchange:"Jupiter"},{id:"3",price:122.47,size:2100,type:"buy",time:"12:30:38",exchange:"Orca"},{id:"4",price:122.41,size:1500,type:"sell",time:"12:30:35",exchange:"Raydium"},{id:"5",price:122.44,size:950,type:"buy",time:"12:30:31",exchange:"Jupiter"}],Kpe=()=>f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h4",{className:"text-sm text-gray-400",children:"Live Order Flow"}),f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-xs text-gray-400",children:"Buy Volume"}),f.jsx("p",{className:"text-sm text-emerald",children:"4,300"})]}),f.jsxs("div",{children:[f.jsx("p",{className:"text-xs text-gray-400",children:"Sell Volume"}),f.jsx("p",{className:"text-sm text-red-500",children:"2,350"})]})]})]}),f.jsx("div",{className:"space-y-2 h-[300px] overflow-y-auto",children:Ype.map(n=>f.jsxs("div",{className:`p-3 rounded-lg ${n.type==="buy"?"bg-emerald/10 border border-emerald/30":"bg-red-500/10 border border-red-500/30"}`,children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[n.type==="buy"?f.jsx(m3,{className:"text-emerald",size:16}):f.jsx(f3,{className:"text-red-500",size:16}),f.jsxs("span",{className:`font-medium ${n.type==="buy"?"text-emerald":"text-red-500"}`,children:["$",n.price.toFixed(2)]})]}),f.jsx("span",{className:"text-white font-medium",children:n.size.toLocaleString()})]}),f.jsxs("div",{className:"flex justify-between mt-1 text-xs text-gray-400",children:[f.jsx("span",{children:n.exchange}),f.jsx("span",{children:n.time})]})]},n.id))})]}),Zpe=(n,e=50)=>{const t=[],r=n*.1;for(let i=0;i<e;i++){const s=n-r/2+r/e*i,a=Math.random()*1e6+5e5,o=Math.random()>.5?"add":"remove";t.push({price:s,liquidity:a,type:o})}return t},Jpe=()=>{const{isDark:n}=Mc(),t=Zpe(122.45),r={labels:t.map(s=>s.price.toFixed(2)),datasets:[{label:"Added Liquidity",data:t.filter(s=>s.type==="add").map(s=>s.liquidity),borderColor:"rgba(22, 153, 118, 1)",backgroundColor:"rgba(22, 153, 118, 0.1)",fill:!0,tension:.4},{label:"Removed Liquidity",data:t.filter(s=>s.type==="remove").map(s=>s.liquidity),borderColor:"rgba(239, 68, 68, 1)",backgroundColor:"rgba(239, 68, 68, 0.1)",fill:!0,tension:.4}]},i={responsive:!0,maintainAspectRatio:!1,interaction:{intersect:!1,mode:"index"},plugins:{legend:{display:!0,labels:{color:n?"#fff":"#000"}},tooltip:{backgroundColor:n?"rgba(0, 0, 0, 0.8)":"rgba(255, 255, 255, 0.8)",titleColor:n?"#fff":"#000",bodyColor:n?"#fff":"#000",borderColor:"rgba(22, 153, 118, 0.3)",borderWidth:1,callbacks:{label:function(s){return`$${s.raw.toLocaleString()}`}}}},scales:{x:{grid:{display:!1},ticks:{color:n?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.7)",maxRotation:0,callback:function(s){return`$${s}`}}},y:{grid:{color:n?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},ticks:{color:n?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.7)",callback:function(s){return`$${(s/1e6).toFixed(1)}M`}}}}};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"text-sm text-gray-400",children:"Liquidity Analysis"}),f.jsx("p",{className:"text-xl font-semibold text-white",children:"Pool Depth"})]}),f.jsxs("div",{className:"text-right",children:[f.jsx("h4",{className:"text-sm text-gray-400",children:"Total Liquidity"}),f.jsx("p",{className:"text-xl font-semibold text-viridian",children:"$24.5M"})]})]}),f.jsx("div",{className:"h-[300px]",children:f.jsx(Tp,{data:r,options:i})})]})},Qpe=[{id:"1",title:"Solana TVL reaches new all-time high as DeFi activity surges",source:"CryptoNews",time:"2h ago",likes:245,comments:42,shares:86},{id:"2",title:"Major protocol upgrade scheduled for next week",source:"SolanaDaily",time:"4h ago",likes:189,comments:31,shares:54},{id:"3",title:"New DEX launches with innovative AMM model",source:"DeFiPulse",time:"6h ago",likes:156,comments:28,shares:42}],eme=()=>f.jsx("div",{className:"space-y-4 h-[400px] overflow-y-auto",children:Qpe.map(n=>f.jsxs("div",{className:"p-4 rounded-lg bg-black/20 border border-viridian/30 hover:border-viridian/50 transition-colors",children:[f.jsx("h4",{className:"font-medium text-white mb-2",children:n.title}),f.jsxs("div",{className:"flex items-center justify-between text-sm",children:[f.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[f.jsx("span",{children:n.source}),f.jsx("span",{children:""}),f.jsx("span",{children:n.time})]}),f.jsxs("div",{className:"flex items-center gap-4 text-gray-400",children:[f.jsxs("button",{className:"flex items-center gap-1 hover:text-viridian",children:[f.jsx(u0,{size:14}),f.jsx("span",{children:n.likes})]}),f.jsxs("button",{className:"flex items-center gap-1 hover:text-viridian",children:[f.jsx(Oa,{size:14}),f.jsx("span",{children:n.comments})]}),f.jsxs("button",{className:"flex items-center gap-1 hover:text-viridian",children:[f.jsx(ST,{size:14}),f.jsx("span",{children:n.shares})]})]})]})]},n.id))}),tme=[{id:"1",type:"tweet",content:"Solana TVL just hit a new ATH!  The ecosystem is growing faster than ever. $SOL",author:{name:"Crypto Analyst",handle:"@cryptoanalyst",avatar:"https://avatars.githubusercontent.com/u/1?v=4"},timestamp:"1h ago",metrics:{likes:1243,comments:89,shares:312},sentiment:"positive"},{id:"2",type:"discord",content:"New protocol upgrade coming next week. Make sure to update your validators! ",author:{name:"Solana Core",handle:"@solana_core",avatar:"https://avatars.githubusercontent.com/u/2?v=4"},timestamp:"2h ago",metrics:{likes:567,comments:45,shares:123},sentiment:"neutral"},{id:"3",type:"telegram",content:"BONK just announced a major partnership! Check the official channel for details ",author:{name:"SOL News",handle:"@solana_news",avatar:"https://avatars.githubusercontent.com/u/3?v=4"},timestamp:"3h ago",metrics:{likes:892,comments:156,shares:278},sentiment:"positive"}],nme=()=>f.jsx("div",{className:"space-y-4 h-[300px] overflow-y-auto",children:tme.map(n=>f.jsxs("div",{className:"p-4 rounded-lg bg-black/20 border border-viridian/30 hover:border-viridian/50 transition-colors",children:[f.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[f.jsx("img",{src:n.author.avatar,alt:n.author.name,className:"w-10 h-10 rounded-full"}),f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"font-medium text-white",children:n.author.name}),f.jsx("span",{className:"text-gray-400",children:n.author.handle})]}),f.jsx("span",{className:"text-sm text-gray-400",children:n.timestamp})]}),f.jsx("div",{className:`ml-auto px-2 py-1 rounded text-xs font-medium ${n.sentiment==="positive"?"bg-emerald/20 text-emerald":n.sentiment==="negative"?"bg-red-500/20 text-red-500":"bg-gray-500/20 text-gray-400"}`,children:n.sentiment.toUpperCase()})]}),f.jsx("p",{className:"text-white mb-4",children:n.content}),f.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-400",children:[f.jsxs("button",{className:"flex items-center gap-1 hover:text-viridian transition-colors",children:[f.jsx(u0,{size:16}),f.jsx("span",{children:n.metrics.likes})]}),f.jsxs("button",{className:"flex items-center gap-1 hover:text-viridian transition-colors",children:[f.jsx(Oa,{size:16}),f.jsx("span",{children:n.metrics.comments})]}),f.jsxs("button",{className:"flex items-center gap-1 hover:text-viridian transition-colors",children:[f.jsx(ST,{size:16}),f.jsx("span",{children:n.metrics.shares})]}),f.jsxs("button",{className:"flex items-center gap-1 hover:text-viridian transition-colors",children:[f.jsx(Zf,{size:16}),f.jsx("span",{children:"Analytics"})]})]})]},n.id))}),qN=[{id:"1",pattern:"Bull Flag",token:"SOL",confidence:85,timeframe:"4H",type:"bullish",time:"2h ago",description:"Consolidation after strong upward movement suggests continuation"},{id:"2",pattern:"Double Bottom",token:"RAY",confidence:78,timeframe:"1D",type:"bullish",time:"4h ago",description:"Strong support level tested twice with increasing volume"},{id:"3",pattern:"Head & Shoulders",token:"BONK",confidence:82,timeframe:"1H",type:"bearish",time:"1h ago",description:"Classic reversal pattern forming at resistance level"},{id:"4",pattern:"Rising Wedge",token:"JTO",confidence:75,timeframe:"2H",type:"bearish",time:"30m ago",description:"Price approaching apex with declining volume"}],rme=()=>f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(aY,{className:"text-viridian",size:18}),f.jsx("h4",{className:"text-sm text-gray-400",children:"Pattern Alerts"})]}),f.jsxs("div",{className:"text-right",children:[f.jsx("p",{className:"text-xs text-gray-400",children:"Active Alerts"}),f.jsx("p",{className:"text-sm text-white font-medium",children:qN.length})]})]}),f.jsx("div",{className:"space-y-3 h-[300px] overflow-y-auto",children:qN.map(n=>f.jsxs("div",{className:`p-4 rounded-lg ${n.type==="bullish"?"bg-emerald/10 border border-emerald/30":"bg-red-500/10 border border-red-500/30"}`,children:[f.jsxs("div",{className:"flex justify-between items-start mb-2",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"font-medium text-white",children:n.token}),f.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-viridian/20 text-viridian",children:n.timeframe})]}),f.jsx("p",{className:"text-lg font-semibold text-white",children:n.pattern})]}),f.jsxs("div",{className:`flex items-center gap-1 ${n.type==="bullish"?"text-emerald":"text-red-500"}`,children:[n.type==="bullish"?f.jsx(ud,{size:16}):f.jsx(Fv,{size:16}),f.jsxs("span",{children:[n.confidence,"%"]})]})]}),f.jsx("p",{className:"text-sm text-gray-400 mb-2",children:n.description}),f.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[f.jsx(c0,{size:12}),f.jsx("span",{children:n.time})]})]},n.id))})]});_x.register(C1,R1,by,wo,wy,qh,mpe,Spe,fpe,ope);const ime=()=>{const{isDark:n}=Mc(),[e,t]=k.useState(!1),[r,i]=k.useState(!1),[s,a]=k.useState([{id:"price-line",title:"Price History",type:"line",dataType:"price",timeframe:"7D",visible:!0,w:2,h:2},{id:"volume-bar",title:"Volume Analysis",type:"bar",dataType:"volume",timeframe:"24H",visible:!0,w:1,h:2},{id:"market-pie",title:"Market Distribution",type:"pie",dataType:"marketCap",timeframe:"24H",visible:!0,w:1,h:2},{id:"sentiment-scatter",title:"Social Sentiment",type:"scatter",dataType:"sentiment",timeframe:"7D",visible:!0,w:2,h:2}]),o=d=>{const h=["Jan","Feb","Mar","Apr","May","Jun"];switch(d.type){case"line":return{labels:h,datasets:[{label:"Price",data:[65,59,80,81,56,55],borderColor:"rgba(22, 153, 118, 1)",backgroundColor:"rgba(22, 153, 118, 0.1)",borderWidth:2,pointRadius:1,pointHoverRadius:5,tension:.4,fill:!0}]};case"bar":return{labels:h,datasets:[{label:"Volume",data:[12,19,3,5,2,3],backgroundColor:"rgba(22, 153, 118, 0.8)",borderColor:"rgba(22, 153, 118, 1)",borderWidth:1}]};case"pie":return{labels:["SOL","RAY","BONK","JTO","PYTH"],datasets:[{data:[30,20,15,25,10],backgroundColor:["rgba(22, 153, 118, 0.8)","rgba(80, 200, 120, 0.8)","rgba(161, 206, 63, 0.8)","rgba(0, 150, 136, 0.8)","rgba(0, 200, 83, 0.8)"],borderColor:n?"rgba(12, 16, 22, 1)":"rgba(255, 255, 255, 1)",borderWidth:2}]};case"scatter":return{datasets:[{label:"Sentiment vs Price",data:Array.from({length:50},()=>({x:Math.random()*100,y:Math.random()*100})),backgroundColor:"rgba(22, 153, 118, 0.8)"}]};default:return{labels:h,datasets:[{label:"Data",data:[65,59,80,81,56,55],borderColor:"rgba(22, 153, 118, 1)",backgroundColor:"rgba(22, 153, 118, 0.1)"}]}}},l={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"top",labels:{color:n?"#fff":"#000"}},tooltip:{mode:"index",intersect:!1,backgroundColor:n?"rgba(0, 0, 0, 0.8)":"rgba(255, 255, 255, 0.8)",titleColor:n?"#fff":"#000",bodyColor:n?"#fff":"#000",borderColor:"rgba(22, 153, 118, 0.3)",borderWidth:1}},scales:{x:{grid:{display:!1,drawBorder:!1},ticks:{color:n?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.7)"}},y:{grid:{color:n?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)",drawBorder:!1},ticks:{color:n?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.7)"}}}},c=d=>{a(h=>h.map(p=>p.id===d?{...p,visible:!p.visible}:p))},u=d=>{const h=o(d);switch(d.type){case"line":return f.jsx(Tp,{data:h,options:l});case"bar":return f.jsx(RM,{data:h,options:l});case"pie":return f.jsx(Ipe,{data:h,options:l});case"scatter":return f.jsx(jpe,{data:h,options:l});default:return f.jsx(Tp,{data:h,options:l})}};return f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-light-text dark:text-dark-text",children:"Chart Analysis"}),f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("button",{onClick:()=>i(!r),className:`px-4 py-2 rounded-lg text-sm transition-colors ${r?"bg-viridian text-white":"bg-viridian/20 text-viridian"}`,children:r?"Save Layout":"Edit Layout"}),f.jsxs("button",{onClick:()=>t(!0),className:"px-4 py-2 bg-viridian/20 text-viridian rounded-lg text-sm hover:bg-viridian/30 transition-colors flex items-center gap-2",children:[f.jsx(jv,{size:16}),"Customize Charts"]})]})]}),f.jsx("div",{className:"grid grid-cols-3 gap-6",children:s.filter(d=>d.visible).map(d=>f.jsxs("div",{className:`col-span-${d.w} row-span-${d.h} dashboard-card group relative`,children:[r&&f.jsxs("div",{className:"absolute top-0 left-0 right-0 p-1 z-10 flex items-center justify-between bg-viridian/10 dark:bg-viridian/20 dark:border-t dark:border-l dark:border-r dark:border-viridian/70 rounded-t-xl drag-handle cursor-move",children:[f.jsx("div",{className:"text-xs font-medium text-viridian dark:text-viridian px-2",children:d.title}),f.jsx("button",{className:"p-1 text-gray-500 hover:text-red-500 rounded",onClick:()=>c(d.id),children:f.jsx(yr,{size:16})})]}),f.jsxs("div",{className:`h-full ${r?"pt-8":""}`,children:[f.jsxs("div",{className:"flex justify-between items-center mb-4",children:[f.jsx("h3",{className:"text-lg font-semibold text-light-text dark:text-dark-text",children:d.title}),f.jsx("div",{className:"flex items-center gap-2",children:f.jsxs("select",{value:d.timeframe,onChange:h=>{a(p=>p.map(y=>y.id===d.id?{...y,timeframe:h.target.value}:y))},className:"bg-light-bg/90 dark:bg-dark-bg/90 border border-light-border/20 dark:border-viridian/40 rounded px-2 py-1 text-sm text-light-text dark:text-dark-text",children:[f.jsx("option",{value:"24H",children:"24H"}),f.jsx("option",{value:"7D",children:"7D"}),f.jsx("option",{value:"1M",children:"1M"}),f.jsx("option",{value:"3M",children:"3M"})]})})]}),f.jsx("div",{className:"h-[300px]",children:u(d)})]})]},d.id))}),e&&f.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:f.jsxs("div",{className:"bg-[#0C1016] border border-viridian/30 rounded-xl p-6 w-[480px] max-h-[80vh] overflow-y-auto",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h3",{className:"text-xl font-bold text-white",children:"Customize Charts"}),f.jsx("button",{onClick:()=>t(!1),className:"p-2 hover:bg-viridian/10 rounded-lg",children:f.jsx(yr,{size:20,className:"text-viridian"})})]}),f.jsx("div",{className:"space-y-4",children:s.map(d=>f.jsxs("div",{className:"p-4 rounded-lg bg-black/30 border border-viridian/20",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("h4",{className:"font-medium text-white",children:d.title}),f.jsx("button",{onClick:()=>c(d.id),className:"p-2 rounded-lg bg-viridian/10 hover:bg-viridian/20 transition-colors",children:d.visible?f.jsx(mY,{size:18,className:"text-viridian"}):f.jsx(pY,{size:18,className:"text-gray-400"})})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Chart Type"}),f.jsxs("select",{value:d.type,onChange:h=>{a(p=>p.map(y=>y.id===d.id?{...y,type:h.target.value}:y))},className:"w-full bg-black/30 border border-viridian/40 rounded px-3 py-2 text-white",children:[f.jsx("option",{value:"line",children:"Line Chart"}),f.jsx("option",{value:"bar",children:"Bar Chart"}),f.jsx("option",{value:"pie",children:"Pie Chart"}),f.jsx("option",{value:"scatter",children:"Scatter Plot"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Data Type"}),f.jsxs("select",{value:d.dataType,onChange:h=>{a(p=>p.map(y=>y.id===d.id?{...y,dataType:h.target.value}:y))},className:"w-full bg-black/30 border border-viridian/40 rounded px-3 py-2 text-white",children:[f.jsx("option",{value:"price",children:"Price"}),f.jsx("option",{value:"volume",children:"Volume"}),f.jsx("option",{value:"marketCap",children:"Market Cap"}),f.jsx("option",{value:"sentiment",children:"Sentiment"})]})]})]})]},d.id))})]})})]})},sme=()=>{const{user:n}=im();return f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[f.jsx("div",{className:"dashboard-card",children:f.jsx(ZU,{})}),f.jsxs("div",{className:"dashboard-card",children:[f.jsx("h3",{className:"card-title mb-6",children:"Account Information"}),f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsxs("h4",{className:"font-medium text-light-text dark:text-dark-text mb-3 flex items-center gap-2",children:[f.jsx(v3,{size:18,className:"text-viridian"}),"Account Timeline"]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{className:"text-light-subtext dark:text-dark-subtext",children:"Account Created:"}),f.jsx("span",{className:"text-light-text dark:text-dark-text",children:n.joinDate})]}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{className:"text-light-subtext dark:text-dark-subtext",children:"Next Distribution:"}),f.jsx("span",{className:"text-light-text dark:text-dark-text",children:n.nextDistribution})]}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{className:"text-light-subtext dark:text-dark-subtext",children:"Total Distributions:"}),f.jsx("span",{className:"text-light-text dark:text-dark-text",children:"3"})]})]})]}),f.jsxs("div",{className:"pt-4 border-t border-light-border/10 dark:border-viridian/20",children:[f.jsxs("h4",{className:"font-medium text-light-text dark:text-dark-text mb-3 flex items-center gap-2",children:[f.jsx(g3,{size:18,className:"text-viridian"}),"Investment Performance"]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{className:"text-light-subtext dark:text-dark-subtext",children:"Current Value:"}),f.jsxs("span",{className:"text-light-text dark:text-dark-text",children:["$",n.portfolioValue.toLocaleString()]})]}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{className:"text-light-subtext dark:text-dark-subtext",children:"Invested Amount:"}),f.jsxs("span",{className:"text-light-text dark:text-dark-text",children:["$",n.investedAmount.toLocaleString()]})]}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{className:"text-light-subtext dark:text-dark-subtext",children:"Monthly Return:"}),f.jsxs("span",{className:"text-lime dark:text-lime",children:["+",n.monthlyReturn,"%"]})]}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{className:"text-light-subtext dark:text-dark-subtext",children:"All-Time Return:"}),f.jsxs("span",{className:"text-lime dark:text-lime",children:["+",n.allTimeReturn,"%"]})]})]})]})]})]}),f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"dashboard-card",children:[f.jsxs("h3",{className:"card-title mb-4 flex items-center gap-2",children:[f.jsx(jv,{size:20,className:"text-viridian"}),"Account Settings"]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-center p-3 rounded-lg bg-light-bg/80 dark:bg-forest/60 border border-emerald/10 dark:border-emerald/20",children:[f.jsx("span",{className:"text-light-text dark:text-dark-text",children:"Email Notifications"}),f.jsx("div",{className:"relative inline-block w-10 h-6 rounded-full bg-viridian/30",children:f.jsx("div",{className:"absolute left-1 top-1 w-4 h-4 rounded-full bg-viridian transition-all"})})]}),f.jsxs("div",{className:"flex justify-between items-center p-3 rounded-lg bg-light-bg/80 dark:bg-forest/60 border border-emerald/10 dark:border-emerald/20",children:[f.jsx("span",{className:"text-light-text dark:text-dark-text",children:"Trading Signals"}),f.jsx("div",{className:"relative inline-block w-10 h-6 rounded-full bg-viridian/30",children:f.jsx("div",{className:"absolute left-5 top-1 w-4 h-4 rounded-full bg-viridian transition-all"})})]}),f.jsxs("div",{className:"flex justify-between items-center p-3 rounded-lg bg-light-bg/80 dark:bg-forest/60 border border-emerald/10 dark:border-emerald/20",children:[f.jsx("span",{className:"text-light-text dark:text-dark-text",children:"Distribution Alerts"}),f.jsx("div",{className:"relative inline-block w-10 h-6 rounded-full bg-viridian/30",children:f.jsx("div",{className:"absolute left-5 top-1 w-4 h-4 rounded-full bg-viridian transition-all"})})]})]})]}),f.jsxs("div",{className:"dashboard-card",children:[f.jsxs("h3",{className:"card-title mb-4 flex items-center gap-2",children:[f.jsx(b3,{size:20,className:"text-viridian"}),"Security"]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-light-text dark:text-dark-text",children:"Two-Factor Authentication"}),f.jsx("button",{className:"text-sm bg-viridian/20 text-viridian px-3 py-1 rounded",children:"Enable"})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-light-text dark:text-dark-text",children:"Password"}),f.jsx("button",{className:"text-sm bg-viridian/20 text-viridian px-3 py-1 rounded",children:"Change"})]}),f.jsx("div",{className:"mt-4 pt-4 border-t border-light-border/10 dark:border-viridian/20",children:f.jsx("button",{className:"secondary-btn w-full",children:"Manage Payment Methods"})})]})]})]})]})},Rh=[{id:"sig-001",token:"Solana",symbol:"SOL",image:"https://assets.coingecko.com/coins/images/4128/large/solana.png",price:"$122.45",action:"BUY",confidence:87,timestamp:"2025-06-30T08:25:00Z",timeframe:"4H",analysis:"Solana is showing strong bullish momentum with increasing volume and positive on-chain metrics. Significant whale accumulation detected in the last 24 hours suggests a potential breakout above the $130 resistance level.",pnl:{daily:3.6,weekly:12.5,monthly:28.4},risk:{conservative:{entryPrice:"$122.45",targetPrice:"$146.94",stopLoss:"$110.20",potentialGain:"20%",riskReward:"2.0"},moderate:{entryPrice:"$122.45",targetPrice:"$183.67",stopLoss:"$110.20",potentialGain:"50%",riskReward:"4.1"},aggressive:{entryPrice:"$122.45",targetPrice:"$244.90",stopLoss:"$110.20",potentialGain:"100%",riskReward:"8.2"}},success:!0,status:"ACTIVE"},{id:"sig-002",token:"Raydium",symbol:"RAY",image:"https://assets.coingecko.com/coins/images/13928/large/PSigc4ie_400x400.jpg",price:"$0.8740",action:"BUY",confidence:73,timestamp:"2025-06-30T06:12:00Z",timeframe:"1D",analysis:"Raydium is forming a potential reversal pattern at a strong support level. Technical indicators suggest oversold conditions and a potential bounce. Increased DEX volumes indicate growing interest.",pnl:{daily:-1.2,weekly:8.7,monthly:15.3},risk:{conservative:{entryPrice:"$0.8740",targetPrice:"$1.0488",stopLoss:"$0.8130",potentialGain:"20%",riskReward:"3.3"},moderate:{entryPrice:"$0.8740",targetPrice:"$1.3110",stopLoss:"$0.8130",potentialGain:"50%",riskReward:"8.2"},aggressive:{entryPrice:"$0.8740",targetPrice:"$1.7480",stopLoss:"$0.8130",potentialGain:"100%",riskReward:"16.5"}},success:!0,status:"ACTIVE"},{id:"sig-003",token:"Pyth Network",symbol:"PYTH",image:"https://assets.coingecko.com/coins/images/27055/large/pyth-200x200.png",price:"$0.5420",action:"BUY",confidence:82,timestamp:"2025-06-29T21:45:00Z",timeframe:"4H",analysis:"PYTH is breaking out of a consolidation phase with high volume. Recent protocol upgrades and growing adoption as an oracle provider indicate strong fundamentals.",pnl:{daily:7.2,weekly:15.4,monthly:24.8},risk:{conservative:{entryPrice:"$0.5420",targetPrice:"$0.6504",stopLoss:"$0.4880",potentialGain:"20%",riskReward:"2.3"},moderate:{entryPrice:"$0.5420",targetPrice:"$0.8130",stopLoss:"$0.4880",potentialGain:"50%",riskReward:"5.9"},aggressive:{entryPrice:"$0.5420",targetPrice:"$1.0840",stopLoss:"$0.4880",potentialGain:"100%",riskReward:"11.7"}},success:!0,status:"ACTIVE",userBought:!0,userAmount:1850,userPnl:7.2},{id:"sig-004",token:"Bonk",symbol:"BONK",image:"https://assets.coingecko.com/coins/images/28600/large/bonk.png",price:"$0.00002953",action:"SELL",confidence:65,timestamp:"2025-06-29T18:30:00Z",timeframe:"1D",analysis:"BONK is showing signs of exhaustion after a strong rally. Social sentiment metrics indicate potential short-term cooling off. Consider taking profits or reducing exposure temporarily.",pnl:{daily:-2.1,weekly:33.5,monthly:65.7},risk:{conservative:{entryPrice:"$0.00002953",targetPrice:"$0.00002362",stopLoss:"$0.00003100",potentialGain:"20%",riskReward:"3.4"},moderate:{entryPrice:"$0.00002953",targetPrice:"$0.00001476",stopLoss:"$0.00003100",potentialGain:"50%",riskReward:"8.5"},aggressive:{entryPrice:"$0.00002953",targetPrice:"$0.00000000",stopLoss:"$0.00003100",potentialGain:"100%",riskReward:"20.7"}},success:!1,status:"COMPLETED"},{id:"sig-005",token:"Jito",symbol:"JTO",image:"https://assets.coingecko.com/coins/images/33969/large/jito.jpeg",price:"$3.24",action:"BUY",confidence:78,timestamp:"2025-06-29T14:15:00Z",timeframe:"12H",analysis:"JTO is forming a bullish pattern after recent protocol upgrades. MEV value captured is increasing, suggesting growing demand for the token in the Solana ecosystem.",pnl:{daily:3.8,weekly:9.7,monthly:17.5},risk:{conservative:{entryPrice:"$3.24",targetPrice:"$3.88",stopLoss:"$2.91",potentialGain:"20%",riskReward:"2.5"},moderate:{entryPrice:"$3.24",targetPrice:"$4.86",stopLoss:"$2.91",potentialGain:"50%",riskReward:"6.2"},aggressive:{entryPrice:"$3.24",targetPrice:"$6.48",stopLoss:"$2.91",potentialGain:"100%",riskReward:"12.4"}},success:!0,status:"ACTIVE",userBought:!0,userAmount:250,userPnl:3.8}],ame=()=>{const{user:n}=im(),[e,t]=k.useState("1D"),[r,i]=k.useState(Rh[0]),[s,a]=k.useState("moderate"),[o,l]=k.useState(!1),[c,u]=k.useState("1000"),h=(()=>{const g={daily:0,weekly:0,monthly:0,totalSignals:Rh.length,successRate:0};let m=0;return Rh.forEach(x=>{g.daily+=x.pnl.daily,g.weekly+=x.pnl.weekly,g.monthly+=x.pnl.monthly,x.success&&m++}),g.successRate=m/Rh.length*100,g})(),p=g=>{const m=new Date(g),_=new Date().getTime()-m.getTime(),b=Math.round(_/6e4);return b<60?`${b}m ago`:b<1440?`${Math.floor(b/60)}h ago`:`${Math.floor(b/1440)}d ago`},y=()=>{l(!1),console.log(`User ${n.id} bought ${c} of ${r.symbol} at ${r.risk[s].entryPrice}`)},v=g=>{const m=g.target.value;(m===""||/^\d*\.?\d*$/.test(m))&&u(m)};return f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[f.jsxs("div",{className:"lg:col-span-3 dashboard-card",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-light-text dark:text-dark-text",children:"Trading Signals Performance"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("button",{onClick:()=>t("1D"),className:`px-3 py-1 rounded-md ${e==="1D"?"bg-viridian/20 dark:bg-viridian/30 text-viridian dark:text-viridian dark:border dark:border-viridian/70":"text-light-subtext dark:text-dark-subtext"}`,children:"Daily"}),f.jsx("button",{onClick:()=>t("7D"),className:`px-3 py-1 rounded-md ${e==="7D"?"bg-viridian/20 dark:bg-viridian/30 text-viridian dark:text-viridian dark:border dark:border-viridian/70":"text-light-subtext dark:text-dark-subtext"}`,children:"Weekly"}),f.jsx("button",{onClick:()=>t("30D"),className:`px-3 py-1 rounded-md ${e==="30D"?"bg-viridian/20 dark:bg-viridian/30 text-viridian dark:text-viridian dark:border dark:border-viridian/70":"text-light-subtext dark:text-dark-subtext"}`,children:"Monthly"})]})]}),f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 mb-6",children:[f.jsxs("div",{className:"p-4 rounded-lg bg-light-bg/80 dark:bg-forest/60 border border-emerald/10 dark:border-emerald/20",children:[f.jsx("p",{className:"text-light-subtext dark:text-dark-subtext text-sm mb-1",children:"Daily PnL"}),f.jsxs("p",{className:`text-2xl font-semibold ${h.daily>=0?"text-lime dark:text-lime":"text-red-500 dark:text-red-400"}`,children:[h.daily>=0?"+":"",h.daily.toFixed(2),"%"]})]}),f.jsxs("div",{className:"p-4 rounded-lg bg-light-bg/80 dark:bg-forest/60 border border-emerald/10 dark:border-emerald/20",children:[f.jsx("p",{className:"text-light-subtext dark:text-dark-subtext text-sm mb-1",children:"Weekly PnL"}),f.jsxs("p",{className:`text-2xl font-semibold ${h.weekly>=0?"text-lime dark:text-lime":"text-red-500 dark:text-red-400"}`,children:[h.weekly>=0?"+":"",h.weekly.toFixed(2),"%"]})]}),f.jsxs("div",{className:"p-4 rounded-lg bg-light-bg/80 dark:bg-forest/60 border border-emerald/10 dark:border-emerald/20",children:[f.jsx("p",{className:"text-light-subtext dark:text-dark-subtext text-sm mb-1",children:"Monthly PnL"}),f.jsxs("p",{className:`text-2xl font-semibold ${h.monthly>=0?"text-lime dark:text-lime":"text-red-500 dark:text-red-400"}`,children:[h.monthly>=0?"+":"",h.monthly.toFixed(2),"%"]})]}),f.jsxs("div",{className:"p-4 rounded-lg bg-light-bg/80 dark:bg-forest/60 border border-emerald/10 dark:border-emerald/20",children:[f.jsx("p",{className:"text-light-subtext dark:text-dark-subtext text-sm mb-1",children:"Success Rate"}),f.jsxs("p",{className:"text-2xl font-semibold text-lime dark:text-lime",children:[h.successRate.toFixed(1),"%"]}),f.jsxs("p",{className:"text-xs text-light-subtext dark:text-dark-subtext",children:[h.totalSignals," signals total"]})]})]})]}),f.jsxs("div",{className:"dashboard-card overflow-hidden",children:[f.jsxs("h3",{className:"card-title mb-6 flex items-center gap-2",children:[f.jsx(Pd,{size:20,className:"text-viridian"}),"Latest Trading Signals"]}),f.jsx("div",{className:"space-y-3 max-h-[700px] overflow-y-auto pr-2",children:Rh.map(g=>f.jsxs("div",{className:`p-4 rounded-lg cursor-pointer transition-all duration-200 ${r.id===g.id?"bg-viridian/10 dark:bg-viridian/20 border border-viridian/30 dark:border-viridian/70":"bg-light-bg/80 dark:bg-forest/60 border border-emerald/10 dark:border-emerald/20 hover:border-viridian/30 dark:hover:border-viridian/50"}`,onClick:()=>i(g),children:[f.jsxs("div",{className:"flex justify-between items-center mb-2",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[g.image?f.jsx("img",{src:g.image,alt:g.symbol,className:"w-8 h-8 rounded-full"}):f.jsx("div",{className:"w-8 h-8 rounded-full bg-viridian/20 flex items-center justify-center text-xs font-bold text-viridian",children:g.symbol.charAt(0)}),f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("span",{className:"font-semibold text-light-text dark:text-dark-text",children:g.symbol}),g.userBought&&f.jsxs("div",{className:"px-1.5 py-0.5 bg-viridian/20 text-viridian text-xs rounded-sm flex items-center",children:[f.jsx(_C,{size:10,className:"mr-1"}),"BOUGHT"]})]}),f.jsx("p",{className:"text-xs text-light-subtext dark:text-dark-subtext",children:g.token})]})]}),f.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full ${g.action==="BUY"?"bg-lime/20 text-lime":"bg-red-500/20 text-red-600 dark:text-red-400"}`,children:g.action})]}),f.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[f.jsxs("span",{className:"text-light-subtext dark:text-dark-subtext",children:["Price: ",g.price]}),f.jsxs("span",{className:"text-light-subtext dark:text-dark-subtext",children:[f.jsx(c0,{size:12,className:"inline mr-1"}),p(g.timestamp)]})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("div",{className:"flex items-center",children:f.jsx("span",{className:"text-xs py-0.5 px-1.5 rounded bg-viridian/10 dark:bg-viridian/20 text-viridian",children:g.timeframe})}),f.jsx("div",{className:"flex items-center",children:f.jsxs("span",{className:`text-xs flex items-center ${g.pnl.daily>=0?"text-lime dark:text-lime":"text-red-500 dark:text-red-400"}`,children:[g.pnl.daily>=0?f.jsx(ud,{size:12,className:"mr-1"}):f.jsx(Fv,{size:12,className:"mr-1"}),g.pnl.daily>=0?"+":"",g.pnl.daily.toFixed(1),"%"]})})]}),g.userBought&&f.jsxs("div",{className:"mt-2 pt-2 border-t border-light-border/10 dark:border-viridian/20",children:[f.jsxs("div",{className:"flex justify-between text-xs",children:[f.jsx("span",{className:"text-light-subtext dark:text-dark-subtext",children:"Your position:"}),f.jsxs("span",{className:"text-light-text dark:text-dark-text",children:[g.userAmount," ",g.symbol]})]}),f.jsxs("div",{className:"flex justify-between text-xs",children:[f.jsx("span",{className:"text-light-subtext dark:text-dark-subtext",children:"Your PnL:"}),f.jsxs("span",{className:`${g.userPnl>=0?"text-lime dark:text-lime":"text-red-500 dark:text-red-400"}`,children:[g.userPnl>=0?"+":"",g.userPnl.toFixed(1),"%"]})]})]})]},g.id))})]}),f.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[f.jsxs("div",{className:"dashboard-card",children:[f.jsxs("div",{className:"flex justify-between items-start mb-6",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[r.image?f.jsx("img",{src:r.image,alt:r.symbol,className:"w-12 h-12 rounded-full"}):f.jsx("div",{className:"w-12 h-12 rounded-full bg-viridian/20 flex items-center justify-center text-lg font-bold text-viridian",children:r.symbol.charAt(0)}),f.jsxs("div",{children:[f.jsxs("h3",{className:"text-2xl font-bold text-light-text dark:text-dark-text flex items-center gap-2",children:[r.symbol,f.jsx("span",{className:`text-sm px-2 py-0.5 rounded-full ${r.action==="BUY"?"bg-lime/20 text-lime":"bg-red-500/20 text-red-600 dark:text-red-400"}`,children:r.action})]}),f.jsx("p",{className:"text-light-subtext dark:text-dark-subtext",children:r.token})]})]}),f.jsxs("div",{className:"flex flex-col items-end",children:[f.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[f.jsx(RY,{size:16,className:"text-yellow-400 fill-yellow-400"}),f.jsxs("span",{className:"text-light-text dark:text-dark-text font-medium",children:[r.confidence,"% Confidence"]})]}),f.jsxs("p",{className:"text-light-subtext dark:text-dark-subtext text-sm flex items-center",children:[f.jsx(c0,{size:14,className:"mr-1"}),p(r.timestamp),"  ",r.timeframe," timeframe"]})]})]}),f.jsxs("div",{className:"mb-6",children:[f.jsx("h4",{className:"font-medium text-light-text dark:text-dark-text mb-2",children:"AI Analysis"}),f.jsx("p",{className:"text-light-subtext dark:text-dark-subtext",children:r.analysis})]}),f.jsxs("div",{className:"mb-6",children:[f.jsx("h4",{className:"font-medium text-light-text dark:text-dark-text mb-3",children:"Performance"}),f.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[f.jsxs("div",{className:"p-3 rounded-lg bg-light-bg/80 dark:bg-forest/60 border border-emerald/10 dark:border-emerald/20",children:[f.jsx("p",{className:"text-light-subtext dark:text-dark-subtext text-xs mb-1",children:"Daily"}),f.jsxs("p",{className:`text-xl font-semibold ${r.pnl.daily>=0?"text-lime dark:text-lime":"text-red-500 dark:text-red-400"}`,children:[r.pnl.daily>=0?"+":"",r.pnl.daily.toFixed(1),"%"]})]}),f.jsxs("div",{className:"p-3 rounded-lg bg-light-bg/80 dark:bg-forest/60 border border-emerald/10 dark:border-emerald/20",children:[f.jsx("p",{className:"text-light-subtext dark:text-dark-subtext text-xs mb-1",children:"Weekly"}),f.jsxs("p",{className:`text-xl font-semibold ${r.pnl.weekly>=0?"text-lime dark:text-lime":"text-red-500 dark:text-red-400"}`,children:[r.pnl.weekly>=0?"+":"",r.pnl.weekly.toFixed(1),"%"]})]}),f.jsxs("div",{className:"p-3 rounded-lg bg-light-bg/80 dark:bg-forest/60 border border-emerald/10 dark:border-emerald/20",children:[f.jsx("p",{className:"text-light-subtext dark:text-dark-subtext text-xs mb-1",children:"Monthly"}),f.jsxs("p",{className:`text-xl font-semibold ${r.pnl.monthly>=0?"text-lime dark:text-lime":"text-red-500 dark:text-red-400"}`,children:[r.pnl.monthly>=0?"+":"",r.pnl.monthly.toFixed(1),"%"]})]})]})]})]}),f.jsxs("div",{className:"dashboard-card",children:[f.jsxs("h3",{className:"card-title mb-6 flex items-center gap-2",children:[f.jsx(OY,{size:20,className:"text-viridian"}),"Entry & Exit Targets"]}),o?f.jsxs("div",{className:"space-y-4",children:[f.jsxs("h4",{className:"font-medium text-light-text dark:text-dark-text",children:[r.action==="BUY"?"Buy":"Sell"," ",r.symbol," (",r.risk[s].potentialGain," potential gain)"]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsxs("label",{className:"text-sm text-light-subtext dark:text-dark-subtext block mb-2",children:["Enter ",r.action==="BUY"?"buy":"sell"," amount:"]}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-light-subtext dark:text-dark-subtext",children:f.jsx(fY,{size:18})}),f.jsx("input",{type:"text",value:c,onChange:v,className:"w-full bg-light-bg/90 dark:bg-dark-bg/90 border border-light-border/20 dark:border-viridian/40 rounded-lg py-3 pl-10 pr-4 text-light-text dark:text-dark-text focus:outline-none focus:border-viridian/40 dark:focus:border-viridian/70"})]})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-3 bg-light-bg/80 dark:bg-forest/60 rounded-lg p-5 mb-3",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-xs text-light-subtext dark:text-dark-subtext mb-1",children:"Entry Price"}),f.jsx("p",{className:"text-light-text dark:text-dark-text font-medium",children:r.risk[s].entryPrice})]}),f.jsxs("div",{children:[f.jsx("p",{className:"text-xs text-light-subtext dark:text-dark-subtext mb-1",children:"Target Price"}),f.jsx("p",{className:"text-lime dark:text-lime font-medium",children:r.risk[s].targetPrice})]}),f.jsxs("div",{children:[f.jsx("p",{className:"text-xs text-light-subtext dark:text-dark-subtext mb-1",children:"Stop Loss"}),f.jsx("p",{className:"text-red-500 dark:text-red-400 font-medium",children:r.risk[s].stopLoss})]}),f.jsxs("div",{children:[f.jsx("p",{className:"text-xs text-light-subtext dark:text-dark-subtext mb-1",children:"Risk Level"}),f.jsx("p",{className:"text-light-text dark:text-dark-text font-medium capitalize",children:s})]})]}),f.jsx("p",{className:"text-xs text-light-subtext dark:text-dark-subtext mb-2",children:"Note: By executing this trade, you confirm that you understand the risks involved and are following the trade signal as recommended by the AI."}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2",children:[f.jsx("button",{className:"secondary-btn py-3",onClick:()=>l(!1),children:"CANCEL"}),f.jsxs("button",{className:"primary-btn py-3",onClick:y,children:["CONFIRM ",r.action]})]})]})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[f.jsxs("button",{onClick:()=>a("conservative"),className:`flex-1 p-4 text-center rounded-lg border ${s==="conservative"?"bg-viridian/10 dark:bg-viridian/20 border-viridian text-viridian dark:border-viridian":"border-light-border/10 dark:border-dark-border/30"}`,children:[f.jsx("div",{className:"text-base font-medium mb-1",children:"Conservative"}),f.jsx("div",{className:"text-sm text-light-subtext dark:text-dark-subtext",children:"20% Gain"})]}),f.jsxs("button",{onClick:()=>a("moderate"),className:`flex-1 p-4 text-center rounded-lg border ${s==="moderate"?"bg-viridian/10 dark:bg-viridian/20 border-viridian text-viridian dark:border-viridian":"border-light-border/10 dark:border-dark-border/30"}`,children:[f.jsx("div",{className:"text-base font-medium mb-1",children:"Moderate"}),f.jsx("div",{className:"text-sm text-light-subtext dark:text-dark-subtext",children:"50% Gain"})]}),f.jsxs("button",{onClick:()=>a("aggressive"),className:`flex-1 p-4 text-center rounded-lg border ${s==="aggressive"?"bg-viridian/10 dark:bg-viridian/20 border-viridian text-viridian dark:border-viridian":"border-light-border/10 dark:border-dark-border/30"}`,children:[f.jsx("div",{className:"text-base font-medium mb-1",children:"XBT Full Send"}),f.jsx("div",{className:"text-sm text-light-subtext dark:text-dark-subtext",children:"100% Gain"})]})]}),f.jsx("div",{className:"bg-light-bg/80 dark:bg-forest/60 rounded-lg p-6 mb-8",children:f.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-4",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-light-subtext dark:text-dark-subtext mb-1",children:"Entry Price"}),f.jsx("p",{className:"text-xl text-light-text dark:text-dark-text font-medium",children:r.risk[s].entryPrice})]}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-light-subtext dark:text-dark-subtext mb-1",children:"Target Price"}),f.jsx("p",{className:"text-xl text-lime dark:text-lime font-medium",children:r.risk[s].targetPrice})]}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-light-subtext dark:text-dark-subtext mb-1",children:"Stop Loss"}),f.jsx("p",{className:"text-xl text-red-500 dark:text-red-400 font-medium",children:r.risk[s].stopLoss})]}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-light-subtext dark:text-dark-subtext mb-1",children:"Potential Gain"}),f.jsx("p",{className:"text-xl text-lime dark:text-lime font-medium",children:r.risk[s].potentialGain})]}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-light-subtext dark:text-dark-subtext mb-1",children:"Risk/Reward Ratio"}),f.jsx("p",{className:"text-xl text-light-text dark:text-dark-text font-medium",children:r.risk[s].riskReward})]}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-light-subtext dark:text-dark-subtext mb-1",children:"Timeframe"}),f.jsx("p",{className:"text-xl text-light-text dark:text-dark-text font-medium",children:r.timeframe})]})]})}),r.userBought?f.jsxs("div",{className:"bg-viridian/10 dark:bg-viridian/20 rounded-lg p-6 border border-viridian/30 dark:border-viridian/40 mb-2",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("h4",{className:"font-medium text-viridian dark:text-viridian flex items-center gap-2",children:[f.jsx(_C,{size:18}),"Your Position"]}),f.jsx("div",{className:"px-2 py-0.5 bg-viridian/20 dark:bg-viridian/30 rounded text-xs text-viridian",children:"ACTIVE"})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-3 mb-6",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-xs text-viridian/70 dark:text-viridian/70 mb-1",children:"Amount"}),f.jsxs("p",{className:"text-light-text dark:text-dark-text font-medium",children:[r.userAmount," ",r.symbol]})]}),f.jsxs("div",{children:[f.jsx("p",{className:"text-xs text-viridian/70 dark:text-viridian/70 mb-1",children:"Entry Price"}),f.jsx("p",{className:"text-light-text dark:text-dark-text font-medium",children:r.risk[s].entryPrice})]}),f.jsxs("div",{children:[f.jsx("p",{className:"text-xs text-viridian/70 dark:text-viridian/70 mb-1",children:"Current PnL"}),f.jsxs("p",{className:`font-medium ${r.userPnl>=0?"text-lime dark:text-lime":"text-red-500 dark:text-red-400"}`,children:[r.userPnl>=0?"+":"",r.userPnl.toFixed(2),"%"]})]}),f.jsxs("div",{children:[f.jsx("p",{className:"text-xs text-viridian/70 dark:text-viridian/70 mb-1",children:"Risk Level"}),f.jsx("p",{className:"text-light-text dark:text-dark-text font-medium capitalize",children:s})]})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsx("button",{className:"secondary-btn py-3",children:"INCREASE POSITION"}),f.jsx("button",{className:"primary-btn py-3",children:"CLOSE POSITION"})]})]}):f.jsx("button",{className:"primary-btn w-full py-4 flex items-center justify-center gap-2 text-base mt-2",onClick:()=>l(!0),children:r.action==="BUY"?f.jsxs(f.Fragment,{children:[f.jsx(m3,{size:20}),"BUY ",r.symbol," NOW"]}):f.jsxs(f.Fragment,{children:[f.jsx(f3,{size:20}),"SELL ",r.symbol," NOW"]})})]})]})]})]})},ome=()=>{const{isLoading:n,chatHistory:e,directChatHistory:t,addUserMessage:r,useDirectAnthropicAPI:i}=Fd(),{user:s}=$s(),[a,o]=k.useState(""),[l,c]=k.useState([{role:"ai",content:`Welcome to TradesXBT - Your Degen Market Analyst. Ask me anything about market conditions, technical analysis, or trading strategies.
Current SOL price: $170.93`,timestamp:new Date}]),[u,d]=k.useState(!1),h=k.useRef(null),p=k.useRef(null);k.useEffect(()=>{if(!i&&e.length>0){const m=[l[0]];e.forEach(x=>{x._getType()==="human"?m.push({role:"user",content:x.content,timestamp:new Date}):x._getType()==="ai"&&m.push({role:"ai",content:x.content,timestamp:new Date})}),c(m)}},[e,i]),k.useEffect(()=>{if(i&&t.length>0){const m=[l[0]];t.forEach(x=>{m.push({role:x.role==="user"?"user":"ai",content:x.content,timestamp:new Date})}),c(m)}},[t,i]),k.useEffect(()=>{const m=h.current;if(!m)return;const x=()=>{if(!m)return;const{scrollTop:_,scrollHeight:b,clientHeight:w}=m,E=b-_-w<100;d(!E)};return m.addEventListener("scroll",x),()=>m.removeEventListener("scroll",x)},[]),k.useEffect(()=>{const m=h.current;if(!m)return;const{scrollTop:x,scrollHeight:_,clientHeight:b}=m;(_-x-b<100||n)&&y()},[l,n]);const y=()=>{var m;(m=p.current)==null||m.scrollIntoView({behavior:"smooth"}),d(!1)},v=async m=>{if(m.preventDefault(),!a.trim()||n||!s)return;c(_=>[..._,{role:"user",content:a,timestamp:new Date}]);const x=a;o(""),y(),await r(x)},g=m=>{var w;const x=/Sentiment Score: (\d+)\/100/i,_=/(BEARISH |DYOR |BULLISH )/i,b=/(APE IN SIGNAL )/i;if(x.test(m)&&_.test(m)){const E=m.split(/(Sentiment Score: \d+\/100)/i);if(E.length>=2){const M=(w=E[1].match(/\d+/))==null?void 0:w[0];let N=m.match(_);const T=N?N[0]:"";let P=m.match(b);const H=P?P[0]:"";let W="";return T.includes("BEARISH")?W="text-red-500 dark:text-red-400":T.includes("DYOR")?W="text-yellow-500 dark:text-yellow-400":T.includes("BULLISH")&&(W="text-lime dark:text-lime"),f.jsxs("div",{className:"whitespace-pre-line",children:[E[0],f.jsxs("div",{className:"my-2 p-3 bg-viridian/10 dark:bg-viridian/20 rounded-lg border border-viridian/30",children:[f.jsxs("div",{className:"font-semibold",children:["Sentiment Score: ",f.jsxs("span",{className:"text-viridian",children:[M,"/100"]})]}),f.jsx("div",{className:`font-bold text-lg ${W}`,children:T}),H&&f.jsx("div",{className:"font-bold text-lg text-viridian mt-1",children:H})]}),E.slice(2).join("")]})}}return f.jsx("div",{className:"whitespace-pre-line",children:m})};return f.jsxs("div",{className:"flex flex-col h-full relative",children:[f.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0 opacity-20",children:[f.jsx("div",{className:"circuit-line horizontal-line-1"}),f.jsx("div",{className:"circuit-line horizontal-line-2"}),f.jsx("div",{className:"circuit-line vertical-line-1"}),f.jsx("div",{className:"circuit-line vertical-line-2"}),f.jsx("div",{className:"circuit-node node-1"}),f.jsx("div",{className:"circuit-node node-2"}),f.jsx("div",{className:"circuit-node node-3"}),f.jsx("div",{className:"circuit-node node-4"})]}),f.jsxs("div",{ref:h,className:"flex-1 overflow-y-auto py-6 px-8 space-y-6 relative circuit-container",children:[l.map((m,x)=>f.jsx("div",{className:`flex ${m.role==="user"?"justify-end":"justify-start"}`,children:f.jsx("div",{className:`max-w-[80%] rounded-lg p-4 message-box ${m.role==="user"?"user-message circuit-pulse bg-viridian/10 text-white":"ai-message circuit-glow bg-[#171717] text-white"}`,children:m.role==="ai"?g(m.content):f.jsx("div",{className:"whitespace-pre-line",children:m.content})})},x)),n&&f.jsx("div",{className:"flex justify-start",children:f.jsx("div",{className:"bg-[#171717] border border-viridian/30 rounded-lg p-4 typing-indicator-container",children:f.jsxs("div",{className:"typing-indicator",children:[f.jsx("span",{}),f.jsx("span",{}),f.jsx("span",{})]})})}),f.jsx("div",{ref:p})]}),u&&f.jsx("button",{onClick:y,className:"scroll-button circuit-pulse-subtle","aria-label":"Scroll to bottom",children:f.jsx(wT,{size:20})}),f.jsxs("div",{className:"p-4 border-t border-viridian/30 relative z-10",children:[f.jsxs("form",{onSubmit:v,className:"bg-[#171717] border border-viridian/40 rounded-lg p-1 flex",children:[f.jsx("input",{type:"text",value:a,onChange:m=>o(m.target.value),placeholder:"Ask about market analysis...",className:"flex-1 bg-transparent px-4 py-2.5 text-white placeholder:text-gray-500 focus:outline-none",disabled:n||!s}),f.jsxs("button",{type:"submit",className:"p-2.5 rounded-lg bg-viridian hover:bg-viridian/90 text-white disabled:opacity-50 send-button",disabled:!a.trim()||n||!s,children:["Send",f.jsx(FS,{size:16,className:"ml-2 inline-block"})]})]}),!s&&f.jsx("p",{className:"text-center text-red-400 text-xs mt-2",children:"Please log in to chat with the AI assistant"})]})]})},Eo=new Map,lme=()=>`req_${Date.now()}_${Math.random().toString(36).substring(2,9)}`,rw=(n,e)=>{const t=new CustomEvent("ai_task_event",{detail:{type:n,payload:e}});window.dispatchEvent(t)},XN=n=>{if(Eo.has(n.requestId)){const e=Eo.get(n.requestId);e&&(e.response=n,e.status="completed",Eo.set(n.requestId,e))}},YN=async n=>new Promise((e,t)=>{const r=2e3+Math.random()*(n.text.length>100?5e3:3e3);setTimeout(()=>{if(Math.random()>.95){t(new Error("Failed to process request: The server is currently experiencing high load. Please try again."));return}let i="";n.text.toLowerCase().includes("bitcoin")||n.text.toLowerCase().includes("btc")?i=`
Analysis of Bitcoin (BTC):

Current market conditions show Bitcoin trading in a consolidation pattern after recent volatility. Technical indicators suggest:

1. RSI: 58 (neutral but trending positive)
2. MACD: Bullish crossover forming
3. Support levels: $34,200, $32,800
4. Resistance levels: $36,500, $38,200

Volume has been increasing on upward movements, which is a positive sign. The 50-day moving average is now providing support at $33,400.

Sentiment Score: 72/100
Recommendation: BULLISH

There appears to be accumulation happening at current levels, suggesting institutional interest remains strong.
`:n.text.toLowerCase().includes("solana")||n.text.toLowerCase().includes("sol")?i=`
Analysis of Solana (SOL):

SOL has shown remarkable strength relative to the broader market, with significant development activity and growing DeFi TVL.

Technical analysis:
1. RSI: 73 (approaching overbought territory)
2. MACD: Strong positive momentum but extended
3. Support levels: $148.50, $138.20
4. Resistance levels: $165.00, $172.80

On-chain metrics show increasing daily active addresses, suggesting strong user adoption. However, the current price level might see short-term resistance.

Sentiment Score: 84/100
Recommendation: BULLISH (with caution on entry points)

APE IN SIGNAL: SOL's technicals combined with ecosystem growth make it a high-conviction opportunity for the next 30-45 days.
`:n.importedData&&Object.keys(n.importedData).length>0?i=`I've analyzed the data you provided from ${Object.keys(n.importedData).length} data sources. 

Key insights from your imported data:
${Object.keys(n.importedData).map(a=>`- ${a}: Found interesting patterns in the ${Object.keys(n.importedData[a]).length} metrics provided`).join(`
`)}

Based on this analysis, I recommend monitoring these key indicators closely as they show potential signals for market movement in the next 24-48 hours.

Sentiment Score: 65/100
Recommendation: DYOR

The data suggests moderate opportunity with defined risk parameters.`:i=`Response to: ${n.text}

I've analyzed your request and found several key points to consider:

1. Market conditions currently show mixed signals with a slight bullish bias
2. Volatility indicators suggest preparing for increased price action in the coming week
3. Sentiment analysis from social media shows growing interest but remains below peak levels

For specific trading recommendations, please provide a token or asset name for detailed analysis.

Sentiment Score: 58/100
Recommendation: DYOR
`;const s={id:`resp_${Date.now()}`,requestId:n.id,content:i.trim(),timestamp:Date.now()};e(s)},r)}),cme=async(n,e=null,t=!1)=>{const r=lme(),i={id:r,text:n,importedData:e,timestamp:Date.now(),processInBackground:t};if(t)return Eo.set(r,{...i,status:"pending"}),rw("task_started",{id:r,title:`${n.substring(0,30)}${n.length>30?"...":""}`}),YN(i).then(s=>{XN(s),rw("task_completed",{id:r,message:s.content})}).catch(s=>{if(console.error("Background task failed:",s),Eo.has(r)){const a=Eo.get(r);a&&(a.status="failed",Eo.set(r,a))}rw("task_failed",{id:r,error:s.message})}),r;try{const s=await YN(i);return XN(s),r}catch(s){throw console.error("AI request failed:",s),s}},ume=()=>Array.from(Eo.values()),dme=({onTaskClick:n})=>{const[e,t]=k.useState([]),[r,i]=k.useState(!1),[s,a]=k.useState(null);k.useEffect(()=>{(()=>{const h=ume().map(p=>({...p,status:"pending"}));t(h)})();const u=d=>{const{type:h,payload:p}=d.detail;h==="task_started"?t(y=>y.some(v=>v.id===p.id)?y:[{id:p.id,text:p.title||"Processing request...",timestamp:Date.now(),processInBackground:!0,importedData:null,status:"pending"},...y]):h==="task_completed"?t(y=>y.map(v=>v.id===p.id?{...v,status:"completed",response:{content:p.message||"Task completed successfully",timestamp:Date.now()}}:v)):h==="task_failed"&&t(y=>y.map(v=>v.id===p.id?{...v,status:"failed",response:{content:p.error||"Task failed",timestamp:Date.now()}}:v))};return window.addEventListener("ai_task_event",u),()=>{window.removeEventListener("ai_task_event",u)}},[]),k.useEffect(()=>{e.length>0&&!r&&i(!0)},[e.length,r]);const o=c=>new Date(c).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),l=c=>{a(s===c?null:c),n&&n(c)};return e.length===0?null:f.jsx("div",{className:"fixed bottom-20 left-1/2 transform -translate-x-1/2 z-30 w-auto max-w-2xl",children:f.jsxs("div",{className:"bg-[#0C1016] border border-viridian/30 rounded-lg shadow-lg overflow-hidden",children:[f.jsxs("div",{className:"px-4 py-2 flex items-center justify-between cursor-pointer hover:bg-viridian/10 transition-colors",onClick:()=>i(!r),children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(c0,{size:16,className:"text-viridian"}),f.jsxs("span",{className:"text-sm font-medium text-white",children:["Background Tasks (",e.filter(c=>c.status==="pending").length," active)"]})]}),r?f.jsx(wT,{size:16,className:"text-gray-400"}):f.jsx(dY,{size:16,className:"text-gray-400"})]}),f.jsx("div",{className:"overflow-hidden transition-all duration-300 ease-in-out",style:{maxHeight:r?"240px":"0px"},children:f.jsx("div",{className:"max-h-60 overflow-y-auto",children:e.map(c=>f.jsx("div",{className:"border-t border-viridian/20",children:f.jsxs("div",{className:`p-3 flex items-start gap-3 cursor-pointer hover:bg-viridian/5 transition-colors ${s===c.id?"bg-viridian/10":""}`,onClick:()=>l(c.id),children:[f.jsxs("div",{className:"flex-shrink-0 mt-1",children:[c.status==="pending"&&f.jsx(cd,{size:16,className:"text-viridian animate-spin"}),c.status==="completed"&&f.jsx(Dv,{size:16,className:"text-green-500"}),c.status==="failed"&&f.jsx(ET,{size:16,className:"text-red-500"})]}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-white font-medium truncate max-w-[400px]",children:c.text}),f.jsx("span",{className:"text-xs text-gray-400",children:o(c.timestamp)})]}),c.status!=="pending"&&f.jsx(Oa,{size:14,className:"text-viridian ml-2 flex-shrink-0"})]}),s===c.id&&c.response&&f.jsxs("div",{className:"mt-2 p-2 bg-black/30 rounded text-sm text-gray-300 border-l-2 border-viridian",children:[c.response.content,f.jsx("div",{className:"text-xs text-gray-500 mt-1",children:o(c.response.timestamp)})]}),c.status==="pending"&&f.jsx("div",{className:"mt-1.5 w-full bg-gray-700 rounded-full h-1",children:f.jsx("div",{className:"bg-viridian h-1 rounded-full animate-pulse",style:{width:"60%"}})})]})]})},c.id))})})]})})},hme=()=>{const n=Ia(),{useDirectAnthropicAPI:e,setUseDirectAnthropicAPI:t,addUserMessage:r,chatHistory:i,directChatHistory:s}=Fd(),{setSelectedToken:a,selectTokenById:o}=PT(),[l,c]=k.useState(!1),[u,d]=k.useState(!1),[h,p]=k.useState(!1),[y,v]=k.useState(!1),[g,m]=k.useState(260),[x,_]=k.useState(260),[b,w]=k.useState(null),[E,S]=k.useState(null),[M,N]=k.useState(!1),[T,P]=k.useState(!1),H=k.useRef(0),W=k.useRef(0),[O,I]=k.useState(!1),[F,j]=k.useState(!1),[L,D]=k.useState(""),[z,K]=k.useState([]),[re,Se]=k.useState(!1),[G,ne]=k.useState(null),[ye,se]=k.useState(!1),[U,X]=k.useState(!1),pe=k.useRef(null),ue=k.useRef(null),[B,He]=k.useState([]),fe={priceChart:"price-chart",tradingView:"trading-view",technicalIndicators:"indicators",volumeProfile:"volume-profile",momentum:"momentum",marketDepth:"market-depth",orderFlow:"order-flow",liquidity:"liquidity",newsFeed:"news-feed",socialFeed:"social-feed",patternAlerts:"pattern-alerts"};k.useEffect(()=>{const ae=localStorage.getItem("dashboard_preferences");if(ae)try{const oe=JSON.parse(ae)}catch(oe){console.error("Error loading dashboard preferences:",oe)}},[]);const me=X3(L,500);k.useEffect(()=>{(()=>{var ze,Ue;let oe;if(e?oe=s:oe=i,!oe||oe.length===0)return;let Pe;if(e?Pe=(ze=[...oe].reverse().find(De=>De.role==="assistant"))==null?void 0:ze.content:Pe=(Ue=[...oe].reverse().find(De=>De._getType&&De._getType()==="ai"))==null?void 0:Ue.content,!Pe)return;const he=Pe.toString().match(/Sentiment Score: (\d+)\/100/i);if(he&&he[1]){const De=parseInt(he[1]);S(De),De<=35?w("BEARISH"):De<=66?w("DYOR"):w("BULLISH"),De>65&&Pe.toString().includes("APE IN SIGNAL")&&w("APE IN")}})()},[i,s,e]),k.useEffect(()=>{const ae=localStorage.getItem("leftPanelEnabled"),oe=localStorage.getItem("rightPanelEnabled"),Pe=localStorage.getItem("leftPanelWidth"),he=localStorage.getItem("rightPanelWidth");if(ae!==null&&c(ae==="true"),oe!==null&&d(oe==="true"),Pe!==null){const ze=parseInt(Pe);!isNaN(ze)&&ze>=200&&ze<=600&&m(ze)}if(he!==null){const ze=parseInt(he);!isNaN(ze)&&ze>=200&&ze<=600&&_(ze)}},[]),k.useEffect(()=>{localStorage.setItem("leftPanelEnabled",String(l)),localStorage.setItem("rightPanelEnabled",String(u)),localStorage.setItem("leftPanelWidth",String(g)),localStorage.setItem("rightPanelWidth",String(x))},[l,u,g,x]);const Ee=ae=>{N(!0),H.current=ae.clientX,W.current=g,document.body.style.cursor="ew-resize",document.body.style.userSelect="none"},xe=ae=>{P(!0),H.current=ae.clientX,W.current=x,document.body.style.cursor="ew-resize",document.body.style.userSelect="none"};k.useEffect(()=>{const ae=Pe=>{if(M){const he=Pe.clientX-H.current,ze=Math.max(200,Math.min(600,W.current+he));m(ze)}else if(T){const he=H.current-Pe.clientX,ze=Math.max(200,Math.min(600,W.current+he));_(ze)}},oe=()=>{(M||T)&&(N(!1),P(!1),document.body.style.cursor="default",document.body.style.userSelect="auto")};return(M||T)&&(document.addEventListener("mousemove",ae),document.addEventListener("mouseup",oe)),()=>{document.removeEventListener("mousemove",ae),document.removeEventListener("mouseup",oe)}},[M,T]),k.useEffect(()=>{(async()=>{if(!me){K([]),se(!1);return}Se(!0),ne(null);try{const oe=await ya.searchCoins(me);K(oe.coins.slice(0,6)),se(!0)}catch(oe){console.error("Search error:",oe),ne("Failed to search tokens")}finally{Se(!1)}})()},[me]);const ce=ae=>{const oe=localStorage.getItem("dashboard_preferences");let Pe=[];if(oe)try{const ze=JSON.parse(oe);ze.visibleCards&&(Pe=ze.visibleCards)}catch(ze){console.error("Error parsing dashboard preferences:",ze)}const he=Object.keys(fe).find(ze=>fe[ze]===ae);He(ze=>ze.map(Ue=>Ue.id===ae?Ue.visible?{...Ue,visible:!1}:he?{...Ue,visible:Pe.includes(he)}:{...Ue,visible:!0}:Ue))},V=()=>{n("/portal?tab=dashboard")},le=k.useCallback(()=>{if(!b||!E)return null;let ae="",oe="",Pe="",he="";switch(b){case"BEARISH":ae="bg-red-600/20",oe="text-red-500",Pe="rgba(239, 68, 68, 1)",he="";break;case"DYOR":ae="bg-yellow-500/20",oe="text-yellow-300",Pe="rgba(252, 211, 77, 1)",he="";break;case"BULLISH":ae="bg-green-500/20",oe="text-green-400",Pe="rgba(161, 206, 63, 1)",he="";break;case"APE IN":ae="bg-purple-500/20",oe="text-purple-300",Pe="rgba(168, 85, 247, 1)",he="";break}return f.jsxs("div",{className:`px-4 py-2 rounded-full ${ae} flex items-center gap-2 ml-4 neon-sentiment-indicator`,style:{boxShadow:`0 0 10px ${Pe}, 0 0 20px ${Pe}`,border:`1px solid ${Pe}`,animation:"neon-pulse 1.5s infinite alternate"},children:[f.jsxs("span",{className:`font-bold text-lg ${oe}`,style:{textShadow:`0 0 5px ${Pe}, 0 0 10px ${Pe}, 0 0 15px ${Pe}`},children:[b," ",he]}),f.jsxs("span",{className:`text-sm ${oe} opacity-90`,style:{textShadow:`0 0 5px ${Pe}`},children:[E,"/100"]})]})},[b,E]),C=async ae=>{var oe,Pe,he,ze,Ue;try{X(!0),await o(ae.id);const De=await ya.getMarketData([ae.id]);if(De&&De.length>0){const Me=De[0];a({id:Me.id,symbol:Me.symbol.toUpperCase(),name:Me.name,image:Me.image,current_price:Me.current_price||0,market_cap:Me.market_cap||0,price_change_percentage_24h:Me.price_change_percentage_24h||0});const Be=`Analyze ${Me.name} (${Me.symbol.toUpperCase()}) for me. 
Current price: $${((oe=Me.current_price)==null?void 0:oe.toLocaleString())||"N/A"}
24h change: ${((Pe=Me.price_change_percentage_24h)==null?void 0:Pe.toFixed(2))||"N/A"}%
Market cap: $${((he=Me.market_cap)==null?void 0:he.toLocaleString())||"N/A"}
Volume (24h): $${((ze=Me.total_volume)==null?void 0:ze.toLocaleString())||"N/A"}
Circulating supply: ${((Ue=Me.circulating_supply)==null?void 0:Ue.toLocaleString())||"N/A"} ${Me.symbol.toUpperCase()}
${Me.ath?`All-time high: $${Me.ath.toLocaleString()}`:""}
${Me.atl?`All-time low: $${Me.atl.toLocaleString()}`:""}

Please provide a detailed analysis including:
1. Current market sentiment based on 5min, 15min, and 30min volume and market cap data
2. Technical analysis with key indicators (RSI, MACD, moving averages)
3. Support and resistance levels
4. Potential trading opportunities and risks
5. Short-term price forecast
6. Momentum sentiment score (0-100) 
7. Your recommendation (BEARISH, DYOR, or BULLISH)`;await r(Be)}else{const Me=`Analyze ${ae.name} (${ae.symbol.toUpperCase()}) for me. What's your assessment of this token and its current market conditions?`;await r(Me)}D(""),K([]),se(!1)}catch(De){console.error("Error fetching token details:",De);const Me=`Analyze ${ae.name} (${ae.symbol.toUpperCase()}) for me. What can you tell me about this token?`;await r(Me)}finally{X(!1)}};k.useEffect(()=>{const ae=oe=>{pe.current&&!pe.current.contains(oe.target)&&I(!1),ue.current&&!ue.current.contains(oe.target)&&j(!1)};return document.addEventListener("mousedown",ae),()=>{document.removeEventListener("mousedown",ae)}},[]);const A=ae=>{const oe=ae==="left"?"Trading Tools":"News & Alerts";return f.jsxs("div",{className:"h-full flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-viridian/20",children:[f.jsx("h3",{className:"text-lg font-bold text-viridian",children:oe}),f.jsx("div",{className:"flex items-center gap-2",children:f.jsx("button",{onClick:()=>ae==="left"?p(!0):v(!0),className:"p-2 rounded-lg hover:bg-viridian/10 text-viridian",title:ae==="left"?"Collapse Left Panel":"Collapse Right Panel",children:ae==="left"?f.jsx(cf,{size:16}):f.jsx(uf,{size:16})})})]}),f.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:f.jsx("div",{className:"text-center p-6 text-gray-400",children:f.jsx("p",{children:"No tools available"})})})]})},Y=400,de=typeof window<"u"?window.innerWidth:1200,be=de-x-Y,ge=de-g-Y,Ze=Math.min(g,be),We=Math.min(x,ge);return f.jsxs("div",{className:"absolute inset-0 flex overflow-hidden select-none",children:[f.jsxs("div",{className:"h-full transition-all duration-300 border-r border-viridian/20 bg-[#0C1016] flex-shrink-0",style:{width:l?h?0:Ze:0,minWidth:l?h?0:200:0,maxWidth:l?600:0},children:[l&&!h&&A("left"),l&&!h&&f.jsx("div",{className:"absolute top-0 bottom-0 w-1 bg-transparent hover:bg-viridian/30 cursor-ew-resize z-20",style:{left:Ze},onMouseDown:Ee}),f.jsx("button",{onClick:()=>p(!h),className:"absolute top-1/2 transform -translate-y-1/2 z-30 w-8 h-12 rounded-r-full bg-viridian/30 border border-viridian/60 flex items-center justify-center transition-colors hover:bg-viridian/40",style:{left:h?0:Ze-4,opacity:l?1:0,pointerEvents:l?"auto":"none"},children:h?f.jsx(uf,{size:18,className:"text-viridian"}):f.jsx(cf,{size:18,className:"text-viridian"})})]}),f.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[f.jsxs("div",{className:"flex-shrink-0 border-b border-viridian/20 p-4 flex items-center justify-between bg-[#0C1016]",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsxs("button",{onClick:V,className:"flex items-center gap-3 hover:opacity-80 transition-opacity",children:[f.jsx(cY,{size:24,className:"text-viridian"}),f.jsx("h2",{className:"text-xl font-bold text-viridian",children:"TradesXBT AI"})]}),le()]}),f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:"text",value:L,onChange:ae=>D(ae.target.value),placeholder:"Search tokens...",className:"w-64 py-2 px-4 rounded-lg bg-black/30 border border-viridian/40 text-white placeholder:text-gray-500 focus:outline-none focus:border-viridian/70",disabled:U}),f.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-viridian",children:re||U?f.jsx(cd,{size:18,className:"animate-spin"}):f.jsx(Iv,{size:18})}),ye&&z.length>0&&f.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-[#0C1016] border border-viridian/40 rounded-lg shadow-lg overflow-hidden z-50",children:z.map(ae=>f.jsxs("button",{className:"w-full px-4 py-3 flex items-center gap-3 hover:bg-viridian/10 text-left border-b border-viridian/20 last:border-0",onClick:()=>C(ae),disabled:U,children:[f.jsx("img",{src:ae.large,alt:ae.name,className:"w-8 h-8 rounded-full"}),f.jsxs("div",{children:[f.jsx("div",{className:"text-white font-medium",children:ae.symbol.toUpperCase()}),f.jsx("div",{className:"text-sm text-gray-400",children:ae.name})]})]},ae.id))})]}),f.jsx("button",{onClick:()=>j(!0),className:"p-2 rounded-lg bg-viridian/10 text-viridian hover:bg-viridian/20 transition-colors",title:"Settings",children:f.jsx(jv,{size:18})})]})]}),f.jsxs("div",{className:"flex-1 relative",children:[f.jsx(ome,{}),f.jsx(dme,{})]})]}),f.jsxs("div",{className:"h-full transition-all duration-300 border-l border-viridian/20 bg-[#0C1016] flex-shrink-0",style:{width:u?y?0:We:0,minWidth:u?y?0:200:0,maxWidth:u?600:0},children:[u&&!y&&A("right"),u&&!y&&f.jsx("div",{className:"absolute top-0 bottom-0 w-1 bg-transparent hover:bg-viridian/30 cursor-ew-resize z-20",style:{right:We},onMouseDown:xe}),f.jsx("button",{onClick:()=>v(!y),className:"absolute top-1/2 transform -translate-y-1/2 z-30 w-8 h-12 rounded-l-full bg-viridian/30 border border-viridian/60 flex items-center justify-center transition-colors hover:bg-viridian/40",style:{right:y?0:We-4,opacity:u?1:0,pointerEvents:u?"auto":"none"},children:y?f.jsx(cf,{size:18,className:"text-viridian"}):f.jsx(uf,{size:18,className:"text-viridian"})})]}),O&&f.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:f.jsxs("div",{ref:pe,className:"bg-[#0C1016] border border-viridian/30 rounded-xl p-6 w-[480px] max-h-[80vh] overflow-y-auto",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h3",{className:"text-xl font-bold text-white",children:"Customize Trading Tools"}),f.jsx("button",{onClick:()=>I(!1),className:"p-2 hover:bg-viridian/10 rounded-lg",children:f.jsx(yr,{size:20,className:"text-viridian"})})]}),f.jsx("div",{className:"mb-6 p-3 rounded-lg bg-viridian/10 border border-viridian/30",children:f.jsxs("p",{className:"text-sm text-gray-300",children:[f.jsx("span",{className:"text-viridian font-medium",children:"Note:"})," Tools must first be enabled in the dashboard before they can be used in the chat interface. You can enable tools by visiting the ",f.jsx("button",{onClick:()=>{I(!1),n("/portal?tab=dashboard")},className:"text-viridian underline hover:text-viridian/80",children:"Dashboard"})," and opening preferences."]})}),f.jsx("div",{className:"space-y-6",children:["analysis","charts","news","alerts"].map(ae=>f.jsxs("div",{className:"space-y-3",children:[f.jsx("h4",{className:"text-white font-medium capitalize",children:ae}),f.jsx("div",{className:"space-y-2",children:B.filter(oe=>oe.category===ae).map(oe=>{const Pe=Object.keys(fe).find(Ue=>fe[Ue]===oe.id),he=localStorage.getItem("dashboard_preferences");let ze=!Pe;if(Pe&&he)try{const Ue=JSON.parse(he);Ue.visibleCards&&(ze=Ue.visibleCards.includes(Pe))}catch(Ue){console.error("Error parsing preferences:",Ue)}return f.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${!ze&&!oe.visible?"bg-black/60 border-gray-800 opacity-70":"bg-black/30 border-viridian/20"}`,children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("span",{className:ze?"text-viridian":"text-gray-500",children:oe.icon}),f.jsxs("div",{children:[f.jsx("span",{className:"text-white",children:oe.name}),!ze&&!oe.visible&&f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enable this tool in Dashboard preferences first"})]})]}),f.jsx("button",{onClick:()=>ce(oe.id),className:`p-2 rounded-lg transition-colors ${ze||oe.visible?"bg-viridian/10 hover:bg-viridian/20":"bg-gray-800/50 cursor-not-allowed"}`,title:!ze&&!oe.visible?"Enable this tool in Dashboard preferences first":oe.visible?"Hide tool":"Show tool",children:oe.visible?f.jsx(yr,{size:18,className:"text-viridian"}):f.jsx(yr,{size:18,className:"text-gray-400"})})]},oe.id)})})]},ae))})]})}),F&&f.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:f.jsxs("div",{ref:ue,className:"bg-[#0C1016] border border-viridian/30 rounded-xl p-6 w-[480px]",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h3",{className:"text-xl font-bold text-white",children:"AI Settings"}),f.jsx("button",{onClick:()=>j(!1),className:"p-2 hover:bg-viridian/10 rounded-lg",children:f.jsx(yr,{size:20,className:"text-viridian"})})]}),f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsx("h4",{className:"text-white font-medium",children:"API Provider"}),f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsx("button",{onClick:()=>t(!0),className:`flex-1 py-3 px-4 rounded-lg transition-colors ${e?"bg-viridian/20 border-2 border-viridian text-viridian":"bg-black/30 border border-gray-700 text-gray-400"}`,children:"Anthropic Claude"}),f.jsx("button",{onClick:()=>t(!1),className:`flex-1 py-3 px-4 rounded-lg transition-colors ${e?"bg-black/30 border border-gray-700 text-gray-400":"bg-viridian/20 border-2 border-viridian text-viridian"}`,children:"LangChain"})]})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("h4",{className:"text-white font-medium",children:"Panel Settings"}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-gray-300",children:"Left Panel"}),f.jsx("button",{onClick:()=>c(!l),className:`relative w-12 h-6 rounded-full transition-colors ${l?"bg-viridian/80":"bg-gray-700"}`,children:f.jsx("span",{className:`absolute top-1 w-4 h-4 rounded-full bg-white transition-all ${l?"left-7":"left-1"}`})})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-gray-300",children:"Right Panel"}),f.jsx("button",{onClick:()=>d(!u),className:`relative w-12 h-6 rounded-full transition-colors ${u?"bg-viridian/80":"bg-gray-700"}`,children:f.jsx("span",{className:`absolute top-1 w-4 h-4 rounded-full bg-white transition-all ${u?"left-7":"left-1"}`})})]})]})]}),f.jsx("div",{className:"pt-4 border-t border-gray-700",children:f.jsx("button",{onClick:()=>j(!1),className:"w-full py-3 bg-viridian hover:bg-viridian/90 text-white rounded-lg transition-colors",children:"Close"})})]})]})})]})},fme=({onSendToAI:n})=>{const[e,t]=k.useState(!1),[r,i]=k.useState(""),[s,a]=k.useState(!1),[o,l]=k.useState(null),[c,u]=k.useState(!1),[d,h]=k.useState("all"),[p,y]=k.useState(!1),[v,g]=k.useState(""),[m,x]=k.useState([]),[_,b]=k.useState(!1),[w,E]=k.useState([]),[S,M]=k.useState(!1),[N,T]=k.useState(""),[P,H]=k.useState("mock"),[W,O]=k.useState(!1),[I,F]=k.useState(null),j=k.useRef(null),L=k.useRef(null),D=k.useRef(null),z=k.useRef(null),K=e4(),re=K.getFocusedCardData(),Se=K.getAllCardData(),G=[{id:"all",name:"All Data Sources",icon:f.jsx(bC,{size:14})},{id:"market",name:"Market Data",icon:f.jsx(Zf,{size:14})},{id:"news",name:"News & Social",icon:f.jsx(ah,{size:14})},{id:"technical",name:"Technical Indicators",icon:f.jsx(IS,{size:14})},{id:"charts",name:"Charts & Visuals",icon:f.jsx(EC,{size:14})}],ne=V=>V.includes("news")||V.includes("social")?"news":V.includes("chart")||V.includes("depth")?"charts":V.includes("indicator")||V.includes("momentum")||V.includes("volume")?"technical":V.includes("token")||V.includes("market")?"market":"all";k.useEffect(()=>{if(o){const V=Object.keys(o).filter(C=>C.includes("token_details")),le=[];V.forEach(C=>{const A=o[C];A&&A.id&&typeof A.id=="string"&&le.push(A.id)})}},[o]);const ye=k.useCallback(async()=>{b(!0);const V=v.trim()||"crypto";F(`Fetching ${V} news...`);try{console.log("Fetching general news with search term:",v);const le=v.trim()?v.split(/[,\s]+/):void 0,C=await ya.getNews(10,le);console.log("General news API response:",C),C.status==="success"?(x(C.data),H(C.source||"mock"),F(null),C.source==="mock"&&F("Using demo news data.")):(console.error("Failed to fetch news:",C),x([]),F("Could not fetch news. Using fallback data."))}catch(le){console.error("Error fetching news:",le);const C=[{id:`mock_${Date.now()}_1`,title:"Crypto Market Shows Signs of Recovery",source:"Mock Crypto News",summary:"The cryptocurrency market is showing signs of recovery after a period of volatility.",publishedAt:new Date().toISOString(),topics:["crypto","market","recovery"],sentiment:"positive"},{id:`mock_${Date.now()}_2`,title:"New Regulations Impact DeFi Projects",source:"Mock Finance Report",summary:"Recent regulatory changes are having significant effects on decentralized finance projects.",publishedAt:new Date(Date.now()-864e5).toISOString(),topics:["defi","regulation","crypto"],sentiment:"neutral"}];x(C),H("mock"),F("Error fetching news. Using fallback data.")}finally{b(!1)}},[v,b,x,H,F]),se=V=>{V.preventDefault(),ye()};k.useEffect(()=>{e&&D.current&&setTimeout(()=>{D.current&&D.current.focus()},500)},[e]),k.useEffect(()=>{p&&!S&&ye()},[p,S,ye]),k.useEffect(()=>{const V=le=>{j.current&&L.current&&!j.current.contains(le.target)&&!L.current.contains(le.target)&&U(),z.current&&!z.current.contains(le.target)&&u(!1)};return document.addEventListener("mousedown",V),()=>{document.removeEventListener("mousedown",V)}},[]);const U=()=>{O(!1),F(null),setTimeout(()=>{t(!1),y(!1),M(!1)},300)},X=()=>{e?U():(t(!0),setTimeout(()=>{O(!0),re&&l({[re.cardId]:re.data})},50))},pe=()=>{r.trim()&&(n(r,o,s),i(""),l(null),U(),E([]))},ue=V=>{const le=Se.find(C=>C.cardId===V);if(le)if(o&&o[V]){const C={...o};delete C[V],l(Object.keys(C).length>0?C:null)}else l({...o||{},[V]:le.data})},B=V=>{w.includes(V)?E(le=>le.filter(C=>C!==V)):E(le=>[...le,V])},He=()=>{if(w.length===0)return;const V=m.filter(le=>w.includes(le.id)).reduce((le,C)=>(le[`news_${C.id}`]={title:C.title,source:C.source,summary:C.summary,publishedAt:C.publishedAt,topics:C.topics,sentiment:C.sentiment,url:C.url,related_token:S?N:void 0},le),{});l(le=>({...le||{},...V})),E([]),y(!1),M(!1)},fe=()=>d==="all"?Se:Se.filter(V=>ne(V.cardId)===d),me=V=>{i(V.target.value);const le=V.target;le.style.height="auto",le.style.height=`${Math.min(le.scrollHeight,200)}px`},Ee=V=>{h(V)},xe=V=>new Date(V).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}),ce=V=>{switch(V){case"positive":return"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300";case"negative":return"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300";default:return"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300"}};return k.useEffect(()=>{const V=document.createElement("style");return V.textContent=`
      @keyframes gooeyPulse {
        0% { transform: scale(1) translateY(0); }
        50% { transform: scale(1.02) translateY(0); }
        100% { transform: scale(1) translateY(0); }
      }
    `,document.head.appendChild(V),()=>{document.head.removeChild(V)}},[]),f.jsxs(f.Fragment,{children:[f.jsx("svg",{className:"absolute w-0 h-0","aria-hidden":"true",focusable:"false",children:f.jsx("defs",{children:f.jsxs("filter",{id:"gooey-effect",children:[f.jsx("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"7",result:"blur"}),f.jsx("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"gooey"})]})})}),f.jsx("div",{className:`fixed bottom-0 right-0 z-10 pointer-events-none ${e?"opacity-100":"opacity-0"} transition-opacity duration-300`,style:{filter:"url(#gooey-effect)"},children:f.jsx("div",{className:`absolute bottom-20 right-4 transition-all duration-300 ease-out ${W?"w-[400px] h-[260px] rounded-2xl":"w-0 h-0"} bg-white dark:bg-[#0C1016] shadow-lg`,style:{transform:`scale(${W?"1":"0"})`,transformOrigin:"bottom right",animation:W?"gooeyPulse 8s ease-in-out infinite":"none"}})}),f.jsx("div",{className:"fixed bottom-6 right-6 z-40 pointer-events-none",children:f.jsx("button",{ref:L,onClick:X,className:"w-16 h-16 rounded-full bg-viridian text-white shadow-lg flex items-center justify-center transition-all duration-300 hover:shadow-viridian/30 hover:scale-105 pointer-events-auto",children:e?f.jsx(yr,{size:26,strokeWidth:2.5}):f.jsx(EY,{size:26,strokeWidth:2.5})})}),e&&f.jsx("div",{ref:j,className:`fixed bottom-24 right-6 z-30 transition-all duration-300 ease-out ${W?"translate-y-0 opacity-100":"translate-y-[20px] opacity-0"} w-[400px]`,style:{pointerEvents:W?"auto":"none"},children:f.jsx("div",{className:"bg-white dark:bg-[#0C1016] shadow-lg rounded-2xl overflow-hidden border border-gray-200 dark:border-gray-800 flex flex-col",children:p?f.jsxs("div",{className:"flex flex-col max-h-[600px]",children:[f.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-800 flex justify-between items-center flex-shrink-0",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsx("h3",{className:"text-sm font-semibold text-gray-800 dark:text-white",children:S?`${N.split("-").map(V=>V.charAt(0).toUpperCase()+V.slice(1)).join(" ")} News`:"Import News Data"})}),f.jsx("button",{onClick:()=>{y(!1),M(!1)},className:"p-1.5 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800",children:f.jsx(yr,{size:16,className:"text-gray-500"})})]}),f.jsxs("div",{className:"flex flex-col h-full",children:[!S&&f.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-800 flex-shrink-0",children:f.jsxs("form",{onSubmit:se,className:"flex items-center",children:[f.jsx("input",{type:"text",placeholder:"Search news by topic...",value:v,onChange:V=>g(V.target.value),className:"flex-1 px-4 py-2 text-sm bg-gray-50 dark:bg-black/40 border border-gray-200 dark:border-gray-800 rounded-lg focus:outline-none focus:ring-1 focus:ring-viridian focus:border-viridian dark:text-white"}),f.jsx("button",{type:"submit",className:"ml-3 p-2 rounded-lg bg-viridian/10 text-viridian hover:bg-viridian/20",disabled:_,children:_?f.jsx(jS,{size:16,className:"animate-spin"}):f.jsx(Iv,{size:16})})]})}),f.jsx("div",{className:"overflow-y-auto p-3",style:{maxHeight:"350px"},children:_?f.jsxs("div",{className:"flex flex-col justify-center items-center h-[300px] gap-3",children:[f.jsx(jS,{size:24,className:"text-viridian animate-spin"}),I&&f.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 animate-pulse",children:I})]}):m.length>0?f.jsxs("div",{className:"space-y-3.5",children:[(P==="brave"||P==="firecrawl")&&f.jsxs("div",{className:"px-3 py-1.5 text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1.5",children:[f.jsx(Pd,{size:12}),f.jsxs("span",{children:["Powered by ",P==="firecrawl"?"Firecrawl":"Brave Search"]})]}),I&&f.jsx("div",{className:"px-3 py-2 text-xs text-viridian bg-viridian/10 rounded-lg",children:I}),m.map(V=>f.jsxs("div",{className:`p-4 rounded-xl border cursor-pointer ${w.includes(V.id)?"bg-viridian/10 border-viridian":"bg-gray-50 dark:bg-black/20 border-gray-200 dark:border-gray-800 hover:border-viridian/50"}`,onClick:()=>B(V.id),children:[f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("h4",{className:"text-sm font-medium dark:text-white mb-1.5",children:V.title}),f.jsxs("div",{className:"flex items-center text-xs text-gray-500 mb-2.5",children:[f.jsx("span",{className:"mr-2",children:V.source}),f.jsx("span",{children:""}),f.jsx("span",{className:"ml-2",children:xe(V.publishedAt)}),V.url&&f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"mx-1.5",children:""}),f.jsxs("a",{href:V.url,target:"_blank",rel:"noopener noreferrer",className:"text-viridian flex items-center hover:underline",onClick:le=>le.stopPropagation(),children:[f.jsx(_3,{size:11,className:"mr-1"}),"Link"]})]})]})]}),f.jsx("div",{className:`w-6 h-6 rounded-full border flex items-center justify-center ${w.includes(V.id)?"bg-viridian border-viridian":"border-gray-300 dark:border-gray-600"}`,children:w.includes(V.id)&&f.jsx(lf,{size:15,className:"text-white"})})]}),f.jsx("p",{className:"text-xs text-gray-700 dark:text-gray-400 line-clamp-2 mb-3",children:V.summary}),f.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[V.sentiment&&f.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full ${ce(V.sentiment)}`,children:V.sentiment.charAt(0).toUpperCase()+V.sentiment.slice(1)}),V.topics.slice(0,3).map((le,C)=>f.jsxs("span",{className:"px-2 py-0.5 text-xs bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-full",children:["#",le]},C))]})]},V.id))]}):f.jsxs("div",{className:"flex flex-col items-center justify-center h-[300px] text-gray-500",children:[f.jsx(ah,{size:32,strokeWidth:1.5,className:"mb-3"}),f.jsx("p",{className:"text-sm",children:"No news items found"}),f.jsx("p",{className:"text-xs mt-1",children:"Try a different search term"})]})}),f.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-800 flex-shrink-0",children:f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("span",{className:"text-xs text-gray-500",children:[w.length," item",w.length!==1?"s":""," selected"]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("button",{onClick:()=>{y(!1),M(!1)},className:"px-3 py-2 rounded-lg flex items-center gap-1.5 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700",children:f.jsx("span",{className:"text-xs font-medium",children:"Cancel"})}),f.jsxs("button",{onClick:He,disabled:w.length===0,className:`px-4 py-2 rounded-lg flex items-center gap-2 ${w.length>0?"bg-viridian text-white hover:bg-viridian-dark":"bg-gray-200 dark:bg-gray-800 text-gray-500 dark:text-gray-400 cursor-not-allowed"}`,children:[f.jsx("span",{className:"text-xs font-medium",children:"Import Selected"}),f.jsx(oY,{size:14})]})]})]})})]})]}):f.jsxs("div",{className:"p-5",children:[f.jsx("textarea",{ref:D,value:r,onChange:me,placeholder:"Ask a question or give an instruction...",className:"w-full px-4 py-3 text-sm bg-gray-50 dark:bg-black/40 border border-gray-200 dark:border-gray-800 rounded-lg resize-none min-h-[90px] max-h-[140px] overflow-y-auto focus:outline-none focus:ring-1 focus:ring-viridian focus:border-viridian dark:text-white",style:{height:"auto"}}),f.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsxs("div",{className:"relative",ref:z,children:[f.jsxs("button",{onClick:()=>{u(!c),y(!1),M(!1)},className:"px-3 py-2 text-xs font-medium rounded-lg flex items-center gap-1.5 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700",children:[f.jsx(xY,{size:14}),"Import Data",f.jsx(bC,{size:12})]}),c&&f.jsxs("div",{className:"absolute left-0 bottom-full mb-2 w-64 bg-white dark:bg-[#0C1016] border border-gray-200 dark:border-gray-800 rounded-lg shadow-lg z-10 py-1.5 overflow-hidden",children:[f.jsxs("button",{onClick:()=>{y(!0),M(!1),u(!1)},className:"w-full px-4 py-2.5 text-xs text-left hover:bg-gray-100 dark:hover:bg-gray-800 flex items-center gap-2 border-b border-gray-200 dark:border-gray-800",children:[f.jsx(ah,{size:15,className:"text-viridian"}),f.jsxs("div",{children:[f.jsx("div",{className:"font-medium",children:"Import Latest News"}),f.jsx("div",{className:"text-[11px] text-gray-500",children:"Get fresh news updates"})]})]}),f.jsxs("div",{className:"px-3 py-2 border-b border-gray-200 dark:border-gray-800",children:[f.jsx("div",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mb-1.5",children:"Dashboard Data"}),f.jsx("div",{className:"flex flex-wrap gap-1.5",children:G.map(V=>f.jsxs("button",{onClick:()=>Ee(V.id),className:`px-2.5 py-1.5 text-xs rounded-full flex items-center gap-1.5 ${d===V.id?"bg-viridian/20 text-viridian":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300"}`,children:[V.icon,f.jsx("span",{className:"truncate max-w-[70px]",children:V.name})]},V.id))})]}),f.jsx("div",{className:"max-h-[220px] overflow-y-auto",children:fe().length>0?fe().map(V=>f.jsxs("button",{onClick:()=>ue(V.cardId),className:"w-full px-4 py-2 text-xs text-left hover:bg-gray-100 dark:hover:bg-gray-800 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[ne(V.cardId)==="news"&&f.jsx(ah,{size:13}),ne(V.cardId)==="charts"&&f.jsx(EC,{size:13}),ne(V.cardId)==="technical"&&f.jsx(IS,{size:13}),ne(V.cardId)==="market"&&f.jsx(Zf,{size:13}),f.jsx("span",{children:V.title})]}),o&&o[V.cardId]?f.jsx(lf,{size:13,className:"text-viridian"}):null]},V.cardId)):f.jsx("div",{className:"px-4 py-3 text-xs text-gray-500 dark:text-gray-400",children:"No data sources available in this category"})})]})]}),f.jsxs("button",{onClick:()=>{y(!0),M(!1)},className:"px-3 py-2 text-xs font-medium rounded-lg flex items-center gap-1.5 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700",children:[f.jsx(ah,{size:14}),"News"]})]}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsxs("label",{className:"flex items-center gap-1.5 text-xs text-gray-600 dark:text-gray-300 cursor-pointer",children:[f.jsx("input",{type:"checkbox",checked:s,onChange:()=>a(!s),className:"rounded text-viridian focus:ring-viridian"}),"Background"]}),f.jsxs("button",{onClick:pe,disabled:!r.trim(),className:`px-4 py-2 rounded-lg flex items-center gap-2 ${r.trim()?"bg-viridian text-white hover:bg-viridian-dark":"bg-gray-200 dark:bg-gray-800 text-gray-500 dark:text-gray-400 cursor-not-allowed"}`,children:[f.jsx("span",{className:"text-xs font-medium",children:"Send"}),f.jsx(kY,{size:14})]})]})]}),o&&Object.keys(o).length>0&&f.jsxs("div",{className:"mt-4 p-3 bg-viridian/10 dark:bg-viridian/20 border border-viridian/30 rounded-lg",children:[f.jsx("div",{className:"text-xs font-medium text-viridian mb-2",children:"Data to be sent with request:"}),f.jsx("div",{className:"overflow-y-auto max-h-[70px] flex flex-wrap gap-1.5 content-start",children:Object.keys(o).map(V=>{let le="";if(V.startsWith("news_"))le=`News: ${o[V].title||V.substring(5)}`;else{const C=Se.find(A=>A.cardId===V);le=(C==null?void 0:C.title)||V}return f.jsxs("div",{className:"px-2.5 py-1.5 bg-viridian/20 text-viridian text-xs rounded-full flex items-center",children:[f.jsx("span",{className:"truncate max-w-[120px]",children:le}),f.jsx("button",{onClick:()=>{const C={...o};delete C[V],l(Object.keys(C).length>0?C:null)},className:"ml-1.5 p-0.5 hover:bg-viridian/30 rounded-full",children:f.jsx(yr,{size:12})})]},V)})})]})]})})})]})},pme=()=>{const[n,e]=k.useState([]),[t,r]=k.useState(!1),[i,s]=k.useState(!1),a=k.useRef(null);k.useEffect(()=>{const p=y=>{if(y.detail&&y.detail.type){const{type:v,payload:g}=y.detail;switch(v){case"task_started":l({id:g.id,title:g.title||"AI Processing Task",status:"pending",timestamp:Date.now()});break;case"task_completed":c(g.id,{status:"completed",message:g.message});break;case"task_failed":c(g.id,{status:"failed",message:g.error||"Task failed"});break}}};return window.addEventListener("ai_task_event",p),()=>{window.removeEventListener("ai_task_event",p)}},[]),k.useEffect(()=>{const p=y=>{a.current&&!a.current.contains(y.target)&&r(!1)};return document.addEventListener("mousedown",p),()=>{document.removeEventListener("mousedown",p)}},[]);const o=()=>{r(!t),i&&!t&&s(!1)},l=p=>{e(y=>[p,...y]),s(!0)},c=(p,y)=>{e(v=>v.map(g=>g.id===p?{...g,...y}:g)),s(!0)},u=p=>{e(y=>y.filter(v=>v.id!==p))},d=p=>new Date(p).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),h=n.filter(p=>p.status==="pending").length;return f.jsxs("div",{className:"relative",ref:a,children:[f.jsxs("button",{onClick:o,className:"relative p-1.5 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-800 transition-colors",children:[f.jsx(lY,{size:18}),h>0&&f.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-viridian rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-[10px] font-bold text-white",children:h})}),i&&!h&&f.jsx("div",{className:"absolute top-0 right-0 w-2 h-2 bg-viridian rounded-full"})]}),t&&f.jsxs("div",{className:"absolute right-0 mt-2 w-80 max-h-96 overflow-y-auto bg-white dark:bg-[#0C1016] border border-gray-200 dark:border-gray-800 rounded-lg shadow-lg z-50",children:[f.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-800 flex items-center justify-between",children:[f.jsx("h3",{className:"text-sm font-semibold text-gray-800 dark:text-white",children:"AI Task Notifications"}),n.length>0&&f.jsx("button",{onClick:()=>e([]),className:"text-xs text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:"Clear All"})]}),f.jsx("div",{className:"max-h-72 overflow-y-auto",children:n.length===0?f.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400 text-sm",children:"No notifications"}):n.map(p=>f.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-800 last:border-b-0 flex items-start gap-3",children:[f.jsxs("div",{className:"flex-shrink-0 mt-0.5",children:[p.status==="pending"&&f.jsx(cd,{size:18,className:"text-viridian animate-spin"}),p.status==="completed"&&f.jsx(Dv,{size:18,className:"text-green-500"}),p.status==="failed"&&f.jsx(Pd,{size:18,className:"text-red-500"})]}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsx("h4",{className:"text-sm font-medium text-gray-800 dark:text-white truncate",children:p.title}),f.jsxs("div",{className:"ml-2 flex items-center gap-2",children:[f.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:d(p.timestamp)}),f.jsx("button",{onClick:()=>u(p.id),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:f.jsx(yr,{size:14})})]})]}),p.message&&f.jsx("p",{className:"mt-1 text-xs text-gray-600 dark:text-gray-300",children:p.message}),p.status==="pending"&&f.jsx("div",{className:"mt-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5",children:f.jsx("div",{className:"bg-viridian h-1.5 rounded-full animate-pulse",style:{width:"60%"}})})]})]},p.id))})]})]})},mme=h3.WidthProvider(rY),Nh=[{id:"beginner",name:"Beginner Trader",description:"Essential tools for new traders with simplified layout",columns:2,visibleCards:["profile","signals","tokenSearch","tokenDetails","social"]},{id:"intermediate",name:"Intermediate Trader",description:"Balanced view with additional technical tools",columns:3,visibleCards:["profile","signals","tokenSearch","tokenDetails","social","priceChart","newsFeed"]},{id:"advanced",name:"Advanced Trader",description:"Full suite of technical analysis tools",columns:3,visibleCards:["profile","signals","tokenSearch","tokenDetails","social","priceChart","tradingView","technicalIndicators","volumeProfile","momentum","newsFeed"]},{id:"professional",name:"Professional Trader",description:"Complete trading environment with all tools",columns:3,visibleCards:["profile","signals","tokenSearch","tokenDetails","social","priceChart","tradingView","technicalIndicators","volumeProfile","momentum","marketDepth","orderFlow","liquidity","newsFeed","socialFeed","patternAlerts"]},{id:"custom",name:"Custom",description:"Your personalized dashboard setup",columns:3,visibleCards:[]}],gme=()=>{const[n,e]=k.useState(3),[t,r]=k.useState(!1),[i,s]=k.useState(!1),a=k.useRef(null),o=bc(),l=Ia(),c=k.useRef(null),[u,d]=k.useState("beginner"),[h,p]=k.useState(()=>!localStorage.getItem("dashboard_preferences")),[y,v]=k.useState(!0),[g,m]=k.useState(!0),[x,_]=k.useState([]);k.useEffect(()=>{const se=localStorage.getItem("dashboard_preferences");if(se)try{const U=JSON.parse(se);U.traderProfile&&d(U.traderProfile),U.columns&&e(U.columns),U.visibleCards&&Array.isArray(U.visibleCards)&&P(X=>X.map(pe=>({...pe,visible:U.visibleCards.includes(pe.id)})))}catch(U){console.error("Error loading dashboard preferences:",U),localStorage.removeItem("dashboard_preferences")}},[]);const b=()=>{y||g?(v(!1),m(!1)):(v(!0),m(!0))},w=k.useCallback(()=>new URLSearchParams(o.search).get("tab")||"dashboard",[o.search]),[E,S]=k.useState(w()),M=k.useCallback(se=>{S(se),l(`/portal?tab=${se}`,{replace:!0})},[l]);k.useEffect(()=>{S(w())},[o,w]),k.useEffect(()=>{const se=U=>{const{tab:X}=U.detail;X&&M(X)};return window.addEventListener("navigate",se),()=>{window.removeEventListener("navigate",se)}},[M]);const N=[{id:"profile",title:"AI Agent Profile",description:"View and interact with your AI trading assistant"},{id:"signals",title:"Trading Signals",description:"Real-time AI-generated trading signals"},{id:"tokenSearch",title:"Token Search",description:"Search and analyze Solana ecosystem tokens"},{id:"tokenDetails",title:"Token Details",description:"In-depth token analysis and metrics"},{id:"social",title:"Social Presence",description:"Community updates and social metrics"},{id:"chatHistory",title:"Chat History",description:"View your conversation history with the AI"},{id:"priceChart",title:"Price Chart",description:"Interactive price chart with historical data"},{id:"tradingView",title:"TradingView",description:"Advanced TradingView charting interface"},{id:"technicalIndicators",title:"Technical Indicators",description:"Key technical indicators with buy/sell signals"},{id:"volumeProfile",title:"Volume Profile",description:"Volume distribution across price levels"},{id:"momentum",title:"Momentum Scanner",description:"Monitor momentum indicators and market trends"},{id:"marketDepth",title:"Market Depth",description:"Order book visualization and liquidity analysis"},{id:"orderFlow",title:"Order Flow",description:"Real-time order flow and buying/selling pressure"},{id:"liquidity",title:"Liquidity Analysis",description:"Market liquidity and depth visualization"},{id:"newsFeed",title:"News Feed",description:"Latest news and updates for crypto markets"},{id:"socialFeed",title:"Social Sentiment",description:"Social media sentiment analysis for tokens"},{id:"patternAlerts",title:"Pattern Alerts",description:"Detect and alert on chart patterns"}],[T,P]=k.useState([{id:"profile",title:"Agent Profile",component:f.jsx(ZU,{}),visible:!0},{id:"signals",title:"Trading Signals",component:f.jsx(Fle,{}),visible:!0},{id:"tokenSearch",title:"Token Search",component:f.jsx(Dle,{}),visible:!0},{id:"tokenDetails",title:"Token Details",component:f.jsx(Ule,{}),visible:!0},{id:"social",title:"Social Presence",component:f.jsx(zle,{}),visible:!0},{id:"chatHistory",title:"Chat History",component:f.jsx(Qce,{}),visible:!1},{id:"priceChart",title:"Price Chart",component:f.jsx(Fpe,{}),visible:!1},{id:"tradingView",title:"TradingView",component:f.jsx(Upe,{symbol:"SOLUSDT"}),visible:!1},{id:"technicalIndicators",title:"Technical Indicators",component:f.jsx(zpe,{}),visible:!1},{id:"volumeProfile",title:"Volume Profile",component:f.jsx(Vpe,{}),visible:!1},{id:"momentum",title:"Momentum Scanner",component:f.jsx(Gpe,{}),visible:!1},{id:"marketDepth",title:"Market Depth",component:f.jsx(Xpe,{}),visible:!1},{id:"orderFlow",title:"Order Flow",component:f.jsx(Kpe,{}),visible:!1},{id:"liquidity",title:"Liquidity Analysis",component:f.jsx(Jpe,{}),visible:!1},{id:"newsFeed",title:"News Feed",component:f.jsx(eme,{}),visible:!1},{id:"socialFeed",title:"Social Sentiment",component:f.jsx(nme,{}),visible:!1},{id:"patternAlerts",title:"Pattern Alerts",component:f.jsx(rme,{}),visible:!1}]),H=se=>{_(U=>U.includes(se)?U.filter(X=>X!==se):[...U,se])},W=se=>{const U=[...se].sort((X,pe)=>X.y!==pe.y?X.y-pe.y:X.x-pe.x);D(U),t&&localStorage.setItem("dashboard_layout",JSON.stringify({layout:U,timestamp:new Date().toISOString()}))},O=se=>{const U=j(se,n);D(U),t&&localStorage.setItem("dashboard_layout",JSON.stringify({layout:U,timestamp:new Date().toISOString()}))},I=se=>{const U=j(se,n);D(U),t&&localStorage.setItem("dashboard_layout",JSON.stringify({layout:U,timestamp:new Date().toISOString()}))},F=k.useCallback(se=>{const U=T.filter(pe=>pe.visible);let X=[];return se===3?X=[{i:"profile",x:0,y:0,w:1,h:2,minW:1,maxW:1},{i:"signals",x:1,y:0,w:1,h:2,minW:1,maxW:1},{i:"tokenSearch",x:2,y:0,w:1,h:2,minW:1,maxW:1},{i:"tokenDetails",x:0,y:2,w:2,h:2,minW:1},{i:"social",x:2,y:2,w:1,h:2,minW:1,maxW:1},{i:"chatHistory",x:0,y:6,w:1,h:2,minW:1},{i:"priceChart",x:0,y:6,w:1,h:2,minW:1,maxW:1},{i:"tradingView",x:1,y:6,w:2,h:2,minW:1},{i:"technicalIndicators",x:0,y:8,w:1,h:2,minW:1,maxW:1},{i:"volumeProfile",x:1,y:8,w:1,h:2,minW:1,maxW:1},{i:"momentum",x:2,y:8,w:1,h:2,minW:1,maxW:1},{i:"marketDepth",x:0,y:10,w:1,h:2,minW:1,maxW:1},{i:"orderFlow",x:1,y:10,w:1,h:2,minW:1,maxW:1},{i:"liquidity",x:2,y:10,w:1,h:2,minW:1,maxW:1},{i:"newsFeed",x:0,y:12,w:1,h:2,minW:1,maxW:1},{i:"socialFeed",x:1,y:12,w:1,h:2,minW:1,maxW:1},{i:"patternAlerts",x:2,y:12,w:1,h:2,minW:1,maxW:1}].filter(pe=>U.some(ue=>ue.id===pe.i)):se===2?X=[{i:"profile",x:0,y:0,w:1,h:2,minW:1,maxW:1},{i:"signals",x:1,y:0,w:1,h:2,minW:1,maxW:1},{i:"tokenSearch",x:0,y:2,w:1,h:2,minW:1,maxW:1},{i:"social",x:1,y:2,w:1,h:2,minW:1,maxW:1},{i:"tokenDetails",x:0,y:4,w:2,h:2,minW:1},{i:"chatHistory",x:0,y:8,w:1,h:2,minW:1},{i:"priceChart",x:0,y:8,w:1,h:2,minW:1,maxW:1},{i:"tradingView",x:0,y:10,w:2,h:2,minW:1},{i:"technicalIndicators",x:0,y:12,w:1,h:2,minW:1,maxW:1},{i:"volumeProfile",x:1,y:12,w:1,h:2,minW:1,maxW:1},{i:"momentum",x:0,y:14,w:1,h:2,minW:1,maxW:1},{i:"marketDepth",x:1,y:14,w:1,h:2,minW:1,maxW:1},{i:"orderFlow",x:0,y:16,w:1,h:2,minW:1,maxW:1},{i:"liquidity",x:1,y:16,w:1,h:2,minW:1,maxW:1},{i:"newsFeed",x:0,y:18,w:1,h:2,minW:1,maxW:1},{i:"socialFeed",x:1,y:18,w:1,h:2,minW:1,maxW:1},{i:"patternAlerts",x:0,y:20,w:1,h:2,minW:1,maxW:1}].filter(pe=>U.some(ue=>ue.id===pe.i)):se===1&&(X=[{i:"profile",x:0,y:0,w:1,h:2,minW:1,maxW:1},{i:"signals",x:0,y:2,w:1,h:2,minW:1,maxW:1},{i:"tokenSearch",x:0,y:4,w:1,h:2,minW:1,maxW:1},{i:"tokenDetails",x:0,y:6,w:1,h:2,minW:1,maxW:1},{i:"social",x:0,y:8,w:1,h:2,minW:1,maxW:1},{i:"chatHistory",x:0,y:12,w:1,h:2,minW:1,maxW:1},{i:"priceChart",x:0,y:12,w:1,h:2,minW:1,maxW:1},{i:"tradingView",x:0,y:14,w:1,h:2,minW:1,maxW:1},{i:"technicalIndicators",x:0,y:16,w:1,h:2,minW:1,maxW:1},{i:"volumeProfile",x:0,y:18,w:1,h:2,minW:1,maxW:1},{i:"momentum",x:0,y:20,w:1,h:2,minW:1,maxW:1},{i:"marketDepth",x:0,y:22,w:1,h:2,minW:1,maxW:1},{i:"orderFlow",x:0,y:24,w:1,h:2,minW:1,maxW:1},{i:"liquidity",x:0,y:26,w:1,h:2,minW:1,maxW:1},{i:"newsFeed",x:0,y:28,w:1,h:2,minW:1,maxW:1},{i:"socialFeed",x:0,y:30,w:1,h:2,minW:1,maxW:1},{i:"patternAlerts",x:0,y:32,w:1,h:2,minW:1,maxW:1}].filter(pe=>U.some(ue=>ue.id===pe.i))),j(X,se)},[T]),j=(se,U)=>{if(!se.length)return se;const X=[...se];let pe=0,ue=!0;const B=10;for(;ue&&pe<B;){ue=!1,pe++,X.sort((xe,ce)=>xe.y!==ce.y?xe.y-ce.y:xe.x-ce.x);const fe=Array(U).fill(0);for(let xe=0;xe<X.length;xe++){const ce=X[xe];let V=0;for(let le=ce.x;le<ce.x+ce.w;le++)le<U&&(V=Math.max(V,fe[le]||0));ce.y!==V&&(ce.y=V,ue=!0);for(let le=ce.x;le<ce.x+ce.w;le++)le<U&&(fe[le]=ce.y+ce.h)}const me=Array(U).fill(null).map(()=>[]),Ee=Math.max(...X.map(xe=>xe.y+xe.h));for(const xe of X)for(let ce=xe.x;ce<xe.x+xe.w;ce++)for(let V=xe.y;V<xe.y+xe.h;V++)me[ce]||(me[ce]=[]),me[ce][V]=!0;for(let xe=0;xe<X.length;xe++){const ce=X[xe];if(ce.x===0)continue;let V=ce.x;e:for(;V>0;){V--;for(let le=ce.y;le<ce.y+ce.h;le++)if(me[V]&&me[V][le]){V++;break e}}if(V!==ce.x){for(let le=ce.x;le<ce.x+ce.w;le++)for(let C=ce.y;C<ce.y+ce.h;C++)me[le]&&(me[le][C]=!1);ce.x=V,ue=!0;for(let le=ce.x;le<ce.x+ce.w;le++)for(let C=ce.y;C<ce.y+ce.h;C++)me[le]||(me[le][C]=!0)}}for(let xe=0;xe<U;xe++)if(xe!==U-1){for(let ce=0;ce<Ee;ce++)if((!me[xe]||!me[xe][ce])&&me[xe+1]&&me[xe+1][ce])for(let V=0;V<X.length;V++){const le=X[V];if(le.x>xe&&le.y<=ce&&le.y+le.h>ce){let C=!0;for(let A=le.y;A<le.y+le.h;A++){for(let Y=xe;Y<xe+le.w&&Y<le.x;Y++)if(me[Y]&&me[Y][A]){C=!1;break}if(!C)break}if(C){for(let A=le.x;A<le.x+le.w;A++)for(let Y=le.y;Y<le.y+le.h;Y++)me[A]&&(me[A][Y]=!1);le.x=xe,ue=!0;for(let A=le.x;A<le.x+le.w;A++)for(let Y=le.y;Y<le.y+le.h;Y++)me[A]||(me[A]=[]),me[A][Y]=!0;break}}}}}X.sort((fe,me)=>fe.y!==me.y?fe.y-me.y:fe.x-me.x);const He=Array(U).fill(0);for(let fe=0;fe<X.length;fe++){const me=X[fe];let Ee=0;for(let xe=me.x;xe<me.x+me.w;xe++)xe<U&&(Ee=Math.max(Ee,He[xe]||0));me.y=Ee;for(let xe=me.x;xe<me.x+me.w;xe++)xe<U&&(He[xe]=Ee+me.h)}return X},[L,D]=k.useState(F(n));k.useEffect(()=>{D(F(n))},[n,T,F]),k.useEffect(()=>{const se=localStorage.getItem("dashboard_layout");if(se)try{const{layout:U}=JSON.parse(se),X=T.filter(ue=>ue.visible).map(ue=>ue.id),pe=U.filter(ue=>X.includes(ue.i));if(pe.length>0){const ue=pe.map(me=>me.i),B=F(n).filter(me=>!ue.includes(me.i)),He=[...pe,...B],fe=j(He,n);D(fe)}}catch(U){console.error("Error loading saved dashboard layout:",U)}},[]),k.useEffect(()=>{const se=U=>{a.current&&!a.current.contains(U.target)&&s(!1)};return document.addEventListener("mousedown",se),()=>{document.removeEventListener("mousedown",se)}},[]);const z=se=>{P(U=>U.map(X=>X.id===se?{...X,visible:!X.visible}:X)),setTimeout(()=>{var He;const U=T.map(fe=>fe.id===se?{...fe,visible:!fe.visible}:fe),X=U.filter(fe=>fe.visible),pe=L.filter(fe=>X.some(me=>me.id===fe.i));if(!((He=T.find(fe=>fe.id===se))!=null&&He.visible)){const me=F(n).find(Ee=>Ee.i===se);me&&pe.push(me)}const ue=j(pe,n);D(ue);const B=U.filter(fe=>fe.visible).map(fe=>fe.id);localStorage.setItem("dashboard_preferences",JSON.stringify({columns:n,visibleCards:B,timestamp:new Date().toISOString()}))},0)},K=k.useCallback(se=>{const U=Nh.find(pe=>pe.id===se);if(!U)return;d(se),e(U.columns),P(pe=>pe.map(ue=>({...ue,visible:U.visibleCards.includes(ue.id)}))),U.layout&&D(U.layout);const X={traderProfile:se,columns:U.columns,visibleCards:U.visibleCards,timestamp:new Date().toISOString()};localStorage.setItem("dashboard_preferences",JSON.stringify(X)),p(!1)},[]),re=se=>{if(se.traderProfile!=="custom"){K(se.traderProfile);return}e(se.columns),P(pe=>pe.map(ue=>({...ue,visible:se.visibleCards.includes(ue.id)})));const U=Nh.find(pe=>pe.id==="custom");U&&(U.columns=se.columns,U.visibleCards=se.visibleCards,U.layout=L);const X={traderProfile:"custom",columns:se.columns,visibleCards:se.visibleCards,timestamp:new Date().toISOString()};localStorage.setItem("dashboard_preferences",JSON.stringify(X)),p(!1)},Se=(se,U,X)=>{cme(se,U,X).then(pe=>{if(!X)M("chat");else if(G("AI is processing your request in the background. You can view progress in the chat tab."),E!=="chat"){const ue=document.getElementById("chat-tab");ue&&(ue.classList.add("tab-notification"),setTimeout(()=>{ue.classList.remove("tab-notification")},3e3))}}).catch(pe=>{console.error("Error sending to AI:",pe),G("Failed to send request to AI","error")})},G=(se,U="success")=>{const X=document.createElement("div");X.className=`fixed top-4 right-4 px-4 py-2 rounded shadow-lg z-50 ${U==="success"?"bg-green-500":"bg-red-500"} text-white`,X.textContent=se,document.body.appendChild(X),setTimeout(()=>{document.body.contains(X)&&document.body.removeChild(X)},3e3)},ne=()=>{switch(E){case"dashboard":return f.jsx(mme,{className:"layout",layout:L,cols:n,rowHeight:160,margin:[10,10],containerPadding:[5,5],isDraggable:t,isResizable:t,onLayoutChange:W,draggableHandle:".drag-handle",compactType:"vertical",verticalCompact:!0,preventCollision:!1,useCSSTransforms:!0,onDragStop:O,onResizeStop:I,resizeHandles:["se","sw","ne","nw","n","s","e","w"],children:T.filter(se=>se.visible).map(se=>f.jsxs("div",{className:"group relative",children:[t&&f.jsxs("div",{className:"absolute top-0 left-0 right-0 p-1 z-10 flex items-center justify-between bg-viridian/10 dark:bg-viridian/20 dark:border-t dark:border-l dark:border-r dark:border-viridian/70 rounded-t-lg drag-handle cursor-move",children:[f.jsx("div",{className:"text-xs font-medium text-viridian dark:text-viridian px-2",children:se.title}),f.jsxs("div",{className:"flex items-center",children:[f.jsx("button",{className:"p-1 text-viridian hover:text-viridian/70 rounded",onClick:()=>H(se.id),children:x.includes(se.id)?f.jsx(wC,{size:14}):f.jsx(SC,{size:14})}),f.jsx("button",{className:"p-1 text-gray-500 hover:text-red-500 rounded",onClick:()=>z(se.id),children:f.jsx(yr,{size:14})})]})]}),f.jsx("div",{className:`h-full ${t?"pt-7":""} overflow-hidden`,children:f.jsxs("div",{className:`dashboard-card ${x.includes(se.id)?"minimized":""}`,children:[!t&&f.jsx("div",{className:"absolute top-1 right-1 z-10 opacity-0 group-hover:opacity-100 transition-opacity",children:f.jsx("button",{className:"p-1 text-viridian hover:bg-viridian/10 rounded-full",onClick:()=>H(se.id),children:x.includes(se.id)?f.jsx(wC,{size:14}):f.jsx(SC,{size:14})})}),se.component]})})]},se.id))});case"charts":return f.jsx(ime,{});case"signals":return f.jsx(ame,{});case"chat":return f.jsx(hme,{});case"profile":return f.jsx(sme,{});default:return f.jsx("div",{children:"Tab not implemented"})}},ye=()=>{const se=Nh.find(U=>U.id===u);return f.jsxs("div",{className:"relative",ref:a,children:[f.jsxs("button",{onClick:()=>s(!i),className:"flex items-center gap-2 px-3 py-2 text-sm bg-black/20 rounded-lg hover:bg-black/30 border border-gray-800 transition-colors",children:[f.jsx(x3,{size:16,className:"text-viridian"}),f.jsx("span",{children:(se==null?void 0:se.name)||"Select Profile"}),f.jsx(wT,{size:14})]}),i&&f.jsxs("div",{className:"absolute top-full left-0 mt-2 w-64 bg-[#0C1016] border border-gray-800 rounded-lg shadow-xl z-50 py-1.5 overflow-hidden",children:[Nh.map(U=>f.jsxs("button",{onClick:()=>{K(U.id),s(!1)},className:`w-full px-4 py-2.5 text-left hover:bg-gray-800/50 flex items-start gap-2 ${u===U.id?"bg-viridian/10":""}`,children:[f.jsx("div",{className:`mt-0.5 ${u===U.id?"text-viridian":"text-gray-400"}`,children:u===U.id?f.jsx(uY,{size:16}):f.jsx(CY,{size:16})}),f.jsxs("div",{children:[f.jsx("div",{className:`text-sm font-medium ${u===U.id?"text-viridian":"text-white"}`,children:U.name}),f.jsx("div",{className:"text-xs text-gray-500 mt-1",children:U.description})]})]},U.id)),f.jsx("div",{className:"px-4 py-2 border-t border-gray-800 mt-1",children:f.jsx("button",{onClick:()=>{p(!0),s(!1)},className:"text-sm text-viridian hover:underline",children:"Customize Dashboard"})})]})]})};return f.jsx(QU,{children:f.jsxs("div",{className:"min-h-screen bg-light-bg dark:bg-black text-light-text dark:text-dark-text p-0 transition-colors",children:[f.jsx("nav",{className:"bg-light-card dark:bg-[#0C1016] border-b border-gray-200 dark:border-gray-800 py-2 px-4 sticky top-0 z-50",children:f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("div",{className:"text-xl font-bold text-viridian",children:"TradesXBT"}),f.jsx("div",{className:"overflow-x-auto",children:f.jsx($le,{activeTab:E,onTabChange:M})})]}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(pme,{}),E==="chat"&&f.jsxs("div",{className:"mr-2 px-3 py-1.5 bg-[#0C1016]/90 border border-viridian/30 rounded-full flex items-center gap-3",children:[f.jsx("button",{onClick:()=>v(!y),className:`p-1.5 rounded-lg transition-colors ${y?"bg-viridian/20 text-viridian":"bg-gray-800/70 text-gray-400"}`,title:y?"Hide Left Panel":"Show Left Panel",children:f.jsx(uf,{size:16})}),f.jsx("button",{onClick:b,className:"p-1.5 rounded-lg bg-viridian/20 text-viridian hover:bg-viridian/30 transition-colors",title:y||g?"Hide All Panels":"Show All Panels",children:y||g?f.jsx(yr,{size:16}):f.jsx(MY,{size:16})}),f.jsx("button",{onClick:()=>m(!g),className:`p-1.5 rounded-lg transition-colors ${g?"bg-viridian/20 text-viridian":"bg-gray-800/70 text-gray-400"}`,title:g?"Hide Right Panel":"Show Right Panel",children:f.jsx(cf,{size:16})})]}),E==="dashboard"&&f.jsx("div",{className:"relative",ref:a,children:ye()}),f.jsx(Hle,{}),f.jsx(Jce,{})]})]})}),f.jsx("div",{className:"max-w-7xl mx-auto px-3 md:px-4 dashboard-container overflow-hidden",ref:c,children:f.jsx("div",{className:"h-full smart-scroll",children:ne()})}),h&&f.jsx(eue,{onClose:()=>p(!1),onSave:re,defaultColumns:n,availableCards:N,traderProfiles:Nh,activeProfile:u}),E!=="chat"&&f.jsx(fme,{onSendToAI:Se})]})})},yme=()=>f.jsxs("footer",{className:"relative mt-12 overflow-hidden",children:[f.jsxs("div",{className:"absolute inset-0 -z-10",children:[f.jsx("div",{className:"absolute left-1/4 transform -translate-x-1/2 bottom-0 w-96 h-96 bg-viridian/30 dark:bg-viridian/20 rounded-full filter blur-[80px]"}),f.jsx("div",{className:"absolute left-3/4 transform -translate-x-1/2 bottom-0 w-96 h-96 bg-emerald/30 dark:bg-emerald/20 rounded-full filter blur-[80px]"}),f.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 bottom-0 w-96 h-96 bg-lime/30 dark:bg-lime/20 rounded-full filter blur-[80px]"})]}),f.jsxs("div",{className:"container mx-auto px-4 py-16",children:[f.jsxs("div",{className:"grid md:grid-cols-3 gap-12 mb-12",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-2xl font-bold mb-4 text-viridian dark:text-viridian",children:"Blockswarm"}),f.jsx("p",{className:"text-light-subtext dark:text-dark-subtext mb-4",children:"AI-Powered Solana Trading Platform with autonomous hedge fund agent offering 24/7 market analysis, trading signals, and portfolio tracking."}),f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsx("a",{href:"https://twitter.com",target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 rounded-full bg-viridian/10 dark:bg-viridian/20 border border-viridian/30 dark:border-viridian/40 flex items-center justify-center text-viridian hover:bg-viridian/20 dark:hover:bg-viridian/30 transition-colors","aria-label":"Twitter",children:f.jsx(TC,{size:18})}),f.jsx("a",{href:"https://discord.com",target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 rounded-full bg-viridian/10 dark:bg-viridian/20 border border-viridian/30 dark:border-viridian/40 flex items-center justify-center text-viridian hover:bg-viridian/20 dark:hover:bg-viridian/30 transition-colors","aria-label":"Discord",children:f.jsx(d0,{size:18})}),f.jsx("a",{href:"https://telegram.org",target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 rounded-full bg-viridian/10 dark:bg-viridian/20 border border-viridian/30 dark:border-viridian/40 flex items-center justify-center text-viridian hover:bg-viridian/20 dark:hover:bg-viridian/30 transition-colors","aria-label":"Telegram",children:f.jsx(FS,{size:18})})]})]}),f.jsxs("div",{children:[f.jsx("h4",{className:"text-lg font-semibold mb-4 text-light-text dark:text-dark-text",children:"Resources"}),f.jsxs("ul",{className:"space-y-3",children:[f.jsx("li",{children:f.jsxs("a",{href:"#",className:"text-light-subtext dark:text-dark-subtext hover:text-viridian dark:hover:text-viridian transition-colors flex items-center",children:[f.jsx(au,{size:14,className:"mr-2"}),"Documentation"]})}),f.jsx("li",{children:f.jsxs("a",{href:"#",className:"text-light-subtext dark:text-dark-subtext hover:text-viridian dark:hover:text-viridian transition-colors flex items-center",children:[f.jsx(au,{size:14,className:"mr-2"}),"API Reference"]})}),f.jsx("li",{children:f.jsxs("a",{href:"#",className:"text-light-subtext dark:text-dark-subtext hover:text-viridian dark:hover:text-viridian transition-colors flex items-center",children:[f.jsx(au,{size:14,className:"mr-2"}),"Trading Guides"]})}),f.jsx("li",{children:f.jsxs("a",{href:"#",className:"text-light-subtext dark:text-dark-subtext hover:text-viridian dark:hover:text-viridian transition-colors flex items-center",children:[f.jsx(au,{size:14,className:"mr-2"}),"FAQ"]})}),f.jsx("li",{children:f.jsxs("a",{href:"#",className:"text-light-subtext dark:text-dark-subtext hover:text-viridian dark:hover:text-viridian transition-colors flex items-center",children:[f.jsx(au,{size:14,className:"mr-2"}),"Blog"]})})]})]}),f.jsxs("div",{children:[f.jsx("h4",{className:"text-lg font-semibold mb-4 text-light-text dark:text-dark-text",children:"Connect With Us"}),f.jsx("p",{className:"text-light-subtext dark:text-dark-subtext mb-6",children:"Join the TradesXBT community for the latest updates, trading insights, and exclusive opportunities."}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("input",{type:"email",placeholder:"Enter your email",className:"flex-1 bg-light-bg/90 dark:bg-dark-bg/90 border border-light-border/20 dark:border-viridian/40 rounded-lg py-3 px-4 text-light-text dark:text-dark-text placeholder:text-light-subtext dark:placeholder:text-dark-subtext focus:outline-none focus:border-viridian/40 dark:focus:border-viridian/70"}),f.jsx("button",{className:"p-3 bg-viridian dark:bg-viridian/90 text-white dark:text-white rounded-lg hover:bg-smaragdine dark:hover:bg-smaragdine transition-colors flex items-center justify-center",children:f.jsx(SY,{size:20})})]})]})]}),f.jsx("div",{className:"relative py-8 mt-8 border-t border-light-border/10 dark:border-viridian/20",children:f.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[f.jsxs("p",{className:"text-sm text-light-subtext dark:text-dark-subtext mb-4 md:mb-0",children:[" ",new Date().getFullYear()," TradesXBT. All rights reserved."]}),f.jsxs("div",{className:"flex items-center space-x-6",children:[f.jsxs("a",{href:"https://twitter.com",target:"_blank",rel:"noopener noreferrer",className:"group relative",children:[f.jsx("div",{className:"absolute inset-0 bg-viridian/20 dark:bg-viridian/30 rounded-full blur-md group-hover:blur-xl transition-all duration-300 opacity-70 group-hover:opacity-100 scale-125"}),f.jsx("div",{className:"relative w-12 h-12 rounded-full bg-viridian/10 dark:bg-viridian/20 border border-viridian/30 dark:border-viridian/40 flex items-center justify-center text-viridian hover:bg-viridian/20 dark:hover:bg-viridian/30 transition-all duration-300 group-hover:scale-110",children:f.jsx(TC,{size:20,className:"group-hover:text-white transition-colors duration-300"})}),f.jsx("span",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 text-xs text-light-subtext dark:text-dark-subtext opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:"X"})]}),f.jsxs("a",{href:"https://discord.com",target:"_blank",rel:"noopener noreferrer",className:"group relative",children:[f.jsx("div",{className:"absolute inset-0 bg-emerald/20 dark:bg-emerald/30 rounded-full blur-md group-hover:blur-xl transition-all duration-300 opacity-70 group-hover:opacity-100 scale-125"}),f.jsx("div",{className:"relative w-12 h-12 rounded-full bg-viridian/10 dark:bg-viridian/20 border border-viridian/30 dark:border-viridian/40 flex items-center justify-center text-viridian hover:bg-viridian/20 dark:hover:bg-viridian/30 transition-all duration-300 group-hover:scale-110",children:f.jsx(d0,{size:20,className:"group-hover:text-white transition-colors duration-300"})}),f.jsx("span",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 text-xs text-light-subtext dark:text-dark-subtext opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:"Discord"})]}),f.jsxs("a",{href:"https://telegram.org",target:"_blank",rel:"noopener noreferrer",className:"group relative",children:[f.jsx("div",{className:"absolute inset-0 bg-lime/20 dark:bg-lime/30 rounded-full blur-md group-hover:blur-xl transition-all duration-300 opacity-70 group-hover:opacity-100 scale-125"}),f.jsx("div",{className:"relative w-12 h-12 rounded-full bg-viridian/10 dark:bg-viridian/20 border border-viridian/30 dark:border-viridian/40 flex items-center justify-center text-viridian hover:bg-viridian/20 dark:hover:bg-viridian/30 transition-all duration-300 group-hover:scale-110",children:f.jsx(FS,{size:20,className:"group-hover:text-white transition-colors duration-300"})}),f.jsx("span",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 text-xs text-light-subtext dark:text-dark-subtext opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:"Telegram"})]})]})]})})]})]}),NM=k.createContext({});function Bd(n){const e=k.useRef(null);return e.current===null&&(e.current=n()),e.current}const Sx=k.createContext(null),Ex=k.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class vme extends k.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function xme({children:n,isPresent:e}){const t=k.useId(),r=k.useRef(null),i=k.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=k.useContext(Ex);return k.useInsertionEffect(()=>{const{width:a,height:o,top:l,left:c}=i.current;if(e||!r.current||!a||!o)return;r.current.dataset.motionPopId=t;const u=document.createElement("style");return s&&(u.nonce=s),document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${o}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[e]),f.jsx(vme,{isPresent:e,childRef:r,sizeRef:i,children:k.cloneElement(n,{ref:r})})}const _me=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:s,mode:a})=>{const o=Bd(bme),l=k.useId(),c=k.useCallback(d=>{o.set(d,!0);for(const h of o.values())if(!h)return;r&&r()},[o,r]),u=k.useMemo(()=>({id:l,initial:e,isPresent:t,custom:i,onExitComplete:c,register:d=>(o.set(d,!1),()=>o.delete(d))}),s?[Math.random(),c]:[t,c]);return k.useMemo(()=>{o.forEach((d,h)=>o.set(h,!1))},[t]),k.useEffect(()=>{!t&&!o.size&&r&&r()},[t]),a==="popLayout"&&(n=f.jsx(xme,{isPresent:t,children:n})),f.jsx(Sx.Provider,{value:u,children:n})};function bme(){return new Map}function tB(n=!0){const e=k.useContext(Sx);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,s=k.useId();k.useEffect(()=>{n&&i(s)},[n]);const a=k.useCallback(()=>n&&r&&r(s),[s,r,n]);return!t&&r?[!1,a]:[!0]}const Xg=n=>n.key||"";function KN(n){const e=[];return k.Children.forEach(n,t=>{k.isValidElement(t)&&e.push(t)}),e}const OM=typeof window<"u",Tx=OM?k.useLayoutEffect:k.useEffect,wme=({children:n,custom:e,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:s="sync",propagate:a=!1})=>{const[o,l]=tB(a),c=k.useMemo(()=>KN(n),[n]),u=a&&!o?[]:c.map(Xg),d=k.useRef(!0),h=k.useRef(c),p=Bd(()=>new Map),[y,v]=k.useState(c),[g,m]=k.useState(c);Tx(()=>{d.current=!1,h.current=c;for(let b=0;b<g.length;b++){const w=Xg(g[b]);u.includes(w)?p.delete(w):p.get(w)!==!0&&p.set(w,!1)}},[g,u.length,u.join("-")]);const x=[];if(c!==y){let b=[...c];for(let w=0;w<g.length;w++){const E=g[w],S=Xg(E);u.includes(S)||(b.splice(w,0,E),x.push(E))}s==="wait"&&x.length&&(b=x),m(KN(b)),v(c);return}const{forceRender:_}=k.useContext(NM);return f.jsx(f.Fragment,{children:g.map(b=>{const w=Xg(b),E=a&&!o?!1:c===g||u.includes(w),S=()=>{if(p.has(w))p.set(w,!0);else return;let M=!0;p.forEach(N=>{N||(M=!1)}),M&&(_==null||_(),m(h.current),a&&(l==null||l()),r&&r())};return f.jsx(_me,{isPresent:E,initial:!d.current||t?void 0:!1,custom:E?void 0:e,presenceAffectsLayout:i,mode:s,onExitComplete:E?void 0:S,children:b},w)})})},xr=n=>n;let Sme=xr,N1=xr;function LM(n){let e;return()=>(e===void 0&&(e=n()),e)}const yc=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r},Ma=n=>n*1e3,ka=n=>n/1e3,Eme={skipAnimations:!1,useManualTiming:!1};function Tme(n){let e=new Set,t=new Set,r=!1,i=!1;const s=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function o(c){s.has(c)&&(l.schedule(c),n()),c(a)}const l={schedule:(c,u=!1,d=!1)=>{const p=d&&r?e:t;return u&&s.add(c),p.has(c)||p.add(c),c},cancel:c=>{t.delete(c),s.delete(c)},process:c=>{if(a=c,r){i=!0;return}r=!0,[e,t]=[t,e],e.forEach(o),e.clear(),r=!1,i&&(i=!1,l.process(c))}};return l}const Yg=["read","resolveKeyframes","update","preRender","render","postRender"],Mme=40;function nB(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,a=Yg.reduce((m,x)=>(m[x]=Tme(s),m),{}),{read:o,resolveKeyframes:l,update:c,preRender:u,render:d,postRender:h}=a,p=()=>{const m=performance.now();t=!1,i.delta=r?1e3/60:Math.max(Math.min(m-i.timestamp,Mme),1),i.timestamp=m,i.isProcessing=!0,o.process(i),l.process(i),c.process(i),u.process(i),d.process(i),h.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(p))},y=()=>{t=!0,r=!0,i.isProcessing||n(p)};return{schedule:Yg.reduce((m,x)=>{const _=a[x];return m[x]=(b,w=!1,E=!1)=>(t||y(),_.schedule(b,w,E)),m},{}),cancel:m=>{for(let x=0;x<Yg.length;x++)a[Yg[x]].cancel(m)},state:i,steps:a}}const{schedule:Ct,cancel:as,state:Rn,steps:iw}=nB(typeof requestAnimationFrame<"u"?requestAnimationFrame:xr,!0),rB=k.createContext({strict:!1}),ZN={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},bd={};for(const n in ZN)bd[n]={isEnabled:e=>ZN[n].some(t=>!!e[t])};function kme(n){for(const e in n)bd[e]={...bd[e],...n[e]}}const Ame=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function X0(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||Ame.has(n)}let iB=n=>!X0(n);function Pme(n){n&&(iB=e=>e.startsWith("on")?!X0(e):n(e))}try{Pme(require("@emotion/is-prop-valid").default)}catch{}function Cme(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(iB(i)||t===!0&&X0(i)||!e&&!X0(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}function Rme(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...r)=>n(...r);return new Proxy(t,{get:(r,i)=>i==="create"?n:(e.has(i)||e.set(i,n(i)),e.get(i))})}const Mx=k.createContext({});function Mp(n){return typeof n=="string"||Array.isArray(n)}function kx(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const DM=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],IM=["initial",...DM];function Ax(n){return kx(n.animate)||IM.some(e=>Mp(n[e]))}function sB(n){return!!(Ax(n)||n.variants)}function Nme(n,e){if(Ax(n)){const{initial:t,animate:r}=n;return{initial:t===!1||Mp(t)?t:void 0,animate:Mp(r)?r:void 0}}return n.inherit!==!1?e:{}}function Ome(n){const{initial:e,animate:t}=Nme(n,k.useContext(Mx));return k.useMemo(()=>({initial:e,animate:t}),[JN(e),JN(t)])}function JN(n){return Array.isArray(n)?n.join(" "):n}const Lme=Symbol.for("motionComponentSymbol");function Ru(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function Dme(n,e,t){return k.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):Ru(t)&&(t.current=r))},[e])}const jM=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Ime="framerAppearId",aB="data-"+jM(Ime),{schedule:FM,cancel:t_e}=nB(queueMicrotask,!1),oB=k.createContext({});function jme(n,e,t,r,i){var s,a;const{visualElement:o}=k.useContext(Mx),l=k.useContext(rB),c=k.useContext(Sx),u=k.useContext(Ex).reducedMotion,d=k.useRef(null);r=r||l.renderer,!d.current&&r&&(d.current=r(n,{visualState:e,parent:o,props:t,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:u}));const h=d.current,p=k.useContext(oB);h&&!h.projection&&i&&(h.type==="html"||h.type==="svg")&&Fme(d.current,t,i,p);const y=k.useRef(!1);k.useInsertionEffect(()=>{h&&y.current&&h.update(t,c)});const v=t[aB],g=k.useRef(!!v&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,v))&&((a=window.MotionHasOptimisedAnimation)===null||a===void 0?void 0:a.call(window,v)));return Tx(()=>{h&&(y.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),FM.render(h.render),g.current&&h.animationState&&h.animationState.animateChanges())}),k.useEffect(()=>{h&&(!g.current&&h.animationState&&h.animationState.animateChanges(),g.current&&(queueMicrotask(()=>{var m;(m=window.MotionHandoffMarkAsComplete)===null||m===void 0||m.call(window,v)}),g.current=!1))}),h}function Fme(n,e,t,r){const{layoutId:i,layout:s,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:c}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:lB(n.parent)),n.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!a||o&&Ru(o),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:r,layoutScroll:l,layoutRoot:c})}function lB(n){if(n)return n.options.allowProjection!==!1?n.projection:lB(n.parent)}function Ume({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:r,Component:i}){var s,a;n&&kme(n);function o(c,u){let d;const h={...k.useContext(Ex),...c,layoutId:Bme(c)},{isStatic:p}=h,y=Ome(c),v=r(c,p);if(!p&&OM){zme();const g=$me(h);d=g.MeasureLayout,y.visualElement=jme(i,v,h,e,g.ProjectionNode)}return f.jsxs(Mx.Provider,{value:y,children:[d&&y.visualElement?f.jsx(d,{visualElement:y.visualElement,...h}):null,t(i,c,Dme(v,y.visualElement,u),v,p,y.visualElement)]})}o.displayName=`motion.${typeof i=="string"?i:`create(${(a=(s=i.displayName)!==null&&s!==void 0?s:i.name)!==null&&a!==void 0?a:""})`}`;const l=k.forwardRef(o);return l[Lme]=i,l}function Bme({layoutId:n}){const e=k.useContext(NM).id;return e&&n!==void 0?e+"-"+n:n}function zme(n,e){k.useContext(rB).strict}function $me(n){const{drag:e,layout:t}=bd;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e!=null&&e.isEnabled(n)||t!=null&&t.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const Vme=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function UM(n){return typeof n!="string"||n.includes("-")?!1:!!(Vme.indexOf(n)>-1||/[A-Z]/u.test(n))}function QN(n){const e=[{},{}];return n==null||n.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function BM(n,e,t,r){if(typeof e=="function"){const[i,s]=QN(r);e=e(t!==void 0?t:n.custom,i,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,s]=QN(r);e=e(t!==void 0?t:n.custom,i,s)}return e}const O1=n=>Array.isArray(n),Hme=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),Wme=n=>O1(n)?n[n.length-1]||0:n,ir=n=>!!(n&&n.getVelocity);function Sy(n){const e=ir(n)?n.get():n;return Hme(e)?e.toValue():e}function Gme({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},r,i,s){const a={latestValues:qme(r,i,s,n),renderState:e()};return t&&(a.onMount=o=>t({props:r,current:o,...a}),a.onUpdate=o=>t(o)),a}const cB=n=>(e,t)=>{const r=k.useContext(Mx),i=k.useContext(Sx),s=()=>Gme(n,e,r,i);return t?s():Bd(s)};function qme(n,e,t,r){const i={},s=r(n,{});for(const h in s)i[h]=Sy(s[h]);let{initial:a,animate:o}=n;const l=Ax(n),c=sB(n);e&&c&&!l&&n.inherit!==!1&&(a===void 0&&(a=e.initial),o===void 0&&(o=e.animate));let u=t?t.initial===!1:!1;u=u||a===!1;const d=u?o:a;if(d&&typeof d!="boolean"&&!kx(d)){const h=Array.isArray(d)?d:[d];for(let p=0;p<h.length;p++){const y=BM(n,h[p]);if(y){const{transitionEnd:v,transition:g,...m}=y;for(const x in m){let _=m[x];if(Array.isArray(_)){const b=u?_.length-1:0;_=_[b]}_!==null&&(i[x]=_)}for(const x in v)i[x]=v[x]}}}return i}const zd=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Ac=new Set(zd),uB=n=>e=>typeof e=="string"&&e.startsWith(n),dB=uB("--"),Xme=uB("var(--"),zM=n=>Xme(n)?Yme.test(n.split("/*")[0].trim()):!1,Yme=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,hB=(n,e)=>e&&typeof n=="number"?e.transform(n):n,Fs=(n,e,t)=>t>e?e:t<n?n:t,$d={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},kp={...$d,transform:n=>Fs(0,1,n)},Kg={...$d,default:1},om=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),ro=om("deg"),Os=om("%"),Ge=om("px"),Kme=om("vh"),Zme=om("vw"),eO={...Os,parse:n=>Os.parse(n)/100,transform:n=>Os.transform(n*100)},Jme={borderWidth:Ge,borderTopWidth:Ge,borderRightWidth:Ge,borderBottomWidth:Ge,borderLeftWidth:Ge,borderRadius:Ge,radius:Ge,borderTopLeftRadius:Ge,borderTopRightRadius:Ge,borderBottomRightRadius:Ge,borderBottomLeftRadius:Ge,width:Ge,maxWidth:Ge,height:Ge,maxHeight:Ge,top:Ge,right:Ge,bottom:Ge,left:Ge,padding:Ge,paddingTop:Ge,paddingRight:Ge,paddingBottom:Ge,paddingLeft:Ge,margin:Ge,marginTop:Ge,marginRight:Ge,marginBottom:Ge,marginLeft:Ge,backgroundPositionX:Ge,backgroundPositionY:Ge},Qme={rotate:ro,rotateX:ro,rotateY:ro,rotateZ:ro,scale:Kg,scaleX:Kg,scaleY:Kg,scaleZ:Kg,skew:ro,skewX:ro,skewY:ro,distance:Ge,translateX:Ge,translateY:Ge,translateZ:Ge,x:Ge,y:Ge,z:Ge,perspective:Ge,transformPerspective:Ge,opacity:kp,originX:eO,originY:eO,originZ:Ge},tO={...$d,transform:Math.round},$M={...Jme,...Qme,zIndex:tO,size:Ge,fillOpacity:kp,strokeOpacity:kp,numOctaves:tO},ege={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},tge=zd.length;function nge(n,e,t){let r="",i=!0;for(let s=0;s<tge;s++){const a=zd[s],o=n[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||t){const c=hB(o,$M[a]);if(!l){i=!1;const u=ege[a]||a;r+=`${u}(${c}) `}t&&(e[a]=c)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function VM(n,e,t){const{style:r,vars:i,transformOrigin:s}=n;let a=!1,o=!1;for(const l in e){const c=e[l];if(Ac.has(l)){a=!0;continue}else if(dB(l)){i[l]=c;continue}else{const u=hB(c,$M[l]);l.startsWith("origin")?(o=!0,s[l]=u):r[l]=u}}if(e.transform||(a||t?r.transform=nge(e,n.transform,t):r.transform&&(r.transform="none")),o){const{originX:l="50%",originY:c="50%",originZ:u=0}=s;r.transformOrigin=`${l} ${c} ${u}`}}const rge={offset:"stroke-dashoffset",array:"stroke-dasharray"},ige={offset:"strokeDashoffset",array:"strokeDasharray"};function sge(n,e,t=1,r=0,i=!0){n.pathLength=1;const s=i?rge:ige;n[s.offset]=Ge.transform(-r);const a=Ge.transform(e),o=Ge.transform(t);n[s.array]=`${a} ${o}`}function nO(n,e,t){return typeof n=="string"?n:Ge.transform(e+t*n)}function age(n,e,t){const r=nO(e,n.x,n.width),i=nO(t,n.y,n.height);return`${r} ${i}`}function HM(n,{attrX:e,attrY:t,attrScale:r,originX:i,originY:s,pathLength:a,pathSpacing:o=1,pathOffset:l=0,...c},u,d){if(VM(n,c,d),u){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:h,style:p,dimensions:y}=n;h.transform&&(y&&(p.transform=h.transform),delete h.transform),y&&(i!==void 0||s!==void 0||p.transform)&&(p.transformOrigin=age(y,i!==void 0?i:.5,s!==void 0?s:.5)),e!==void 0&&(h.x=e),t!==void 0&&(h.y=t),r!==void 0&&(h.scale=r),a!==void 0&&sge(h,a,o,l,!1)}const WM=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),fB=()=>({...WM(),attrs:{}}),GM=n=>typeof n=="string"&&n.toLowerCase()==="svg";function pB(n,{style:e,vars:t},r,i){Object.assign(n.style,e,i&&i.getProjectionStyles(r));for(const s in t)n.style.setProperty(s,t[s])}const mB=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function gB(n,e,t,r){pB(n,e,void 0,r);for(const i in e.attrs)n.setAttribute(mB.has(i)?i:jM(i),e.attrs[i])}const Y0={};function oge(n){Object.assign(Y0,n)}function yB(n,{layout:e,layoutId:t}){return Ac.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!Y0[n]||n==="opacity")}function qM(n,e,t){var r;const{style:i}=n,s={};for(const a in i)(ir(i[a])||e.style&&ir(e.style[a])||yB(a,n)||((r=t==null?void 0:t.getValue(a))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(s[a]=i[a]);return s}function vB(n,e,t){const r=qM(n,e,t);for(const i in n)if(ir(n[i])||ir(e[i])){const s=zd.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[s]=n[i]}return r}function lge(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const rO=["x","y","width","height","cx","cy","r"],cge={useVisualState:cB({scrapeMotionValuesFromProps:vB,createRenderState:fB,onUpdate:({props:n,prevProps:e,current:t,renderState:r,latestValues:i})=>{if(!t)return;let s=!!n.drag;if(!s){for(const o in i)if(Ac.has(o)){s=!0;break}}if(!s)return;let a=!e;if(e)for(let o=0;o<rO.length;o++){const l=rO[o];n[l]!==e[l]&&(a=!0)}a&&Ct.read(()=>{lge(t,r),Ct.render(()=>{HM(r,i,GM(t.tagName),n.transformTemplate),gB(t,r)})})}})},uge={useVisualState:cB({scrapeMotionValuesFromProps:qM,createRenderState:WM})};function xB(n,e,t){for(const r in e)!ir(e[r])&&!yB(r,t)&&(n[r]=e[r])}function dge({transformTemplate:n},e){return k.useMemo(()=>{const t=WM();return VM(t,e,n),Object.assign({},t.vars,t.style)},[e])}function hge(n,e){const t=n.style||{},r={};return xB(r,t,n),Object.assign(r,dge(n,e)),r}function fge(n,e){const t={},r=hge(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}function pge(n,e,t,r){const i=k.useMemo(()=>{const s=fB();return HM(s,e,GM(r),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};xB(s,n.style,n),i.style={...s,...i.style}}return i}function mge(n=!1){return(t,r,i,{latestValues:s},a)=>{const l=(UM(t)?pge:fge)(r,s,a,t),c=Cme(r,typeof t=="string",n),u=t!==k.Fragment?{...c,...l,ref:i}:{},{children:d}=r,h=k.useMemo(()=>ir(d)?d.get():d,[d]);return k.createElement(t,{...u,children:h})}}function gge(n,e){return function(r,{forwardMotionProps:i}={forwardMotionProps:!1}){const a={...UM(r)?cge:uge,preloadedFeatures:n,useRender:mge(i),createVisualElement:e,Component:r};return Ume(a)}}function _B(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}function Px(n,e,t){const r=n.getProps();return BM(r,e,t!==void 0?t:r.custom,n)}const bB=LM(()=>window.ScrollTimeline!==void 0);class yge{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let r=0;r<this.animations.length;r++)this.animations[r][e]=t}attachTimeline(e,t){const r=this.animations.map(i=>{if(bB()&&i.attachTimeline)return i.attachTimeline(e);if(typeof t=="function")return t(i)});return()=>{r.forEach((i,s)=>{i&&i(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class vge extends yge{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function XM(n,e){return n?n[e]||n.default||n:void 0}const L1=2e4;function wB(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<L1;)e+=t,r=n.next(e);return e>=L1?1/0:e}function YM(n){return typeof n=="function"}function iO(n,e){n.timeline=e,n.onfinish=null}const KM=n=>Array.isArray(n)&&typeof n[0]=="number",xge={linearEasing:void 0};function _ge(n,e){const t=LM(n);return()=>{var r;return(r=xge[e])!==null&&r!==void 0?r:t()}}const K0=_ge(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),SB=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let s=0;s<i;s++)r+=n(yc(0,i-1,s))+", ";return`linear(${r.substring(0,r.length-2)})`};function EB(n){return!!(typeof n=="function"&&K0()||!n||typeof n=="string"&&(n in D1||K0())||KM(n)||Array.isArray(n)&&n.every(EB))}const Yh=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,D1={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Yh([0,.65,.55,1]),circOut:Yh([.55,0,1,.45]),backIn:Yh([.31,.01,.66,-.59]),backOut:Yh([.33,1.53,.69,.99])};function TB(n,e){if(n)return typeof n=="function"&&K0()?SB(n,e):KM(n)?Yh(n):Array.isArray(n)?n.map(t=>TB(t,e)||D1.easeOut):D1[n]}const Bi={x:!1,y:!1};function MB(){return Bi.x||Bi.y}function kB(n,e,t){var r;if(n instanceof Element)return[n];if(typeof n=="string"){let i=document;const s=(r=void 0)!==null&&r!==void 0?r:i.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function AB(n,e){const t=kB(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function sO(n){return e=>{e.pointerType==="touch"||MB()||n(e)}}function bge(n,e,t={}){const[r,i,s]=AB(n,t),a=sO(o=>{const{target:l}=o,c=e(o);if(typeof c!="function"||!l)return;const u=sO(d=>{c(d),l.removeEventListener("pointerleave",u)});l.addEventListener("pointerleave",u,i)});return r.forEach(o=>{o.addEventListener("pointerenter",a,i)}),s}const PB=(n,e)=>e?n===e?!0:PB(n,e.parentElement):!1,ZM=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,wge=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Sge(n){return wge.has(n.tagName)||n.tabIndex!==-1}const Kh=new WeakSet;function aO(n){return e=>{e.key==="Enter"&&n(e)}}function sw(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const Ege=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=aO(()=>{if(Kh.has(t))return;sw(t,"down");const i=aO(()=>{sw(t,"up")}),s=()=>sw(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function oO(n){return ZM(n)&&!MB()}function Tge(n,e,t={}){const[r,i,s]=AB(n,t),a=o=>{const l=o.currentTarget;if(!oO(o)||Kh.has(l))return;Kh.add(l);const c=e(o),u=(p,y)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",h),!(!oO(p)||!Kh.has(l))&&(Kh.delete(l),typeof c=="function"&&c(p,{success:y}))},d=p=>{u(p,t.useGlobalTarget||PB(l,p.target))},h=p=>{u(p,!1)};window.addEventListener("pointerup",d,i),window.addEventListener("pointercancel",h,i)};return r.forEach(o=>{!Sge(o)&&o.getAttribute("tabindex")===null&&(o.tabIndex=0),(t.useGlobalTarget?window:o).addEventListener("pointerdown",a,i),o.addEventListener("focus",c=>Ege(c,i),i)}),s}function Mge(n){return n==="x"||n==="y"?Bi[n]?null:(Bi[n]=!0,()=>{Bi[n]=!1}):Bi.x||Bi.y?null:(Bi.x=Bi.y=!0,()=>{Bi.x=Bi.y=!1})}const CB=new Set(["width","height","top","left","right","bottom",...zd]);let Ey;function kge(){Ey=void 0}const Ls={now:()=>(Ey===void 0&&Ls.set(Rn.isProcessing||Eme.useManualTiming?Rn.timestamp:performance.now()),Ey),set:n=>{Ey=n,queueMicrotask(kge)}};function JM(n,e){n.indexOf(e)===-1&&n.push(e)}function QM(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class ek{constructor(){this.subscriptions=[]}add(e){return JM(this.subscriptions,e),()=>QM(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let s=0;s<i;s++){const a=this.subscriptions[s];a&&a(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function tk(n,e){return e?n*(1e3/e):0}const lO=30,Age=n=>!isNaN(parseFloat(n)),Tf={current:void 0};class Pge{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,i=!0)=>{const s=Ls.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=Ls.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=Age(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new ek);const r=this.events[e].add(t);return e==="change"?()=>{r(),Ct.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return Tf.current&&Tf.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=Ls.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>lO)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,lO);return tk(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Ps(n,e){return new Pge(n,e)}function Cge(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,Ps(t))}function Rge(n,e){const t=Px(n,e);let{transitionEnd:r={},transition:i={},...s}=t||{};s={...s,...r};for(const a in s){const o=Wme(s[a]);Cge(n,a,o)}}function Nge(n){return!!(ir(n)&&n.add)}function I1(n,e){const t=n.getValue("willChange");if(Nge(t))return t.add(e)}function RB(n){return n.props[aB]}const NB=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,Oge=1e-7,Lge=12;function Dge(n,e,t,r,i){let s,a,o=0;do a=e+(t-e)/2,s=NB(a,r,i)-n,s>0?t=a:e=a;while(Math.abs(s)>Oge&&++o<Lge);return a}function lm(n,e,t,r){if(n===e&&t===r)return xr;const i=s=>Dge(s,0,1,n,t);return s=>s===0||s===1?s:NB(i(s),e,r)}const OB=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,LB=n=>e=>1-n(1-e),DB=lm(.33,1.53,.69,.99),nk=LB(DB),IB=OB(nk),jB=n=>(n*=2)<1?.5*nk(n):.5*(2-Math.pow(2,-10*(n-1))),rk=n=>1-Math.sin(Math.acos(n)),FB=LB(rk),UB=OB(rk),BB=n=>/^0[^.\s]+$/u.test(n);function Ige(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||BB(n):!0}const Mf=n=>Math.round(n*1e5)/1e5,ik=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function jge(n){return n==null}const Fge=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,sk=(n,e)=>t=>!!(typeof t=="string"&&Fge.test(t)&&t.startsWith(n)||e&&!jge(t)&&Object.prototype.hasOwnProperty.call(t,e)),zB=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,s,a,o]=r.match(ik);return{[n]:parseFloat(i),[e]:parseFloat(s),[t]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},Uge=n=>Fs(0,255,n),aw={...$d,transform:n=>Math.round(Uge(n))},$l={test:sk("rgb","red"),parse:zB("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+aw.transform(n)+", "+aw.transform(e)+", "+aw.transform(t)+", "+Mf(kp.transform(r))+")"};function Bge(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const j1={test:sk("#"),parse:Bge,transform:$l.transform},Nu={test:sk("hsl","hue"),parse:zB("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+Os.transform(Mf(e))+", "+Os.transform(Mf(t))+", "+Mf(kp.transform(r))+")"},Jn={test:n=>$l.test(n)||j1.test(n)||Nu.test(n),parse:n=>$l.test(n)?$l.parse(n):Nu.test(n)?Nu.parse(n):j1.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?$l.transform(n):Nu.transform(n)},zge=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function $ge(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(ik))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(zge))===null||t===void 0?void 0:t.length)||0)>0}const $B="number",VB="color",Vge="var",Hge="var(",cO="${}",Wge=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Ap(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let s=0;const o=e.replace(Wge,l=>(Jn.test(l)?(r.color.push(s),i.push(VB),t.push(Jn.parse(l))):l.startsWith(Hge)?(r.var.push(s),i.push(Vge),t.push(l)):(r.number.push(s),i.push($B),t.push(parseFloat(l))),++s,cO)).split(cO);return{values:t,split:o,indexes:r,types:i}}function HB(n){return Ap(n).values}function WB(n){const{split:e,types:t}=Ap(n),r=e.length;return i=>{let s="";for(let a=0;a<r;a++)if(s+=e[a],i[a]!==void 0){const o=t[a];o===$B?s+=Mf(i[a]):o===VB?s+=Jn.transform(i[a]):s+=i[a]}return s}}const Gge=n=>typeof n=="number"?0:n;function qge(n){const e=HB(n);return WB(n)(e.map(Gge))}const Xo={test:$ge,parse:HB,createTransformer:WB,getAnimatableNone:qge},Xge=new Set(["brightness","contrast","saturate","opacity"]);function Yge(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(ik)||[];if(!r)return n;const i=t.replace(r,"");let s=Xge.has(e)?1:0;return r!==t&&(s*=100),e+"("+s+i+")"}const Kge=/\b([a-z-]*)\(.*?\)/gu,F1={...Xo,getAnimatableNone:n=>{const e=n.match(Kge);return e?e.map(Yge).join(" "):n}},Zge={...$M,color:Jn,backgroundColor:Jn,outlineColor:Jn,fill:Jn,stroke:Jn,borderColor:Jn,borderTopColor:Jn,borderRightColor:Jn,borderBottomColor:Jn,borderLeftColor:Jn,filter:F1,WebkitFilter:F1},ak=n=>Zge[n];function GB(n,e){let t=ak(n);return t!==F1&&(t=Xo),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const Jge=new Set(["auto","none","0"]);function Qge(n,e,t){let r=0,i;for(;r<n.length&&!i;){const s=n[r];typeof s=="string"&&!Jge.has(s)&&Ap(s).values.length&&(i=n[r]),r++}if(i&&t)for(const s of e)n[s]=GB(t,i)}const uO=n=>n===$d||n===Ge,dO=(n,e)=>parseFloat(n.split(", ")[e]),hO=(n,e)=>(t,{transform:r})=>{if(r==="none"||!r)return 0;const i=r.match(/^matrix3d\((.+)\)$/u);if(i)return dO(i[1],e);{const s=r.match(/^matrix\((.+)\)$/u);return s?dO(s[1],n):0}},eye=new Set(["x","y","z"]),tye=zd.filter(n=>!eye.has(n));function nye(n){const e=[];return tye.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const wd={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:hO(4,13),y:hO(5,14)};wd.translateX=wd.x;wd.translateY=wd.y;const ec=new Set;let U1=!1,B1=!1;function qB(){if(B1){const n=Array.from(ec).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=nye(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([s,a])=>{var o;(o=r.getValue(s))===null||o===void 0||o.set(a)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}B1=!1,U1=!1,ec.forEach(n=>n.complete()),ec.clear()}function XB(){ec.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(B1=!0)})}function rye(){XB(),qB()}class ok{constructor(e,t,r,i,s,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=s,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(ec.add(this),U1||(U1=!0,Ct.read(XB),Ct.resolveKeyframes(qB))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const a=i==null?void 0:i.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&t){const l=r.readValue(t,o);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),ec.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,ec.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const YB=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),iye=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function sye(n){const e=iye.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function KB(n,e,t=1){const[r,i]=sye(n);if(!r)return;const s=window.getComputedStyle(e).getPropertyValue(r);if(s){const a=s.trim();return YB(a)?parseFloat(a):a}return zM(i)?KB(i,e,t+1):i}const ZB=n=>e=>e.test(n),aye={test:n=>n==="auto",parse:n=>n},JB=[$d,Ge,Os,ro,Zme,Kme,aye],fO=n=>JB.find(ZB(n));class QB extends ok{constructor(e,t,r,i,s){super(e,t,r,i,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),zM(c))){const u=KB(c,t.current);u!==void 0&&(e[l]=u),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!CB.has(r)||e.length!==2)return;const[i,s]=e,a=fO(i),o=fO(s);if(a!==o)if(uO(a)&&uO(o))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)Ige(e[i])&&r.push(i);r.length&&Qge(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=wd[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){var e;const{element:t,name:r,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const s=t.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=i.length-1,o=i[a];i[a]=wd[r](t.measureViewportBox(),window.getComputedStyle(t.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,c])=>{t.getValue(l).set(c)}),this.resolveNoneKeyframes()}}const pO=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(Xo.test(n)||n==="0")&&!n.startsWith("url("));function oye(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function lye(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],a=pO(i,e),o=pO(s,e);return!a||!o?!1:oye(n)||(t==="spring"||YM(t))&&r}const cye=n=>n!==null;function Cx(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter(cye),s=e&&t!=="loop"&&e%2===1?0:i.length-1;return!s||r===void 0?i[s]:r}const uye=40;class ez{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:a="loop",...o}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Ls.now(),this.options={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:s,repeatType:a,...o},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>uye?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&rye(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=Ls.now(),this.hasAttemptedResolve=!0;const{name:r,type:i,velocity:s,delay:a,onComplete:o,onUpdate:l,isGenerator:c}=this.options;if(!c&&!lye(e,r,i,s))if(a)this.options.duration=0;else{l&&l(Cx(e,this.options,t)),o&&o(),this.resolveFinishedPromise();return}const u=this.initPlayback(e,t);u!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...u},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const tn=(n,e,t)=>n+(e-n)*t;function ow(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function dye({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,s=0,a=0;if(!e)i=s=a=t;else{const o=t<.5?t*(1+e):t+e-t*e,l=2*t-o;i=ow(l,o,n+1/3),s=ow(l,o,n),a=ow(l,o,n-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(a*255),alpha:r}}function Z0(n,e){return t=>t>0?e:n}const lw=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},hye=[j1,$l,Nu],fye=n=>hye.find(e=>e.test(n));function mO(n){const e=fye(n);if(!e)return!1;let t=e.parse(n);return e===Nu&&(t=dye(t)),t}const gO=(n,e)=>{const t=mO(n),r=mO(e);if(!t||!r)return Z0(n,e);const i={...t};return s=>(i.red=lw(t.red,r.red,s),i.green=lw(t.green,r.green,s),i.blue=lw(t.blue,r.blue,s),i.alpha=tn(t.alpha,r.alpha,s),$l.transform(i))},pye=(n,e)=>t=>e(n(t)),cm=(...n)=>n.reduce(pye),z1=new Set(["none","hidden"]);function mye(n,e){return z1.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function gye(n,e){return t=>tn(n,e,t)}function lk(n){return typeof n=="number"?gye:typeof n=="string"?zM(n)?Z0:Jn.test(n)?gO:xye:Array.isArray(n)?tz:typeof n=="object"?Jn.test(n)?gO:yye:Z0}function tz(n,e){const t=[...n],r=t.length,i=n.map((s,a)=>lk(s)(s,e[a]));return s=>{for(let a=0;a<r;a++)t[a]=i[a](s);return t}}function yye(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=lk(n[i])(n[i],e[i]));return i=>{for(const s in r)t[s]=r[s](i);return t}}function vye(n,e){var t;const r=[],i={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const a=e.types[s],o=n.indexes[a][i[a]],l=(t=n.values[o])!==null&&t!==void 0?t:0;r[s]=l,i[a]++}return r}const xye=(n,e)=>{const t=Xo.createTransformer(e),r=Ap(n),i=Ap(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?z1.has(n)&&!i.values.length||z1.has(e)&&!r.values.length?mye(n,e):cm(tz(vye(r,i),i.values),t):Z0(n,e)};function nz(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?tn(n,e,t):lk(n)(n,e)}const _ye=5;function rz(n,e,t){const r=Math.max(e-_ye,0);return tk(t-n(r),e-r)}const an={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},cw=.001;function bye({duration:n=an.duration,bounce:e=an.bounce,velocity:t=an.velocity,mass:r=an.mass}){let i,s,a=1-e;a=Fs(an.minDamping,an.maxDamping,a),n=Fs(an.minDuration,an.maxDuration,ka(n)),a<1?(i=c=>{const u=c*a,d=u*n,h=u-t,p=$1(c,a),y=Math.exp(-d);return cw-h/p*y},s=c=>{const d=c*a*n,h=d*t+t,p=Math.pow(a,2)*Math.pow(c,2)*n,y=Math.exp(-d),v=$1(Math.pow(c,2),a);return(-i(c)+cw>0?-1:1)*((h-p)*y)/v}):(i=c=>{const u=Math.exp(-c*n),d=(c-t)*n+1;return-cw+u*d},s=c=>{const u=Math.exp(-c*n),d=(t-c)*(n*n);return u*d});const o=5/n,l=Sye(i,s,o);if(n=Ma(n),isNaN(l))return{stiffness:an.stiffness,damping:an.damping,duration:n};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:a*2*Math.sqrt(r*c),duration:n}}}const wye=12;function Sye(n,e,t){let r=t;for(let i=1;i<wye;i++)r=r-n(r)/e(r);return r}function $1(n,e){return n*Math.sqrt(1-e*e)}const Eye=["duration","bounce"],Tye=["stiffness","damping","mass"];function yO(n,e){return e.some(t=>n[t]!==void 0)}function Mye(n){let e={velocity:an.velocity,stiffness:an.stiffness,damping:an.damping,mass:an.mass,isResolvedFromDuration:!1,...n};if(!yO(n,Tye)&&yO(n,Eye))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,s=2*Fs(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:an.mass,stiffness:i,damping:s}}else{const t=bye(n);e={...e,...t,mass:an.mass},e.isResolvedFromDuration=!0}return e}function iz(n=an.visualDuration,e=an.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const s=t.keyframes[0],a=t.keyframes[t.keyframes.length-1],o={done:!1,value:s},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:p}=Mye({...t,velocity:-ka(t.velocity||0)}),y=h||0,v=c/(2*Math.sqrt(l*u)),g=a-s,m=ka(Math.sqrt(l/u)),x=Math.abs(g)<5;r||(r=x?an.restSpeed.granular:an.restSpeed.default),i||(i=x?an.restDelta.granular:an.restDelta.default);let _;if(v<1){const w=$1(m,v);_=E=>{const S=Math.exp(-v*m*E);return a-S*((y+v*m*g)/w*Math.sin(w*E)+g*Math.cos(w*E))}}else if(v===1)_=w=>a-Math.exp(-m*w)*(g+(y+m*g)*w);else{const w=m*Math.sqrt(v*v-1);_=E=>{const S=Math.exp(-v*m*E),M=Math.min(w*E,300);return a-S*((y+v*m*g)*Math.sinh(M)+w*g*Math.cosh(M))/w}}const b={calculatedDuration:p&&d||null,next:w=>{const E=_(w);if(p)o.done=w>=d;else{let S=0;v<1&&(S=w===0?Ma(y):rz(_,w,E));const M=Math.abs(S)<=r,N=Math.abs(a-E)<=i;o.done=M&&N}return o.value=o.done?a:E,o},toString:()=>{const w=Math.min(wB(b),L1),E=SB(S=>b.next(w*S).value,w,30);return w+"ms "+E}};return b}function vO({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:a,min:o,max:l,restDelta:c=.5,restSpeed:u}){const d=n[0],h={done:!1,value:d},p=M=>o!==void 0&&M<o||l!==void 0&&M>l,y=M=>o===void 0?l:l===void 0||Math.abs(o-M)<Math.abs(l-M)?o:l;let v=t*e;const g=d+v,m=a===void 0?g:a(g);m!==g&&(v=m-d);const x=M=>-v*Math.exp(-M/r),_=M=>m+x(M),b=M=>{const N=x(M),T=_(M);h.done=Math.abs(N)<=c,h.value=h.done?m:T};let w,E;const S=M=>{p(h.value)&&(w=M,E=iz({keyframes:[h.value,y(h.value)],velocity:rz(_,M,h.value),damping:i,stiffness:s,restDelta:c,restSpeed:u}))};return S(0),{calculatedDuration:null,next:M=>{let N=!1;return!E&&w===void 0&&(N=!0,b(M),S(M)),w!==void 0&&M>=w?E.next(M-w):(!N&&b(M),h)}}}const kye=lm(.42,0,1,1),Aye=lm(0,0,.58,1),sz=lm(.42,0,.58,1),Pye=n=>Array.isArray(n)&&typeof n[0]!="number",xO={linear:xr,easeIn:kye,easeInOut:sz,easeOut:Aye,circIn:rk,circInOut:UB,circOut:FB,backIn:nk,backInOut:IB,backOut:DB,anticipate:jB},_O=n=>{if(KM(n)){N1(n.length===4);const[e,t,r,i]=n;return lm(e,t,r,i)}else if(typeof n=="string")return N1(xO[n]!==void 0),xO[n];return n};function Cye(n,e,t){const r=[],i=t||nz,s=n.length-1;for(let a=0;a<s;a++){let o=i(n[a],n[a+1]);if(e){const l=Array.isArray(e)?e[a]||xr:e;o=cm(l,o)}r.push(o)}return r}function ck(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const s=n.length;if(N1(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const a=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const o=Cye(e,r,i),l=o.length,c=u=>{if(a&&u<n[0])return e[0];let d=0;if(l>1)for(;d<n.length-2&&!(u<n[d+1]);d++);const h=yc(n[d],n[d+1],u);return o[d](h)};return t?u=>c(Fs(n[0],n[s-1],u)):c}function Rye(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=yc(0,e,r);n.push(tn(t,1,i))}}function az(n){const e=[0];return Rye(e,n.length-1),e}function Nye(n,e){return n.map(t=>t*e)}function Oye(n,e){return n.map(()=>e||sz).splice(0,n.length-1)}function J0({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=Pye(r)?r.map(_O):_O(r),s={done:!1,value:e[0]},a=Nye(t&&t.length===e.length?t:az(e),n),o=ck(a,e,{ease:Array.isArray(i)?i:Oye(e,i)});return{calculatedDuration:n,next:l=>(s.value=o(l),s.done=l>=n,s)}}const Lye=n=>{const e=({timestamp:t})=>n(t);return{start:()=>Ct.update(e,!0),stop:()=>as(e),now:()=>Rn.isProcessing?Rn.timestamp:Ls.now()}},Dye={decay:vO,inertia:vO,tween:J0,keyframes:J0,spring:iz},Iye=n=>n/100;class uk extends ez{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:t,motionValue:r,element:i,keyframes:s}=this.options,a=(i==null?void 0:i.KeyframeResolver)||ok,o=(l,c)=>this.onKeyframesResolved(l,c);this.resolver=new a(s,o,t,r,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:s,velocity:a=0}=this.options,o=YM(t)?t:Dye[t]||J0;let l,c;o!==J0&&typeof e[0]!="number"&&(l=cm(Iye,nz(e[0],e[1])),e=[0,100]);const u=o({...this.options,keyframes:e});s==="mirror"&&(c=o({...this.options,keyframes:[...e].reverse(),velocity:-a})),u.calculatedDuration===null&&(u.calculatedDuration=wB(u));const{calculatedDuration:d}=u,h=d+i,p=h*(r+1)-i;return{generator:u,mirroredGenerator:c,mapPercentToKeyframes:l,calculatedDuration:d,resolvedDuration:h,totalDuration:p}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:r}=this;if(!r){const{keyframes:M}=this.options;return{done:!0,value:M[M.length-1]}}const{finalKeyframe:i,generator:s,mirroredGenerator:a,mapPercentToKeyframes:o,keyframes:l,calculatedDuration:c,totalDuration:u,resolvedDuration:d}=r;if(this.startTime===null)return s.next(0);const{delay:h,repeat:p,repeatType:y,repeatDelay:v,onUpdate:g}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-u/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const m=this.currentTime-h*(this.speed>=0?1:-1),x=this.speed>=0?m<0:m>u;this.currentTime=Math.max(m,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=u);let _=this.currentTime,b=s;if(p){const M=Math.min(this.currentTime,u)/d;let N=Math.floor(M),T=M%1;!T&&M>=1&&(T=1),T===1&&N--,N=Math.min(N,p+1),!!(N%2)&&(y==="reverse"?(T=1-T,v&&(T-=v/d)):y==="mirror"&&(b=a)),_=Fs(0,1,T)*d}const w=x?{done:!1,value:l[0]}:b.next(_);o&&(w.value=o(w.value));let{done:E}=w;!x&&c!==null&&(E=this.speed>=0?this.currentTime>=u:this.currentTime<=0);const S=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&E);return S&&i!==void 0&&(w.value=Cx(l,this.options,i)),g&&g(w.value),S&&this.finish(),w}get duration(){const{resolved:e}=this;return e?ka(e.calculatedDuration):0}get time(){return ka(this.currentTime)}set time(e){e=Ma(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=ka(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=Lye,onPlay:t,startTime:r}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const jye=new Set(["opacity","clipPath","filter","transform"]);function Fye(n,e,t,{delay:r=0,duration:i=300,repeat:s=0,repeatType:a="loop",ease:o="easeInOut",times:l}={}){const c={[e]:t};l&&(c.offset=l);const u=TB(o,i);return Array.isArray(u)&&(c.easing=u),n.animate(c,{delay:r,duration:i,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:s+1,direction:a==="reverse"?"alternate":"normal"})}const Uye=LM(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Q0=10,Bye=2e4;function zye(n){return YM(n.type)||n.type==="spring"||!EB(n.ease)}function $ye(n,e){const t=new uk({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:n[0]};const i=[];let s=0;for(;!r.done&&s<Bye;)r=t.sample(s),i.push(r.value),s+=Q0;return{times:void 0,keyframes:i,duration:s-Q0,ease:"linear"}}const oz={anticipate:jB,backInOut:IB,circInOut:UB};function Vye(n){return n in oz}class bO extends ez{constructor(e){super(e);const{name:t,motionValue:r,element:i,keyframes:s}=this.options;this.resolver=new QB(s,(a,o)=>this.onKeyframesResolved(a,o),t,r,i),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:r=300,times:i,ease:s,type:a,motionValue:o,name:l,startTime:c}=this.options;if(!o.owner||!o.owner.current)return!1;if(typeof s=="string"&&K0()&&Vye(s)&&(s=oz[s]),zye(this.options)){const{onComplete:d,onUpdate:h,motionValue:p,element:y,...v}=this.options,g=$ye(e,v);e=g.keyframes,e.length===1&&(e[1]=e[0]),r=g.duration,i=g.times,s=g.ease,a="keyframes"}const u=Fye(o.owner.current,l,e,{...this.options,duration:r,times:i,ease:s});return u.startTime=c??this.calcStartTime(),this.pendingTimeline?(iO(u,this.pendingTimeline),this.pendingTimeline=void 0):u.onfinish=()=>{const{onComplete:d}=this.options;o.set(Cx(e,this.options,t)),d&&d(),this.cancel(),this.resolveFinishedPromise()},{animation:u,duration:r,times:i,type:a,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return ka(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return ka(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.currentTime=Ma(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return xr;const{animation:r}=t;iO(r,e)}return xr}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:r,duration:i,type:s,ease:a,times:o}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:c,onUpdate:u,onComplete:d,element:h,...p}=this.options,y=new uk({...p,keyframes:r,duration:i,type:s,ease:a,times:o,isGenerator:!0}),v=Ma(this.time);c.setWithVelocity(y.sample(v-Q0).value,y.sample(v).value,Q0)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:r,repeatDelay:i,repeatType:s,damping:a,type:o}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=t.owner.getProps();return Uye()&&r&&jye.has(r)&&!l&&!c&&!i&&s!=="mirror"&&a!==0&&o!=="inertia"}}const Hye={type:"spring",stiffness:500,damping:25,restSpeed:10},Wye=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),Gye={type:"keyframes",duration:.8},qye={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Xye=(n,{keyframes:e})=>e.length>2?Gye:Ac.has(n)?n.startsWith("scale")?Wye(e[1]):Hye:qye;function Yye({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:a,repeatDelay:o,from:l,elapsed:c,...u}){return!!Object.keys(u).length}const dk=(n,e,t,r={},i,s)=>a=>{const o=XM(r,n)||{},l=o.delay||r.delay||0;let{elapsed:c=0}=r;c=c-Ma(l);let u={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...o,delay:-c,onUpdate:h=>{e.set(h),o.onUpdate&&o.onUpdate(h)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:n,motionValue:e,element:s?void 0:i};Yye(o)||(u={...u,...Xye(n,u)}),u.duration&&(u.duration=Ma(u.duration)),u.repeatDelay&&(u.repeatDelay=Ma(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let d=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(u.duration=0,u.delay===0&&(d=!0)),d&&!s&&e.get()!==void 0){const h=Cx(u.keyframes,o);if(h!==void 0)return Ct.update(()=>{u.onUpdate(h),u.onComplete()}),new vge([])}return!s&&bO.supports(u)?new bO(u):new uk(u)};function Kye({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function lz(n,e,{delay:t=0,transitionOverride:r,type:i}={}){var s;let{transition:a=n.getDefaultTransition(),transitionEnd:o,...l}=e;r&&(a=r);const c=[],u=i&&n.animationState&&n.animationState.getState()[i];for(const d in l){const h=n.getValue(d,(s=n.latestValues[d])!==null&&s!==void 0?s:null),p=l[d];if(p===void 0||u&&Kye(u,d))continue;const y={delay:t,...XM(a||{},d)};let v=!1;if(window.MotionHandoffAnimation){const m=RB(n);if(m){const x=window.MotionHandoffAnimation(m,d,Ct);x!==null&&(y.startTime=x,v=!0)}}I1(n,d),h.start(dk(d,h,p,n.shouldReduceMotion&&CB.has(d)?{type:!1}:y,n,v));const g=h.animation;g&&c.push(g)}return o&&Promise.all(c).then(()=>{Ct.update(()=>{o&&Rge(n,o)})}),c}function V1(n,e,t={}){var r;const i=Px(n,e,t.type==="exit"?(r=n.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=i||{};t.transitionOverride&&(s=t.transitionOverride);const a=i?()=>Promise.all(lz(n,i,t)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=s;return Zye(n,e,u+c,d,h,t)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,u]=l==="beforeChildren"?[a,o]:[o,a];return c().then(()=>u())}else return Promise.all([a(),o(t.delay)])}function Zye(n,e,t=0,r=0,i=1,s){const a=[],o=(n.variantChildren.size-1)*r,l=i===1?(c=0)=>c*r:(c=0)=>o-c*r;return Array.from(n.variantChildren).sort(Jye).forEach((c,u)=>{c.notify("AnimationStart",e),a.push(V1(c,e,{...s,delay:t+l(u)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(a)}function Jye(n,e){return n.sortNodePosition(e)}function Qye(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(s=>V1(n,s,t));r=Promise.all(i)}else if(typeof e=="string")r=V1(n,e,t);else{const i=typeof e=="function"?Px(n,e,t.custom):e;r=Promise.all(lz(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}const e0e=IM.length;function cz(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?cz(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<e0e;t++){const r=IM[t],i=n.props[r];(Mp(i)||i===!1)&&(e[r]=i)}return e}const t0e=[...DM].reverse(),n0e=DM.length;function r0e(n){return e=>Promise.all(e.map(({animation:t,options:r})=>Qye(n,t,r)))}function i0e(n){let e=r0e(n),t=wO(),r=!0;const i=l=>(c,u)=>{var d;const h=Px(n,u,l==="exit"?(d=n.presenceContext)===null||d===void 0?void 0:d.custom:void 0);if(h){const{transition:p,transitionEnd:y,...v}=h;c={...c,...v,...y}}return c};function s(l){e=l(n)}function a(l){const{props:c}=n,u=cz(n.parent)||{},d=[],h=new Set;let p={},y=1/0;for(let g=0;g<n0e;g++){const m=t0e[g],x=t[m],_=c[m]!==void 0?c[m]:u[m],b=Mp(_),w=m===l?x.isActive:null;w===!1&&(y=g);let E=_===u[m]&&_!==c[m]&&b;if(E&&r&&n.manuallyAnimateOnMount&&(E=!1),x.protectedKeys={...p},!x.isActive&&w===null||!_&&!x.prevProp||kx(_)||typeof _=="boolean")continue;const S=s0e(x.prevProp,_);let M=S||m===l&&x.isActive&&!E&&b||g>y&&b,N=!1;const T=Array.isArray(_)?_:[_];let P=T.reduce(i(m),{});w===!1&&(P={});const{prevResolvedValues:H={}}=x,W={...H,...P},O=j=>{M=!0,h.has(j)&&(N=!0,h.delete(j)),x.needsAnimating[j]=!0;const L=n.getValue(j);L&&(L.liveStyle=!1)};for(const j in W){const L=P[j],D=H[j];if(p.hasOwnProperty(j))continue;let z=!1;O1(L)&&O1(D)?z=!_B(L,D):z=L!==D,z?L!=null?O(j):h.add(j):L!==void 0&&h.has(j)?O(j):x.protectedKeys[j]=!0}x.prevProp=_,x.prevResolvedValues=P,x.isActive&&(p={...p,...P}),r&&n.blockInitialAnimation&&(M=!1),M&&(!(E&&S)||N)&&d.push(...T.map(j=>({animation:j,options:{type:m}})))}if(h.size){const g={};h.forEach(m=>{const x=n.getBaseTarget(m),_=n.getValue(m);_&&(_.liveStyle=!0),g[m]=x??null}),d.push({animation:g})}let v=!!d.length;return r&&(c.initial===!1||c.initial===c.animate)&&!n.manuallyAnimateOnMount&&(v=!1),r=!1,v?e(d):Promise.resolve()}function o(l,c){var u;if(t[l].isActive===c)return Promise.resolve();(u=n.variantChildren)===null||u===void 0||u.forEach(h=>{var p;return(p=h.animationState)===null||p===void 0?void 0:p.setActive(l,c)}),t[l].isActive=c;const d=a(l);for(const h in t)t[h].protectedKeys={};return d}return{animateChanges:a,setActive:o,setAnimateFunction:s,getState:()=>t,reset:()=>{t=wO(),r=!0}}}function s0e(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!_B(e,n):!1}function yl(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function wO(){return{animate:yl(!0),whileInView:yl(),whileHover:yl(),whileTap:yl(),whileDrag:yl(),whileFocus:yl(),exit:yl()}}class tl{constructor(e){this.isMounted=!1,this.node=e}update(){}}class a0e extends tl{constructor(e){super(e),e.animationState||(e.animationState=i0e(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();kx(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let o0e=0;class l0e extends tl{constructor(){super(...arguments),this.id=o0e++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const c0e={animation:{Feature:a0e},exit:{Feature:l0e}};function Pp(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function um(n){return{point:{x:n.pageX,y:n.pageY}}}const u0e=n=>e=>ZM(e)&&n(e,um(e));function kf(n,e,t,r){return Pp(n,e,u0e(t),r)}const SO=(n,e)=>Math.abs(n-e);function d0e(n,e){const t=SO(n.x,e.x),r=SO(n.y,e.y);return Math.sqrt(t**2+r**2)}class uz{constructor(e,t,{transformPagePoint:r,contextWindow:i,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=dw(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,p=d0e(d.offset,{x:0,y:0})>=3;if(!h&&!p)return;const{point:y}=d,{timestamp:v}=Rn;this.history.push({...y,timestamp:v});const{onStart:g,onMove:m}=this.handlers;h||(g&&g(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),m&&m(this.lastMoveEvent,d)},this.handlePointerMove=(d,h)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=uw(h,this.transformPagePoint),Ct.update(this.updatePoint,!0)},this.handlePointerUp=(d,h)=>{this.end();const{onEnd:p,onSessionEnd:y,resumeAnimation:v}=this.handlers;if(this.dragSnapToOrigin&&v&&v(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=dw(d.type==="pointercancel"?this.lastMoveEventInfo:uw(h,this.transformPagePoint),this.history);this.startEvent&&p&&p(d,g),y&&y(d,g)},!ZM(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=r,this.contextWindow=i||window;const a=um(e),o=uw(a,this.transformPagePoint),{point:l}=o,{timestamp:c}=Rn;this.history=[{...l,timestamp:c}];const{onSessionStart:u}=t;u&&u(e,dw(o,this.history)),this.removeListeners=cm(kf(this.contextWindow,"pointermove",this.handlePointerMove),kf(this.contextWindow,"pointerup",this.handlePointerUp),kf(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),as(this.updatePoint)}}function uw(n,e){return e?{point:e(n.point)}:n}function EO(n,e){return{x:n.x-e.x,y:n.y-e.y}}function dw({point:n},e){return{point:n,delta:EO(n,dz(e)),offset:EO(n,h0e(e)),velocity:f0e(e,.1)}}function h0e(n){return n[0]}function dz(n){return n[n.length-1]}function f0e(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=dz(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>Ma(e)));)t--;if(!r)return{x:0,y:0};const s=ka(i.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const a={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}const hz=1e-4,p0e=1-hz,m0e=1+hz,fz=.01,g0e=0-fz,y0e=0+fz;function ci(n){return n.max-n.min}function v0e(n,e,t){return Math.abs(n-e)<=t}function TO(n,e,t,r=.5){n.origin=r,n.originPoint=tn(e.min,e.max,n.origin),n.scale=ci(t)/ci(e),n.translate=tn(t.min,t.max,n.origin)-n.originPoint,(n.scale>=p0e&&n.scale<=m0e||isNaN(n.scale))&&(n.scale=1),(n.translate>=g0e&&n.translate<=y0e||isNaN(n.translate))&&(n.translate=0)}function Af(n,e,t,r){TO(n.x,e.x,t.x,r?r.originX:void 0),TO(n.y,e.y,t.y,r?r.originY:void 0)}function MO(n,e,t){n.min=t.min+e.min,n.max=n.min+ci(e)}function x0e(n,e,t){MO(n.x,e.x,t.x),MO(n.y,e.y,t.y)}function kO(n,e,t){n.min=e.min-t.min,n.max=n.min+ci(e)}function Pf(n,e,t){kO(n.x,e.x,t.x),kO(n.y,e.y,t.y)}function _0e(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?tn(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?tn(t,n,r.max):Math.min(n,t)),n}function AO(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function b0e(n,{top:e,left:t,bottom:r,right:i}){return{x:AO(n.x,t,i),y:AO(n.y,e,r)}}function PO(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function w0e(n,e){return{x:PO(n.x,e.x),y:PO(n.y,e.y)}}function S0e(n,e){let t=.5;const r=ci(n),i=ci(e);return i>r?t=yc(e.min,e.max-r,n.min):r>i&&(t=yc(n.min,n.max-i,e.min)),Fs(0,1,t)}function E0e(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const H1=.35;function T0e(n=H1){return n===!1?n=0:n===!0&&(n=H1),{x:CO(n,"left","right"),y:CO(n,"top","bottom")}}function CO(n,e,t){return{min:RO(n,e),max:RO(n,t)}}function RO(n,e){return typeof n=="number"?n:n[e]||0}const NO=()=>({translate:0,scale:1,origin:0,originPoint:0}),Ou=()=>({x:NO(),y:NO()}),OO=()=>({min:0,max:0}),dn=()=>({x:OO(),y:OO()});function _i(n){return[n("x"),n("y")]}function pz({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function M0e({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function k0e(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function hw(n){return n===void 0||n===1}function W1({scale:n,scaleX:e,scaleY:t}){return!hw(n)||!hw(e)||!hw(t)}function Ml(n){return W1(n)||mz(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function mz(n){return LO(n.x)||LO(n.y)}function LO(n){return n&&n!=="0%"}function ev(n,e,t){const r=n-t,i=e*r;return t+i}function DO(n,e,t,r,i){return i!==void 0&&(n=ev(n,i,r)),ev(n,t,r)+e}function G1(n,e=0,t=1,r,i){n.min=DO(n.min,e,t,r,i),n.max=DO(n.max,e,t,r,i)}function gz(n,{x:e,y:t}){G1(n.x,e.translate,e.scale,e.originPoint),G1(n.y,t.translate,t.scale,t.originPoint)}const IO=.999999999999,jO=1.0000000000001;function A0e(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let s,a;for(let o=0;o<i;o++){s=t[o],a=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Du(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,gz(n,a)),r&&Ml(s.latestValues)&&Du(n,s.latestValues))}e.x<jO&&e.x>IO&&(e.x=1),e.y<jO&&e.y>IO&&(e.y=1)}function Lu(n,e){n.min=n.min+e,n.max=n.max+e}function FO(n,e,t,r,i=.5){const s=tn(n.min,n.max,i);G1(n,e,t,s,r)}function Du(n,e){FO(n.x,e.x,e.scaleX,e.scale,e.originX),FO(n.y,e.y,e.scaleY,e.scale,e.originY)}function yz(n,e){return pz(k0e(n.getBoundingClientRect(),e))}function P0e(n,e,t){const r=yz(n,t),{scroll:i}=e;return i&&(Lu(r.x,i.offset.x),Lu(r.y,i.offset.y)),r}const vz=({current:n})=>n?n.ownerDocument.defaultView:null,C0e=new WeakMap;class R0e{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=dn(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=u=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(um(u).point)},s=(u,d)=>{const{drag:h,dragPropagation:p,onDragStart:y}=this.getProps();if(h&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Mge(h),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),_i(g=>{let m=this.getAxisMotionValue(g).get()||0;if(Os.test(m)){const{projection:x}=this.visualElement;if(x&&x.layout){const _=x.layout.layoutBox[g];_&&(m=ci(_)*(parseFloat(m)/100))}}this.originPoint[g]=m}),y&&Ct.postRender(()=>y(u,d)),I1(this.visualElement,"transform");const{animationState:v}=this.visualElement;v&&v.setActive("whileDrag",!0)},a=(u,d)=>{const{dragPropagation:h,dragDirectionLock:p,onDirectionLock:y,onDrag:v}=this.getProps();if(!h&&!this.openDragLock)return;const{offset:g}=d;if(p&&this.currentDirection===null){this.currentDirection=N0e(g),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",d.point,g),this.updateAxis("y",d.point,g),this.visualElement.render(),v&&v(u,d)},o=(u,d)=>this.stop(u,d),l=()=>_i(u=>{var d;return this.getAnimationState(u)==="paused"&&((d=this.getAxisMotionValue(u).animation)===null||d===void 0?void 0:d.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new uz(e,{onSessionStart:i,onStart:s,onMove:a,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:vz(this.visualElement)})}stop(e,t){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:i}=t;this.startAnimation(i);const{onDragEnd:s}=this.getProps();s&&Ct.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!Zg(e,i,this.currentDirection))return;const s=this.getAxisMotionValue(e);let a=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(a=_0e(a,this.constraints[e],this.elastic[e])),s.set(a)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:r}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&Ru(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=b0e(i.layoutBox,t):this.constraints=!1,this.elastic=T0e(r),s!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&_i(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=E0e(i.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Ru(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=P0e(r,i.root,this.visualElement.getTransformPagePoint());let a=w0e(i.layout.layoutBox,s);if(t){const o=t(M0e(a));this.hasMutatedConstraints=!!o,o&&(a=pz(o))}return a}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:s,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=_i(u=>{if(!Zg(u,t,this.currentDirection))return;let d=l&&l[u]||{};a&&(d={min:0,max:0});const h=i?200:1e6,p=i?40:1e7,y={type:"inertia",velocity:r?e[u]:0,bounceStiffness:h,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...s,...d};return this.startAxisValueAnimation(u,y)});return Promise.all(c).then(o)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return I1(this.visualElement,e),r.start(dk(e,r,0,t,this.visualElement,!1))}stopAnimation(){_i(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){_i(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){_i(t=>{const{drag:r}=this.getProps();if(!Zg(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(t);if(i&&i.layout){const{min:a,max:o}=i.layout.layoutBox[t];s.set(e[t]-tn(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!Ru(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};_i(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();i[a]=S0e({min:l,max:l},this.constraints[a])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),_i(a=>{if(!Zg(a,e,null))return;const o=this.getAxisMotionValue(a),{min:l,max:c}=this.constraints[a];o.set(tn(l,c,i[a]))})}addListeners(){if(!this.visualElement.current)return;C0e.set(this.visualElement,this);const e=this.visualElement.current,t=kf(e,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();Ru(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),Ct.read(r);const a=Pp(window,"resize",()=>this.scalePositionWithinConstraints()),o=i.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(_i(u=>{const d=this.getAxisMotionValue(u);d&&(this.originPoint[u]+=l[u].translate,d.set(d.get()+l[u].translate))}),this.visualElement.render())});return()=>{a(),t(),s(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:a=H1,dragMomentum:o=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:s,dragElastic:a,dragMomentum:o}}}function Zg(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function N0e(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class O0e extends tl{constructor(e){super(e),this.removeGroupControls=xr,this.removeListeners=xr,this.controls=new R0e(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||xr}unmount(){this.removeGroupControls(),this.removeListeners()}}const UO=n=>(e,t)=>{n&&Ct.postRender(()=>n(e,t))};class L0e extends tl{constructor(){super(...arguments),this.removePointerDownListener=xr}onPointerDown(e){this.session=new uz(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:vz(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:UO(e),onStart:UO(t),onMove:r,onEnd:(s,a)=>{delete this.session,i&&Ct.postRender(()=>i(s,a))}}}mount(){this.removePointerDownListener=kf(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Ty={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function BO(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Oh={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(Ge.test(n))n=parseFloat(n);else return n;const t=BO(n,e.target.x),r=BO(n,e.target.y);return`${t}% ${r}%`}},D0e={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=Xo.parse(n);if(i.length>5)return r;const s=Xo.createTransformer(n),a=typeof i[0]!="number"?1:0,o=t.x.scale*e.x,l=t.y.scale*e.y;i[0+a]/=o,i[1+a]/=l;const c=tn(o,l,.5);return typeof i[2+a]=="number"&&(i[2+a]/=c),typeof i[3+a]=="number"&&(i[3+a]/=c),s(i)}};class I0e extends k.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:s}=e;oge(j0e),s&&(t.group&&t.group.add(s),r&&r.register&&i&&r.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),Ty.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:s}=this.props,a=r.projection;return a&&(a.isPresent=s,i||e.layoutDependency!==t||t===void 0?a.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?a.promote():a.relegate()||Ct.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),FM.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function xz(n){const[e,t]=tB(),r=k.useContext(NM);return f.jsx(I0e,{...n,layoutGroup:r,switchLayoutGroup:k.useContext(oB),isPresent:e,safeToRemove:t})}const j0e={borderRadius:{...Oh,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Oh,borderTopRightRadius:Oh,borderBottomLeftRadius:Oh,borderBottomRightRadius:Oh,boxShadow:D0e};function F0e(n,e,t){const r=ir(n)?n:Ps(n);return r.start(dk("",r,e,t)),r.animation}function U0e(n){return n instanceof SVGElement&&n.tagName!=="svg"}const B0e=(n,e)=>n.depth-e.depth;class z0e{constructor(){this.children=[],this.isDirty=!1}add(e){JM(this.children,e),this.isDirty=!0}remove(e){QM(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(B0e),this.isDirty=!1,this.children.forEach(e)}}function $0e(n,e){const t=Ls.now(),r=({timestamp:i})=>{const s=i-t;s>=e&&(as(r),n(s-e))};return Ct.read(r,!0),()=>as(r)}const _z=["TopLeft","TopRight","BottomLeft","BottomRight"],V0e=_z.length,zO=n=>typeof n=="string"?parseFloat(n):n,$O=n=>typeof n=="number"||Ge.test(n);function H0e(n,e,t,r,i,s){i?(n.opacity=tn(0,t.opacity!==void 0?t.opacity:1,W0e(r)),n.opacityExit=tn(e.opacity!==void 0?e.opacity:1,0,G0e(r))):s&&(n.opacity=tn(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,r));for(let a=0;a<V0e;a++){const o=`border${_z[a]}Radius`;let l=VO(e,o),c=VO(t,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||$O(l)===$O(c)?(n[o]=Math.max(tn(zO(l),zO(c),r),0),(Os.test(c)||Os.test(l))&&(n[o]+="%")):n[o]=c}(e.rotate||t.rotate)&&(n.rotate=tn(e.rotate||0,t.rotate||0,r))}function VO(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const W0e=bz(0,.5,FB),G0e=bz(.5,.95,xr);function bz(n,e,t){return r=>r<n?0:r>e?1:t(yc(n,e,r))}function HO(n,e){n.min=e.min,n.max=e.max}function vi(n,e){HO(n.x,e.x),HO(n.y,e.y)}function WO(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function GO(n,e,t,r,i){return n-=e,n=ev(n,1/t,r),i!==void 0&&(n=ev(n,1/i,r)),n}function q0e(n,e=0,t=1,r=.5,i,s=n,a=n){if(Os.test(e)&&(e=parseFloat(e),e=tn(a.min,a.max,e/100)-a.min),typeof e!="number")return;let o=tn(s.min,s.max,r);n===s&&(o-=e),n.min=GO(n.min,e,t,o,i),n.max=GO(n.max,e,t,o,i)}function qO(n,e,[t,r,i],s,a){q0e(n,e[t],e[r],e[i],e.scale,s,a)}const X0e=["x","scaleX","originX"],Y0e=["y","scaleY","originY"];function XO(n,e,t,r){qO(n.x,e,X0e,t?t.x:void 0,r?r.x:void 0),qO(n.y,e,Y0e,t?t.y:void 0,r?r.y:void 0)}function YO(n){return n.translate===0&&n.scale===1}function wz(n){return YO(n.x)&&YO(n.y)}function KO(n,e){return n.min===e.min&&n.max===e.max}function K0e(n,e){return KO(n.x,e.x)&&KO(n.y,e.y)}function ZO(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function Sz(n,e){return ZO(n.x,e.x)&&ZO(n.y,e.y)}function JO(n){return ci(n.x)/ci(n.y)}function QO(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class Z0e{constructor(){this.members=[]}add(e){JM(this.members,e),e.scheduleRender()}remove(e){if(QM(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){r=s;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function J0e(n,e,t){let r="";const i=n.x.translate/e.x,s=n.y.translate/e.y,a=(t==null?void 0:t.z)||0;if((i||s||a)&&(r=`translate3d(${i}px, ${s}px, ${a}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:c,rotate:u,rotateX:d,rotateY:h,skewX:p,skewY:y}=t;c&&(r=`perspective(${c}px) ${r}`),u&&(r+=`rotate(${u}deg) `),d&&(r+=`rotateX(${d}deg) `),h&&(r+=`rotateY(${h}deg) `),p&&(r+=`skewX(${p}deg) `),y&&(r+=`skewY(${y}deg) `)}const o=n.x.scale*e.x,l=n.y.scale*e.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const kl={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Zh=typeof window<"u"&&window.MotionDebug!==void 0,fw=["","X","Y","Z"],Q0e={visibility:"hidden"},eL=1e3;let eve=0;function pw(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function Ez(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=RB(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",Ct,!(i||s))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&Ez(r)}function Tz({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(a={},o=e==null?void 0:e()){this.id=eve++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Zh&&(kl.totalNodes=kl.resolvedTargetDeltas=kl.recalculatedProjection=0),this.nodes.forEach(rve),this.nodes.forEach(lve),this.nodes.forEach(cve),this.nodes.forEach(ive),Zh&&window.MotionDebug.record(kl)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new z0e)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new ek),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=U0e(a),this.instance=a;const{layoutId:l,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(c||l)&&(this.isLayoutDirty=!0),n){let d;const h=()=>this.root.updateBlockedByResize=!1;n(a,()=>{this.root.updateBlockedByResize=!0,d&&d(),d=$0e(h,250),Ty.hasAnimatedSinceResize&&(Ty.hasAnimatedSinceResize=!1,this.nodes.forEach(nL))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||c)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:h,hasRelativeTargetChanged:p,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const v=this.options.transition||u.getDefaultTransition()||pve,{onLayoutAnimationStart:g,onLayoutAnimationComplete:m}=u.getProps(),x=!this.targetLayout||!Sz(this.targetLayout,y)||p,_=!h&&p;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||_||h&&(x||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(d,_);const b={...XM(v,"layout"),onPlay:g,onComplete:m};(u.shouldReduceMotion||this.options.layoutRoot)&&(b.delay=0,b.type=!1),this.startAnimation(b)}else h||nL(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,as(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(uve),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Ez(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const d=this.path[u];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(tL);return}this.isUpdating||this.nodes.forEach(ave),this.isUpdating=!1,this.nodes.forEach(ove),this.nodes.forEach(tve),this.nodes.forEach(nve),this.clearAllSnapshots();const o=Ls.now();Rn.delta=Fs(0,1e3/60,o-Rn.timestamp),Rn.timestamp=o,Rn.isProcessing=!0,iw.update.process(Rn),iw.preRender.process(Rn),iw.render.process(Rn),Rn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,FM.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(sve),this.sharedNodes.forEach(dve)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Ct.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Ct.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=dn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!wz(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;a&&(o||Ml(this.latestValues)||u)&&(i(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),mve(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var a;const{visualElement:o}=this.options;if(!o)return dn();const l=o.measureViewportBox();if(!(((a=this.scroll)===null||a===void 0?void 0:a.wasRoot)||this.path.some(gve))){const{scroll:u}=this.root;u&&(Lu(l.x,u.offset.x),Lu(l.y,u.offset.y))}return l}removeElementScroll(a){var o;const l=dn();if(vi(l,a),!((o=this.scroll)===null||o===void 0)&&o.wasRoot)return l;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:h}=u;u!==this.root&&d&&h.layoutScroll&&(d.wasRoot&&vi(l,a),Lu(l.x,d.offset.x),Lu(l.y,d.offset.y))}return l}applyTransform(a,o=!1){const l=dn();vi(l,a);for(let c=0;c<this.path.length;c++){const u=this.path[c];!o&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Du(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Ml(u.latestValues)&&Du(l,u.latestValues)}return Ml(this.latestValues)&&Du(l,this.latestValues),l}removeTransform(a){const o=dn();vi(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Ml(c.latestValues))continue;W1(c.latestValues)&&c.updateSnapshot();const u=dn(),d=c.measurePageBox();vi(u,d),XO(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return Ml(this.latestValues)&&XO(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Rn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var o;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(a||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:h}=this.options;if(!(!this.layout||!(d||h))){if(this.resolvedRelativeTargetAt=Rn.timestamp,!this.targetDelta&&!this.relativeTarget){const p=this.getClosestProjectingParent();p&&p.layout&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=dn(),this.relativeTargetOrigin=dn(),Pf(this.relativeTargetOrigin,this.layout.layoutBox,p.layout.layoutBox),vi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=dn(),this.targetWithTransforms=dn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),x0e(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):vi(this.target,this.layout.layoutBox),gz(this.target,this.targetDelta)):vi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const p=this.getClosestProjectingParent();p&&!!p.resumingFrom==!!this.resumingFrom&&!p.options.layoutScroll&&p.target&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=dn(),this.relativeTargetOrigin=dn(),Pf(this.relativeTargetOrigin,this.target,p.target),vi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Zh&&kl.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||W1(this.parent.latestValues)||mz(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const o=this.getLead(),l=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===Rn.timestamp&&(c=!1),c)return;const{layout:u,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||d))return;vi(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,p=this.treeScale.y;A0e(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=dn());const{target:y}=o;if(!y){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(WO(this.prevProjectionDelta.x,this.projectionDelta.x),WO(this.prevProjectionDelta.y,this.projectionDelta.y)),Af(this.projectionDelta,this.layoutCorrected,y,this.latestValues),(this.treeScale.x!==h||this.treeScale.y!==p||!QO(this.projectionDelta.x,this.prevProjectionDelta.x)||!QO(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y)),Zh&&kl.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)===null||o===void 0||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Ou(),this.projectionDelta=Ou(),this.projectionDeltaWithTransform=Ou()}setAnimationOrigin(a,o=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},d=Ou();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const h=dn(),p=l?l.source:void 0,y=this.layout?this.layout.source:void 0,v=p!==y,g=this.getStack(),m=!g||g.members.length<=1,x=!!(v&&!m&&this.options.crossfade===!0&&!this.path.some(fve));this.animationProgress=0;let _;this.mixTargetDelta=b=>{const w=b/1e3;rL(d.x,a.x,w),rL(d.y,a.y,w),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Pf(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),hve(this.relativeTarget,this.relativeTargetOrigin,h,w),_&&K0e(this.relativeTarget,_)&&(this.isProjectionDirty=!1),_||(_=dn()),vi(_,this.relativeTarget)),v&&(this.animationValues=u,H0e(u,c,this.latestValues,w,x,m)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=w},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(as(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Ct.update(()=>{Ty.hasAnimatedSinceResize=!0,this.currentAnimation=F0e(0,eL,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(eL),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:u}=a;if(!(!o||!l||!c)){if(this!==a&&this.layout&&c&&Mz(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||dn();const d=ci(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+d;const h=ci(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+h}vi(o,l),Du(o,u),Af(this.projectionDeltaWithTransform,this.layoutCorrected,o,u)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new Z0e),this.sharedNodes.get(a).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const c={};l.z&&pw("z",a,c,this.animationValues);for(let u=0;u<fw.length;u++)pw(`rotate${fw[u]}`,a,c,this.animationValues),pw(`skew${fw[u]}`,a,c,this.animationValues);a.render();for(const u in c)a.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);a.scheduleRender()}getProjectionStyles(a){var o,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Q0e;const c={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=Sy(a==null?void 0:a.pointerEvents)||"",c.transform=u?u(this.latestValues,""):"none",c;const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){const v={};return this.options.layoutId&&(v.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,v.pointerEvents=Sy(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!Ml(this.latestValues)&&(v.transform=u?u({},""):"none",this.hasProjected=!1),v}const h=d.animationValues||d.latestValues;this.applyTransformsToTarget(),c.transform=J0e(this.projectionDeltaWithTransform,this.treeScale,h),u&&(c.transform=u(h,c.transform));const{x:p,y}=this.projectionDelta;c.transformOrigin=`${p.origin*100}% ${y.origin*100}% 0`,d.animationValues?c.opacity=d===this?(l=(o=h.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:c.opacity=d===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const v in Y0){if(h[v]===void 0)continue;const{correct:g,applyTo:m}=Y0[v],x=c.transform==="none"?h[v]:g(h[v],d);if(m){const _=m.length;for(let b=0;b<_;b++)c[m[b]]=x}else c[v]=x}return this.options.layoutId&&(c.pointerEvents=d===this?Sy(a==null?void 0:a.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(tL),this.root.sharedNodes.clear()}}}function tve(n){n.updateLayout()}function nve(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=n.layout,{animationType:s}=n.options,a=t.source!==n.layout.source;s==="size"?_i(d=>{const h=a?t.measuredBox[d]:t.layoutBox[d],p=ci(h);h.min=r[d].min,h.max=h.min+p}):Mz(s,t.layoutBox,r)&&_i(d=>{const h=a?t.measuredBox[d]:t.layoutBox[d],p=ci(r[d]);h.max=h.min+p,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[d].max=n.relativeTarget[d].min+p)});const o=Ou();Af(o,r,t.layoutBox);const l=Ou();a?Af(l,n.applyTransform(i,!0),t.measuredBox):Af(l,r,t.layoutBox);const c=!wz(o);let u=!1;if(!n.resumeFrom){const d=n.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:h,layout:p}=d;if(h&&p){const y=dn();Pf(y,t.layoutBox,h.layoutBox);const v=dn();Pf(v,r,p.layoutBox),Sz(y,v)||(u=!0),d.options.layoutRoot&&(n.relativeTarget=v,n.relativeTargetOrigin=y,n.relativeParent=d)}}}n.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeTargetChanged:u})}else if(n.isLead()){const{onExitComplete:r}=n.options;r&&r()}n.options.transition=void 0}function rve(n){Zh&&kl.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function ive(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function sve(n){n.clearSnapshot()}function tL(n){n.clearMeasurements()}function ave(n){n.isLayoutDirty=!1}function ove(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function nL(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function lve(n){n.resolveTargetDelta()}function cve(n){n.calcProjection()}function uve(n){n.resetSkewAndRotation()}function dve(n){n.removeLeadSnapshot()}function rL(n,e,t){n.translate=tn(e.translate,0,t),n.scale=tn(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function iL(n,e,t,r){n.min=tn(e.min,t.min,r),n.max=tn(e.max,t.max,r)}function hve(n,e,t,r){iL(n.x,e.x,t.x,r),iL(n.y,e.y,t.y,r)}function fve(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const pve={duration:.45,ease:[.4,0,.1,1]},sL=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),aL=sL("applewebkit/")&&!sL("chrome/")?Math.round:xr;function oL(n){n.min=aL(n.min),n.max=aL(n.max)}function mve(n){oL(n.x),oL(n.y)}function Mz(n,e,t){return n==="position"||n==="preserve-aspect"&&!v0e(JO(e),JO(t),.2)}function gve(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const yve=Tz({attachResizeListener:(n,e)=>Pp(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),mw={current:void 0},kz=Tz({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!mw.current){const n=new yve({});n.mount(window),n.setOptions({layoutScroll:!0}),mw.current=n}return mw.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),vve={pan:{Feature:L0e},drag:{Feature:O0e,ProjectionNode:kz,MeasureLayout:xz}};function lL(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,s=r[i];s&&Ct.postRender(()=>s(e,um(e)))}class xve extends tl{mount(){const{current:e}=this.node;e&&(this.unmount=bge(e,t=>(lL(this.node,t,"Start"),r=>lL(this.node,r,"End"))))}unmount(){}}class _ve extends tl{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=cm(Pp(this.node.current,"focus",()=>this.onFocus()),Pp(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function cL(n,e,t){const{props:r}=n;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),s=r[i];s&&Ct.postRender(()=>s(e,um(e)))}class bve extends tl{mount(){const{current:e}=this.node;e&&(this.unmount=Tge(e,t=>(cL(this.node,t,"Start"),(r,{success:i})=>cL(this.node,r,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const q1=new WeakMap,gw=new WeakMap,wve=n=>{const e=q1.get(n.target);e&&e(n)},Sve=n=>{n.forEach(wve)};function Eve({root:n,...e}){const t=n||document;gw.has(t)||gw.set(t,{});const r=gw.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(Sve,{root:n,...e})),r[i]}function Tve(n,e,t){const r=Eve(e);return q1.set(n,t),r.observe(n),()=>{q1.delete(n),r.unobserve(n)}}const Mve={some:0,all:1};class kve extends tl{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:s}=e,a={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:Mve[i]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,s&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:d}=this.node.getProps(),h=c?u:d;h&&h(l)};return Tve(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(Ave(e,t))&&this.startObserver()}unmount(){}}function Ave({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const Pve={inView:{Feature:kve},tap:{Feature:bve},focus:{Feature:_ve},hover:{Feature:xve}},Cve={layout:{ProjectionNode:kz,MeasureLayout:xz}},X1={current:null},Az={current:!1};function Rve(){if(Az.current=!0,!!OM)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>X1.current=n.matches;n.addListener(e),e()}else X1.current=!1}const Nve=[...JB,Jn,Xo],Ove=n=>Nve.find(ZB(n)),uL=new WeakMap;function Lve(n,e,t){for(const r in e){const i=e[r],s=t[r];if(ir(i))n.addValue(r,i);else if(ir(s))n.addValue(r,Ps(i,{owner:n}));else if(s!==i)if(n.hasValue(r)){const a=n.getValue(r);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=n.getStaticValue(r);n.addValue(r,Ps(a!==void 0?a:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const dL=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Dve{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:s,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=ok,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const p=Ls.now();this.renderScheduledAt<p&&(this.renderScheduledAt=p,Ct.render(this.render,!1,!0))};const{latestValues:l,renderState:c,onUpdate:u}=a;this.onUpdate=u,this.latestValues=l,this.baseTarget={...l},this.initialValues=t.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=o,this.blockInitialAnimation=!!s,this.isControllingVariants=Ax(t),this.isVariantNode=sB(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:d,...h}=this.scrapeMotionValuesFromProps(t,{},this);for(const p in h){const y=h[p];l[p]!==void 0&&ir(y)&&y.set(l[p],!1)}}mount(e){this.current=e,uL.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),Az.current||Rve(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:X1.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){uL.delete(this.current),this.projection&&this.projection.unmount(),as(this.notifyUpdate),as(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=Ac.has(e),i=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&Ct.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),s(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in bd){const t=bd[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):dn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<dL.length;r++){const i=dL[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s="on"+i,a=e[s];a&&(this.propEventSubscriptions[i]=this.on(i,a))}this.prevMotionValues=Lve(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=Ps(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){var r;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(r=this.getBaseTargetFromProps(this.props,e))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(YB(i)||BB(i))?i=parseFloat(i):!Ove(i)&&Xo.test(t)&&(i=GB(e,t)),this.setBaseTarget(e,ir(i)?i.get():i)),ir(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:r}=this.props;let i;if(typeof r=="string"||typeof r=="object"){const a=BM(this.props,r,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);a&&(i=a[e])}if(r&&i!==void 0)return i;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!ir(s)?s:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new ek),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class Pz extends Dve{constructor(){super(...arguments),this.KeyframeResolver=QB}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;ir(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function Ive(n){return window.getComputedStyle(n)}class jve extends Pz{constructor(){super(...arguments),this.type="html",this.renderInstance=pB}readValueFromInstance(e,t){if(Ac.has(t)){const r=ak(t);return r&&r.default||0}else{const r=Ive(e),i=(dB(t)?r.getPropertyValue(t):r[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return yz(e,t)}build(e,t,r){VM(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return qM(e,t,r)}}class Fve extends Pz{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=dn}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Ac.has(t)){const r=ak(t);return r&&r.default||0}return t=mB.has(t)?t:jM(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return vB(e,t,r)}build(e,t,r){HM(e,t,this.isSVGTag,r.transformTemplate)}renderInstance(e,t,r,i){gB(e,t,r,i)}mount(e){this.isSVGTag=GM(e.tagName),super.mount(e)}}const Uve=(n,e)=>UM(n)?new Fve(e):new jve(e,{allowProjection:n!==k.Fragment}),Bve=gge({...c0e,...Pve,...vve,...Cve},Uve),Qs=Rme(Bve);function Cz(n,e){let t;const r=()=>{const{currentTime:i}=e,a=(i===null?0:i.value)/100;t!==a&&n(a),t=a};return Ct.update(r,!0),()=>as(r)}const My=new WeakMap;let io;function zve(n,e){if(e){const{inlineSize:t,blockSize:r}=e[0];return{width:t,height:r}}else return n instanceof SVGElement&&"getBBox"in n?n.getBBox():{width:n.offsetWidth,height:n.offsetHeight}}function $ve({target:n,contentRect:e,borderBoxSize:t}){var r;(r=My.get(n))===null||r===void 0||r.forEach(i=>{i({target:n,contentSize:e,get size(){return zve(n,t)}})})}function Vve(n){n.forEach($ve)}function Hve(){typeof ResizeObserver>"u"||(io=new ResizeObserver(Vve))}function Wve(n,e){io||Hve();const t=kB(n);return t.forEach(r=>{let i=My.get(r);i||(i=new Set,My.set(r,i)),i.add(e),io==null||io.observe(r)}),()=>{t.forEach(r=>{const i=My.get(r);i==null||i.delete(e),i!=null&&i.size||io==null||io.unobserve(r)})}}const ky=new Set;let Cf;function Gve(){Cf=()=>{const n={width:window.innerWidth,height:window.innerHeight},e={target:window,size:n,contentSize:n};ky.forEach(t=>t(e))},window.addEventListener("resize",Cf)}function qve(n){return ky.add(n),Cf||Gve(),()=>{ky.delete(n),!ky.size&&Cf&&(Cf=void 0)}}function Xve(n,e){return typeof n=="function"?qve(n):Wve(n,e)}const Yve=50,hL=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),Kve=()=>({time:0,x:hL(),y:hL()}),Zve={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function fL(n,e,t,r){const i=t[e],{length:s,position:a}=Zve[e],o=i.current,l=t.time;i.current=n[`scroll${a}`],i.scrollLength=n[`scroll${s}`]-n[`client${s}`],i.offset.length=0,i.offset[0]=0,i.offset[1]=i.scrollLength,i.progress=yc(0,i.scrollLength,i.current);const c=r-l;i.velocity=c>Yve?0:tk(i.current-o,c)}function Jve(n,e,t){fL(n,"x",e,t),fL(n,"y",e,t),e.time=t}function Qve(n,e){const t={x:0,y:0};let r=n;for(;r&&r!==e;)if(r instanceof HTMLElement)t.x+=r.offsetLeft,t.y+=r.offsetTop,r=r.offsetParent;else if(r.tagName==="svg"){const i=r.getBoundingClientRect();r=r.parentElement;const s=r.getBoundingClientRect();t.x+=i.left-s.left,t.y+=i.top-s.top}else if(r instanceof SVGGraphicsElement){const{x:i,y:s}=r.getBBox();t.x+=i,t.y+=s;let a=null,o=r.parentNode;for(;!a;)o.tagName==="svg"&&(a=o),o=r.parentNode;r=a}else break;return t}const Y1={start:0,center:.5,end:1};function pL(n,e,t=0){let r=0;if(n in Y1&&(n=Y1[n]),typeof n=="string"){const i=parseFloat(n);n.endsWith("px")?r=i:n.endsWith("%")?n=i/100:n.endsWith("vw")?r=i/100*document.documentElement.clientWidth:n.endsWith("vh")?r=i/100*document.documentElement.clientHeight:n=i}return typeof n=="number"&&(r=e*n),t+r}const exe=[0,0];function txe(n,e,t,r){let i=Array.isArray(n)?n:exe,s=0,a=0;return typeof n=="number"?i=[n,n]:typeof n=="string"&&(n=n.trim(),n.includes(" ")?i=n.split(" "):i=[n,Y1[n]?n:"0"]),s=pL(i[0],t,r),a=pL(i[1],e),s-a}const nxe={Enter:[[0,1],[1,1]],Exit:[[0,0],[1,0]],Any:[[1,0],[0,1]],All:[[0,0],[1,1]]},rxe={x:0,y:0};function ixe(n){return"getBBox"in n&&n.tagName!=="svg"?n.getBBox():{width:n.clientWidth,height:n.clientHeight}}function sxe(n,e,t){const{offset:r=nxe.All}=t,{target:i=n,axis:s="y"}=t,a=s==="y"?"height":"width",o=i!==n?Qve(i,n):rxe,l=i===n?{width:n.scrollWidth,height:n.scrollHeight}:ixe(i),c={width:n.clientWidth,height:n.clientHeight};e[s].offset.length=0;let u=!e[s].interpolate;const d=r.length;for(let h=0;h<d;h++){const p=txe(r[h],c[a],l[a],o[s]);!u&&p!==e[s].interpolatorOffsets[h]&&(u=!0),e[s].offset[h]=p}u&&(e[s].interpolate=ck(e[s].offset,az(r),{clamp:!1}),e[s].interpolatorOffsets=[...e[s].offset]),e[s].progress=Fs(0,1,e[s].interpolate(e[s].current))}function axe(n,e=n,t){if(t.x.targetOffset=0,t.y.targetOffset=0,e!==n){let r=e;for(;r&&r!==n;)t.x.targetOffset+=r.offsetLeft,t.y.targetOffset+=r.offsetTop,r=r.offsetParent}t.x.targetLength=e===n?e.scrollWidth:e.clientWidth,t.y.targetLength=e===n?e.scrollHeight:e.clientHeight,t.x.containerLength=n.clientWidth,t.y.containerLength=n.clientHeight}function oxe(n,e,t,r={}){return{measure:()=>axe(n,r.target,t),update:i=>{Jve(n,t,i),(r.offset||r.target)&&sxe(n,t,r)},notify:()=>e(t)}}const Lh=new WeakMap,mL=new WeakMap,yw=new WeakMap,gL=n=>n===document.documentElement?window:n;function hk(n,{container:e=document.documentElement,...t}={}){let r=yw.get(e);r||(r=new Set,yw.set(e,r));const i=Kve(),s=oxe(e,n,i,t);if(r.add(s),!Lh.has(e)){const o=()=>{for(const h of r)h.measure()},l=()=>{for(const h of r)h.update(Rn.timestamp)},c=()=>{for(const h of r)h.notify()},u=()=>{Ct.read(o,!1,!0),Ct.read(l,!1,!0),Ct.update(c,!1,!0)};Lh.set(e,u);const d=gL(e);window.addEventListener("resize",u,{passive:!0}),e!==document.documentElement&&mL.set(e,Xve(e,u)),d.addEventListener("scroll",u,{passive:!0})}const a=Lh.get(e);return Ct.read(a,!1,!0),()=>{var o;as(a);const l=yw.get(e);if(!l||(l.delete(s),l.size))return;const c=Lh.get(e);Lh.delete(e),c&&(gL(e).removeEventListener("scroll",c),(o=mL.get(e))===null||o===void 0||o(),window.removeEventListener("resize",c))}}function lxe({source:n,container:e,axis:t="y"}){n&&(e=n);const r={value:0},i=hk(s=>{r.value=s[t].progress*100},{container:e,axis:t});return{currentTime:r,cancel:i}}const vw=new Map;function Rz({source:n,container:e=document.documentElement,axis:t="y"}={}){n&&(e=n),vw.has(e)||vw.set(e,{});const r=vw.get(e);return r[t]||(r[t]=bB()?new ScrollTimeline({source:e,axis:t}):lxe({source:e,axis:t})),r[t]}function cxe(n){return n.length===2}function Nz(n){return n&&(n.target||n.offset)}function uxe(n,e){return cxe(n)||Nz(e)?hk(t=>{n(t[e.axis].progress,t)},e):Cz(n,Rz(e))}function dxe(n,e){if(n.flatten(),Nz(e))return n.pause(),hk(t=>{n.time=n.duration*t[e.axis].progress},e);{const t=Rz(e);return n.attachTimeline?n.attachTimeline(t,r=>(r.pause(),Cz(i=>{r.time=r.duration*i},t))):xr}}function hxe(n,{axis:e="y",...t}={}){const r={axis:e,...t};return typeof n=="function"?uxe(n,r):dxe(n,r)}function yL(n,e){Sme(!!(!e||e.current))}const fxe=()=>({scrollX:Ps(0),scrollY:Ps(0),scrollXProgress:Ps(0),scrollYProgress:Ps(0)});function pxe({container:n,target:e,layoutEffect:t=!0,...r}={}){const i=Bd(fxe);return(t?Tx:k.useEffect)(()=>(yL("target",e),yL("container",n),hxe((a,{x:o,y:l})=>{i.scrollX.set(o.current),i.scrollXProgress.set(o.progress),i.scrollY.set(l.current),i.scrollYProgress.set(l.progress)},{...r,container:(n==null?void 0:n.current)||void 0,target:(e==null?void 0:e.current)||void 0})),[n,e,JSON.stringify(r.offset)]),i}function mxe(n){const e=Bd(()=>Ps(n)),{isStatic:t}=k.useContext(Ex);if(t){const[,r]=k.useState(n);k.useEffect(()=>e.on("change",r),[])}return e}function Oz(n,e){const t=mxe(e()),r=()=>t.set(e());return r(),Tx(()=>{const i=()=>Ct.preRender(r,!1,!0),s=n.map(a=>a.on("change",i));return()=>{s.forEach(a=>a()),as(r)}}),t}const gxe=n=>n&&typeof n=="object"&&n.mix,yxe=n=>gxe(n)?n.mix:void 0;function vxe(...n){const e=!Array.isArray(n[0]),t=e?0:-1,r=n[0+t],i=n[1+t],s=n[2+t],a=n[3+t],o=ck(i,s,{mixer:yxe(s[0]),...a});return e?o(r):o}function xxe(n){Tf.current=[],n();const e=Oz(Tf.current,n);return Tf.current=void 0,e}function ea(n,e,t,r){if(typeof n=="function")return xxe(n);const i=typeof e=="function"?e:vxe(e,t,r);return Array.isArray(n)?vL(n,i):vL([n],([s])=>i(s))}function vL(n,e){const t=Bd(()=>[]);return Oz(n,()=>{t.length=0;const r=n.length;for(let i=0;i<r;i++)t[i]=n[i].get();return e(t)})}function _xe(){const n=k.useRef(null),{scrollYProgress:e}=pxe({target:n,offset:["start start","end start"]}),[t,r]=k.useState(0),[i,s]=k.useState(!0),[a,o]=k.useState({}),l=[{src:"/assets/db1.png",alt:"AI Chat"},{src:"/assets/db2.png",alt:"TradesXBT Dashboard"},{src:"/assets/db3.png",alt:"Customizable Charts"},{src:"/assets/db4.png",alt:"Portfolio Analysis"}],c=ea(e,[0,.5],[1,0]),u=ea(e,[0,.5],[1,.8]),d=ea(e,[0,.5],[0,-50]),h=ea(e,[.3,.5],[0,1]),p=ea(e,[.3,.5],[50,0]),y=ea(e,[.1,.2,.6,.8],[0,1,1,0]),v=ea(e,[.1,.5],[20,0]),g=ea(e,[.1,.5],[100,-50]),m=ea(e,[.1,.5],[.8,1]),x=w=>{console.error(`Failed to load image at index ${w}:`,l[w].src),o(E=>({...E,[w]:!0}))};k.useEffect(()=>{let w;return i&&(w=setInterval(()=>{r(E=>E===l.length-1?0:E+1)},4e3)),()=>{w&&clearInterval(w)}},[i,l.length]);const _=()=>{r(w=>w===0?l.length-1:w-1),s(!1)},b=()=>{r(w=>w===l.length-1?0:w+1),s(!1)};return f.jsxs("div",{ref:n,className:"relative min-h-[130vh] w-full overflow-hidden",children:[f.jsx(Qs.div,{className:"sticky top-0 flex flex-col items-center justify-center min-h-screen w-full py-20 px-4",style:{opacity:c,scale:u,y:d},children:f.jsxs(Qs.div,{className:"text-center max-w-4xl mx-auto",children:[f.jsxs(Qs.h1,{className:"text-4xl sm:text-5xl md:text-6xl font-bold mb-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},children:[f.jsx("span",{className:"bg-gradient-to-r from-green-400 to-cyan-400 bg-clip-text text-transparent",children:"AI-Powered Trading"}),f.jsx("br",{}),"for the Solana Ecosystem"]}),f.jsx(Qs.p,{className:"text-xl text-gray-400 max-w-2xl mx-auto",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.4},children:"Experience the future of crypto trading with TradesXBT, your autonomous AI hedge fund agent specializing in the Solana ecosystem."})]})}),f.jsx(Qs.div,{className:"sticky top-[30%] w-full mb-24",style:{opacity:y,translateY:g,scale:m},children:f.jsxs("div",{className:"max-w-5xl mx-auto px-4 relative",children:[f.jsx("div",{className:"absolute top-1/2 left-4 -translate-y-1/2 z-10",children:f.jsx("button",{onClick:_,className:"w-10 h-10 rounded-full bg-black/40 backdrop-blur-sm text-white border border-white/10 flex items-center justify-center hover:bg-black/60 transition-colors","aria-label":"Previous slide",onMouseEnter:()=>s(!1),children:f.jsx(cf,{size:20})})}),f.jsx("div",{className:"absolute top-1/2 right-4 -translate-y-1/2 z-10",children:f.jsx("button",{onClick:b,className:"w-10 h-10 rounded-full bg-black/40 backdrop-blur-sm text-white border border-white/10 flex items-center justify-center hover:bg-black/60 transition-colors","aria-label":"Next slide",onMouseEnter:()=>s(!1),children:f.jsx(uf,{size:20})})}),f.jsxs(Qs.div,{className:"w-full rounded-xl shadow-2xl overflow-hidden relative",style:{perspective:"1000px",rotateX:v,boxShadow:"0 25px 50px -12px rgba(22, 153, 118, 0.25)",border:"1px solid rgba(22, 153, 118, 0.3)"},children:[f.jsxs("div",{className:"relative w-full aspect-[16/9] overflow-hidden bg-black/20",children:[f.jsx(wme,{initial:!1,children:f.jsx(Qs.img,{src:l[t].src,alt:l[t].alt,className:"w-full h-full object-cover absolute inset-0",initial:{opacity:0,x:100},animate:{opacity:1,x:0},exit:{opacity:0,x:-100},transition:{x:{type:"spring",stiffness:300,damping:30},opacity:{duration:.3}},onError:()=>x(t)},t)}),a[t]&&f.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gradient-to-r from-gray-900 to-black text-white p-4",children:[f.jsx("div",{className:"text-3xl mb-2",children:""}),f.jsx("p",{className:"font-medium text-lg mb-1",children:l[t].alt}),f.jsx("p",{className:"text-sm text-gray-400",children:"Image could not be loaded"})]})]}),f.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2 z-10",children:l.map((w,E)=>f.jsx("button",{onClick:()=>{r(E),s(!1)},className:`w-2.5 h-2.5 rounded-full transition-colors ${t===E?"bg-viridian":"bg-white/30 hover:bg-white/50"}`,"aria-label":`Go to slide ${E+1}`},E))}),f.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/70 backdrop-blur-sm text-white p-4 text-center",children:f.jsx("p",{className:"text-sm font-medium bg-gradient-to-r from-green-400 to-cyan-400 bg-clip-text text-transparent inline-block",children:l[t].alt})})]})]})}),f.jsx(Qs.div,{className:"sticky top-20 w-full py-20 px-4",style:{opacity:h,y:p},children:f.jsxs("div",{className:"max-w-6xl mx-auto",children:[f.jsxs("div",{className:"text-center mb-16",children:[f.jsx("h2",{className:"text-3xl md:text-4xl font-bold mb-6 bg-gradient-to-r from-green-400 to-cyan-400 bg-clip-text text-transparent",children:"Powerful AI Trading Features"}),f.jsx("p",{className:"text-xl text-gray-400 max-w-2xl mx-auto",children:"Our advanced AI technology helps you navigate the Solana ecosystem with confidence"})]}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[{title:"Real-time Analysis",description:"Continuously monitors market conditions, on-chain data, and social sentiment",icon:""},{title:"Trading Signals",description:"Receives AI-generated signals with precise entry and exit points",icon:""},{title:"Portfolio Management",description:"Track and manage your investments with detailed performance analytics",icon:""}].map((w,E)=>f.jsxs(Qs.div,{className:"bg-black/80 backdrop-blur-lg rounded-xl p-6 border border-green-500/20 hover:border-green-500/40 transition-all duration-300",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2+E*.1},children:[f.jsx("div",{className:"text-4xl mb-4",children:w.icon}),f.jsx("h3",{className:"text-xl font-semibold mb-2",children:w.title}),f.jsx("p",{className:"text-gray-400",children:w.description})]},E))})]})})]})}const bxe=({message:n,type:e,duration:t=3e3,onDismiss:r})=>{const[i,s]=k.useState(!0);if(k.useEffect(()=>{if(e!=="loading"&&t>0){const l=setTimeout(()=>{s(!1),r&&r()},t);return()=>clearTimeout(l)}},[e,t,r]),!i)return null;const a=()=>{switch(e){case"success":return"bg-viridian/20 border-viridian text-viridian";case"error":return"bg-red-500/20 border-red-500 text-red-500";case"loading":return"bg-blue-500/20 border-blue-500 text-blue-500"}},o=()=>{switch(e){case"success":return f.jsx(Dv,{size:20});case"error":return f.jsx(ET,{size:20});case"loading":return f.jsx(cd,{size:20,className:"animate-spin"})}};return f.jsxs("div",{className:`fixed top-4 right-4 z-50 py-2 px-4 rounded-lg border ${a()} flex items-center gap-2 shadow-lg`,children:[o(),f.jsx("span",{children:n})]})},wxe=({onSuccess:n})=>{const[e,t]=k.useState(""),[r,i]=k.useState(""),[s,a]=k.useState(!1),[o,l]=k.useState(null),[c,u]=k.useState(!1),[d,h]=k.useState(null),{signIn:p,signUp:y,createUserProfile:v}=$s(),g=async m=>{m.preventDefault(),l(null),u(!0);try{let x;if(s){if(h({type:"loading",message:"Creating your account..."}),x=await y(e,r),x.error)l(x.error.message),h({type:"error",message:x.error.message});else if(x.data.user){if(x.data.user.id)try{await v(x.data.user.id,e)}catch(_){console.error("Error creating user profile:",_)}x.data.session?(h({type:"success",message:"Account created successfully!"}),setTimeout(()=>{n&&n()},1500)):h({type:"success",message:"Account created! Please check your email to confirm your account."})}}else if(h({type:"loading",message:"Signing in..."}),x=await p(e,r),x.error)x.error.message.includes("email not confirmed")?(l("Email confirmation is required. Please check your inbox."),h({type:"error",message:"Email confirmation required"})):(l(x.error.message),h({type:"error",message:x.error.message}));else if(x.data.user){if(x.data.user.id)try{await v(x.data.user.id,e)}catch(_){console.error("Error ensuring user profile exists:",_)}h({type:"success",message:"Signed in successfully!"}),n&&n()}}catch(x){l("An unexpected error occurred. Please try again."),h({type:"error",message:"An unexpected error occurred"}),console.error("Auth error:",x)}finally{u(!1)}};return f.jsxs("div",{className:"p-6 bg-light-card dark:bg-dark-card rounded-lg border border-light-border/20 dark:border-viridian/30 shadow-xl w-full max-w-md",children:[f.jsx("h2",{className:"text-2xl font-bold mb-6 text-center text-light-text dark:text-dark-text",children:s?"Create your account":"Sign in to TradesXBT"}),o&&f.jsx("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/20 border border-red-300 dark:border-red-700 rounded-lg text-red-600 dark:text-red-400 text-sm",children:o}),f.jsxs("form",{onSubmit:g,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-light-subtext dark:text-dark-subtext mb-1",children:"Email"}),f.jsx("input",{id:"email",type:"email",value:e,onChange:m=>t(m.target.value),required:!0,className:"w-full bg-light-bg/90 dark:bg-dark-bg/90 border border-light-border/20 dark:border-viridian/40 rounded-lg py-2 px-3 text-light-text dark:text-dark-text focus:outline-none focus:border-viridian/40 dark:focus:border-viridian/70"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-light-subtext dark:text-dark-subtext mb-1",children:"Password"}),f.jsx("input",{id:"password",type:"password",value:r,onChange:m=>i(m.target.value),required:!0,className:"w-full bg-light-bg/90 dark:bg-dark-bg/90 border border-light-border/20 dark:border-viridian/40 rounded-lg py-2 px-3 text-light-text dark:text-dark-text focus:outline-none focus:border-viridian/40 dark:focus:border-viridian/70"})]}),f.jsx("button",{type:"submit",disabled:c,className:"w-full primary-btn py-2.5 text-base",children:c?f.jsxs("span",{className:"flex items-center justify-center",children:[f.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):s?"Create Account":"Sign In"})]}),f.jsx("div",{className:"mt-6 text-center",children:f.jsx("button",{onClick:()=>a(!s),className:"text-viridian dark:text-viridian hover:underline text-sm",children:s?"Already have an account? Sign in":"Need an account? Sign up"})}),d&&f.jsx(bxe,{type:d.type,message:d.message,onDismiss:()=>h(null)})]})},Sxe=()=>{var a,o;const{user:n,loading:e}=$s(),t=Ia(),i=((o=(a=bc().state)==null?void 0:a.from)==null?void 0:o.pathname)||"/portal";if(n&&!e)return f.jsx(XE,{to:i,replace:!0});const s=()=>{t(i,{replace:!0})};return f.jsx("div",{className:"min-h-screen bg-black text-white flex flex-col",children:f.jsx("div",{className:"flex-grow flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:f.jsxs("div",{className:"w-full max-w-md space-y-8",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("h1",{className:"text-3xl font-bold text-viridian mb-2",children:"TradesXBT"}),f.jsx("p",{className:"text-gray-400",children:"Sign in to access your AI trading dashboard"})]}),f.jsx(wxe,{onSuccess:s}),f.jsxs("div",{className:"text-center text-sm text-gray-400 mt-6",children:[f.jsx("p",{children:"For demo purposes, you can create a new account with any email and password."}),f.jsx("p",{className:"mt-2",children:"Your data will be stored securely in Supabase."})]})]})})})},Exe=()=>{const n=Ia(),e=bc(),{user:t,createUserProfile:r}=$s(),[i,s]=k.useState("loading"),[a,o]=k.useState("Verifying your email..."),[l,c]=k.useState(5);k.useEffect(()=>{const h=new URLSearchParams(e.search),p=h.get("token"),y=h.get("type"),v=h.get("email");(async()=>{try{if(!p||!y||!v){s("error"),o("Invalid confirmation link. Please request a new one.");return}if(y==="email_confirmation"||y==="signup"){const{data:m,error:x}=await Et.auth.getUser();if(x){console.error("Error verifying email:",x),s("error"),o("Failed to verify your email. Please try again.");return}m.user?(v&&await r(m.user.id,v),s("success"),o("Your email has been successfully verified!"),u()):(s("error"),o("Email verification failed. Please sign in manually."))}else s("error"),o("Invalid confirmation type. Please try again.")}catch(m){console.error("Error in email verification:",m),s("error"),o("An unexpected error occurred. Please try again.")}})()},[e.search,r]);const u=()=>{const h=setInterval(()=>{c(p=>p<=1?(clearInterval(h),n("/portal"),0):p-1)},1e3);return()=>clearInterval(h)},d=()=>{switch(i){case"loading":return f.jsx(bY,{size:48,className:"animate-spin text-viridian"});case"success":return f.jsx(Dv,{size:48,className:"text-green-500"});case"error":return f.jsx(ET,{size:48,className:"text-red-500"})}};return f.jsx("div",{className:"min-h-screen bg-black text-white flex flex-col items-center justify-center p-4",children:f.jsxs("div",{className:"bg-dark-card border border-viridian/30 rounded-lg p-8 max-w-md w-full text-center",children:[f.jsx("div",{className:"flex justify-center mb-6",children:d()}),f.jsx("h1",{className:"text-2xl font-bold mb-4",children:i==="loading"?"Verifying Email":i==="success"?"Email Verified!":"Verification Failed"}),f.jsx("p",{className:"text-gray-400 mb-6",children:a}),i==="success"&&f.jsxs("div",{className:"mb-6",children:[f.jsx("div",{className:"w-16 h-16 rounded-full bg-viridian/20 flex items-center justify-center text-white text-2xl mx-auto",children:l}),f.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:["Redirecting to dashboard in ",l," seconds..."]})]}),f.jsxs("div",{className:"flex flex-col space-y-4",children:[i==="success"&&f.jsx("button",{onClick:()=>n("/portal"),className:"primary-btn py-2.5",children:"Go to Dashboard Now"}),i==="error"&&f.jsx("button",{onClick:()=>n("/login"),className:"primary-btn py-2.5",children:"Go to Login"}),f.jsx("button",{onClick:()=>n("/"),className:"secondary-btn py-2.5",children:"Back to Home"})]})]})})},Txe=({children:n})=>{const{user:e,loading:t}=$s(),r=bc();return t?f.jsx("div",{className:"min-h-screen flex items-center justify-center bg-light-bg dark:bg-black text-light-text dark:text-dark-text",children:f.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-viridian border-t-transparent rounded-full"})}):e?f.jsx(f.Fragment,{children:n}):f.jsx(XE,{to:"/login",state:{from:r},replace:!0})},Mxe=()=>{const n=Ia(),{user:e}=$s(),t=()=>{n(e?"/portal":"/login")};return f.jsxs("div",{className:"min-h-screen bg-black text-white",children:[f.jsx(w7,{}),f.jsxs("div",{className:"relative z-10",children:[f.jsx("nav",{className:"fixed top-0 left-0 right-0 z-50 bg-black/80 backdrop-blur-sm border-b border-green-500/20 py-4 px-6",children:f.jsxs("div",{className:"max-w-7xl mx-auto flex justify-between items-center",children:[f.jsx("div",{className:"text-2xl font-bold text-green-400",children:"Blockswarm"}),f.jsx("button",{onClick:t,className:"px-6 py-2 bg-green-500 text-black font-semibold rounded-lg hover:bg-green-400 transition-colors",children:"Enter Portal"})]})}),f.jsx(_xe,{}),f.jsxs("div",{className:"container mx-auto px-4 py-12",children:[f.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-24",children:[{icon:f.jsx(y3,{className:"w-8 h-8 text-green-400"}),title:"AI Analysis",description:"Advanced token analysis powered by Claude AI"},{icon:f.jsx(Zf,{className:"w-8 h-8 text-green-400"}),title:"Live Signals",description:"Real-time trading signals and market insights"},{icon:f.jsx(LY,{className:"w-8 h-8 text-green-400"}),title:"Portfolio Tracking",description:"Monitor and manage your Solana portfolio"},{icon:f.jsx(IS,{className:"w-8 h-8 text-green-400"}),title:"Market Data",description:"Comprehensive price and market cap tracking"}].map((r,i)=>f.jsxs("div",{className:"bg-black/80 backdrop-blur-lg rounded-xl p-6 border border-green-500/20 hover:border-green-500/40 transition-all duration-300",children:[r.icon,f.jsx("h3",{className:"text-xl font-semibold mt-4 mb-2",children:r.title}),f.jsx("p",{className:"text-gray-400",children:r.description})]},i))}),f.jsxs("div",{className:"mb-24",children:[f.jsx("h2",{className:"text-3xl font-bold mb-8 text-center bg-gradient-to-r from-green-400 to-cyan-400 bg-clip-text text-transparent",children:"What Our Investors Say"}),f.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[{quote:"TradesXBT has transformed my Solana trading strategy. The AI insights are consistently ahead of market trends.",author:"Alex K.",role:"Early Investor"},{quote:"I've tried many trading platforms, but none offer the level of AI intelligence and Solana ecosystem focus like TradesXBT.",author:"Sarah M.",role:"Crypto Entrepreneur"},{quote:"The returns I've seen since joining the hedge fund have exceeded my expectations. The AI agent is truly impressive.",author:"David L.",role:"Institutional Investor"}].map((r,i)=>f.jsxs("div",{className:"bg-black/80 backdrop-blur-lg rounded-xl p-6 border border-green-500/20",children:[f.jsx("div",{className:"mb-4",children:[1,2,3,4,5].map(s=>f.jsx("span",{className:"text-green-400",children:""},s))}),f.jsxs("p",{className:"text-gray-400 mb-6 italic",children:['"',r.quote,'"']}),f.jsxs("div",{children:[f.jsx("p",{className:"font-semibold text-white",children:r.author}),f.jsx("p",{className:"text-green-400 text-sm",children:r.role})]})]},i))})]})]})]}),f.jsx(yme,{})]})},kxe=()=>f.jsx(Txe,{children:f.jsx(gme,{})});function Axe(){return f.jsx(QU,{children:f.jsx(iH,{children:f.jsxs(tH,{children:[f.jsx(su,{path:"/",element:f.jsx(Mxe,{})}),f.jsx(su,{path:"/portal",element:f.jsx(kxe,{})}),f.jsx(su,{path:"/login",element:f.jsx(Sxe,{})}),f.jsx(su,{path:"/confirm",element:f.jsx(Exe,{})}),f.jsx(su,{path:"*",element:f.jsx(XE,{to:"/",replace:!0})})]})})})}RI(document.getElementById("root")).render(f.jsx(k.StrictMode,{children:f.jsx(Vle,{children:f.jsx(Ole,{children:f.jsx(mZ,{children:f.jsx(Ile,{children:f.jsx(Lle,{children:f.jsx(Axe,{})})})})})})}));export{o1 as B,Yi as P,wU as c,Cp as g,Cu as r};
